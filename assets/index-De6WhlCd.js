(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=r(a);fetch(a.href,o)}})();var X0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},pm={exports:{}},Su={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r_;function JA(){if(r_)return Su;r_=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function r(n,a,o){var l=null;if(o!==void 0&&(l=""+o),a.key!==void 0&&(l=""+a.key),"key"in a){o={};for(var u in a)u!=="key"&&(o[u]=a[u])}else o=a;return a=o.ref,{$$typeof:t,type:n,key:l,ref:a!==void 0?a:null,props:o}}return Su.Fragment=e,Su.jsx=r,Su.jsxs=r,Su}var n_;function e3(){return n_||(n_=1,pm.exports=JA()),pm.exports}var k=e3(),gm={exports:{}},At={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var a_;function t3(){if(a_)return At;a_=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),v=Symbol.iterator;function _(W){return W===null||typeof W!="object"?null:(W=v&&W[v]||W["@@iterator"],typeof W=="function"?W:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,E={};function S(W,pe,V){this.props=W,this.context=pe,this.refs=E,this.updater=V||y}S.prototype.isReactComponent={},S.prototype.setState=function(W,pe){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,pe,"setState")},S.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function L(){}L.prototype=S.prototype;function z(W,pe,V){this.props=W,this.context=pe,this.refs=E,this.updater=V||y}var O=z.prototype=new L;O.constructor=z,w(O,S.prototype),O.isPureReactComponent=!0;var ee=Array.isArray,te={H:null,A:null,T:null,S:null,V:null},Z=Object.prototype.hasOwnProperty;function C(W,pe,V,Y,Q,J){return V=J.ref,{$$typeof:t,type:W,key:pe,ref:V!==void 0?V:null,props:J}}function I(W,pe){return C(W.type,pe,void 0,void 0,void 0,W.props)}function R(W){return typeof W=="object"&&W!==null&&W.$$typeof===t}function B(W){var pe={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(V){return pe[V]})}var D=/\/+/g;function F(W,pe){return typeof W=="object"&&W!==null&&W.key!=null?B(""+W.key):pe.toString(36)}function M(){}function Fe(W){switch(W.status){case"fulfilled":return W.value;case"rejected":throw W.reason;default:switch(typeof W.status=="string"?W.then(M,M):(W.status="pending",W.then(function(pe){W.status==="pending"&&(W.status="fulfilled",W.value=pe)},function(pe){W.status==="pending"&&(W.status="rejected",W.reason=pe)})),W.status){case"fulfilled":return W.value;case"rejected":throw W.reason}}throw W}function Se(W,pe,V,Y,Q){var J=typeof W;(J==="undefined"||J==="boolean")&&(W=null);var ue=!1;if(W===null)ue=!0;else switch(J){case"bigint":case"string":case"number":ue=!0;break;case"object":switch(W.$$typeof){case t:case e:ue=!0;break;case p:return ue=W._init,Se(ue(W._payload),pe,V,Y,Q)}}if(ue)return Q=Q(W),ue=Y===""?"."+F(W,0):Y,ee(Q)?(V="",ue!=null&&(V=ue.replace(D,"$&/")+"/"),Se(Q,pe,V,"",function(Oe){return Oe})):Q!=null&&(R(Q)&&(Q=I(Q,V+(Q.key==null||W&&W.key===Q.key?"":(""+Q.key).replace(D,"$&/")+"/")+ue)),pe.push(Q)),1;ue=0;var Ie=Y===""?".":Y+":";if(ee(W))for(var ke=0;ke<W.length;ke++)Y=W[ke],J=Ie+F(Y,ke),ue+=Se(Y,pe,V,J,Q);else if(ke=_(W),typeof ke=="function")for(W=ke.call(W),ke=0;!(Y=W.next()).done;)Y=Y.value,J=Ie+F(Y,ke++),ue+=Se(Y,pe,V,J,Q);else if(J==="object"){if(typeof W.then=="function")return Se(Fe(W),pe,V,Y,Q);throw pe=String(W),Error("Objects are not valid as a React child (found: "+(pe==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":pe)+"). If you meant to render a collection of children, use an array instead.")}return ue}function ne(W,pe,V){if(W==null)return W;var Y=[],Q=0;return Se(W,Y,"","",function(J){return pe.call(V,J,Q++)}),Y}function se(W){if(W._status===-1){var pe=W._result;pe=pe(),pe.then(function(V){(W._status===0||W._status===-1)&&(W._status=1,W._result=V)},function(V){(W._status===0||W._status===-1)&&(W._status=2,W._result=V)}),W._status===-1&&(W._status=0,W._result=pe)}if(W._status===1)return W._result.default;throw W._result}var Le=typeof reportError=="function"?reportError:function(W){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var pe=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof W=="object"&&W!==null&&typeof W.message=="string"?String(W.message):String(W),error:W});if(!window.dispatchEvent(pe))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",W);return}console.error(W)};function ae(){}return At.Children={map:ne,forEach:function(W,pe,V){ne(W,function(){pe.apply(this,arguments)},V)},count:function(W){var pe=0;return ne(W,function(){pe++}),pe},toArray:function(W){return ne(W,function(pe){return pe})||[]},only:function(W){if(!R(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},At.Component=S,At.Fragment=r,At.Profiler=a,At.PureComponent=z,At.StrictMode=n,At.Suspense=h,At.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=te,At.__COMPILER_RUNTIME={__proto__:null,c:function(W){return te.H.useMemoCache(W)}},At.cache=function(W){return function(){return W.apply(null,arguments)}},At.cloneElement=function(W,pe,V){if(W==null)throw Error("The argument must be a React element, but you passed "+W+".");var Y=w({},W.props),Q=W.key,J=void 0;if(pe!=null)for(ue in pe.ref!==void 0&&(J=void 0),pe.key!==void 0&&(Q=""+pe.key),pe)!Z.call(pe,ue)||ue==="key"||ue==="__self"||ue==="__source"||ue==="ref"&&pe.ref===void 0||(Y[ue]=pe[ue]);var ue=arguments.length-2;if(ue===1)Y.children=V;else if(1<ue){for(var Ie=Array(ue),ke=0;ke<ue;ke++)Ie[ke]=arguments[ke+2];Y.children=Ie}return C(W.type,Q,void 0,void 0,J,Y)},At.createContext=function(W){return W={$$typeof:l,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null},W.Provider=W,W.Consumer={$$typeof:o,_context:W},W},At.createElement=function(W,pe,V){var Y,Q={},J=null;if(pe!=null)for(Y in pe.key!==void 0&&(J=""+pe.key),pe)Z.call(pe,Y)&&Y!=="key"&&Y!=="__self"&&Y!=="__source"&&(Q[Y]=pe[Y]);var ue=arguments.length-2;if(ue===1)Q.children=V;else if(1<ue){for(var Ie=Array(ue),ke=0;ke<ue;ke++)Ie[ke]=arguments[ke+2];Q.children=Ie}if(W&&W.defaultProps)for(Y in ue=W.defaultProps,ue)Q[Y]===void 0&&(Q[Y]=ue[Y]);return C(W,J,void 0,void 0,null,Q)},At.createRef=function(){return{current:null}},At.forwardRef=function(W){return{$$typeof:u,render:W}},At.isValidElement=R,At.lazy=function(W){return{$$typeof:p,_payload:{_status:-1,_result:W},_init:se}},At.memo=function(W,pe){return{$$typeof:d,type:W,compare:pe===void 0?null:pe}},At.startTransition=function(W){var pe=te.T,V={};te.T=V;try{var Y=W(),Q=te.S;Q!==null&&Q(V,Y),typeof Y=="object"&&Y!==null&&typeof Y.then=="function"&&Y.then(ae,Le)}catch(J){Le(J)}finally{te.T=pe}},At.unstable_useCacheRefresh=function(){return te.H.useCacheRefresh()},At.use=function(W){return te.H.use(W)},At.useActionState=function(W,pe,V){return te.H.useActionState(W,pe,V)},At.useCallback=function(W,pe){return te.H.useCallback(W,pe)},At.useContext=function(W){return te.H.useContext(W)},At.useDebugValue=function(){},At.useDeferredValue=function(W,pe){return te.H.useDeferredValue(W,pe)},At.useEffect=function(W,pe,V){var Y=te.H;if(typeof V=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return Y.useEffect(W,pe)},At.useId=function(){return te.H.useId()},At.useImperativeHandle=function(W,pe,V){return te.H.useImperativeHandle(W,pe,V)},At.useInsertionEffect=function(W,pe){return te.H.useInsertionEffect(W,pe)},At.useLayoutEffect=function(W,pe){return te.H.useLayoutEffect(W,pe)},At.useMemo=function(W,pe){return te.H.useMemo(W,pe)},At.useOptimistic=function(W,pe){return te.H.useOptimistic(W,pe)},At.useReducer=function(W,pe,V){return te.H.useReducer(W,pe,V)},At.useRef=function(W){return te.H.useRef(W)},At.useState=function(W){return te.H.useState(W)},At.useSyncExternalStore=function(W,pe,V){return te.H.useSyncExternalStore(W,pe,V)},At.useTransition=function(){return te.H.useTransition()},At.version="19.1.1",At}var i_;function Sp(){return i_||(i_=1,gm.exports=t3()),gm.exports}var bt=Sp(),xm={exports:{}},Au={},vm={exports:{}},_m={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var s_;function r3(){return s_||(s_=1,(function(t){function e(ne,se){var Le=ne.length;ne.push(se);e:for(;0<Le;){var ae=Le-1>>>1,W=ne[ae];if(0<a(W,se))ne[ae]=se,ne[Le]=W,Le=ae;else break e}}function r(ne){return ne.length===0?null:ne[0]}function n(ne){if(ne.length===0)return null;var se=ne[0],Le=ne.pop();if(Le!==se){ne[0]=Le;e:for(var ae=0,W=ne.length,pe=W>>>1;ae<pe;){var V=2*(ae+1)-1,Y=ne[V],Q=V+1,J=ne[Q];if(0>a(Y,Le))Q<W&&0>a(J,Y)?(ne[ae]=J,ne[Q]=Le,ae=Q):(ne[ae]=Y,ne[V]=Le,ae=V);else if(Q<W&&0>a(J,Le))ne[ae]=J,ne[Q]=Le,ae=Q;else break e}}return se}function a(ne,se){var Le=ne.sortIndex-se.sortIndex;return Le!==0?Le:ne.id-se.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var l=Date,u=l.now();t.unstable_now=function(){return l.now()-u}}var h=[],d=[],p=1,v=null,_=3,y=!1,w=!1,E=!1,S=!1,L=typeof setTimeout=="function"?setTimeout:null,z=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;function ee(ne){for(var se=r(d);se!==null;){if(se.callback===null)n(d);else if(se.startTime<=ne)n(d),se.sortIndex=se.expirationTime,e(h,se);else break;se=r(d)}}function te(ne){if(E=!1,ee(ne),!w)if(r(h)!==null)w=!0,Z||(Z=!0,F());else{var se=r(d);se!==null&&Se(te,se.startTime-ne)}}var Z=!1,C=-1,I=5,R=-1;function B(){return S?!0:!(t.unstable_now()-R<I)}function D(){if(S=!1,Z){var ne=t.unstable_now();R=ne;var se=!0;try{e:{w=!1,E&&(E=!1,z(C),C=-1),y=!0;var Le=_;try{t:{for(ee(ne),v=r(h);v!==null&&!(v.expirationTime>ne&&B());){var ae=v.callback;if(typeof ae=="function"){v.callback=null,_=v.priorityLevel;var W=ae(v.expirationTime<=ne);if(ne=t.unstable_now(),typeof W=="function"){v.callback=W,ee(ne),se=!0;break t}v===r(h)&&n(h),ee(ne)}else n(h);v=r(h)}if(v!==null)se=!0;else{var pe=r(d);pe!==null&&Se(te,pe.startTime-ne),se=!1}}break e}finally{v=null,_=Le,y=!1}se=void 0}}finally{se?F():Z=!1}}}var F;if(typeof O=="function")F=function(){O(D)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,Fe=M.port2;M.port1.onmessage=D,F=function(){Fe.postMessage(null)}}else F=function(){L(D,0)};function Se(ne,se){C=L(function(){ne(t.unstable_now())},se)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ne){ne.callback=null},t.unstable_forceFrameRate=function(ne){0>ne||125<ne?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<ne?Math.floor(1e3/ne):5},t.unstable_getCurrentPriorityLevel=function(){return _},t.unstable_next=function(ne){switch(_){case 1:case 2:case 3:var se=3;break;default:se=_}var Le=_;_=se;try{return ne()}finally{_=Le}},t.unstable_requestPaint=function(){S=!0},t.unstable_runWithPriority=function(ne,se){switch(ne){case 1:case 2:case 3:case 4:case 5:break;default:ne=3}var Le=_;_=ne;try{return se()}finally{_=Le}},t.unstable_scheduleCallback=function(ne,se,Le){var ae=t.unstable_now();switch(typeof Le=="object"&&Le!==null?(Le=Le.delay,Le=typeof Le=="number"&&0<Le?ae+Le:ae):Le=ae,ne){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=Le+W,ne={id:p++,callback:se,priorityLevel:ne,startTime:Le,expirationTime:W,sortIndex:-1},Le>ae?(ne.sortIndex=Le,e(d,ne),r(h)===null&&ne===r(d)&&(E?(z(C),C=-1):E=!0,Se(te,Le-ae))):(ne.sortIndex=W,e(h,ne),w||y||(w=!0,Z||(Z=!0,F()))),ne},t.unstable_shouldYield=B,t.unstable_wrapCallback=function(ne){var se=_;return function(){var Le=_;_=se;try{return ne.apply(this,arguments)}finally{_=Le}}}})(_m)),_m}var o_;function n3(){return o_||(o_=1,vm.exports=r3()),vm.exports}var ym={exports:{}},Sn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l_;function a3(){if(l_)return Sn;l_=1;var t=Sp();function e(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(e(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(h,d,p){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:v==null?null:""+v,children:h,containerInfo:d,implementation:p}}var l=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Sn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,Sn.createPortal=function(h,d){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return o(h,d,null,p)},Sn.flushSync=function(h){var d=l.T,p=n.p;try{if(l.T=null,n.p=2,h)return h()}finally{l.T=d,n.p=p,n.d.f()}},Sn.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(h,d))},Sn.prefetchDNS=function(h){typeof h=="string"&&n.d.D(h)},Sn.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var p=d.as,v=u(p,d.crossOrigin),_=typeof d.integrity=="string"?d.integrity:void 0,y=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;p==="style"?n.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:v,integrity:_,fetchPriority:y}):p==="script"&&n.d.X(h,{crossOrigin:v,integrity:_,fetchPriority:y,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Sn.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var p=u(d.as,d.crossOrigin);n.d.M(h,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(h)},Sn.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var p=d.as,v=u(p,d.crossOrigin);n.d.L(h,p,{crossOrigin:v,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Sn.preloadModule=function(h,d){if(typeof h=="string")if(d){var p=u(d.as,d.crossOrigin);n.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(h)},Sn.requestFormReset=function(h){n.d.r(h)},Sn.unstable_batchedUpdates=function(h,d){return h(d)},Sn.useFormState=function(h,d,p){return l.H.useFormState(h,d,p)},Sn.useFormStatus=function(){return l.H.useHostTransitionStatus()},Sn.version="19.1.1",Sn}var c_;function i3(){if(c_)return ym.exports;c_=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),ym.exports=a3(),ym.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var u_;function s3(){if(u_)return Au;u_=1;var t=n3(),e=Sp(),r=i3();function n(i){var s="https://react.dev/errors/"+i;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)s+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function o(i){var s=i,c=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,(s.flags&4098)!==0&&(c=s.return),i=s.return;while(i)}return s.tag===3?c:null}function l(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function u(i){if(o(i)!==i)throw Error(n(188))}function h(i){var s=i.alternate;if(!s){if(s=o(i),s===null)throw Error(n(188));return s!==i?null:i}for(var c=i,f=s;;){var g=c.return;if(g===null)break;var x=g.alternate;if(x===null){if(f=g.return,f!==null){c=f;continue}break}if(g.child===x.child){for(x=g.child;x;){if(x===c)return u(g),i;if(x===f)return u(g),s;x=x.sibling}throw Error(n(188))}if(c.return!==f.return)c=g,f=x;else{for(var b=!1,P=g.child;P;){if(P===c){b=!0,c=g,f=x;break}if(P===f){b=!0,f=g,c=x;break}P=P.sibling}if(!b){for(P=x.child;P;){if(P===c){b=!0,c=x,f=g;break}if(P===f){b=!0,f=x,c=g;break}P=P.sibling}if(!b)throw Error(n(189))}}if(c.alternate!==f)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?i:s}function d(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i;for(i=i.child;i!==null;){if(s=d(i),s!==null)return s;i=i.sibling}return null}var p=Object.assign,v=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),L=Symbol.for("react.provider"),z=Symbol.for("react.consumer"),O=Symbol.for("react.context"),ee=Symbol.for("react.forward_ref"),te=Symbol.for("react.suspense"),Z=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),B=Symbol.for("react.memo_cache_sentinel"),D=Symbol.iterator;function F(i){return i===null||typeof i!="object"?null:(i=D&&i[D]||i["@@iterator"],typeof i=="function"?i:null)}var M=Symbol.for("react.client.reference");function Fe(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===M?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case w:return"Fragment";case S:return"Profiler";case E:return"StrictMode";case te:return"Suspense";case Z:return"SuspenseList";case R:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case y:return"Portal";case O:return(i.displayName||"Context")+".Provider";case z:return(i._context.displayName||"Context")+".Consumer";case ee:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case C:return s=i.displayName||null,s!==null?s:Fe(i.type)||"Memo";case I:s=i._payload,i=i._init;try{return Fe(i(s))}catch{}}return null}var Se=Array.isArray,ne=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,se=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Le={pending:!1,data:null,method:null,action:null},ae=[],W=-1;function pe(i){return{current:i}}function V(i){0>W||(i.current=ae[W],ae[W]=null,W--)}function Y(i,s){W++,ae[W]=i.current,i.current=s}var Q=pe(null),J=pe(null),ue=pe(null),Ie=pe(null);function ke(i,s){switch(Y(ue,s),Y(J,i),Y(Q,null),s.nodeType){case 9:case 11:i=(i=s.documentElement)&&(i=i.namespaceURI)?D2(i):0;break;default:if(i=s.tagName,s=s.namespaceURI)s=D2(s),i=I2(s,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}V(Q),Y(Q,i)}function Oe(){V(Q),V(J),V(ue)}function le(i){i.memoizedState!==null&&Y(Ie,i);var s=Q.current,c=I2(s,i.type);s!==c&&(Y(J,i),Y(Q,c))}function Qe(i){J.current===i&&(V(Q),V(J)),Ie.current===i&&(V(Ie),_u._currentValue=Le)}var G=Object.prototype.hasOwnProperty,et=t.unstable_scheduleCallback,Ve=t.unstable_cancelCallback,at=t.unstable_shouldYield,Ze=t.unstable_requestPaint,be=t.unstable_now,Ee=t.unstable_getCurrentPriorityLevel,ze=t.unstable_ImmediatePriority,Ke=t.unstable_UserBlockingPriority,We=t.unstable_NormalPriority,Be=t.unstable_LowPriority,Ye=t.unstable_IdlePriority,je=t.log,dt=t.unstable_setDisableYieldValue,rt=null,lt=null;function ut(i){if(typeof je=="function"&&dt(i),lt&&typeof lt.setStrictMode=="function")try{lt.setStrictMode(rt,i)}catch{}}var Tt=Math.clz32?Math.clz32:pr,ft=Math.log,er=Math.LN2;function pr(i){return i>>>=0,i===0?32:31-(ft(i)/er|0)|0}var tr=256,En=4194304;function Wn(i){var s=i&42;if(s!==0)return s;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function ss(i,s,c){var f=i.pendingLanes;if(f===0)return 0;var g=0,x=i.suspendedLanes,b=i.pingedLanes;i=i.warmLanes;var P=f&134217727;return P!==0?(f=P&~x,f!==0?g=Wn(f):(b&=P,b!==0?g=Wn(b):c||(c=P&~i,c!==0&&(g=Wn(c))))):(P=f&~x,P!==0?g=Wn(P):b!==0?g=Wn(b):c||(c=f&~i,c!==0&&(g=Wn(c)))),g===0?0:s!==0&&s!==g&&(s&x)===0&&(x=g&-g,c=s&-s,x>=c||x===32&&(c&4194048)!==0)?s:g}function bi(i,s){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&s)===0}function os(i,s){switch(i){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ls(){var i=tr;return tr<<=1,(tr&4194048)===0&&(tr=256),i}function cs(){var i=En;return En<<=1,(En&62914560)===0&&(En=4194304),i}function La(i){for(var s=[],c=0;31>c;c++)s.push(i);return s}function Ba(i,s){i.pendingLanes|=s,s!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function $a(i,s,c,f,g,x){var b=i.pendingLanes;i.pendingLanes=c,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=c,i.entangledLanes&=c,i.errorRecoveryDisabledLanes&=c,i.shellSuspendCounter=0;var P=i.entanglements,re=i.expirationTimes,me=i.hiddenUpdates;for(c=b&~c;0<c;){var Ae=31-Tt(c),Re=1<<Ae;P[Ae]=0,re[Ae]=-1;var ve=me[Ae];if(ve!==null)for(me[Ae]=null,Ae=0;Ae<ve.length;Ae++){var _e=ve[Ae];_e!==null&&(_e.lane&=-536870913)}c&=~Re}f!==0&&ma(i,f,0),x!==0&&g===0&&i.tag!==0&&(i.suspendedLanes|=x&~(b&~s))}function ma(i,s,c){i.pendingLanes|=s,i.suspendedLanes&=~s;var f=31-Tt(s);i.entangledLanes|=s,i.entanglements[f]=i.entanglements[f]|1073741824|c&4194090}function ao(i,s){var c=i.entangledLanes|=s;for(i=i.entanglements;c;){var f=31-Tt(c),g=1<<f;g&s|i[f]&s&&(i[f]|=s),c&=~g}}function Qa(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function us(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function Za(){var i=se.p;return i!==0?i:(i=window.event,i===void 0?32:$2(i.type))}function sl(i,s){var c=se.p;try{return se.p=i,s()}finally{se.p=c}}var dr=Math.random().toString(36).slice(2),Or="__reactFiber$"+dr,yr="__reactProps$"+dr,Gn="__reactContainer$"+dr,io="__reactEvents$"+dr,kc="__reactListeners$"+dr,N="__reactHandles$"+dr,X="__reactResources$"+dr,j="__reactMarker$"+dr;function H(i){delete i[Or],delete i[yr],delete i[io],delete i[kc],delete i[N]}function q(i){var s=i[Or];if(s)return s;for(var c=i.parentNode;c;){if(s=c[Gn]||c[Or]){if(c=s.alternate,s.child!==null||c!==null&&c.child!==null)for(i=M2(i);i!==null;){if(c=i[Or])return c;i=M2(i)}return s}i=c,c=i.parentNode}return null}function K(i){if(i=i[Or]||i[Gn]){var s=i.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return i}return null}function de(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i.stateNode;throw Error(n(33))}function ye(i){var s=i[X];return s||(s=i[X]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function ce(i){i[j]=!0}var ge=new Set,xe={};function Me(i,s){He(i,s),He(i+"Capture",s)}function He(i,s){for(xe[i]=s,i=0;i<s.length;i++)ge.add(s[i])}var Je=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ue={},$e={};function vt(i){return G.call($e,i)?!0:G.call(Ue,i)?!1:Je.test(i)?$e[i]=!0:(Ue[i]=!0,!1)}function qt(i,s,c){if(vt(s))if(c===null)i.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":i.removeAttribute(s);return;case"boolean":var f=s.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){i.removeAttribute(s);return}}i.setAttribute(s,""+c)}}function Pt(i,s,c){if(c===null)i.removeAttribute(s);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(s);return}i.setAttribute(s,""+c)}}function Lt(i,s,c,f){if(f===null)i.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(c);return}i.setAttributeNS(s,c,""+f)}}var ea,Ja;function Pn(i){if(ea===void 0)try{throw Error()}catch(c){var s=c.stack.trim().match(/\n( *(at )?)/);ea=s&&s[1]||"",Ja=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ea+i+Ja}var qn=!1;function ei(i,s){if(!i||qn)return"";qn=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(s){var Re=function(){throw Error()};if(Object.defineProperty(Re.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Re,[])}catch(_e){var ve=_e}Reflect.construct(i,[],Re)}else{try{Re.call()}catch(_e){ve=_e}i.call(Re.prototype)}}else{try{throw Error()}catch(_e){ve=_e}(Re=i())&&typeof Re.catch=="function"&&Re.catch(function(){})}}catch(_e){if(_e&&ve&&typeof _e.stack=="string")return[_e.stack,ve.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var x=f.DetermineComponentFrameRoot(),b=x[0],P=x[1];if(b&&P){var re=b.split(`
`),me=P.split(`
`);for(g=f=0;f<re.length&&!re[f].includes("DetermineComponentFrameRoot");)f++;for(;g<me.length&&!me[g].includes("DetermineComponentFrameRoot");)g++;if(f===re.length||g===me.length)for(f=re.length-1,g=me.length-1;1<=f&&0<=g&&re[f]!==me[g];)g--;for(;1<=f&&0<=g;f--,g--)if(re[f]!==me[g]){if(f!==1||g!==1)do if(f--,g--,0>g||re[f]!==me[g]){var Ae=`
`+re[f].replace(" at new "," at ");return i.displayName&&Ae.includes("<anonymous>")&&(Ae=Ae.replace("<anonymous>",i.displayName)),Ae}while(1<=f&&0<=g);break}}}finally{qn=!1,Error.prepareStackTrace=c}return(c=i?i.displayName||i.name:"")?Pn(c):""}function Ln(i){switch(i.tag){case 26:case 27:case 5:return Pn(i.type);case 16:return Pn("Lazy");case 13:return Pn("Suspense");case 19:return Pn("SuspenseList");case 0:case 15:return ei(i.type,!1);case 11:return ei(i.type.render,!1);case 1:return ei(i.type,!0);case 31:return Pn("Activity");default:return""}}function ol(i){try{var s="";do s+=Ln(i),i=i.return;while(i);return s}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}function Bn(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function bc(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function _d(i){var s=bc(i)?"checked":"value",c=Object.getOwnPropertyDescriptor(i.constructor.prototype,s),f=""+i[s];if(!i.hasOwnProperty(s)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var g=c.get,x=c.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return g.call(this)},set:function(b){f=""+b,x.call(this,b)}}),Object.defineProperty(i,s,{enumerable:c.enumerable}),{getValue:function(){return f},setValue:function(b){f=""+b},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function ll(i){i._valueTracker||(i._valueTracker=_d(i))}function Cc(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var c=s.getValue(),f="";return i&&(f=bc(i)?i.checked?"true":"false":i.value),i=f,i!==c?(s.setValue(i),!0):!1}function so(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var yd=/[\n"\\]/g;function Vr(i){return i.replace(yd,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function ta(i,s,c,f,g,x,b,P){i.name="",b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"?i.type=b:i.removeAttribute("type"),s!=null?b==="number"?(s===0&&i.value===""||i.value!=s)&&(i.value=""+Bn(s)):i.value!==""+Bn(s)&&(i.value=""+Bn(s)):b!=="submit"&&b!=="reset"||i.removeAttribute("value"),s!=null?fs(i,b,Bn(s)):c!=null?fs(i,b,Bn(c)):f!=null&&i.removeAttribute("value"),g==null&&x!=null&&(i.defaultChecked=!!x),g!=null&&(i.checked=g&&typeof g!="function"&&typeof g!="symbol"),P!=null&&typeof P!="function"&&typeof P!="symbol"&&typeof P!="boolean"?i.name=""+Bn(P):i.removeAttribute("name")}function oo(i,s,c,f,g,x,b,P){if(x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"&&(i.type=x),s!=null||c!=null){if(!(x!=="submit"&&x!=="reset"||s!=null))return;c=c!=null?""+Bn(c):"",s=s!=null?""+Bn(s):c,P||s===i.value||(i.value=s),i.defaultValue=s}f=f??g,f=typeof f!="function"&&typeof f!="symbol"&&!!f,i.checked=P?i.checked:!!f,i.defaultChecked=!!f,b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(i.name=b)}function fs(i,s,c){s==="number"&&so(i.ownerDocument)===i||i.defaultValue===""+c||(i.defaultValue=""+c)}function Ci(i,s,c,f){if(i=i.options,s){s={};for(var g=0;g<c.length;g++)s["$"+c[g]]=!0;for(c=0;c<i.length;c++)g=s.hasOwnProperty("$"+i[c].value),i[c].selected!==g&&(i[c].selected=g),g&&f&&(i[c].defaultSelected=!0)}else{for(c=""+Bn(c),s=null,g=0;g<i.length;g++){if(i[g].value===c){i[g].selected=!0,f&&(i[g].defaultSelected=!0);return}s!==null||i[g].disabled||(s=i[g])}s!==null&&(s.selected=!0)}}function or(i,s,c){if(s!=null&&(s=""+Bn(s),s!==i.value&&(i.value=s),c==null)){i.defaultValue!==s&&(i.defaultValue=s);return}i.defaultValue=c!=null?""+Bn(c):""}function lo(i,s,c,f){if(s==null){if(f!=null){if(c!=null)throw Error(n(92));if(Se(f)){if(1<f.length)throw Error(n(93));f=f[0]}c=f}c==null&&(c=""),s=c}c=Bn(s),i.defaultValue=c,f=i.textContent,f===c&&f!==""&&f!==null&&(i.value=f)}function pa(i,s){if(s){var c=i.firstChild;if(c&&c===i.lastChild&&c.nodeType===3){c.nodeValue=s;return}}i.textContent=s}var co=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Of(i,s,c){var f=s.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?f?i.setProperty(s,""):s==="float"?i.cssFloat="":i[s]="":f?i.setProperty(s,c):typeof c!="number"||c===0||co.has(s)?s==="float"?i.cssFloat=c:i[s]=(""+c).trim():i[s]=c+"px"}function Rc(i,s,c){if(s!=null&&typeof s!="object")throw Error(n(62));if(i=i.style,c!=null){for(var f in c)!c.hasOwnProperty(f)||s!=null&&s.hasOwnProperty(f)||(f.indexOf("--")===0?i.setProperty(f,""):f==="float"?i.cssFloat="":i[f]="");for(var g in s)f=s[g],s.hasOwnProperty(g)&&c[g]!==f&&Of(i,g,f)}else for(var x in s)s.hasOwnProperty(x)&&Of(i,x,s[x])}function Dc(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Td=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ed=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function cl(i){return Ed.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var Ri=null;function ga(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Di=null,Ii=null;function Ic(i){var s=K(i);if(s&&(i=s.stateNode)){var c=i[yr]||null;e:switch(i=s.stateNode,s.type){case"input":if(ta(i,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),s=c.name,c.type==="radio"&&s!=null){for(c=i;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Vr(""+s)+'"][type="radio"]'),s=0;s<c.length;s++){var f=c[s];if(f!==i&&f.form===i.form){var g=f[yr]||null;if(!g)throw Error(n(90));ta(f,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(s=0;s<c.length;s++)f=c[s],f.form===i.form&&Cc(f)}break e;case"textarea":or(i,c.value,c.defaultValue);break e;case"select":s=c.value,s!=null&&Ci(i,!!c.multiple,s,!1)}}}var ti=!1;function Ff(i,s,c){if(ti)return i(s,c);ti=!0;try{var f=i(s);return f}finally{if(ti=!1,(Di!==null||Ii!==null)&&(k0(),Di&&(s=Di,i=Ii,Ii=Di=null,Ic(s),i)))for(s=0;s<i.length;s++)Ic(i[s])}}function uo(i,s){var c=i.stateNode;if(c===null)return null;var f=c[yr]||null;if(f===null)return null;c=f[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(i=i.type,f=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!f;break e;default:i=!1}if(i)return null;if(c&&typeof c!="function")throw Error(n(231,s,typeof c));return c}var Va=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),xa=!1;if(Va)try{var fo={};Object.defineProperty(fo,"passive",{get:function(){xa=!0}}),window.addEventListener("test",fo,fo),window.removeEventListener("test",fo,fo)}catch{xa=!1}var ri=null,hs=null,Oi=null;function Oc(){if(Oi)return Oi;var i,s=hs,c=s.length,f,g="value"in ri?ri.value:ri.textContent,x=g.length;for(i=0;i<c&&s[i]===g[i];i++);var b=c-i;for(f=1;f<=b&&s[c-f]===g[x-f];f++);return Oi=g.slice(i,1<f?1-f:void 0)}function ni(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function ai(){return!0}function Fc(){return!1}function tn(i){function s(c,f,g,x,b){this._reactName=c,this._targetInst=g,this.type=f,this.nativeEvent=x,this.target=b,this.currentTarget=null;for(var P in i)i.hasOwnProperty(P)&&(c=i[P],this[P]=c?c(x):x[P]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?ai:Fc,this.isPropagationStopped=Fc,this}return p(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=ai)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=ai)},persist:function(){},isPersistent:ai}),s}var $t={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ul=tn($t),ho=p({},$t,{view:0,detail:0}),Nf=tn(ho),fl,hl,ii,mo=p({},ho,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:xo,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==ii&&(ii&&i.type==="mousemove"?(fl=i.screenX-ii.screenX,hl=i.screenY-ii.screenY):hl=fl=0,ii=i),fl)},movementY:function(i){return"movementY"in i?i.movementY:hl}}),va=tn(mo),Mf=p({},mo,{dataTransfer:0}),wd=tn(Mf),po=p({},ho,{relatedTarget:0}),dl=tn(po),Nc=p({},$t,{animationName:0,elapsedTime:0,pseudoElement:0}),ml=tn(Nc),Pf=p({},$t,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),pl=tn(Pf),Sd=p({},$t,{data:0}),Mc=tn(Sd),go={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Lf={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Bf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pc(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=Bf[i])?!!s[i]:!1}function xo(){return Pc}var Vf=p({},ho,{key:function(i){if(i.key){var s=go[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=ni(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Lf[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:xo,charCode:function(i){return i.type==="keypress"?ni(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?ni(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),gl=tn(Vf),Uf=p({},mo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Lc=tn(Uf),Fi=p({},ho,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:xo}),jf=tn(Fi),zf=p({},$t,{propertyName:0,elapsedTime:0,pseudoElement:0}),Hf=tn(zf),Wf=p({},mo,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),xl=tn(Wf),Vn=p({},$t,{newState:0,oldState:0}),Gf=tn(Vn),qf=[9,13,27,32],si=Va&&"CompositionEvent"in window,m=null;Va&&"documentMode"in document&&(m=document.documentMode);var T=Va&&"TextEvent"in window&&!m,A=Va&&(!si||m&&8<m&&11>=m),U=" ",fe=!1;function Te(i,s){switch(i){case"keyup":return qf.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function qe(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Bt=!1;function Xr(i,s){switch(i){case"compositionend":return qe(s);case"keypress":return s.which!==32?null:(fe=!0,U);case"textInput":return i=s.data,i===U&&fe?null:i;default:return null}}function Vt(i,s){if(Bt)return i==="compositionend"||!si&&Te(i,s)?(i=Oc(),Oi=hs=ri=null,Bt=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return A&&s.locale!=="ko"?null:s.data;default:return null}}var rn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Yr(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!rn[i.type]:s==="textarea"}function Ni(i,s,c,f){Di?Ii?Ii.push(f):Ii=[f]:Di=f,s=O0(s,"onChange"),0<s.length&&(c=new ul("onChange","change",null,c,f),i.push({event:c,listeners:s}))}var hn=null,oi=null;function Bc(i){A2(i,0)}function Xf(i){var s=de(i);if(Cc(s))return i}function qg(i,s){if(i==="change")return s}var Xg=!1;if(Va){var Ad;if(Va){var kd="oninput"in document;if(!kd){var Yg=document.createElement("div");Yg.setAttribute("oninput","return;"),kd=typeof Yg.oninput=="function"}Ad=kd}else Ad=!1;Xg=Ad&&(!document.documentMode||9<document.documentMode)}function Kg(){hn&&(hn.detachEvent("onpropertychange",$g),oi=hn=null)}function $g(i){if(i.propertyName==="value"&&Xf(oi)){var s=[];Ni(s,oi,i,ga(i)),Ff(Bc,s)}}function R4(i,s,c){i==="focusin"?(Kg(),hn=s,oi=c,hn.attachEvent("onpropertychange",$g)):i==="focusout"&&Kg()}function D4(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Xf(oi)}function I4(i,s){if(i==="click")return Xf(s)}function O4(i,s){if(i==="input"||i==="change")return Xf(s)}function F4(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var ra=typeof Object.is=="function"?Object.is:F4;function Vc(i,s){if(ra(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var c=Object.keys(i),f=Object.keys(s);if(c.length!==f.length)return!1;for(f=0;f<c.length;f++){var g=c[f];if(!G.call(s,g)||!ra(i[g],s[g]))return!1}return!0}function Qg(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Zg(i,s){var c=Qg(i);i=0;for(var f;c;){if(c.nodeType===3){if(f=i+c.textContent.length,i<=s&&f>=s)return{node:c,offset:s-i};i=f}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=Qg(c)}}function Jg(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?Jg(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function ex(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var s=so(i.document);s instanceof i.HTMLIFrameElement;){try{var c=typeof s.contentWindow.location.href=="string"}catch{c=!1}if(c)i=s.contentWindow;else break;s=so(i.document)}return s}function bd(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}var N4=Va&&"documentMode"in document&&11>=document.documentMode,vl=null,Cd=null,Uc=null,Rd=!1;function tx(i,s,c){var f=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Rd||vl==null||vl!==so(f)||(f=vl,"selectionStart"in f&&bd(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),Uc&&Vc(Uc,f)||(Uc=f,f=O0(Cd,"onSelect"),0<f.length&&(s=new ul("onSelect","select",null,s,c),i.push({event:s,listeners:f}),s.target=vl)))}function vo(i,s){var c={};return c[i.toLowerCase()]=s.toLowerCase(),c["Webkit"+i]="webkit"+s,c["Moz"+i]="moz"+s,c}var _l={animationend:vo("Animation","AnimationEnd"),animationiteration:vo("Animation","AnimationIteration"),animationstart:vo("Animation","AnimationStart"),transitionrun:vo("Transition","TransitionRun"),transitionstart:vo("Transition","TransitionStart"),transitioncancel:vo("Transition","TransitionCancel"),transitionend:vo("Transition","TransitionEnd")},Dd={},rx={};Va&&(rx=document.createElement("div").style,"AnimationEvent"in window||(delete _l.animationend.animation,delete _l.animationiteration.animation,delete _l.animationstart.animation),"TransitionEvent"in window||delete _l.transitionend.transition);function _o(i){if(Dd[i])return Dd[i];if(!_l[i])return i;var s=_l[i],c;for(c in s)if(s.hasOwnProperty(c)&&c in rx)return Dd[i]=s[c];return i}var nx=_o("animationend"),ax=_o("animationiteration"),ix=_o("animationstart"),M4=_o("transitionrun"),P4=_o("transitionstart"),L4=_o("transitioncancel"),sx=_o("transitionend"),ox=new Map,Id="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Id.push("scrollEnd");function Ua(i,s){ox.set(i,s),Me(s,[i])}var lx=new WeakMap;function _a(i,s){if(typeof i=="object"&&i!==null){var c=lx.get(i);return c!==void 0?c:(s={value:i,source:s,stack:ol(s)},lx.set(i,s),s)}return{value:i,source:s,stack:ol(s)}}var ya=[],yl=0,Od=0;function Yf(){for(var i=yl,s=Od=yl=0;s<i;){var c=ya[s];ya[s++]=null;var f=ya[s];ya[s++]=null;var g=ya[s];ya[s++]=null;var x=ya[s];if(ya[s++]=null,f!==null&&g!==null){var b=f.pending;b===null?g.next=g:(g.next=b.next,b.next=g),f.pending=g}x!==0&&cx(c,g,x)}}function Kf(i,s,c,f){ya[yl++]=i,ya[yl++]=s,ya[yl++]=c,ya[yl++]=f,Od|=f,i.lanes|=f,i=i.alternate,i!==null&&(i.lanes|=f)}function Fd(i,s,c,f){return Kf(i,s,c,f),$f(i)}function Tl(i,s){return Kf(i,null,null,s),$f(i)}function cx(i,s,c){i.lanes|=c;var f=i.alternate;f!==null&&(f.lanes|=c);for(var g=!1,x=i.return;x!==null;)x.childLanes|=c,f=x.alternate,f!==null&&(f.childLanes|=c),x.tag===22&&(i=x.stateNode,i===null||i._visibility&1||(g=!0)),i=x,x=x.return;return i.tag===3?(x=i.stateNode,g&&s!==null&&(g=31-Tt(c),i=x.hiddenUpdates,f=i[g],f===null?i[g]=[s]:f.push(s),s.lane=c|536870912),x):null}function $f(i){if(50<fu)throw fu=0,V1=null,Error(n(185));for(var s=i.return;s!==null;)i=s,s=i.return;return i.tag===3?i.stateNode:null}var El={};function B4(i,s,c,f){this.tag=i,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function na(i,s,c,f){return new B4(i,s,c,f)}function Nd(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Mi(i,s){var c=i.alternate;return c===null?(c=na(i.tag,s,i.key,i.mode),c.elementType=i.elementType,c.type=i.type,c.stateNode=i.stateNode,c.alternate=i,i.alternate=c):(c.pendingProps=s,c.type=i.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=i.flags&65011712,c.childLanes=i.childLanes,c.lanes=i.lanes,c.child=i.child,c.memoizedProps=i.memoizedProps,c.memoizedState=i.memoizedState,c.updateQueue=i.updateQueue,s=i.dependencies,c.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},c.sibling=i.sibling,c.index=i.index,c.ref=i.ref,c.refCleanup=i.refCleanup,c}function ux(i,s){i.flags&=65011714;var c=i.alternate;return c===null?(i.childLanes=0,i.lanes=s,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=c.childLanes,i.lanes=c.lanes,i.child=c.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=c.memoizedProps,i.memoizedState=c.memoizedState,i.updateQueue=c.updateQueue,i.type=c.type,s=c.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i}function Qf(i,s,c,f,g,x){var b=0;if(f=i,typeof i=="function")Nd(i)&&(b=1);else if(typeof i=="string")b=UA(i,c,Q.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case R:return i=na(31,c,s,g),i.elementType=R,i.lanes=x,i;case w:return yo(c.children,g,x,s);case E:b=8,g|=24;break;case S:return i=na(12,c,s,g|2),i.elementType=S,i.lanes=x,i;case te:return i=na(13,c,s,g),i.elementType=te,i.lanes=x,i;case Z:return i=na(19,c,s,g),i.elementType=Z,i.lanes=x,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case L:case O:b=10;break e;case z:b=9;break e;case ee:b=11;break e;case C:b=14;break e;case I:b=16,f=null;break e}b=29,c=Error(n(130,i===null?"null":typeof i,"")),f=null}return s=na(b,c,s,g),s.elementType=i,s.type=f,s.lanes=x,s}function yo(i,s,c,f){return i=na(7,i,f,s),i.lanes=c,i}function Md(i,s,c){return i=na(6,i,null,s),i.lanes=c,i}function Pd(i,s,c){return s=na(4,i.children!==null?i.children:[],i.key,s),s.lanes=c,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}var wl=[],Sl=0,Zf=null,Jf=0,Ta=[],Ea=0,To=null,Pi=1,Li="";function Eo(i,s){wl[Sl++]=Jf,wl[Sl++]=Zf,Zf=i,Jf=s}function fx(i,s,c){Ta[Ea++]=Pi,Ta[Ea++]=Li,Ta[Ea++]=To,To=i;var f=Pi;i=Li;var g=32-Tt(f)-1;f&=~(1<<g),c+=1;var x=32-Tt(s)+g;if(30<x){var b=g-g%5;x=(f&(1<<b)-1).toString(32),f>>=b,g-=b,Pi=1<<32-Tt(s)+g|c<<g|f,Li=x+i}else Pi=1<<x|c<<g|f,Li=i}function Ld(i){i.return!==null&&(Eo(i,1),fx(i,1,0))}function Bd(i){for(;i===Zf;)Zf=wl[--Sl],wl[Sl]=null,Jf=wl[--Sl],wl[Sl]=null;for(;i===To;)To=Ta[--Ea],Ta[Ea]=null,Li=Ta[--Ea],Ta[Ea]=null,Pi=Ta[--Ea],Ta[Ea]=null}var Un=null,br=null,Kt=!1,wo=null,li=!1,Vd=Error(n(519));function So(i){var s=Error(n(418,""));throw Hc(_a(s,i)),Vd}function hx(i){var s=i.stateNode,c=i.type,f=i.memoizedProps;switch(s[Or]=i,s[yr]=f,c){case"dialog":Ft("cancel",s),Ft("close",s);break;case"iframe":case"object":case"embed":Ft("load",s);break;case"video":case"audio":for(c=0;c<du.length;c++)Ft(du[c],s);break;case"source":Ft("error",s);break;case"img":case"image":case"link":Ft("error",s),Ft("load",s);break;case"details":Ft("toggle",s);break;case"input":Ft("invalid",s),oo(s,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0),ll(s);break;case"select":Ft("invalid",s);break;case"textarea":Ft("invalid",s),lo(s,f.value,f.defaultValue,f.children),ll(s)}c=f.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||s.textContent===""+c||f.suppressHydrationWarning===!0||R2(s.textContent,c)?(f.popover!=null&&(Ft("beforetoggle",s),Ft("toggle",s)),f.onScroll!=null&&Ft("scroll",s),f.onScrollEnd!=null&&Ft("scrollend",s),f.onClick!=null&&(s.onclick=F0),s=!0):s=!1,s||So(i)}function dx(i){for(Un=i.return;Un;)switch(Un.tag){case 5:case 13:li=!1;return;case 27:case 3:li=!0;return;default:Un=Un.return}}function jc(i){if(i!==Un)return!1;if(!Kt)return dx(i),Kt=!0,!1;var s=i.tag,c;if((c=s!==3&&s!==27)&&((c=s===5)&&(c=i.type,c=!(c!=="form"&&c!=="button")||tm(i.type,i.memoizedProps)),c=!c),c&&br&&So(i),dx(i),s===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));e:{for(i=i.nextSibling,s=0;i;){if(i.nodeType===8)if(c=i.data,c==="/$"){if(s===0){br=za(i.nextSibling);break e}s--}else c!=="$"&&c!=="$!"&&c!=="$?"||s++;i=i.nextSibling}br=null}}else s===27?(s=br,Cs(i.type)?(i=im,im=null,br=i):br=s):br=Un?za(i.stateNode.nextSibling):null;return!0}function zc(){br=Un=null,Kt=!1}function mx(){var i=wo;return i!==null&&(Kn===null?Kn=i:Kn.push.apply(Kn,i),wo=null),i}function Hc(i){wo===null?wo=[i]:wo.push(i)}var Ud=pe(null),Ao=null,Bi=null;function ds(i,s,c){Y(Ud,s._currentValue),s._currentValue=c}function Vi(i){i._currentValue=Ud.current,V(Ud)}function jd(i,s,c){for(;i!==null;){var f=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,f!==null&&(f.childLanes|=s)):f!==null&&(f.childLanes&s)!==s&&(f.childLanes|=s),i===c)break;i=i.return}}function zd(i,s,c,f){var g=i.child;for(g!==null&&(g.return=i);g!==null;){var x=g.dependencies;if(x!==null){var b=g.child;x=x.firstContext;e:for(;x!==null;){var P=x;x=g;for(var re=0;re<s.length;re++)if(P.context===s[re]){x.lanes|=c,P=x.alternate,P!==null&&(P.lanes|=c),jd(x.return,c,i),f||(b=null);break e}x=P.next}}else if(g.tag===18){if(b=g.return,b===null)throw Error(n(341));b.lanes|=c,x=b.alternate,x!==null&&(x.lanes|=c),jd(b,c,i),b=null}else b=g.child;if(b!==null)b.return=g;else for(b=g;b!==null;){if(b===i){b=null;break}if(g=b.sibling,g!==null){g.return=b.return,b=g;break}b=b.return}g=b}}function Wc(i,s,c,f){i=null;for(var g=s,x=!1;g!==null;){if(!x){if((g.flags&524288)!==0)x=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var b=g.alternate;if(b===null)throw Error(n(387));if(b=b.memoizedProps,b!==null){var P=g.type;ra(g.pendingProps.value,b.value)||(i!==null?i.push(P):i=[P])}}else if(g===Ie.current){if(b=g.alternate,b===null)throw Error(n(387));b.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(i!==null?i.push(_u):i=[_u])}g=g.return}i!==null&&zd(s,i,c,f),s.flags|=262144}function e0(i){for(i=i.firstContext;i!==null;){if(!ra(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function ko(i){Ao=i,Bi=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function wn(i){return px(Ao,i)}function t0(i,s){return Ao===null&&ko(i),px(i,s)}function px(i,s){var c=s._currentValue;if(s={context:s,memoizedValue:c,next:null},Bi===null){if(i===null)throw Error(n(308));Bi=s,i.dependencies={lanes:0,firstContext:s},i.flags|=524288}else Bi=Bi.next=s;return c}var V4=typeof AbortController<"u"?AbortController:function(){var i=[],s=this.signal={aborted:!1,addEventListener:function(c,f){i.push(f)}};this.abort=function(){s.aborted=!0,i.forEach(function(c){return c()})}},U4=t.unstable_scheduleCallback,j4=t.unstable_NormalPriority,Kr={$$typeof:O,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Hd(){return{controller:new V4,data:new Map,refCount:0}}function Gc(i){i.refCount--,i.refCount===0&&U4(j4,function(){i.controller.abort()})}var qc=null,Wd=0,Al=0,kl=null;function z4(i,s){if(qc===null){var c=qc=[];Wd=0,Al=q1(),kl={status:"pending",value:void 0,then:function(f){c.push(f)}}}return Wd++,s.then(gx,gx),s}function gx(){if(--Wd===0&&qc!==null){kl!==null&&(kl.status="fulfilled");var i=qc;qc=null,Al=0,kl=null;for(var s=0;s<i.length;s++)(0,i[s])()}}function H4(i,s){var c=[],f={status:"pending",value:null,reason:null,then:function(g){c.push(g)}};return i.then(function(){f.status="fulfilled",f.value=s;for(var g=0;g<c.length;g++)(0,c[g])(s)},function(g){for(f.status="rejected",f.reason=g,g=0;g<c.length;g++)(0,c[g])(void 0)}),f}var xx=ne.S;ne.S=function(i,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&z4(i,s),xx!==null&&xx(i,s)};var bo=pe(null);function Gd(){var i=bo.current;return i!==null?i:mr.pooledCache}function r0(i,s){s===null?Y(bo,bo.current):Y(bo,s.pool)}function vx(){var i=Gd();return i===null?null:{parent:Kr._currentValue,pool:i}}var Xc=Error(n(460)),_x=Error(n(474)),n0=Error(n(542)),qd={then:function(){}};function yx(i){return i=i.status,i==="fulfilled"||i==="rejected"}function a0(){}function Tx(i,s,c){switch(c=i[c],c===void 0?i.push(s):c!==s&&(s.then(a0,a0),s=c),s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,wx(i),i;default:if(typeof s.status=="string")s.then(a0,a0);else{if(i=mr,i!==null&&100<i.shellSuspendCounter)throw Error(n(482));i=s,i.status="pending",i.then(function(f){if(s.status==="pending"){var g=s;g.status="fulfilled",g.value=f}},function(f){if(s.status==="pending"){var g=s;g.status="rejected",g.reason=f}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,wx(i),i}throw Yc=s,Xc}}var Yc=null;function Ex(){if(Yc===null)throw Error(n(459));var i=Yc;return Yc=null,i}function wx(i){if(i===Xc||i===n0)throw Error(n(483))}var ms=!1;function Xd(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Yd(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function ps(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function gs(i,s,c){var f=i.updateQueue;if(f===null)return null;if(f=f.shared,(rr&2)!==0){var g=f.pending;return g===null?s.next=s:(s.next=g.next,g.next=s),f.pending=s,s=$f(i),cx(i,null,c),s}return Kf(i,f,s,c),$f(i)}function Kc(i,s,c){if(s=s.updateQueue,s!==null&&(s=s.shared,(c&4194048)!==0)){var f=s.lanes;f&=i.pendingLanes,c|=f,s.lanes=c,ao(i,c)}}function Kd(i,s){var c=i.updateQueue,f=i.alternate;if(f!==null&&(f=f.updateQueue,c===f)){var g=null,x=null;if(c=c.firstBaseUpdate,c!==null){do{var b={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};x===null?g=x=b:x=x.next=b,c=c.next}while(c!==null);x===null?g=x=s:x=x.next=s}else g=x=s;c={baseState:f.baseState,firstBaseUpdate:g,lastBaseUpdate:x,shared:f.shared,callbacks:f.callbacks},i.updateQueue=c;return}i=c.lastBaseUpdate,i===null?c.firstBaseUpdate=s:i.next=s,c.lastBaseUpdate=s}var $d=!1;function $c(){if($d){var i=kl;if(i!==null)throw i}}function Qc(i,s,c,f){$d=!1;var g=i.updateQueue;ms=!1;var x=g.firstBaseUpdate,b=g.lastBaseUpdate,P=g.shared.pending;if(P!==null){g.shared.pending=null;var re=P,me=re.next;re.next=null,b===null?x=me:b.next=me,b=re;var Ae=i.alternate;Ae!==null&&(Ae=Ae.updateQueue,P=Ae.lastBaseUpdate,P!==b&&(P===null?Ae.firstBaseUpdate=me:P.next=me,Ae.lastBaseUpdate=re))}if(x!==null){var Re=g.baseState;b=0,Ae=me=re=null,P=x;do{var ve=P.lane&-536870913,_e=ve!==P.lane;if(_e?(Ut&ve)===ve:(f&ve)===ve){ve!==0&&ve===Al&&($d=!0),Ae!==null&&(Ae=Ae.next={lane:0,tag:P.tag,payload:P.payload,callback:null,next:null});e:{var _t=i,ht=P;ve=s;var ur=c;switch(ht.tag){case 1:if(_t=ht.payload,typeof _t=="function"){Re=_t.call(ur,Re,ve);break e}Re=_t;break e;case 3:_t.flags=_t.flags&-65537|128;case 0:if(_t=ht.payload,ve=typeof _t=="function"?_t.call(ur,Re,ve):_t,ve==null)break e;Re=p({},Re,ve);break e;case 2:ms=!0}}ve=P.callback,ve!==null&&(i.flags|=64,_e&&(i.flags|=8192),_e=g.callbacks,_e===null?g.callbacks=[ve]:_e.push(ve))}else _e={lane:ve,tag:P.tag,payload:P.payload,callback:P.callback,next:null},Ae===null?(me=Ae=_e,re=Re):Ae=Ae.next=_e,b|=ve;if(P=P.next,P===null){if(P=g.shared.pending,P===null)break;_e=P,P=_e.next,_e.next=null,g.lastBaseUpdate=_e,g.shared.pending=null}}while(!0);Ae===null&&(re=Re),g.baseState=re,g.firstBaseUpdate=me,g.lastBaseUpdate=Ae,x===null&&(g.shared.lanes=0),Ss|=b,i.lanes=b,i.memoizedState=Re}}function Sx(i,s){if(typeof i!="function")throw Error(n(191,i));i.call(s)}function Ax(i,s){var c=i.callbacks;if(c!==null)for(i.callbacks=null,i=0;i<c.length;i++)Sx(c[i],s)}var bl=pe(null),i0=pe(0);function kx(i,s){i=qi,Y(i0,i),Y(bl,s),qi=i|s.baseLanes}function Qd(){Y(i0,qi),Y(bl,bl.current)}function Zd(){qi=i0.current,V(bl),V(i0)}var xs=0,Ct=null,lr=null,Ur=null,s0=!1,Cl=!1,Co=!1,o0=0,Zc=0,Rl=null,W4=0;function Fr(){throw Error(n(321))}function Jd(i,s){if(s===null)return!1;for(var c=0;c<s.length&&c<i.length;c++)if(!ra(i[c],s[c]))return!1;return!0}function e1(i,s,c,f,g,x){return xs=x,Ct=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,ne.H=i===null||i.memoizedState===null?cv:uv,Co=!1,x=c(f,g),Co=!1,Cl&&(x=Cx(s,c,f,g)),bx(i),x}function bx(i){ne.H=d0;var s=lr!==null&&lr.next!==null;if(xs=0,Ur=lr=Ct=null,s0=!1,Zc=0,Rl=null,s)throw Error(n(300));i===null||nn||(i=i.dependencies,i!==null&&e0(i)&&(nn=!0))}function Cx(i,s,c,f){Ct=i;var g=0;do{if(Cl&&(Rl=null),Zc=0,Cl=!1,25<=g)throw Error(n(301));if(g+=1,Ur=lr=null,i.updateQueue!=null){var x=i.updateQueue;x.lastEffect=null,x.events=null,x.stores=null,x.memoCache!=null&&(x.memoCache.index=0)}ne.H=Q4,x=s(c,f)}while(Cl);return x}function G4(){var i=ne.H,s=i.useState()[0];return s=typeof s.then=="function"?Jc(s):s,i=i.useState()[0],(lr!==null?lr.memoizedState:null)!==i&&(Ct.flags|=1024),s}function t1(){var i=o0!==0;return o0=0,i}function r1(i,s,c){s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~c}function n1(i){if(s0){for(i=i.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}s0=!1}xs=0,Ur=lr=Ct=null,Cl=!1,Zc=o0=0,Rl=null}function Xn(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ur===null?Ct.memoizedState=Ur=i:Ur=Ur.next=i,Ur}function jr(){if(lr===null){var i=Ct.alternate;i=i!==null?i.memoizedState:null}else i=lr.next;var s=Ur===null?Ct.memoizedState:Ur.next;if(s!==null)Ur=s,lr=i;else{if(i===null)throw Ct.alternate===null?Error(n(467)):Error(n(310));lr=i,i={memoizedState:lr.memoizedState,baseState:lr.baseState,baseQueue:lr.baseQueue,queue:lr.queue,next:null},Ur===null?Ct.memoizedState=Ur=i:Ur=Ur.next=i}return Ur}function a1(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Jc(i){var s=Zc;return Zc+=1,Rl===null&&(Rl=[]),i=Tx(Rl,i,s),s=Ct,(Ur===null?s.memoizedState:Ur.next)===null&&(s=s.alternate,ne.H=s===null||s.memoizedState===null?cv:uv),i}function l0(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Jc(i);if(i.$$typeof===O)return wn(i)}throw Error(n(438,String(i)))}function i1(i){var s=null,c=Ct.updateQueue;if(c!==null&&(s=c.memoCache),s==null){var f=Ct.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(s={data:f.data.map(function(g){return g.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),c===null&&(c=a1(),Ct.updateQueue=c),c.memoCache=s,c=s.data[s.index],c===void 0)for(c=s.data[s.index]=Array(i),f=0;f<i;f++)c[f]=B;return s.index++,c}function Ui(i,s){return typeof s=="function"?s(i):s}function c0(i){var s=jr();return s1(s,lr,i)}function s1(i,s,c){var f=i.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=c;var g=i.baseQueue,x=f.pending;if(x!==null){if(g!==null){var b=g.next;g.next=x.next,x.next=b}s.baseQueue=g=x,f.pending=null}if(x=i.baseState,g===null)i.memoizedState=x;else{s=g.next;var P=b=null,re=null,me=s,Ae=!1;do{var Re=me.lane&-536870913;if(Re!==me.lane?(Ut&Re)===Re:(xs&Re)===Re){var ve=me.revertLane;if(ve===0)re!==null&&(re=re.next={lane:0,revertLane:0,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null}),Re===Al&&(Ae=!0);else if((xs&ve)===ve){me=me.next,ve===Al&&(Ae=!0);continue}else Re={lane:0,revertLane:me.revertLane,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null},re===null?(P=re=Re,b=x):re=re.next=Re,Ct.lanes|=ve,Ss|=ve;Re=me.action,Co&&c(x,Re),x=me.hasEagerState?me.eagerState:c(x,Re)}else ve={lane:Re,revertLane:me.revertLane,action:me.action,hasEagerState:me.hasEagerState,eagerState:me.eagerState,next:null},re===null?(P=re=ve,b=x):re=re.next=ve,Ct.lanes|=Re,Ss|=Re;me=me.next}while(me!==null&&me!==s);if(re===null?b=x:re.next=P,!ra(x,i.memoizedState)&&(nn=!0,Ae&&(c=kl,c!==null)))throw c;i.memoizedState=x,i.baseState=b,i.baseQueue=re,f.lastRenderedState=x}return g===null&&(f.lanes=0),[i.memoizedState,f.dispatch]}function o1(i){var s=jr(),c=s.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=i;var f=c.dispatch,g=c.pending,x=s.memoizedState;if(g!==null){c.pending=null;var b=g=g.next;do x=i(x,b.action),b=b.next;while(b!==g);ra(x,s.memoizedState)||(nn=!0),s.memoizedState=x,s.baseQueue===null&&(s.baseState=x),c.lastRenderedState=x}return[x,f]}function Rx(i,s,c){var f=Ct,g=jr(),x=Kt;if(x){if(c===void 0)throw Error(n(407));c=c()}else c=s();var b=!ra((lr||g).memoizedState,c);b&&(g.memoizedState=c,nn=!0),g=g.queue;var P=Ox.bind(null,f,g,i);if(eu(2048,8,P,[i]),g.getSnapshot!==s||b||Ur!==null&&Ur.memoizedState.tag&1){if(f.flags|=2048,Dl(9,u0(),Ix.bind(null,f,g,c,s),null),mr===null)throw Error(n(349));x||(xs&124)!==0||Dx(f,s,c)}return c}function Dx(i,s,c){i.flags|=16384,i={getSnapshot:s,value:c},s=Ct.updateQueue,s===null?(s=a1(),Ct.updateQueue=s,s.stores=[i]):(c=s.stores,c===null?s.stores=[i]:c.push(i))}function Ix(i,s,c,f){s.value=c,s.getSnapshot=f,Fx(s)&&Nx(i)}function Ox(i,s,c){return c(function(){Fx(s)&&Nx(i)})}function Fx(i){var s=i.getSnapshot;i=i.value;try{var c=s();return!ra(i,c)}catch{return!0}}function Nx(i){var s=Tl(i,2);s!==null&&la(s,i,2)}function l1(i){var s=Xn();if(typeof i=="function"){var c=i;if(i=c(),Co){ut(!0);try{c()}finally{ut(!1)}}}return s.memoizedState=s.baseState=i,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ui,lastRenderedState:i},s}function Mx(i,s,c,f){return i.baseState=c,s1(i,lr,typeof f=="function"?f:Ui)}function q4(i,s,c,f,g){if(h0(i))throw Error(n(485));if(i=s.action,i!==null){var x={payload:g,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(b){x.listeners.push(b)}};ne.T!==null?c(!0):x.isTransition=!1,f(x),c=s.pending,c===null?(x.next=s.pending=x,Px(s,x)):(x.next=c.next,s.pending=c.next=x)}}function Px(i,s){var c=s.action,f=s.payload,g=i.state;if(s.isTransition){var x=ne.T,b={};ne.T=b;try{var P=c(g,f),re=ne.S;re!==null&&re(b,P),Lx(i,s,P)}catch(me){c1(i,s,me)}finally{ne.T=x}}else try{x=c(g,f),Lx(i,s,x)}catch(me){c1(i,s,me)}}function Lx(i,s,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(f){Bx(i,s,f)},function(f){return c1(i,s,f)}):Bx(i,s,c)}function Bx(i,s,c){s.status="fulfilled",s.value=c,Vx(s),i.state=c,s=i.pending,s!==null&&(c=s.next,c===s?i.pending=null:(c=c.next,s.next=c,Px(i,c)))}function c1(i,s,c){var f=i.pending;if(i.pending=null,f!==null){f=f.next;do s.status="rejected",s.reason=c,Vx(s),s=s.next;while(s!==f)}i.action=null}function Vx(i){i=i.listeners;for(var s=0;s<i.length;s++)(0,i[s])()}function Ux(i,s){return s}function jx(i,s){if(Kt){var c=mr.formState;if(c!==null){e:{var f=Ct;if(Kt){if(br){t:{for(var g=br,x=li;g.nodeType!==8;){if(!x){g=null;break t}if(g=za(g.nextSibling),g===null){g=null;break t}}x=g.data,g=x==="F!"||x==="F"?g:null}if(g){br=za(g.nextSibling),f=g.data==="F!";break e}}So(f)}f=!1}f&&(s=c[0])}}return c=Xn(),c.memoizedState=c.baseState=s,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ux,lastRenderedState:s},c.queue=f,c=sv.bind(null,Ct,f),f.dispatch=c,f=l1(!1),x=m1.bind(null,Ct,!1,f.queue),f=Xn(),g={state:s,dispatch:null,action:i,pending:null},f.queue=g,c=q4.bind(null,Ct,g,x,c),g.dispatch=c,f.memoizedState=i,[s,c,!1]}function zx(i){var s=jr();return Hx(s,lr,i)}function Hx(i,s,c){if(s=s1(i,s,Ux)[0],i=c0(Ui)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var f=Jc(s)}catch(b){throw b===Xc?n0:b}else f=s;s=jr();var g=s.queue,x=g.dispatch;return c!==s.memoizedState&&(Ct.flags|=2048,Dl(9,u0(),X4.bind(null,g,c),null)),[f,x,i]}function X4(i,s){i.action=s}function Wx(i){var s=jr(),c=lr;if(c!==null)return Hx(s,c,i);jr(),s=s.memoizedState,c=jr();var f=c.queue.dispatch;return c.memoizedState=i,[s,f,!1]}function Dl(i,s,c,f){return i={tag:i,create:c,deps:f,inst:s,next:null},s=Ct.updateQueue,s===null&&(s=a1(),Ct.updateQueue=s),c=s.lastEffect,c===null?s.lastEffect=i.next=i:(f=c.next,c.next=i,i.next=f,s.lastEffect=i),i}function u0(){return{destroy:void 0,resource:void 0}}function Gx(){return jr().memoizedState}function f0(i,s,c,f){var g=Xn();f=f===void 0?null:f,Ct.flags|=i,g.memoizedState=Dl(1|s,u0(),c,f)}function eu(i,s,c,f){var g=jr();f=f===void 0?null:f;var x=g.memoizedState.inst;lr!==null&&f!==null&&Jd(f,lr.memoizedState.deps)?g.memoizedState=Dl(s,x,c,f):(Ct.flags|=i,g.memoizedState=Dl(1|s,x,c,f))}function qx(i,s){f0(8390656,8,i,s)}function Xx(i,s){eu(2048,8,i,s)}function Yx(i,s){return eu(4,2,i,s)}function Kx(i,s){return eu(4,4,i,s)}function $x(i,s){if(typeof s=="function"){i=i();var c=s(i);return function(){typeof c=="function"?c():s(null)}}if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function Qx(i,s,c){c=c!=null?c.concat([i]):null,eu(4,4,$x.bind(null,s,i),c)}function u1(){}function Zx(i,s){var c=jr();s=s===void 0?null:s;var f=c.memoizedState;return s!==null&&Jd(s,f[1])?f[0]:(c.memoizedState=[i,s],i)}function Jx(i,s){var c=jr();s=s===void 0?null:s;var f=c.memoizedState;if(s!==null&&Jd(s,f[1]))return f[0];if(f=i(),Co){ut(!0);try{i()}finally{ut(!1)}}return c.memoizedState=[f,s],f}function f1(i,s,c){return c===void 0||(xs&1073741824)!==0?i.memoizedState=s:(i.memoizedState=c,i=r2(),Ct.lanes|=i,Ss|=i,c)}function ev(i,s,c,f){return ra(c,s)?c:bl.current!==null?(i=f1(i,c,f),ra(i,s)||(nn=!0),i):(xs&42)===0?(nn=!0,i.memoizedState=c):(i=r2(),Ct.lanes|=i,Ss|=i,s)}function tv(i,s,c,f,g){var x=se.p;se.p=x!==0&&8>x?x:8;var b=ne.T,P={};ne.T=P,m1(i,!1,s,c);try{var re=g(),me=ne.S;if(me!==null&&me(P,re),re!==null&&typeof re=="object"&&typeof re.then=="function"){var Ae=H4(re,f);tu(i,s,Ae,oa(i))}else tu(i,s,f,oa(i))}catch(Re){tu(i,s,{then:function(){},status:"rejected",reason:Re},oa())}finally{se.p=x,ne.T=b}}function Y4(){}function h1(i,s,c,f){if(i.tag!==5)throw Error(n(476));var g=rv(i).queue;tv(i,g,s,Le,c===null?Y4:function(){return nv(i),c(f)})}function rv(i){var s=i.memoizedState;if(s!==null)return s;s={memoizedState:Le,baseState:Le,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ui,lastRenderedState:Le},next:null};var c={};return s.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ui,lastRenderedState:c},next:null},i.memoizedState=s,i=i.alternate,i!==null&&(i.memoizedState=s),s}function nv(i){var s=rv(i).next.queue;tu(i,s,{},oa())}function d1(){return wn(_u)}function av(){return jr().memoizedState}function iv(){return jr().memoizedState}function K4(i){for(var s=i.return;s!==null;){switch(s.tag){case 24:case 3:var c=oa();i=ps(c);var f=gs(s,i,c);f!==null&&(la(f,s,c),Kc(f,s,c)),s={cache:Hd()},i.payload=s;return}s=s.return}}function $4(i,s,c){var f=oa();c={lane:f,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null},h0(i)?ov(s,c):(c=Fd(i,s,c,f),c!==null&&(la(c,i,f),lv(c,s,f)))}function sv(i,s,c){var f=oa();tu(i,s,c,f)}function tu(i,s,c,f){var g={lane:f,revertLane:0,action:c,hasEagerState:!1,eagerState:null,next:null};if(h0(i))ov(s,g);else{var x=i.alternate;if(i.lanes===0&&(x===null||x.lanes===0)&&(x=s.lastRenderedReducer,x!==null))try{var b=s.lastRenderedState,P=x(b,c);if(g.hasEagerState=!0,g.eagerState=P,ra(P,b))return Kf(i,s,g,0),mr===null&&Yf(),!1}catch{}finally{}if(c=Fd(i,s,g,f),c!==null)return la(c,i,f),lv(c,s,f),!0}return!1}function m1(i,s,c,f){if(f={lane:2,revertLane:q1(),action:f,hasEagerState:!1,eagerState:null,next:null},h0(i)){if(s)throw Error(n(479))}else s=Fd(i,c,f,2),s!==null&&la(s,i,2)}function h0(i){var s=i.alternate;return i===Ct||s!==null&&s===Ct}function ov(i,s){Cl=s0=!0;var c=i.pending;c===null?s.next=s:(s.next=c.next,c.next=s),i.pending=s}function lv(i,s,c){if((c&4194048)!==0){var f=s.lanes;f&=i.pendingLanes,c|=f,s.lanes=c,ao(i,c)}}var d0={readContext:wn,use:l0,useCallback:Fr,useContext:Fr,useEffect:Fr,useImperativeHandle:Fr,useLayoutEffect:Fr,useInsertionEffect:Fr,useMemo:Fr,useReducer:Fr,useRef:Fr,useState:Fr,useDebugValue:Fr,useDeferredValue:Fr,useTransition:Fr,useSyncExternalStore:Fr,useId:Fr,useHostTransitionStatus:Fr,useFormState:Fr,useActionState:Fr,useOptimistic:Fr,useMemoCache:Fr,useCacheRefresh:Fr},cv={readContext:wn,use:l0,useCallback:function(i,s){return Xn().memoizedState=[i,s===void 0?null:s],i},useContext:wn,useEffect:qx,useImperativeHandle:function(i,s,c){c=c!=null?c.concat([i]):null,f0(4194308,4,$x.bind(null,s,i),c)},useLayoutEffect:function(i,s){return f0(4194308,4,i,s)},useInsertionEffect:function(i,s){f0(4,2,i,s)},useMemo:function(i,s){var c=Xn();s=s===void 0?null:s;var f=i();if(Co){ut(!0);try{i()}finally{ut(!1)}}return c.memoizedState=[f,s],f},useReducer:function(i,s,c){var f=Xn();if(c!==void 0){var g=c(s);if(Co){ut(!0);try{c(s)}finally{ut(!1)}}}else g=s;return f.memoizedState=f.baseState=g,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:g},f.queue=i,i=i.dispatch=$4.bind(null,Ct,i),[f.memoizedState,i]},useRef:function(i){var s=Xn();return i={current:i},s.memoizedState=i},useState:function(i){i=l1(i);var s=i.queue,c=sv.bind(null,Ct,s);return s.dispatch=c,[i.memoizedState,c]},useDebugValue:u1,useDeferredValue:function(i,s){var c=Xn();return f1(c,i,s)},useTransition:function(){var i=l1(!1);return i=tv.bind(null,Ct,i.queue,!0,!1),Xn().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,s,c){var f=Ct,g=Xn();if(Kt){if(c===void 0)throw Error(n(407));c=c()}else{if(c=s(),mr===null)throw Error(n(349));(Ut&124)!==0||Dx(f,s,c)}g.memoizedState=c;var x={value:c,getSnapshot:s};return g.queue=x,qx(Ox.bind(null,f,x,i),[i]),f.flags|=2048,Dl(9,u0(),Ix.bind(null,f,x,c,s),null),c},useId:function(){var i=Xn(),s=mr.identifierPrefix;if(Kt){var c=Li,f=Pi;c=(f&~(1<<32-Tt(f)-1)).toString(32)+c,s=""+s+"R"+c,c=o0++,0<c&&(s+="H"+c.toString(32)),s+=""}else c=W4++,s=""+s+"r"+c.toString(32)+"";return i.memoizedState=s},useHostTransitionStatus:d1,useFormState:jx,useActionState:jx,useOptimistic:function(i){var s=Xn();s.memoizedState=s.baseState=i;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=c,s=m1.bind(null,Ct,!0,c),c.dispatch=s,[i,s]},useMemoCache:i1,useCacheRefresh:function(){return Xn().memoizedState=K4.bind(null,Ct)}},uv={readContext:wn,use:l0,useCallback:Zx,useContext:wn,useEffect:Xx,useImperativeHandle:Qx,useInsertionEffect:Yx,useLayoutEffect:Kx,useMemo:Jx,useReducer:c0,useRef:Gx,useState:function(){return c0(Ui)},useDebugValue:u1,useDeferredValue:function(i,s){var c=jr();return ev(c,lr.memoizedState,i,s)},useTransition:function(){var i=c0(Ui)[0],s=jr().memoizedState;return[typeof i=="boolean"?i:Jc(i),s]},useSyncExternalStore:Rx,useId:av,useHostTransitionStatus:d1,useFormState:zx,useActionState:zx,useOptimistic:function(i,s){var c=jr();return Mx(c,lr,i,s)},useMemoCache:i1,useCacheRefresh:iv},Q4={readContext:wn,use:l0,useCallback:Zx,useContext:wn,useEffect:Xx,useImperativeHandle:Qx,useInsertionEffect:Yx,useLayoutEffect:Kx,useMemo:Jx,useReducer:o1,useRef:Gx,useState:function(){return o1(Ui)},useDebugValue:u1,useDeferredValue:function(i,s){var c=jr();return lr===null?f1(c,i,s):ev(c,lr.memoizedState,i,s)},useTransition:function(){var i=o1(Ui)[0],s=jr().memoizedState;return[typeof i=="boolean"?i:Jc(i),s]},useSyncExternalStore:Rx,useId:av,useHostTransitionStatus:d1,useFormState:Wx,useActionState:Wx,useOptimistic:function(i,s){var c=jr();return lr!==null?Mx(c,lr,i,s):(c.baseState=i,[i,c.queue.dispatch])},useMemoCache:i1,useCacheRefresh:iv},Il=null,ru=0;function m0(i){var s=ru;return ru+=1,Il===null&&(Il=[]),Tx(Il,i,s)}function nu(i,s){s=s.props.ref,i.ref=s!==void 0?s:null}function p0(i,s){throw s.$$typeof===v?Error(n(525)):(i=Object.prototype.toString.call(s),Error(n(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i)))}function fv(i){var s=i._init;return s(i._payload)}function hv(i){function s(oe,ie){if(i){var he=oe.deletions;he===null?(oe.deletions=[ie],oe.flags|=16):he.push(ie)}}function c(oe,ie){if(!i)return null;for(;ie!==null;)s(oe,ie),ie=ie.sibling;return null}function f(oe){for(var ie=new Map;oe!==null;)oe.key!==null?ie.set(oe.key,oe):ie.set(oe.index,oe),oe=oe.sibling;return ie}function g(oe,ie){return oe=Mi(oe,ie),oe.index=0,oe.sibling=null,oe}function x(oe,ie,he){return oe.index=he,i?(he=oe.alternate,he!==null?(he=he.index,he<ie?(oe.flags|=67108866,ie):he):(oe.flags|=67108866,ie)):(oe.flags|=1048576,ie)}function b(oe){return i&&oe.alternate===null&&(oe.flags|=67108866),oe}function P(oe,ie,he,Ce){return ie===null||ie.tag!==6?(ie=Md(he,oe.mode,Ce),ie.return=oe,ie):(ie=g(ie,he),ie.return=oe,ie)}function re(oe,ie,he,Ce){var nt=he.type;return nt===w?Ae(oe,ie,he.props.children,Ce,he.key):ie!==null&&(ie.elementType===nt||typeof nt=="object"&&nt!==null&&nt.$$typeof===I&&fv(nt)===ie.type)?(ie=g(ie,he.props),nu(ie,he),ie.return=oe,ie):(ie=Qf(he.type,he.key,he.props,null,oe.mode,Ce),nu(ie,he),ie.return=oe,ie)}function me(oe,ie,he,Ce){return ie===null||ie.tag!==4||ie.stateNode.containerInfo!==he.containerInfo||ie.stateNode.implementation!==he.implementation?(ie=Pd(he,oe.mode,Ce),ie.return=oe,ie):(ie=g(ie,he.children||[]),ie.return=oe,ie)}function Ae(oe,ie,he,Ce,nt){return ie===null||ie.tag!==7?(ie=yo(he,oe.mode,Ce,nt),ie.return=oe,ie):(ie=g(ie,he),ie.return=oe,ie)}function Re(oe,ie,he){if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return ie=Md(""+ie,oe.mode,he),ie.return=oe,ie;if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case _:return he=Qf(ie.type,ie.key,ie.props,null,oe.mode,he),nu(he,ie),he.return=oe,he;case y:return ie=Pd(ie,oe.mode,he),ie.return=oe,ie;case I:var Ce=ie._init;return ie=Ce(ie._payload),Re(oe,ie,he)}if(Se(ie)||F(ie))return ie=yo(ie,oe.mode,he,null),ie.return=oe,ie;if(typeof ie.then=="function")return Re(oe,m0(ie),he);if(ie.$$typeof===O)return Re(oe,t0(oe,ie),he);p0(oe,ie)}return null}function ve(oe,ie,he,Ce){var nt=ie!==null?ie.key:null;if(typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint")return nt!==null?null:P(oe,ie,""+he,Ce);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case _:return he.key===nt?re(oe,ie,he,Ce):null;case y:return he.key===nt?me(oe,ie,he,Ce):null;case I:return nt=he._init,he=nt(he._payload),ve(oe,ie,he,Ce)}if(Se(he)||F(he))return nt!==null?null:Ae(oe,ie,he,Ce,null);if(typeof he.then=="function")return ve(oe,ie,m0(he),Ce);if(he.$$typeof===O)return ve(oe,ie,t0(oe,he),Ce);p0(oe,he)}return null}function _e(oe,ie,he,Ce,nt){if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number"||typeof Ce=="bigint")return oe=oe.get(he)||null,P(ie,oe,""+Ce,nt);if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case _:return oe=oe.get(Ce.key===null?he:Ce.key)||null,re(ie,oe,Ce,nt);case y:return oe=oe.get(Ce.key===null?he:Ce.key)||null,me(ie,oe,Ce,nt);case I:var Dt=Ce._init;return Ce=Dt(Ce._payload),_e(oe,ie,he,Ce,nt)}if(Se(Ce)||F(Ce))return oe=oe.get(he)||null,Ae(ie,oe,Ce,nt,null);if(typeof Ce.then=="function")return _e(oe,ie,he,m0(Ce),nt);if(Ce.$$typeof===O)return _e(oe,ie,he,t0(ie,Ce),nt);p0(ie,Ce)}return null}function _t(oe,ie,he,Ce){for(var nt=null,Dt=null,it=ie,mt=ie=0,sn=null;it!==null&&mt<he.length;mt++){it.index>mt?(sn=it,it=null):sn=it.sibling;var Xt=ve(oe,it,he[mt],Ce);if(Xt===null){it===null&&(it=sn);break}i&&it&&Xt.alternate===null&&s(oe,it),ie=x(Xt,ie,mt),Dt===null?nt=Xt:Dt.sibling=Xt,Dt=Xt,it=sn}if(mt===he.length)return c(oe,it),Kt&&Eo(oe,mt),nt;if(it===null){for(;mt<he.length;mt++)it=Re(oe,he[mt],Ce),it!==null&&(ie=x(it,ie,mt),Dt===null?nt=it:Dt.sibling=it,Dt=it);return Kt&&Eo(oe,mt),nt}for(it=f(it);mt<he.length;mt++)sn=_e(it,oe,mt,he[mt],Ce),sn!==null&&(i&&sn.alternate!==null&&it.delete(sn.key===null?mt:sn.key),ie=x(sn,ie,mt),Dt===null?nt=sn:Dt.sibling=sn,Dt=sn);return i&&it.forEach(function(Fs){return s(oe,Fs)}),Kt&&Eo(oe,mt),nt}function ht(oe,ie,he,Ce){if(he==null)throw Error(n(151));for(var nt=null,Dt=null,it=ie,mt=ie=0,sn=null,Xt=he.next();it!==null&&!Xt.done;mt++,Xt=he.next()){it.index>mt?(sn=it,it=null):sn=it.sibling;var Fs=ve(oe,it,Xt.value,Ce);if(Fs===null){it===null&&(it=sn);break}i&&it&&Fs.alternate===null&&s(oe,it),ie=x(Fs,ie,mt),Dt===null?nt=Fs:Dt.sibling=Fs,Dt=Fs,it=sn}if(Xt.done)return c(oe,it),Kt&&Eo(oe,mt),nt;if(it===null){for(;!Xt.done;mt++,Xt=he.next())Xt=Re(oe,Xt.value,Ce),Xt!==null&&(ie=x(Xt,ie,mt),Dt===null?nt=Xt:Dt.sibling=Xt,Dt=Xt);return Kt&&Eo(oe,mt),nt}for(it=f(it);!Xt.done;mt++,Xt=he.next())Xt=_e(it,oe,mt,Xt.value,Ce),Xt!==null&&(i&&Xt.alternate!==null&&it.delete(Xt.key===null?mt:Xt.key),ie=x(Xt,ie,mt),Dt===null?nt=Xt:Dt.sibling=Xt,Dt=Xt);return i&&it.forEach(function(ZA){return s(oe,ZA)}),Kt&&Eo(oe,mt),nt}function ur(oe,ie,he,Ce){if(typeof he=="object"&&he!==null&&he.type===w&&he.key===null&&(he=he.props.children),typeof he=="object"&&he!==null){switch(he.$$typeof){case _:e:{for(var nt=he.key;ie!==null;){if(ie.key===nt){if(nt=he.type,nt===w){if(ie.tag===7){c(oe,ie.sibling),Ce=g(ie,he.props.children),Ce.return=oe,oe=Ce;break e}}else if(ie.elementType===nt||typeof nt=="object"&&nt!==null&&nt.$$typeof===I&&fv(nt)===ie.type){c(oe,ie.sibling),Ce=g(ie,he.props),nu(Ce,he),Ce.return=oe,oe=Ce;break e}c(oe,ie);break}else s(oe,ie);ie=ie.sibling}he.type===w?(Ce=yo(he.props.children,oe.mode,Ce,he.key),Ce.return=oe,oe=Ce):(Ce=Qf(he.type,he.key,he.props,null,oe.mode,Ce),nu(Ce,he),Ce.return=oe,oe=Ce)}return b(oe);case y:e:{for(nt=he.key;ie!==null;){if(ie.key===nt)if(ie.tag===4&&ie.stateNode.containerInfo===he.containerInfo&&ie.stateNode.implementation===he.implementation){c(oe,ie.sibling),Ce=g(ie,he.children||[]),Ce.return=oe,oe=Ce;break e}else{c(oe,ie);break}else s(oe,ie);ie=ie.sibling}Ce=Pd(he,oe.mode,Ce),Ce.return=oe,oe=Ce}return b(oe);case I:return nt=he._init,he=nt(he._payload),ur(oe,ie,he,Ce)}if(Se(he))return _t(oe,ie,he,Ce);if(F(he)){if(nt=F(he),typeof nt!="function")throw Error(n(150));return he=nt.call(he),ht(oe,ie,he,Ce)}if(typeof he.then=="function")return ur(oe,ie,m0(he),Ce);if(he.$$typeof===O)return ur(oe,ie,t0(oe,he),Ce);p0(oe,he)}return typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint"?(he=""+he,ie!==null&&ie.tag===6?(c(oe,ie.sibling),Ce=g(ie,he),Ce.return=oe,oe=Ce):(c(oe,ie),Ce=Md(he,oe.mode,Ce),Ce.return=oe,oe=Ce),b(oe)):c(oe,ie)}return function(oe,ie,he,Ce){try{ru=0;var nt=ur(oe,ie,he,Ce);return Il=null,nt}catch(it){if(it===Xc||it===n0)throw it;var Dt=na(29,it,null,oe.mode);return Dt.lanes=Ce,Dt.return=oe,Dt}finally{}}}var Ol=hv(!0),dv=hv(!1),wa=pe(null),ci=null;function vs(i){var s=i.alternate;Y($r,$r.current&1),Y(wa,i),ci===null&&(s===null||bl.current!==null||s.memoizedState!==null)&&(ci=i)}function mv(i){if(i.tag===22){if(Y($r,$r.current),Y(wa,i),ci===null){var s=i.alternate;s!==null&&s.memoizedState!==null&&(ci=i)}}else _s()}function _s(){Y($r,$r.current),Y(wa,wa.current)}function ji(i){V(wa),ci===i&&(ci=null),V($r)}var $r=pe(0);function g0(i){for(var s=i;s!==null;){if(s.tag===13){var c=s.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||am(c)))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}function p1(i,s,c,f){s=i.memoizedState,c=c(f,s),c=c==null?s:p({},s,c),i.memoizedState=c,i.lanes===0&&(i.updateQueue.baseState=c)}var g1={enqueueSetState:function(i,s,c){i=i._reactInternals;var f=oa(),g=ps(f);g.payload=s,c!=null&&(g.callback=c),s=gs(i,g,f),s!==null&&(la(s,i,f),Kc(s,i,f))},enqueueReplaceState:function(i,s,c){i=i._reactInternals;var f=oa(),g=ps(f);g.tag=1,g.payload=s,c!=null&&(g.callback=c),s=gs(i,g,f),s!==null&&(la(s,i,f),Kc(s,i,f))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var c=oa(),f=ps(c);f.tag=2,s!=null&&(f.callback=s),s=gs(i,f,c),s!==null&&(la(s,i,c),Kc(s,i,c))}};function pv(i,s,c,f,g,x,b){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(f,x,b):s.prototype&&s.prototype.isPureReactComponent?!Vc(c,f)||!Vc(g,x):!0}function gv(i,s,c,f){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(c,f),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(c,f),s.state!==i&&g1.enqueueReplaceState(s,s.state,null)}function Ro(i,s){var c=s;if("ref"in s){c={};for(var f in s)f!=="ref"&&(c[f]=s[f])}if(i=i.defaultProps){c===s&&(c=p({},c));for(var g in i)c[g]===void 0&&(c[g]=i[g])}return c}var x0=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function xv(i){x0(i)}function vv(i){console.error(i)}function _v(i){x0(i)}function v0(i,s){try{var c=i.onUncaughtError;c(s.value,{componentStack:s.stack})}catch(f){setTimeout(function(){throw f})}}function yv(i,s,c){try{var f=i.onCaughtError;f(c.value,{componentStack:c.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function x1(i,s,c){return c=ps(c),c.tag=3,c.payload={element:null},c.callback=function(){v0(i,s)},c}function Tv(i){return i=ps(i),i.tag=3,i}function Ev(i,s,c,f){var g=c.type.getDerivedStateFromError;if(typeof g=="function"){var x=f.value;i.payload=function(){return g(x)},i.callback=function(){yv(s,c,f)}}var b=c.stateNode;b!==null&&typeof b.componentDidCatch=="function"&&(i.callback=function(){yv(s,c,f),typeof g!="function"&&(As===null?As=new Set([this]):As.add(this));var P=f.stack;this.componentDidCatch(f.value,{componentStack:P!==null?P:""})})}function Z4(i,s,c,f,g){if(c.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(s=c.alternate,s!==null&&Wc(s,c,g,!0),c=wa.current,c!==null){switch(c.tag){case 13:return ci===null?j1():c.alternate===null&&Cr===0&&(Cr=3),c.flags&=-257,c.flags|=65536,c.lanes=g,f===qd?c.flags|=16384:(s=c.updateQueue,s===null?c.updateQueue=new Set([f]):s.add(f),H1(i,f,g)),!1;case 22:return c.flags|=65536,f===qd?c.flags|=16384:(s=c.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([f])},c.updateQueue=s):(c=s.retryQueue,c===null?s.retryQueue=new Set([f]):c.add(f)),H1(i,f,g)),!1}throw Error(n(435,c.tag))}return H1(i,f,g),j1(),!1}if(Kt)return s=wa.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=g,f!==Vd&&(i=Error(n(422),{cause:f}),Hc(_a(i,c)))):(f!==Vd&&(s=Error(n(423),{cause:f}),Hc(_a(s,c))),i=i.current.alternate,i.flags|=65536,g&=-g,i.lanes|=g,f=_a(f,c),g=x1(i.stateNode,f,g),Kd(i,g),Cr!==4&&(Cr=2)),!1;var x=Error(n(520),{cause:f});if(x=_a(x,c),uu===null?uu=[x]:uu.push(x),Cr!==4&&(Cr=2),s===null)return!0;f=_a(f,c),c=s;do{switch(c.tag){case 3:return c.flags|=65536,i=g&-g,c.lanes|=i,i=x1(c.stateNode,f,i),Kd(c,i),!1;case 1:if(s=c.type,x=c.stateNode,(c.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(As===null||!As.has(x))))return c.flags|=65536,g&=-g,c.lanes|=g,g=Tv(g),Ev(g,i,c,f),Kd(c,g),!1}c=c.return}while(c!==null);return!1}var wv=Error(n(461)),nn=!1;function dn(i,s,c,f){s.child=i===null?dv(s,null,c,f):Ol(s,i.child,c,f)}function Sv(i,s,c,f,g){c=c.render;var x=s.ref;if("ref"in f){var b={};for(var P in f)P!=="ref"&&(b[P]=f[P])}else b=f;return ko(s),f=e1(i,s,c,b,x,g),P=t1(),i!==null&&!nn?(r1(i,s,g),zi(i,s,g)):(Kt&&P&&Ld(s),s.flags|=1,dn(i,s,f,g),s.child)}function Av(i,s,c,f,g){if(i===null){var x=c.type;return typeof x=="function"&&!Nd(x)&&x.defaultProps===void 0&&c.compare===null?(s.tag=15,s.type=x,kv(i,s,x,f,g)):(i=Qf(c.type,null,f,s,s.mode,g),i.ref=s.ref,i.return=s,s.child=i)}if(x=i.child,!A1(i,g)){var b=x.memoizedProps;if(c=c.compare,c=c!==null?c:Vc,c(b,f)&&i.ref===s.ref)return zi(i,s,g)}return s.flags|=1,i=Mi(x,f),i.ref=s.ref,i.return=s,s.child=i}function kv(i,s,c,f,g){if(i!==null){var x=i.memoizedProps;if(Vc(x,f)&&i.ref===s.ref)if(nn=!1,s.pendingProps=f=x,A1(i,g))(i.flags&131072)!==0&&(nn=!0);else return s.lanes=i.lanes,zi(i,s,g)}return v1(i,s,c,f,g)}function bv(i,s,c){var f=s.pendingProps,g=f.children,x=i!==null?i.memoizedState:null;if(f.mode==="hidden"){if((s.flags&128)!==0){if(f=x!==null?x.baseLanes|c:c,i!==null){for(g=s.child=i.child,x=0;g!==null;)x=x|g.lanes|g.childLanes,g=g.sibling;s.childLanes=x&~f}else s.childLanes=0,s.child=null;return Cv(i,s,f,c)}if((c&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},i!==null&&r0(s,x!==null?x.cachePool:null),x!==null?kx(s,x):Qd(),mv(s);else return s.lanes=s.childLanes=536870912,Cv(i,s,x!==null?x.baseLanes|c:c,c)}else x!==null?(r0(s,x.cachePool),kx(s,x),_s(),s.memoizedState=null):(i!==null&&r0(s,null),Qd(),_s());return dn(i,s,g,c),s.child}function Cv(i,s,c,f){var g=Gd();return g=g===null?null:{parent:Kr._currentValue,pool:g},s.memoizedState={baseLanes:c,cachePool:g},i!==null&&r0(s,null),Qd(),mv(s),i!==null&&Wc(i,s,f,!0),null}function _0(i,s){var c=s.ref;if(c===null)i!==null&&i.ref!==null&&(s.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(n(284));(i===null||i.ref!==c)&&(s.flags|=4194816)}}function v1(i,s,c,f,g){return ko(s),c=e1(i,s,c,f,void 0,g),f=t1(),i!==null&&!nn?(r1(i,s,g),zi(i,s,g)):(Kt&&f&&Ld(s),s.flags|=1,dn(i,s,c,g),s.child)}function Rv(i,s,c,f,g,x){return ko(s),s.updateQueue=null,c=Cx(s,f,c,g),bx(i),f=t1(),i!==null&&!nn?(r1(i,s,x),zi(i,s,x)):(Kt&&f&&Ld(s),s.flags|=1,dn(i,s,c,x),s.child)}function Dv(i,s,c,f,g){if(ko(s),s.stateNode===null){var x=El,b=c.contextType;typeof b=="object"&&b!==null&&(x=wn(b)),x=new c(f,x),s.memoizedState=x.state!==null&&x.state!==void 0?x.state:null,x.updater=g1,s.stateNode=x,x._reactInternals=s,x=s.stateNode,x.props=f,x.state=s.memoizedState,x.refs={},Xd(s),b=c.contextType,x.context=typeof b=="object"&&b!==null?wn(b):El,x.state=s.memoizedState,b=c.getDerivedStateFromProps,typeof b=="function"&&(p1(s,c,b,f),x.state=s.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof x.getSnapshotBeforeUpdate=="function"||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(b=x.state,typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount(),b!==x.state&&g1.enqueueReplaceState(x,x.state,null),Qc(s,f,x,g),$c(),x.state=s.memoizedState),typeof x.componentDidMount=="function"&&(s.flags|=4194308),f=!0}else if(i===null){x=s.stateNode;var P=s.memoizedProps,re=Ro(c,P);x.props=re;var me=x.context,Ae=c.contextType;b=El,typeof Ae=="object"&&Ae!==null&&(b=wn(Ae));var Re=c.getDerivedStateFromProps;Ae=typeof Re=="function"||typeof x.getSnapshotBeforeUpdate=="function",P=s.pendingProps!==P,Ae||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(P||me!==b)&&gv(s,x,f,b),ms=!1;var ve=s.memoizedState;x.state=ve,Qc(s,f,x,g),$c(),me=s.memoizedState,P||ve!==me||ms?(typeof Re=="function"&&(p1(s,c,Re,f),me=s.memoizedState),(re=ms||pv(s,c,re,f,ve,me,b))?(Ae||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(s.flags|=4194308)):(typeof x.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=f,s.memoizedState=me),x.props=f,x.state=me,x.context=b,f=re):(typeof x.componentDidMount=="function"&&(s.flags|=4194308),f=!1)}else{x=s.stateNode,Yd(i,s),b=s.memoizedProps,Ae=Ro(c,b),x.props=Ae,Re=s.pendingProps,ve=x.context,me=c.contextType,re=El,typeof me=="object"&&me!==null&&(re=wn(me)),P=c.getDerivedStateFromProps,(me=typeof P=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(b!==Re||ve!==re)&&gv(s,x,f,re),ms=!1,ve=s.memoizedState,x.state=ve,Qc(s,f,x,g),$c();var _e=s.memoizedState;b!==Re||ve!==_e||ms||i!==null&&i.dependencies!==null&&e0(i.dependencies)?(typeof P=="function"&&(p1(s,c,P,f),_e=s.memoizedState),(Ae=ms||pv(s,c,Ae,f,ve,_e,re)||i!==null&&i.dependencies!==null&&e0(i.dependencies))?(me||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(f,_e,re),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(f,_e,re)),typeof x.componentDidUpdate=="function"&&(s.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof x.componentDidUpdate!="function"||b===i.memoizedProps&&ve===i.memoizedState||(s.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||b===i.memoizedProps&&ve===i.memoizedState||(s.flags|=1024),s.memoizedProps=f,s.memoizedState=_e),x.props=f,x.state=_e,x.context=re,f=Ae):(typeof x.componentDidUpdate!="function"||b===i.memoizedProps&&ve===i.memoizedState||(s.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||b===i.memoizedProps&&ve===i.memoizedState||(s.flags|=1024),f=!1)}return x=f,_0(i,s),f=(s.flags&128)!==0,x||f?(x=s.stateNode,c=f&&typeof c.getDerivedStateFromError!="function"?null:x.render(),s.flags|=1,i!==null&&f?(s.child=Ol(s,i.child,null,g),s.child=Ol(s,null,c,g)):dn(i,s,c,g),s.memoizedState=x.state,i=s.child):i=zi(i,s,g),i}function Iv(i,s,c,f){return zc(),s.flags|=256,dn(i,s,c,f),s.child}var _1={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function y1(i){return{baseLanes:i,cachePool:vx()}}function T1(i,s,c){return i=i!==null?i.childLanes&~c:0,s&&(i|=Sa),i}function Ov(i,s,c){var f=s.pendingProps,g=!1,x=(s.flags&128)!==0,b;if((b=x)||(b=i!==null&&i.memoizedState===null?!1:($r.current&2)!==0),b&&(g=!0,s.flags&=-129),b=(s.flags&32)!==0,s.flags&=-33,i===null){if(Kt){if(g?vs(s):_s(),Kt){var P=br,re;if(re=P){e:{for(re=P,P=li;re.nodeType!==8;){if(!P){P=null;break e}if(re=za(re.nextSibling),re===null){P=null;break e}}P=re}P!==null?(s.memoizedState={dehydrated:P,treeContext:To!==null?{id:Pi,overflow:Li}:null,retryLane:536870912,hydrationErrors:null},re=na(18,null,null,0),re.stateNode=P,re.return=s,s.child=re,Un=s,br=null,re=!0):re=!1}re||So(s)}if(P=s.memoizedState,P!==null&&(P=P.dehydrated,P!==null))return am(P)?s.lanes=32:s.lanes=536870912,null;ji(s)}return P=f.children,f=f.fallback,g?(_s(),g=s.mode,P=y0({mode:"hidden",children:P},g),f=yo(f,g,c,null),P.return=s,f.return=s,P.sibling=f,s.child=P,g=s.child,g.memoizedState=y1(c),g.childLanes=T1(i,b,c),s.memoizedState=_1,f):(vs(s),E1(s,P))}if(re=i.memoizedState,re!==null&&(P=re.dehydrated,P!==null)){if(x)s.flags&256?(vs(s),s.flags&=-257,s=w1(i,s,c)):s.memoizedState!==null?(_s(),s.child=i.child,s.flags|=128,s=null):(_s(),g=f.fallback,P=s.mode,f=y0({mode:"visible",children:f.children},P),g=yo(g,P,c,null),g.flags|=2,f.return=s,g.return=s,f.sibling=g,s.child=f,Ol(s,i.child,null,c),f=s.child,f.memoizedState=y1(c),f.childLanes=T1(i,b,c),s.memoizedState=_1,s=g);else if(vs(s),am(P)){if(b=P.nextSibling&&P.nextSibling.dataset,b)var me=b.dgst;b=me,f=Error(n(419)),f.stack="",f.digest=b,Hc({value:f,source:null,stack:null}),s=w1(i,s,c)}else if(nn||Wc(i,s,c,!1),b=(c&i.childLanes)!==0,nn||b){if(b=mr,b!==null&&(f=c&-c,f=(f&42)!==0?1:Qa(f),f=(f&(b.suspendedLanes|c))!==0?0:f,f!==0&&f!==re.retryLane))throw re.retryLane=f,Tl(i,f),la(b,i,f),wv;P.data==="$?"||j1(),s=w1(i,s,c)}else P.data==="$?"?(s.flags|=192,s.child=i.child,s=null):(i=re.treeContext,br=za(P.nextSibling),Un=s,Kt=!0,wo=null,li=!1,i!==null&&(Ta[Ea++]=Pi,Ta[Ea++]=Li,Ta[Ea++]=To,Pi=i.id,Li=i.overflow,To=s),s=E1(s,f.children),s.flags|=4096);return s}return g?(_s(),g=f.fallback,P=s.mode,re=i.child,me=re.sibling,f=Mi(re,{mode:"hidden",children:f.children}),f.subtreeFlags=re.subtreeFlags&65011712,me!==null?g=Mi(me,g):(g=yo(g,P,c,null),g.flags|=2),g.return=s,f.return=s,f.sibling=g,s.child=f,f=g,g=s.child,P=i.child.memoizedState,P===null?P=y1(c):(re=P.cachePool,re!==null?(me=Kr._currentValue,re=re.parent!==me?{parent:me,pool:me}:re):re=vx(),P={baseLanes:P.baseLanes|c,cachePool:re}),g.memoizedState=P,g.childLanes=T1(i,b,c),s.memoizedState=_1,f):(vs(s),c=i.child,i=c.sibling,c=Mi(c,{mode:"visible",children:f.children}),c.return=s,c.sibling=null,i!==null&&(b=s.deletions,b===null?(s.deletions=[i],s.flags|=16):b.push(i)),s.child=c,s.memoizedState=null,c)}function E1(i,s){return s=y0({mode:"visible",children:s},i.mode),s.return=i,i.child=s}function y0(i,s){return i=na(22,i,null,s),i.lanes=0,i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},i}function w1(i,s,c){return Ol(s,i.child,null,c),i=E1(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function Fv(i,s,c){i.lanes|=s;var f=i.alternate;f!==null&&(f.lanes|=s),jd(i.return,s,c)}function S1(i,s,c,f,g){var x=i.memoizedState;x===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:f,tail:c,tailMode:g}:(x.isBackwards=s,x.rendering=null,x.renderingStartTime=0,x.last=f,x.tail=c,x.tailMode=g)}function Nv(i,s,c){var f=s.pendingProps,g=f.revealOrder,x=f.tail;if(dn(i,s,f.children,c),f=$r.current,(f&2)!==0)f=f&1|2,s.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Fv(i,c,s);else if(i.tag===19)Fv(i,c,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}f&=1}switch(Y($r,f),g){case"forwards":for(c=s.child,g=null;c!==null;)i=c.alternate,i!==null&&g0(i)===null&&(g=c),c=c.sibling;c=g,c===null?(g=s.child,s.child=null):(g=c.sibling,c.sibling=null),S1(s,!1,g,c,x);break;case"backwards":for(c=null,g=s.child,s.child=null;g!==null;){if(i=g.alternate,i!==null&&g0(i)===null){s.child=g;break}i=g.sibling,g.sibling=c,c=g,g=i}S1(s,!0,c,null,x);break;case"together":S1(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function zi(i,s,c){if(i!==null&&(s.dependencies=i.dependencies),Ss|=s.lanes,(c&s.childLanes)===0)if(i!==null){if(Wc(i,s,c,!1),(c&s.childLanes)===0)return null}else return null;if(i!==null&&s.child!==i.child)throw Error(n(153));if(s.child!==null){for(i=s.child,c=Mi(i,i.pendingProps),s.child=c,c.return=s;i.sibling!==null;)i=i.sibling,c=c.sibling=Mi(i,i.pendingProps),c.return=s;c.sibling=null}return s.child}function A1(i,s){return(i.lanes&s)!==0?!0:(i=i.dependencies,!!(i!==null&&e0(i)))}function J4(i,s,c){switch(s.tag){case 3:ke(s,s.stateNode.containerInfo),ds(s,Kr,i.memoizedState.cache),zc();break;case 27:case 5:le(s);break;case 4:ke(s,s.stateNode.containerInfo);break;case 10:ds(s,s.type,s.memoizedProps.value);break;case 13:var f=s.memoizedState;if(f!==null)return f.dehydrated!==null?(vs(s),s.flags|=128,null):(c&s.child.childLanes)!==0?Ov(i,s,c):(vs(s),i=zi(i,s,c),i!==null?i.sibling:null);vs(s);break;case 19:var g=(i.flags&128)!==0;if(f=(c&s.childLanes)!==0,f||(Wc(i,s,c,!1),f=(c&s.childLanes)!==0),g){if(f)return Nv(i,s,c);s.flags|=128}if(g=s.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),Y($r,$r.current),f)break;return null;case 22:case 23:return s.lanes=0,bv(i,s,c);case 24:ds(s,Kr,i.memoizedState.cache)}return zi(i,s,c)}function Mv(i,s,c){if(i!==null)if(i.memoizedProps!==s.pendingProps)nn=!0;else{if(!A1(i,c)&&(s.flags&128)===0)return nn=!1,J4(i,s,c);nn=(i.flags&131072)!==0}else nn=!1,Kt&&(s.flags&1048576)!==0&&fx(s,Jf,s.index);switch(s.lanes=0,s.tag){case 16:e:{i=s.pendingProps;var f=s.elementType,g=f._init;if(f=g(f._payload),s.type=f,typeof f=="function")Nd(f)?(i=Ro(f,i),s.tag=1,s=Dv(null,s,f,i,c)):(s.tag=0,s=v1(null,s,f,i,c));else{if(f!=null){if(g=f.$$typeof,g===ee){s.tag=11,s=Sv(null,s,f,i,c);break e}else if(g===C){s.tag=14,s=Av(null,s,f,i,c);break e}}throw s=Fe(f)||f,Error(n(306,s,""))}}return s;case 0:return v1(i,s,s.type,s.pendingProps,c);case 1:return f=s.type,g=Ro(f,s.pendingProps),Dv(i,s,f,g,c);case 3:e:{if(ke(s,s.stateNode.containerInfo),i===null)throw Error(n(387));f=s.pendingProps;var x=s.memoizedState;g=x.element,Yd(i,s),Qc(s,f,null,c);var b=s.memoizedState;if(f=b.cache,ds(s,Kr,f),f!==x.cache&&zd(s,[Kr],c,!0),$c(),f=b.element,x.isDehydrated)if(x={element:f,isDehydrated:!1,cache:b.cache},s.updateQueue.baseState=x,s.memoizedState=x,s.flags&256){s=Iv(i,s,f,c);break e}else if(f!==g){g=_a(Error(n(424)),s),Hc(g),s=Iv(i,s,f,c);break e}else{switch(i=s.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(br=za(i.firstChild),Un=s,Kt=!0,wo=null,li=!0,c=dv(s,null,f,c),s.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(zc(),f===g){s=zi(i,s,c);break e}dn(i,s,f,c)}s=s.child}return s;case 26:return _0(i,s),i===null?(c=V2(s.type,null,s.pendingProps,null))?s.memoizedState=c:Kt||(c=s.type,i=s.pendingProps,f=N0(ue.current).createElement(c),f[Or]=s,f[yr]=i,pn(f,c,i),ce(f),s.stateNode=f):s.memoizedState=V2(s.type,i.memoizedProps,s.pendingProps,i.memoizedState),null;case 27:return le(s),i===null&&Kt&&(f=s.stateNode=P2(s.type,s.pendingProps,ue.current),Un=s,li=!0,g=br,Cs(s.type)?(im=g,br=za(f.firstChild)):br=g),dn(i,s,s.pendingProps.children,c),_0(i,s),i===null&&(s.flags|=4194304),s.child;case 5:return i===null&&Kt&&((g=f=br)&&(f=bA(f,s.type,s.pendingProps,li),f!==null?(s.stateNode=f,Un=s,br=za(f.firstChild),li=!1,g=!0):g=!1),g||So(s)),le(s),g=s.type,x=s.pendingProps,b=i!==null?i.memoizedProps:null,f=x.children,tm(g,x)?f=null:b!==null&&tm(g,b)&&(s.flags|=32),s.memoizedState!==null&&(g=e1(i,s,G4,null,null,c),_u._currentValue=g),_0(i,s),dn(i,s,f,c),s.child;case 6:return i===null&&Kt&&((i=c=br)&&(c=CA(c,s.pendingProps,li),c!==null?(s.stateNode=c,Un=s,br=null,i=!0):i=!1),i||So(s)),null;case 13:return Ov(i,s,c);case 4:return ke(s,s.stateNode.containerInfo),f=s.pendingProps,i===null?s.child=Ol(s,null,f,c):dn(i,s,f,c),s.child;case 11:return Sv(i,s,s.type,s.pendingProps,c);case 7:return dn(i,s,s.pendingProps,c),s.child;case 8:return dn(i,s,s.pendingProps.children,c),s.child;case 12:return dn(i,s,s.pendingProps.children,c),s.child;case 10:return f=s.pendingProps,ds(s,s.type,f.value),dn(i,s,f.children,c),s.child;case 9:return g=s.type._context,f=s.pendingProps.children,ko(s),g=wn(g),f=f(g),s.flags|=1,dn(i,s,f,c),s.child;case 14:return Av(i,s,s.type,s.pendingProps,c);case 15:return kv(i,s,s.type,s.pendingProps,c);case 19:return Nv(i,s,c);case 31:return f=s.pendingProps,c=s.mode,f={mode:f.mode,children:f.children},i===null?(c=y0(f,c),c.ref=s.ref,s.child=c,c.return=s,s=c):(c=Mi(i.child,f),c.ref=s.ref,s.child=c,c.return=s,s=c),s;case 22:return bv(i,s,c);case 24:return ko(s),f=wn(Kr),i===null?(g=Gd(),g===null&&(g=mr,x=Hd(),g.pooledCache=x,x.refCount++,x!==null&&(g.pooledCacheLanes|=c),g=x),s.memoizedState={parent:f,cache:g},Xd(s),ds(s,Kr,g)):((i.lanes&c)!==0&&(Yd(i,s),Qc(s,null,null,c),$c()),g=i.memoizedState,x=s.memoizedState,g.parent!==f?(g={parent:f,cache:f},s.memoizedState=g,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=g),ds(s,Kr,f)):(f=x.cache,ds(s,Kr,f),f!==g.cache&&zd(s,[Kr],c,!0))),dn(i,s,s.pendingProps.children,c),s.child;case 29:throw s.pendingProps}throw Error(n(156,s.tag))}function Hi(i){i.flags|=4}function Pv(i,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!W2(s)){if(s=wa.current,s!==null&&((Ut&4194048)===Ut?ci!==null:(Ut&62914560)!==Ut&&(Ut&536870912)===0||s!==ci))throw Yc=qd,_x;i.flags|=8192}}function T0(i,s){s!==null&&(i.flags|=4),i.flags&16384&&(s=i.tag!==22?cs():536870912,i.lanes|=s,Pl|=s)}function au(i,s){if(!Kt)switch(i.tailMode){case"hidden":s=i.tail;for(var c=null;s!==null;)s.alternate!==null&&(c=s),s=s.sibling;c===null?i.tail=null:c.sibling=null;break;case"collapsed":c=i.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:f.sibling=null}}function Er(i){var s=i.alternate!==null&&i.alternate.child===i.child,c=0,f=0;if(s)for(var g=i.child;g!==null;)c|=g.lanes|g.childLanes,f|=g.subtreeFlags&65011712,f|=g.flags&65011712,g.return=i,g=g.sibling;else for(g=i.child;g!==null;)c|=g.lanes|g.childLanes,f|=g.subtreeFlags,f|=g.flags,g.return=i,g=g.sibling;return i.subtreeFlags|=f,i.childLanes=c,s}function eA(i,s,c){var f=s.pendingProps;switch(Bd(s),s.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Er(s),null;case 1:return Er(s),null;case 3:return c=s.stateNode,f=null,i!==null&&(f=i.memoizedState.cache),s.memoizedState.cache!==f&&(s.flags|=2048),Vi(Kr),Oe(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(i===null||i.child===null)&&(jc(s)?Hi(s):i===null||i.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,mx())),Er(s),null;case 26:return c=s.memoizedState,i===null?(Hi(s),c!==null?(Er(s),Pv(s,c)):(Er(s),s.flags&=-16777217)):c?c!==i.memoizedState?(Hi(s),Er(s),Pv(s,c)):(Er(s),s.flags&=-16777217):(i.memoizedProps!==f&&Hi(s),Er(s),s.flags&=-16777217),null;case 27:Qe(s),c=ue.current;var g=s.type;if(i!==null&&s.stateNode!=null)i.memoizedProps!==f&&Hi(s);else{if(!f){if(s.stateNode===null)throw Error(n(166));return Er(s),null}i=Q.current,jc(s)?hx(s):(i=P2(g,f,c),s.stateNode=i,Hi(s))}return Er(s),null;case 5:if(Qe(s),c=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==f&&Hi(s);else{if(!f){if(s.stateNode===null)throw Error(n(166));return Er(s),null}if(i=Q.current,jc(s))hx(s);else{switch(g=N0(ue.current),i){case 1:i=g.createElementNS("http://www.w3.org/2000/svg",c);break;case 2:i=g.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;default:switch(c){case"svg":i=g.createElementNS("http://www.w3.org/2000/svg",c);break;case"math":i=g.createElementNS("http://www.w3.org/1998/Math/MathML",c);break;case"script":i=g.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof f.is=="string"?g.createElement("select",{is:f.is}):g.createElement("select"),f.multiple?i.multiple=!0:f.size&&(i.size=f.size);break;default:i=typeof f.is=="string"?g.createElement(c,{is:f.is}):g.createElement(c)}}i[Or]=s,i[yr]=f;e:for(g=s.child;g!==null;){if(g.tag===5||g.tag===6)i.appendChild(g.stateNode);else if(g.tag!==4&&g.tag!==27&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===s)break e;for(;g.sibling===null;){if(g.return===null||g.return===s)break e;g=g.return}g.sibling.return=g.return,g=g.sibling}s.stateNode=i;e:switch(pn(i,c,f),c){case"button":case"input":case"select":case"textarea":i=!!f.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&Hi(s)}}return Er(s),s.flags&=-16777217,null;case 6:if(i&&s.stateNode!=null)i.memoizedProps!==f&&Hi(s);else{if(typeof f!="string"&&s.stateNode===null)throw Error(n(166));if(i=ue.current,jc(s)){if(i=s.stateNode,c=s.memoizedProps,f=null,g=Un,g!==null)switch(g.tag){case 27:case 5:f=g.memoizedProps}i[Or]=s,i=!!(i.nodeValue===c||f!==null&&f.suppressHydrationWarning===!0||R2(i.nodeValue,c)),i||So(s)}else i=N0(i).createTextNode(f),i[Or]=s,s.stateNode=i}return Er(s),null;case 13:if(f=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(g=jc(s),f!==null&&f.dehydrated!==null){if(i===null){if(!g)throw Error(n(318));if(g=s.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(n(317));g[Or]=s}else zc(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Er(s),g=!1}else g=mx(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=g),g=!0;if(!g)return s.flags&256?(ji(s),s):(ji(s),null)}if(ji(s),(s.flags&128)!==0)return s.lanes=c,s;if(c=f!==null,i=i!==null&&i.memoizedState!==null,c){f=s.child,g=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(g=f.alternate.memoizedState.cachePool.pool);var x=null;f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(x=f.memoizedState.cachePool.pool),x!==g&&(f.flags|=2048)}return c!==i&&c&&(s.child.flags|=8192),T0(s,s.updateQueue),Er(s),null;case 4:return Oe(),i===null&&$1(s.stateNode.containerInfo),Er(s),null;case 10:return Vi(s.type),Er(s),null;case 19:if(V($r),g=s.memoizedState,g===null)return Er(s),null;if(f=(s.flags&128)!==0,x=g.rendering,x===null)if(f)au(g,!1);else{if(Cr!==0||i!==null&&(i.flags&128)!==0)for(i=s.child;i!==null;){if(x=g0(i),x!==null){for(s.flags|=128,au(g,!1),i=x.updateQueue,s.updateQueue=i,T0(s,i),s.subtreeFlags=0,i=c,c=s.child;c!==null;)ux(c,i),c=c.sibling;return Y($r,$r.current&1|2),s.child}i=i.sibling}g.tail!==null&&be()>S0&&(s.flags|=128,f=!0,au(g,!1),s.lanes=4194304)}else{if(!f)if(i=g0(x),i!==null){if(s.flags|=128,f=!0,i=i.updateQueue,s.updateQueue=i,T0(s,i),au(g,!0),g.tail===null&&g.tailMode==="hidden"&&!x.alternate&&!Kt)return Er(s),null}else 2*be()-g.renderingStartTime>S0&&c!==536870912&&(s.flags|=128,f=!0,au(g,!1),s.lanes=4194304);g.isBackwards?(x.sibling=s.child,s.child=x):(i=g.last,i!==null?i.sibling=x:s.child=x,g.last=x)}return g.tail!==null?(s=g.tail,g.rendering=s,g.tail=s.sibling,g.renderingStartTime=be(),s.sibling=null,i=$r.current,Y($r,f?i&1|2:i&1),s):(Er(s),null);case 22:case 23:return ji(s),Zd(),f=s.memoizedState!==null,i!==null?i.memoizedState!==null!==f&&(s.flags|=8192):f&&(s.flags|=8192),f?(c&536870912)!==0&&(s.flags&128)===0&&(Er(s),s.subtreeFlags&6&&(s.flags|=8192)):Er(s),c=s.updateQueue,c!==null&&T0(s,c.retryQueue),c=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),f=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(f=s.memoizedState.cachePool.pool),f!==c&&(s.flags|=2048),i!==null&&V(bo),null;case 24:return c=null,i!==null&&(c=i.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),Vi(Kr),Er(s),null;case 25:return null;case 30:return null}throw Error(n(156,s.tag))}function tA(i,s){switch(Bd(s),s.tag){case 1:return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return Vi(Kr),Oe(),i=s.flags,(i&65536)!==0&&(i&128)===0?(s.flags=i&-65537|128,s):null;case 26:case 27:case 5:return Qe(s),null;case 13:if(ji(s),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(n(340));zc()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return V($r),null;case 4:return Oe(),null;case 10:return Vi(s.type),null;case 22:case 23:return ji(s),Zd(),i!==null&&V(bo),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 24:return Vi(Kr),null;case 25:return null;default:return null}}function Lv(i,s){switch(Bd(s),s.tag){case 3:Vi(Kr),Oe();break;case 26:case 27:case 5:Qe(s);break;case 4:Oe();break;case 13:ji(s);break;case 19:V($r);break;case 10:Vi(s.type);break;case 22:case 23:ji(s),Zd(),i!==null&&V(bo);break;case 24:Vi(Kr)}}function iu(i,s){try{var c=s.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var g=f.next;c=g;do{if((c.tag&i)===i){f=void 0;var x=c.create,b=c.inst;f=x(),b.destroy=f}c=c.next}while(c!==g)}}catch(P){hr(s,s.return,P)}}function ys(i,s,c){try{var f=s.updateQueue,g=f!==null?f.lastEffect:null;if(g!==null){var x=g.next;f=x;do{if((f.tag&i)===i){var b=f.inst,P=b.destroy;if(P!==void 0){b.destroy=void 0,g=s;var re=c,me=P;try{me()}catch(Ae){hr(g,re,Ae)}}}f=f.next}while(f!==x)}}catch(Ae){hr(s,s.return,Ae)}}function Bv(i){var s=i.updateQueue;if(s!==null){var c=i.stateNode;try{Ax(s,c)}catch(f){hr(i,i.return,f)}}}function Vv(i,s,c){c.props=Ro(i.type,i.memoizedProps),c.state=i.memoizedState;try{c.componentWillUnmount()}catch(f){hr(i,s,f)}}function su(i,s){try{var c=i.ref;if(c!==null){switch(i.tag){case 26:case 27:case 5:var f=i.stateNode;break;case 30:f=i.stateNode;break;default:f=i.stateNode}typeof c=="function"?i.refCleanup=c(f):c.current=f}}catch(g){hr(i,s,g)}}function ui(i,s){var c=i.ref,f=i.refCleanup;if(c!==null)if(typeof f=="function")try{f()}catch(g){hr(i,s,g)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(g){hr(i,s,g)}else c.current=null}function Uv(i){var s=i.type,c=i.memoizedProps,f=i.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":c.autoFocus&&f.focus();break e;case"img":c.src?f.src=c.src:c.srcSet&&(f.srcset=c.srcSet)}}catch(g){hr(i,i.return,g)}}function k1(i,s,c){try{var f=i.stateNode;EA(f,i.type,c,s),f[yr]=s}catch(g){hr(i,i.return,g)}}function jv(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&Cs(i.type)||i.tag===4}function b1(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||jv(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&Cs(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function C1(i,s,c){var f=i.tag;if(f===5||f===6)i=i.stateNode,s?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(i,s):(s=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,s.appendChild(i),c=c._reactRootContainer,c!=null||s.onclick!==null||(s.onclick=F0));else if(f!==4&&(f===27&&Cs(i.type)&&(c=i.stateNode,s=null),i=i.child,i!==null))for(C1(i,s,c),i=i.sibling;i!==null;)C1(i,s,c),i=i.sibling}function E0(i,s,c){var f=i.tag;if(f===5||f===6)i=i.stateNode,s?c.insertBefore(i,s):c.appendChild(i);else if(f!==4&&(f===27&&Cs(i.type)&&(c=i.stateNode),i=i.child,i!==null))for(E0(i,s,c),i=i.sibling;i!==null;)E0(i,s,c),i=i.sibling}function zv(i){var s=i.stateNode,c=i.memoizedProps;try{for(var f=i.type,g=s.attributes;g.length;)s.removeAttributeNode(g[0]);pn(s,f,c),s[Or]=i,s[yr]=c}catch(x){hr(i,i.return,x)}}var Wi=!1,Nr=!1,R1=!1,Hv=typeof WeakSet=="function"?WeakSet:Set,an=null;function rA(i,s){if(i=i.containerInfo,J1=U0,i=ex(i),bd(i)){if("selectionStart"in i)var c={start:i.selectionStart,end:i.selectionEnd};else e:{c=(c=i.ownerDocument)&&c.defaultView||window;var f=c.getSelection&&c.getSelection();if(f&&f.rangeCount!==0){c=f.anchorNode;var g=f.anchorOffset,x=f.focusNode;f=f.focusOffset;try{c.nodeType,x.nodeType}catch{c=null;break e}var b=0,P=-1,re=-1,me=0,Ae=0,Re=i,ve=null;t:for(;;){for(var _e;Re!==c||g!==0&&Re.nodeType!==3||(P=b+g),Re!==x||f!==0&&Re.nodeType!==3||(re=b+f),Re.nodeType===3&&(b+=Re.nodeValue.length),(_e=Re.firstChild)!==null;)ve=Re,Re=_e;for(;;){if(Re===i)break t;if(ve===c&&++me===g&&(P=b),ve===x&&++Ae===f&&(re=b),(_e=Re.nextSibling)!==null)break;Re=ve,ve=Re.parentNode}Re=_e}c=P===-1||re===-1?null:{start:P,end:re}}else c=null}c=c||{start:0,end:0}}else c=null;for(em={focusedElem:i,selectionRange:c},U0=!1,an=s;an!==null;)if(s=an,i=s.child,(s.subtreeFlags&1024)!==0&&i!==null)i.return=s,an=i;else for(;an!==null;){switch(s=an,x=s.alternate,i=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((i&1024)!==0&&x!==null){i=void 0,c=s,g=x.memoizedProps,x=x.memoizedState,f=c.stateNode;try{var _t=Ro(c.type,g,c.elementType===c.type);i=f.getSnapshotBeforeUpdate(_t,x),f.__reactInternalSnapshotBeforeUpdate=i}catch(ht){hr(c,c.return,ht)}}break;case 3:if((i&1024)!==0){if(i=s.stateNode.containerInfo,c=i.nodeType,c===9)nm(i);else if(c===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":nm(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(n(163))}if(i=s.sibling,i!==null){i.return=s.return,an=i;break}an=s.return}}function Wv(i,s,c){var f=c.flags;switch(c.tag){case 0:case 11:case 15:Ts(i,c),f&4&&iu(5,c);break;case 1:if(Ts(i,c),f&4)if(i=c.stateNode,s===null)try{i.componentDidMount()}catch(b){hr(c,c.return,b)}else{var g=Ro(c.type,s.memoizedProps);s=s.memoizedState;try{i.componentDidUpdate(g,s,i.__reactInternalSnapshotBeforeUpdate)}catch(b){hr(c,c.return,b)}}f&64&&Bv(c),f&512&&su(c,c.return);break;case 3:if(Ts(i,c),f&64&&(i=c.updateQueue,i!==null)){if(s=null,c.child!==null)switch(c.child.tag){case 27:case 5:s=c.child.stateNode;break;case 1:s=c.child.stateNode}try{Ax(i,s)}catch(b){hr(c,c.return,b)}}break;case 27:s===null&&f&4&&zv(c);case 26:case 5:Ts(i,c),s===null&&f&4&&Uv(c),f&512&&su(c,c.return);break;case 12:Ts(i,c);break;case 13:Ts(i,c),f&4&&Xv(i,c),f&64&&(i=c.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(c=fA.bind(null,c),RA(i,c))));break;case 22:if(f=c.memoizedState!==null||Wi,!f){s=s!==null&&s.memoizedState!==null||Nr,g=Wi;var x=Nr;Wi=f,(Nr=s)&&!x?Es(i,c,(c.subtreeFlags&8772)!==0):Ts(i,c),Wi=g,Nr=x}break;case 30:break;default:Ts(i,c)}}function Gv(i){var s=i.alternate;s!==null&&(i.alternate=null,Gv(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&H(s)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Tr=null,Yn=!1;function Gi(i,s,c){for(c=c.child;c!==null;)qv(i,s,c),c=c.sibling}function qv(i,s,c){if(lt&&typeof lt.onCommitFiberUnmount=="function")try{lt.onCommitFiberUnmount(rt,c)}catch{}switch(c.tag){case 26:Nr||ui(c,s),Gi(i,s,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Nr||ui(c,s);var f=Tr,g=Yn;Cs(c.type)&&(Tr=c.stateNode,Yn=!1),Gi(i,s,c),pu(c.stateNode),Tr=f,Yn=g;break;case 5:Nr||ui(c,s);case 6:if(f=Tr,g=Yn,Tr=null,Gi(i,s,c),Tr=f,Yn=g,Tr!==null)if(Yn)try{(Tr.nodeType===9?Tr.body:Tr.nodeName==="HTML"?Tr.ownerDocument.body:Tr).removeChild(c.stateNode)}catch(x){hr(c,s,x)}else try{Tr.removeChild(c.stateNode)}catch(x){hr(c,s,x)}break;case 18:Tr!==null&&(Yn?(i=Tr,N2(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,c.stateNode),wu(i)):N2(Tr,c.stateNode));break;case 4:f=Tr,g=Yn,Tr=c.stateNode.containerInfo,Yn=!0,Gi(i,s,c),Tr=f,Yn=g;break;case 0:case 11:case 14:case 15:Nr||ys(2,c,s),Nr||ys(4,c,s),Gi(i,s,c);break;case 1:Nr||(ui(c,s),f=c.stateNode,typeof f.componentWillUnmount=="function"&&Vv(c,s,f)),Gi(i,s,c);break;case 21:Gi(i,s,c);break;case 22:Nr=(f=Nr)||c.memoizedState!==null,Gi(i,s,c),Nr=f;break;default:Gi(i,s,c)}}function Xv(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{wu(i)}catch(c){hr(s,s.return,c)}}function nA(i){switch(i.tag){case 13:case 19:var s=i.stateNode;return s===null&&(s=i.stateNode=new Hv),s;case 22:return i=i.stateNode,s=i._retryCache,s===null&&(s=i._retryCache=new Hv),s;default:throw Error(n(435,i.tag))}}function D1(i,s){var c=nA(i);s.forEach(function(f){var g=hA.bind(null,i,f);c.has(f)||(c.add(f),f.then(g,g))})}function aa(i,s){var c=s.deletions;if(c!==null)for(var f=0;f<c.length;f++){var g=c[f],x=i,b=s,P=b;e:for(;P!==null;){switch(P.tag){case 27:if(Cs(P.type)){Tr=P.stateNode,Yn=!1;break e}break;case 5:Tr=P.stateNode,Yn=!1;break e;case 3:case 4:Tr=P.stateNode.containerInfo,Yn=!0;break e}P=P.return}if(Tr===null)throw Error(n(160));qv(x,b,g),Tr=null,Yn=!1,x=g.alternate,x!==null&&(x.return=null),g.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)Yv(s,i),s=s.sibling}var ja=null;function Yv(i,s){var c=i.alternate,f=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:aa(s,i),ia(i),f&4&&(ys(3,i,i.return),iu(3,i),ys(5,i,i.return));break;case 1:aa(s,i),ia(i),f&512&&(Nr||c===null||ui(c,c.return)),f&64&&Wi&&(i=i.updateQueue,i!==null&&(f=i.callbacks,f!==null&&(c=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=c===null?f:c.concat(f))));break;case 26:var g=ja;if(aa(s,i),ia(i),f&512&&(Nr||c===null||ui(c,c.return)),f&4){var x=c!==null?c.memoizedState:null;if(f=i.memoizedState,c===null)if(f===null)if(i.stateNode===null){e:{f=i.type,c=i.memoizedProps,g=g.ownerDocument||g;t:switch(f){case"title":x=g.getElementsByTagName("title")[0],(!x||x[j]||x[Or]||x.namespaceURI==="http://www.w3.org/2000/svg"||x.hasAttribute("itemprop"))&&(x=g.createElement(f),g.head.insertBefore(x,g.querySelector("head > title"))),pn(x,f,c),x[Or]=i,ce(x),f=x;break e;case"link":var b=z2("link","href",g).get(f+(c.href||""));if(b){for(var P=0;P<b.length;P++)if(x=b[P],x.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&x.getAttribute("rel")===(c.rel==null?null:c.rel)&&x.getAttribute("title")===(c.title==null?null:c.title)&&x.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){b.splice(P,1);break t}}x=g.createElement(f),pn(x,f,c),g.head.appendChild(x);break;case"meta":if(b=z2("meta","content",g).get(f+(c.content||""))){for(P=0;P<b.length;P++)if(x=b[P],x.getAttribute("content")===(c.content==null?null:""+c.content)&&x.getAttribute("name")===(c.name==null?null:c.name)&&x.getAttribute("property")===(c.property==null?null:c.property)&&x.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&x.getAttribute("charset")===(c.charSet==null?null:c.charSet)){b.splice(P,1);break t}}x=g.createElement(f),pn(x,f,c),g.head.appendChild(x);break;default:throw Error(n(468,f))}x[Or]=i,ce(x),f=x}i.stateNode=f}else H2(g,i.type,i.stateNode);else i.stateNode=j2(g,f,i.memoizedProps);else x!==f?(x===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):x.count--,f===null?H2(g,i.type,i.stateNode):j2(g,f,i.memoizedProps)):f===null&&i.stateNode!==null&&k1(i,i.memoizedProps,c.memoizedProps)}break;case 27:aa(s,i),ia(i),f&512&&(Nr||c===null||ui(c,c.return)),c!==null&&f&4&&k1(i,i.memoizedProps,c.memoizedProps);break;case 5:if(aa(s,i),ia(i),f&512&&(Nr||c===null||ui(c,c.return)),i.flags&32){g=i.stateNode;try{pa(g,"")}catch(_e){hr(i,i.return,_e)}}f&4&&i.stateNode!=null&&(g=i.memoizedProps,k1(i,g,c!==null?c.memoizedProps:g)),f&1024&&(R1=!0);break;case 6:if(aa(s,i),ia(i),f&4){if(i.stateNode===null)throw Error(n(162));f=i.memoizedProps,c=i.stateNode;try{c.nodeValue=f}catch(_e){hr(i,i.return,_e)}}break;case 3:if(L0=null,g=ja,ja=M0(s.containerInfo),aa(s,i),ja=g,ia(i),f&4&&c!==null&&c.memoizedState.isDehydrated)try{wu(s.containerInfo)}catch(_e){hr(i,i.return,_e)}R1&&(R1=!1,Kv(i));break;case 4:f=ja,ja=M0(i.stateNode.containerInfo),aa(s,i),ia(i),ja=f;break;case 12:aa(s,i),ia(i);break;case 13:aa(s,i),ia(i),i.child.flags&8192&&i.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(P1=be()),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,D1(i,f)));break;case 22:g=i.memoizedState!==null;var re=c!==null&&c.memoizedState!==null,me=Wi,Ae=Nr;if(Wi=me||g,Nr=Ae||re,aa(s,i),Nr=Ae,Wi=me,ia(i),f&8192)e:for(s=i.stateNode,s._visibility=g?s._visibility&-2:s._visibility|1,g&&(c===null||re||Wi||Nr||Do(i)),c=null,s=i;;){if(s.tag===5||s.tag===26){if(c===null){re=c=s;try{if(x=re.stateNode,g)b=x.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none";else{P=re.stateNode;var Re=re.memoizedProps.style,ve=Re!=null&&Re.hasOwnProperty("display")?Re.display:null;P.style.display=ve==null||typeof ve=="boolean"?"":(""+ve).trim()}}catch(_e){hr(re,re.return,_e)}}}else if(s.tag===6){if(c===null){re=s;try{re.stateNode.nodeValue=g?"":re.memoizedProps}catch(_e){hr(re,re.return,_e)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===i)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;c===s&&(c=null),s=s.return}c===s&&(c=null),s.sibling.return=s.return,s=s.sibling}f&4&&(f=i.updateQueue,f!==null&&(c=f.retryQueue,c!==null&&(f.retryQueue=null,D1(i,c))));break;case 19:aa(s,i),ia(i),f&4&&(f=i.updateQueue,f!==null&&(i.updateQueue=null,D1(i,f)));break;case 30:break;case 21:break;default:aa(s,i),ia(i)}}function ia(i){var s=i.flags;if(s&2){try{for(var c,f=i.return;f!==null;){if(jv(f)){c=f;break}f=f.return}if(c==null)throw Error(n(160));switch(c.tag){case 27:var g=c.stateNode,x=b1(i);E0(i,x,g);break;case 5:var b=c.stateNode;c.flags&32&&(pa(b,""),c.flags&=-33);var P=b1(i);E0(i,P,b);break;case 3:case 4:var re=c.stateNode.containerInfo,me=b1(i);C1(i,me,re);break;default:throw Error(n(161))}}catch(Ae){hr(i,i.return,Ae)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function Kv(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var s=i;Kv(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),i=i.sibling}}function Ts(i,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)Wv(i,s.alternate,s),s=s.sibling}function Do(i){for(i=i.child;i!==null;){var s=i;switch(s.tag){case 0:case 11:case 14:case 15:ys(4,s,s.return),Do(s);break;case 1:ui(s,s.return);var c=s.stateNode;typeof c.componentWillUnmount=="function"&&Vv(s,s.return,c),Do(s);break;case 27:pu(s.stateNode);case 26:case 5:ui(s,s.return),Do(s);break;case 22:s.memoizedState===null&&Do(s);break;case 30:Do(s);break;default:Do(s)}i=i.sibling}}function Es(i,s,c){for(c=c&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var f=s.alternate,g=i,x=s,b=x.flags;switch(x.tag){case 0:case 11:case 15:Es(g,x,c),iu(4,x);break;case 1:if(Es(g,x,c),f=x,g=f.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(me){hr(f,f.return,me)}if(f=x,g=f.updateQueue,g!==null){var P=f.stateNode;try{var re=g.shared.hiddenCallbacks;if(re!==null)for(g.shared.hiddenCallbacks=null,g=0;g<re.length;g++)Sx(re[g],P)}catch(me){hr(f,f.return,me)}}c&&b&64&&Bv(x),su(x,x.return);break;case 27:zv(x);case 26:case 5:Es(g,x,c),c&&f===null&&b&4&&Uv(x),su(x,x.return);break;case 12:Es(g,x,c);break;case 13:Es(g,x,c),c&&b&4&&Xv(g,x);break;case 22:x.memoizedState===null&&Es(g,x,c),su(x,x.return);break;case 30:break;default:Es(g,x,c)}s=s.sibling}}function I1(i,s){var c=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(c=i.memoizedState.cachePool.pool),i=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(i=s.memoizedState.cachePool.pool),i!==c&&(i!=null&&i.refCount++,c!=null&&Gc(c))}function O1(i,s){i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Gc(i))}function fi(i,s,c,f){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)$v(i,s,c,f),s=s.sibling}function $v(i,s,c,f){var g=s.flags;switch(s.tag){case 0:case 11:case 15:fi(i,s,c,f),g&2048&&iu(9,s);break;case 1:fi(i,s,c,f);break;case 3:fi(i,s,c,f),g&2048&&(i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Gc(i)));break;case 12:if(g&2048){fi(i,s,c,f),i=s.stateNode;try{var x=s.memoizedProps,b=x.id,P=x.onPostCommit;typeof P=="function"&&P(b,s.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(re){hr(s,s.return,re)}}else fi(i,s,c,f);break;case 13:fi(i,s,c,f);break;case 23:break;case 22:x=s.stateNode,b=s.alternate,s.memoizedState!==null?x._visibility&2?fi(i,s,c,f):ou(i,s):x._visibility&2?fi(i,s,c,f):(x._visibility|=2,Fl(i,s,c,f,(s.subtreeFlags&10256)!==0)),g&2048&&I1(b,s);break;case 24:fi(i,s,c,f),g&2048&&O1(s.alternate,s);break;default:fi(i,s,c,f)}}function Fl(i,s,c,f,g){for(g=g&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var x=i,b=s,P=c,re=f,me=b.flags;switch(b.tag){case 0:case 11:case 15:Fl(x,b,P,re,g),iu(8,b);break;case 23:break;case 22:var Ae=b.stateNode;b.memoizedState!==null?Ae._visibility&2?Fl(x,b,P,re,g):ou(x,b):(Ae._visibility|=2,Fl(x,b,P,re,g)),g&&me&2048&&I1(b.alternate,b);break;case 24:Fl(x,b,P,re,g),g&&me&2048&&O1(b.alternate,b);break;default:Fl(x,b,P,re,g)}s=s.sibling}}function ou(i,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var c=i,f=s,g=f.flags;switch(f.tag){case 22:ou(c,f),g&2048&&I1(f.alternate,f);break;case 24:ou(c,f),g&2048&&O1(f.alternate,f);break;default:ou(c,f)}s=s.sibling}}var lu=8192;function Nl(i){if(i.subtreeFlags&lu)for(i=i.child;i!==null;)Qv(i),i=i.sibling}function Qv(i){switch(i.tag){case 26:Nl(i),i.flags&lu&&i.memoizedState!==null&&zA(ja,i.memoizedState,i.memoizedProps);break;case 5:Nl(i);break;case 3:case 4:var s=ja;ja=M0(i.stateNode.containerInfo),Nl(i),ja=s;break;case 22:i.memoizedState===null&&(s=i.alternate,s!==null&&s.memoizedState!==null?(s=lu,lu=16777216,Nl(i),lu=s):Nl(i));break;default:Nl(i)}}function Zv(i){var s=i.alternate;if(s!==null&&(i=s.child,i!==null)){s.child=null;do s=i.sibling,i.sibling=null,i=s;while(i!==null)}}function cu(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var f=s[c];an=f,e2(f,i)}Zv(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Jv(i),i=i.sibling}function Jv(i){switch(i.tag){case 0:case 11:case 15:cu(i),i.flags&2048&&ys(9,i,i.return);break;case 3:cu(i);break;case 12:cu(i);break;case 22:var s=i.stateNode;i.memoizedState!==null&&s._visibility&2&&(i.return===null||i.return.tag!==13)?(s._visibility&=-3,w0(i)):cu(i);break;default:cu(i)}}function w0(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var c=0;c<s.length;c++){var f=s[c];an=f,e2(f,i)}Zv(i)}for(i=i.child;i!==null;){switch(s=i,s.tag){case 0:case 11:case 15:ys(8,s,s.return),w0(s);break;case 22:c=s.stateNode,c._visibility&2&&(c._visibility&=-3,w0(s));break;default:w0(s)}i=i.sibling}}function e2(i,s){for(;an!==null;){var c=an;switch(c.tag){case 0:case 11:case 15:ys(8,c,s);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var f=c.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Gc(c.memoizedState.cache)}if(f=c.child,f!==null)f.return=c,an=f;else e:for(c=i;an!==null;){f=an;var g=f.sibling,x=f.return;if(Gv(f),f===c){an=null;break e}if(g!==null){g.return=x,an=g;break e}an=x}}}var aA={getCacheForType:function(i){var s=wn(Kr),c=s.data.get(i);return c===void 0&&(c=i(),s.data.set(i,c)),c}},iA=typeof WeakMap=="function"?WeakMap:Map,rr=0,mr=null,Ot=null,Ut=0,nr=0,sa=null,ws=!1,Ml=!1,F1=!1,qi=0,Cr=0,Ss=0,Io=0,N1=0,Sa=0,Pl=0,uu=null,Kn=null,M1=!1,P1=0,S0=1/0,A0=null,As=null,mn=0,ks=null,Ll=null,Bl=0,L1=0,B1=null,t2=null,fu=0,V1=null;function oa(){if((rr&2)!==0&&Ut!==0)return Ut&-Ut;if(ne.T!==null){var i=Al;return i!==0?i:q1()}return Za()}function r2(){Sa===0&&(Sa=(Ut&536870912)===0||Kt?ls():536870912);var i=wa.current;return i!==null&&(i.flags|=32),Sa}function la(i,s,c){(i===mr&&(nr===2||nr===9)||i.cancelPendingCommit!==null)&&(Vl(i,0),bs(i,Ut,Sa,!1)),Ba(i,c),((rr&2)===0||i!==mr)&&(i===mr&&((rr&2)===0&&(Io|=c),Cr===4&&bs(i,Ut,Sa,!1)),hi(i))}function n2(i,s,c){if((rr&6)!==0)throw Error(n(327));var f=!c&&(s&124)===0&&(s&i.expiredLanes)===0||bi(i,s),g=f?lA(i,s):z1(i,s,!0),x=f;do{if(g===0){Ml&&!f&&bs(i,s,0,!1);break}else{if(c=i.current.alternate,x&&!sA(c)){g=z1(i,s,!1),x=!1;continue}if(g===2){if(x=s,i.errorRecoveryDisabledLanes&x)var b=0;else b=i.pendingLanes&-536870913,b=b!==0?b:b&536870912?536870912:0;if(b!==0){s=b;e:{var P=i;g=uu;var re=P.current.memoizedState.isDehydrated;if(re&&(Vl(P,b).flags|=256),b=z1(P,b,!1),b!==2){if(F1&&!re){P.errorRecoveryDisabledLanes|=x,Io|=x,g=4;break e}x=Kn,Kn=g,x!==null&&(Kn===null?Kn=x:Kn.push.apply(Kn,x))}g=b}if(x=!1,g!==2)continue}}if(g===1){Vl(i,0),bs(i,s,0,!0);break}e:{switch(f=i,x=g,x){case 0:case 1:throw Error(n(345));case 4:if((s&4194048)!==s)break;case 6:bs(f,s,Sa,!ws);break e;case 2:Kn=null;break;case 3:case 5:break;default:throw Error(n(329))}if((s&62914560)===s&&(g=P1+300-be(),10<g)){if(bs(f,s,Sa,!ws),ss(f,0,!0)!==0)break e;f.timeoutHandle=O2(a2.bind(null,f,c,Kn,A0,M1,s,Sa,Io,Pl,ws,x,2,-0,0),g);break e}a2(f,c,Kn,A0,M1,s,Sa,Io,Pl,ws,x,0,-0,0)}}break}while(!0);hi(i)}function a2(i,s,c,f,g,x,b,P,re,me,Ae,Re,ve,_e){if(i.timeoutHandle=-1,Re=s.subtreeFlags,(Re&8192||(Re&16785408)===16785408)&&(vu={stylesheets:null,count:0,unsuspend:jA},Qv(s),Re=HA(),Re!==null)){i.cancelPendingCommit=Re(f2.bind(null,i,s,x,c,f,g,b,P,re,Ae,1,ve,_e)),bs(i,x,b,!me);return}f2(i,s,x,c,f,g,b,P,re)}function sA(i){for(var s=i;;){var c=s.tag;if((c===0||c===11||c===15)&&s.flags&16384&&(c=s.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var f=0;f<c.length;f++){var g=c[f],x=g.getSnapshot;g=g.value;try{if(!ra(x(),g))return!1}catch{return!1}}if(c=s.child,s.subtreeFlags&16384&&c!==null)c.return=s,s=c;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function bs(i,s,c,f){s&=~N1,s&=~Io,i.suspendedLanes|=s,i.pingedLanes&=~s,f&&(i.warmLanes|=s),f=i.expirationTimes;for(var g=s;0<g;){var x=31-Tt(g),b=1<<x;f[x]=-1,g&=~b}c!==0&&ma(i,c,s)}function k0(){return(rr&6)===0?(hu(0),!1):!0}function U1(){if(Ot!==null){if(nr===0)var i=Ot.return;else i=Ot,Bi=Ao=null,n1(i),Il=null,ru=0,i=Ot;for(;i!==null;)Lv(i.alternate,i),i=i.return;Ot=null}}function Vl(i,s){var c=i.timeoutHandle;c!==-1&&(i.timeoutHandle=-1,SA(c)),c=i.cancelPendingCommit,c!==null&&(i.cancelPendingCommit=null,c()),U1(),mr=i,Ot=c=Mi(i.current,null),Ut=s,nr=0,sa=null,ws=!1,Ml=bi(i,s),F1=!1,Pl=Sa=N1=Io=Ss=Cr=0,Kn=uu=null,M1=!1,(s&8)!==0&&(s|=s&32);var f=i.entangledLanes;if(f!==0)for(i=i.entanglements,f&=s;0<f;){var g=31-Tt(f),x=1<<g;s|=i[g],f&=~x}return qi=s,Yf(),c}function i2(i,s){Ct=null,ne.H=d0,s===Xc||s===n0?(s=Ex(),nr=3):s===_x?(s=Ex(),nr=4):nr=s===wv?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,sa=s,Ot===null&&(Cr=1,v0(i,_a(s,i.current)))}function s2(){var i=ne.H;return ne.H=d0,i===null?d0:i}function o2(){var i=ne.A;return ne.A=aA,i}function j1(){Cr=4,ws||(Ut&4194048)!==Ut&&wa.current!==null||(Ml=!0),(Ss&134217727)===0&&(Io&134217727)===0||mr===null||bs(mr,Ut,Sa,!1)}function z1(i,s,c){var f=rr;rr|=2;var g=s2(),x=o2();(mr!==i||Ut!==s)&&(A0=null,Vl(i,s)),s=!1;var b=Cr;e:do try{if(nr!==0&&Ot!==null){var P=Ot,re=sa;switch(nr){case 8:U1(),b=6;break e;case 3:case 2:case 9:case 6:wa.current===null&&(s=!0);var me=nr;if(nr=0,sa=null,Ul(i,P,re,me),c&&Ml){b=0;break e}break;default:me=nr,nr=0,sa=null,Ul(i,P,re,me)}}oA(),b=Cr;break}catch(Ae){i2(i,Ae)}while(!0);return s&&i.shellSuspendCounter++,Bi=Ao=null,rr=f,ne.H=g,ne.A=x,Ot===null&&(mr=null,Ut=0,Yf()),b}function oA(){for(;Ot!==null;)l2(Ot)}function lA(i,s){var c=rr;rr|=2;var f=s2(),g=o2();mr!==i||Ut!==s?(A0=null,S0=be()+500,Vl(i,s)):Ml=bi(i,s);e:do try{if(nr!==0&&Ot!==null){s=Ot;var x=sa;t:switch(nr){case 1:nr=0,sa=null,Ul(i,s,x,1);break;case 2:case 9:if(yx(x)){nr=0,sa=null,c2(s);break}s=function(){nr!==2&&nr!==9||mr!==i||(nr=7),hi(i)},x.then(s,s);break e;case 3:nr=7;break e;case 4:nr=5;break e;case 7:yx(x)?(nr=0,sa=null,c2(s)):(nr=0,sa=null,Ul(i,s,x,7));break;case 5:var b=null;switch(Ot.tag){case 26:b=Ot.memoizedState;case 5:case 27:var P=Ot;if(!b||W2(b)){nr=0,sa=null;var re=P.sibling;if(re!==null)Ot=re;else{var me=P.return;me!==null?(Ot=me,b0(me)):Ot=null}break t}}nr=0,sa=null,Ul(i,s,x,5);break;case 6:nr=0,sa=null,Ul(i,s,x,6);break;case 8:U1(),Cr=6;break e;default:throw Error(n(462))}}cA();break}catch(Ae){i2(i,Ae)}while(!0);return Bi=Ao=null,ne.H=f,ne.A=g,rr=c,Ot!==null?0:(mr=null,Ut=0,Yf(),Cr)}function cA(){for(;Ot!==null&&!at();)l2(Ot)}function l2(i){var s=Mv(i.alternate,i,qi);i.memoizedProps=i.pendingProps,s===null?b0(i):Ot=s}function c2(i){var s=i,c=s.alternate;switch(s.tag){case 15:case 0:s=Rv(c,s,s.pendingProps,s.type,void 0,Ut);break;case 11:s=Rv(c,s,s.pendingProps,s.type.render,s.ref,Ut);break;case 5:n1(s);default:Lv(c,s),s=Ot=ux(s,qi),s=Mv(c,s,qi)}i.memoizedProps=i.pendingProps,s===null?b0(i):Ot=s}function Ul(i,s,c,f){Bi=Ao=null,n1(s),Il=null,ru=0;var g=s.return;try{if(Z4(i,g,s,c,Ut)){Cr=1,v0(i,_a(c,i.current)),Ot=null;return}}catch(x){if(g!==null)throw Ot=g,x;Cr=1,v0(i,_a(c,i.current)),Ot=null;return}s.flags&32768?(Kt||f===1?i=!0:Ml||(Ut&536870912)!==0?i=!1:(ws=i=!0,(f===2||f===9||f===3||f===6)&&(f=wa.current,f!==null&&f.tag===13&&(f.flags|=16384))),u2(s,i)):b0(s)}function b0(i){var s=i;do{if((s.flags&32768)!==0){u2(s,ws);return}i=s.return;var c=eA(s.alternate,s,qi);if(c!==null){Ot=c;return}if(s=s.sibling,s!==null){Ot=s;return}Ot=s=i}while(s!==null);Cr===0&&(Cr=5)}function u2(i,s){do{var c=tA(i.alternate,i);if(c!==null){c.flags&=32767,Ot=c;return}if(c=i.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!s&&(i=i.sibling,i!==null)){Ot=i;return}Ot=i=c}while(i!==null);Cr=6,Ot=null}function f2(i,s,c,f,g,x,b,P,re){i.cancelPendingCommit=null;do C0();while(mn!==0);if((rr&6)!==0)throw Error(n(327));if(s!==null){if(s===i.current)throw Error(n(177));if(x=s.lanes|s.childLanes,x|=Od,$a(i,c,x,b,P,re),i===mr&&(Ot=mr=null,Ut=0),Ll=s,ks=i,Bl=c,L1=x,B1=g,t2=f,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,dA(We,function(){return g2(),null})):(i.callbackNode=null,i.callbackPriority=0),f=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||f){f=ne.T,ne.T=null,g=se.p,se.p=2,b=rr,rr|=4;try{rA(i,s,c)}finally{rr=b,se.p=g,ne.T=f}}mn=1,h2(),d2(),m2()}}function h2(){if(mn===1){mn=0;var i=ks,s=Ll,c=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||c){c=ne.T,ne.T=null;var f=se.p;se.p=2;var g=rr;rr|=4;try{Yv(s,i);var x=em,b=ex(i.containerInfo),P=x.focusedElem,re=x.selectionRange;if(b!==P&&P&&P.ownerDocument&&Jg(P.ownerDocument.documentElement,P)){if(re!==null&&bd(P)){var me=re.start,Ae=re.end;if(Ae===void 0&&(Ae=me),"selectionStart"in P)P.selectionStart=me,P.selectionEnd=Math.min(Ae,P.value.length);else{var Re=P.ownerDocument||document,ve=Re&&Re.defaultView||window;if(ve.getSelection){var _e=ve.getSelection(),_t=P.textContent.length,ht=Math.min(re.start,_t),ur=re.end===void 0?ht:Math.min(re.end,_t);!_e.extend&&ht>ur&&(b=ur,ur=ht,ht=b);var oe=Zg(P,ht),ie=Zg(P,ur);if(oe&&ie&&(_e.rangeCount!==1||_e.anchorNode!==oe.node||_e.anchorOffset!==oe.offset||_e.focusNode!==ie.node||_e.focusOffset!==ie.offset)){var he=Re.createRange();he.setStart(oe.node,oe.offset),_e.removeAllRanges(),ht>ur?(_e.addRange(he),_e.extend(ie.node,ie.offset)):(he.setEnd(ie.node,ie.offset),_e.addRange(he))}}}}for(Re=[],_e=P;_e=_e.parentNode;)_e.nodeType===1&&Re.push({element:_e,left:_e.scrollLeft,top:_e.scrollTop});for(typeof P.focus=="function"&&P.focus(),P=0;P<Re.length;P++){var Ce=Re[P];Ce.element.scrollLeft=Ce.left,Ce.element.scrollTop=Ce.top}}U0=!!J1,em=J1=null}finally{rr=g,se.p=f,ne.T=c}}i.current=s,mn=2}}function d2(){if(mn===2){mn=0;var i=ks,s=Ll,c=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||c){c=ne.T,ne.T=null;var f=se.p;se.p=2;var g=rr;rr|=4;try{Wv(i,s.alternate,s)}finally{rr=g,se.p=f,ne.T=c}}mn=3}}function m2(){if(mn===4||mn===3){mn=0,Ze();var i=ks,s=Ll,c=Bl,f=t2;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?mn=5:(mn=0,Ll=ks=null,p2(i,i.pendingLanes));var g=i.pendingLanes;if(g===0&&(As=null),us(c),s=s.stateNode,lt&&typeof lt.onCommitFiberRoot=="function")try{lt.onCommitFiberRoot(rt,s,void 0,(s.current.flags&128)===128)}catch{}if(f!==null){s=ne.T,g=se.p,se.p=2,ne.T=null;try{for(var x=i.onRecoverableError,b=0;b<f.length;b++){var P=f[b];x(P.value,{componentStack:P.stack})}}finally{ne.T=s,se.p=g}}(Bl&3)!==0&&C0(),hi(i),g=i.pendingLanes,(c&4194090)!==0&&(g&42)!==0?i===V1?fu++:(fu=0,V1=i):fu=0,hu(0)}}function p2(i,s){(i.pooledCacheLanes&=s)===0&&(s=i.pooledCache,s!=null&&(i.pooledCache=null,Gc(s)))}function C0(i){return h2(),d2(),m2(),g2()}function g2(){if(mn!==5)return!1;var i=ks,s=L1;L1=0;var c=us(Bl),f=ne.T,g=se.p;try{se.p=32>c?32:c,ne.T=null,c=B1,B1=null;var x=ks,b=Bl;if(mn=0,Ll=ks=null,Bl=0,(rr&6)!==0)throw Error(n(331));var P=rr;if(rr|=4,Jv(x.current),$v(x,x.current,b,c),rr=P,hu(0,!1),lt&&typeof lt.onPostCommitFiberRoot=="function")try{lt.onPostCommitFiberRoot(rt,x)}catch{}return!0}finally{se.p=g,ne.T=f,p2(i,s)}}function x2(i,s,c){s=_a(c,s),s=x1(i.stateNode,s,2),i=gs(i,s,2),i!==null&&(Ba(i,2),hi(i))}function hr(i,s,c){if(i.tag===3)x2(i,i,c);else for(;s!==null;){if(s.tag===3){x2(s,i,c);break}else if(s.tag===1){var f=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(As===null||!As.has(f))){i=_a(c,i),c=Tv(2),f=gs(s,c,2),f!==null&&(Ev(c,f,s,i),Ba(f,2),hi(f));break}}s=s.return}}function H1(i,s,c){var f=i.pingCache;if(f===null){f=i.pingCache=new iA;var g=new Set;f.set(s,g)}else g=f.get(s),g===void 0&&(g=new Set,f.set(s,g));g.has(c)||(F1=!0,g.add(c),i=uA.bind(null,i,s,c),s.then(i,i))}function uA(i,s,c){var f=i.pingCache;f!==null&&f.delete(s),i.pingedLanes|=i.suspendedLanes&c,i.warmLanes&=~c,mr===i&&(Ut&c)===c&&(Cr===4||Cr===3&&(Ut&62914560)===Ut&&300>be()-P1?(rr&2)===0&&Vl(i,0):N1|=c,Pl===Ut&&(Pl=0)),hi(i)}function v2(i,s){s===0&&(s=cs()),i=Tl(i,s),i!==null&&(Ba(i,s),hi(i))}function fA(i){var s=i.memoizedState,c=0;s!==null&&(c=s.retryLane),v2(i,c)}function hA(i,s){var c=0;switch(i.tag){case 13:var f=i.stateNode,g=i.memoizedState;g!==null&&(c=g.retryLane);break;case 19:f=i.stateNode;break;case 22:f=i.stateNode._retryCache;break;default:throw Error(n(314))}f!==null&&f.delete(s),v2(i,c)}function dA(i,s){return et(i,s)}var R0=null,jl=null,W1=!1,D0=!1,G1=!1,Oo=0;function hi(i){i!==jl&&i.next===null&&(jl===null?R0=jl=i:jl=jl.next=i),D0=!0,W1||(W1=!0,pA())}function hu(i,s){if(!G1&&D0){G1=!0;do for(var c=!1,f=R0;f!==null;){if(i!==0){var g=f.pendingLanes;if(g===0)var x=0;else{var b=f.suspendedLanes,P=f.pingedLanes;x=(1<<31-Tt(42|i)+1)-1,x&=g&~(b&~P),x=x&201326741?x&201326741|1:x?x|2:0}x!==0&&(c=!0,E2(f,x))}else x=Ut,x=ss(f,f===mr?x:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(x&3)===0||bi(f,x)||(c=!0,E2(f,x));f=f.next}while(c);G1=!1}}function mA(){_2()}function _2(){D0=W1=!1;var i=0;Oo!==0&&(wA()&&(i=Oo),Oo=0);for(var s=be(),c=null,f=R0;f!==null;){var g=f.next,x=y2(f,s);x===0?(f.next=null,c===null?R0=g:c.next=g,g===null&&(jl=c)):(c=f,(i!==0||(x&3)!==0)&&(D0=!0)),f=g}hu(i)}function y2(i,s){for(var c=i.suspendedLanes,f=i.pingedLanes,g=i.expirationTimes,x=i.pendingLanes&-62914561;0<x;){var b=31-Tt(x),P=1<<b,re=g[b];re===-1?((P&c)===0||(P&f)!==0)&&(g[b]=os(P,s)):re<=s&&(i.expiredLanes|=P),x&=~P}if(s=mr,c=Ut,c=ss(i,i===s?c:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),f=i.callbackNode,c===0||i===s&&(nr===2||nr===9)||i.cancelPendingCommit!==null)return f!==null&&f!==null&&Ve(f),i.callbackNode=null,i.callbackPriority=0;if((c&3)===0||bi(i,c)){if(s=c&-c,s===i.callbackPriority)return s;switch(f!==null&&Ve(f),us(c)){case 2:case 8:c=Ke;break;case 32:c=We;break;case 268435456:c=Ye;break;default:c=We}return f=T2.bind(null,i),c=et(c,f),i.callbackPriority=s,i.callbackNode=c,s}return f!==null&&f!==null&&Ve(f),i.callbackPriority=2,i.callbackNode=null,2}function T2(i,s){if(mn!==0&&mn!==5)return i.callbackNode=null,i.callbackPriority=0,null;var c=i.callbackNode;if(C0()&&i.callbackNode!==c)return null;var f=Ut;return f=ss(i,i===mr?f:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),f===0?null:(n2(i,f,s),y2(i,be()),i.callbackNode!=null&&i.callbackNode===c?T2.bind(null,i):null)}function E2(i,s){if(C0())return null;n2(i,s,!0)}function pA(){AA(function(){(rr&6)!==0?et(ze,mA):_2()})}function q1(){return Oo===0&&(Oo=ls()),Oo}function w2(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:cl(""+i)}function S2(i,s){var c=s.ownerDocument.createElement("input");return c.name=s.name,c.value=s.value,i.id&&c.setAttribute("form",i.id),s.parentNode.insertBefore(c,s),i=new FormData(i),c.parentNode.removeChild(c),i}function gA(i,s,c,f,g){if(s==="submit"&&c&&c.stateNode===g){var x=w2((g[yr]||null).action),b=f.submitter;b&&(s=(s=b[yr]||null)?w2(s.formAction):b.getAttribute("formAction"),s!==null&&(x=s,b=null));var P=new ul("action","action",null,f,g);i.push({event:P,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Oo!==0){var re=b?S2(g,b):new FormData(g);h1(c,{pending:!0,data:re,method:g.method,action:x},null,re)}}else typeof x=="function"&&(P.preventDefault(),re=b?S2(g,b):new FormData(g),h1(c,{pending:!0,data:re,method:g.method,action:x},x,re))},currentTarget:g}]})}}for(var X1=0;X1<Id.length;X1++){var Y1=Id[X1],xA=Y1.toLowerCase(),vA=Y1[0].toUpperCase()+Y1.slice(1);Ua(xA,"on"+vA)}Ua(nx,"onAnimationEnd"),Ua(ax,"onAnimationIteration"),Ua(ix,"onAnimationStart"),Ua("dblclick","onDoubleClick"),Ua("focusin","onFocus"),Ua("focusout","onBlur"),Ua(M4,"onTransitionRun"),Ua(P4,"onTransitionStart"),Ua(L4,"onTransitionCancel"),Ua(sx,"onTransitionEnd"),He("onMouseEnter",["mouseout","mouseover"]),He("onMouseLeave",["mouseout","mouseover"]),He("onPointerEnter",["pointerout","pointerover"]),He("onPointerLeave",["pointerout","pointerover"]),Me("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Me("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Me("onBeforeInput",["compositionend","keypress","textInput","paste"]),Me("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Me("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Me("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var du="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_A=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(du));function A2(i,s){s=(s&4)!==0;for(var c=0;c<i.length;c++){var f=i[c],g=f.event;f=f.listeners;e:{var x=void 0;if(s)for(var b=f.length-1;0<=b;b--){var P=f[b],re=P.instance,me=P.currentTarget;if(P=P.listener,re!==x&&g.isPropagationStopped())break e;x=P,g.currentTarget=me;try{x(g)}catch(Ae){x0(Ae)}g.currentTarget=null,x=re}else for(b=0;b<f.length;b++){if(P=f[b],re=P.instance,me=P.currentTarget,P=P.listener,re!==x&&g.isPropagationStopped())break e;x=P,g.currentTarget=me;try{x(g)}catch(Ae){x0(Ae)}g.currentTarget=null,x=re}}}}function Ft(i,s){var c=s[io];c===void 0&&(c=s[io]=new Set);var f=i+"__bubble";c.has(f)||(k2(s,i,2,!1),c.add(f))}function K1(i,s,c){var f=0;s&&(f|=4),k2(c,i,f,s)}var I0="_reactListening"+Math.random().toString(36).slice(2);function $1(i){if(!i[I0]){i[I0]=!0,ge.forEach(function(c){c!=="selectionchange"&&(_A.has(c)||K1(c,!1,i),K1(c,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[I0]||(s[I0]=!0,K1("selectionchange",!1,s))}}function k2(i,s,c,f){switch($2(s)){case 2:var g=qA;break;case 8:g=XA;break;default:g=um}c=g.bind(null,s,c,i),g=void 0,!xa||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(g=!0),f?g!==void 0?i.addEventListener(s,c,{capture:!0,passive:g}):i.addEventListener(s,c,!0):g!==void 0?i.addEventListener(s,c,{passive:g}):i.addEventListener(s,c,!1)}function Q1(i,s,c,f,g){var x=f;if((s&1)===0&&(s&2)===0&&f!==null)e:for(;;){if(f===null)return;var b=f.tag;if(b===3||b===4){var P=f.stateNode.containerInfo;if(P===g)break;if(b===4)for(b=f.return;b!==null;){var re=b.tag;if((re===3||re===4)&&b.stateNode.containerInfo===g)return;b=b.return}for(;P!==null;){if(b=q(P),b===null)return;if(re=b.tag,re===5||re===6||re===26||re===27){f=x=b;continue e}P=P.parentNode}}f=f.return}Ff(function(){var me=x,Ae=ga(c),Re=[];e:{var ve=ox.get(i);if(ve!==void 0){var _e=ul,_t=i;switch(i){case"keypress":if(ni(c)===0)break e;case"keydown":case"keyup":_e=gl;break;case"focusin":_t="focus",_e=dl;break;case"focusout":_t="blur",_e=dl;break;case"beforeblur":case"afterblur":_e=dl;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_e=va;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_e=wd;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_e=jf;break;case nx:case ax:case ix:_e=ml;break;case sx:_e=Hf;break;case"scroll":case"scrollend":_e=Nf;break;case"wheel":_e=xl;break;case"copy":case"cut":case"paste":_e=pl;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_e=Lc;break;case"toggle":case"beforetoggle":_e=Gf}var ht=(s&4)!==0,ur=!ht&&(i==="scroll"||i==="scrollend"),oe=ht?ve!==null?ve+"Capture":null:ve;ht=[];for(var ie=me,he;ie!==null;){var Ce=ie;if(he=Ce.stateNode,Ce=Ce.tag,Ce!==5&&Ce!==26&&Ce!==27||he===null||oe===null||(Ce=uo(ie,oe),Ce!=null&&ht.push(mu(ie,Ce,he))),ur)break;ie=ie.return}0<ht.length&&(ve=new _e(ve,_t,null,c,Ae),Re.push({event:ve,listeners:ht}))}}if((s&7)===0){e:{if(ve=i==="mouseover"||i==="pointerover",_e=i==="mouseout"||i==="pointerout",ve&&c!==Ri&&(_t=c.relatedTarget||c.fromElement)&&(q(_t)||_t[Gn]))break e;if((_e||ve)&&(ve=Ae.window===Ae?Ae:(ve=Ae.ownerDocument)?ve.defaultView||ve.parentWindow:window,_e?(_t=c.relatedTarget||c.toElement,_e=me,_t=_t?q(_t):null,_t!==null&&(ur=o(_t),ht=_t.tag,_t!==ur||ht!==5&&ht!==27&&ht!==6)&&(_t=null)):(_e=null,_t=me),_e!==_t)){if(ht=va,Ce="onMouseLeave",oe="onMouseEnter",ie="mouse",(i==="pointerout"||i==="pointerover")&&(ht=Lc,Ce="onPointerLeave",oe="onPointerEnter",ie="pointer"),ur=_e==null?ve:de(_e),he=_t==null?ve:de(_t),ve=new ht(Ce,ie+"leave",_e,c,Ae),ve.target=ur,ve.relatedTarget=he,Ce=null,q(Ae)===me&&(ht=new ht(oe,ie+"enter",_t,c,Ae),ht.target=he,ht.relatedTarget=ur,Ce=ht),ur=Ce,_e&&_t)t:{for(ht=_e,oe=_t,ie=0,he=ht;he;he=zl(he))ie++;for(he=0,Ce=oe;Ce;Ce=zl(Ce))he++;for(;0<ie-he;)ht=zl(ht),ie--;for(;0<he-ie;)oe=zl(oe),he--;for(;ie--;){if(ht===oe||oe!==null&&ht===oe.alternate)break t;ht=zl(ht),oe=zl(oe)}ht=null}else ht=null;_e!==null&&b2(Re,ve,_e,ht,!1),_t!==null&&ur!==null&&b2(Re,ur,_t,ht,!0)}}e:{if(ve=me?de(me):window,_e=ve.nodeName&&ve.nodeName.toLowerCase(),_e==="select"||_e==="input"&&ve.type==="file")var nt=qg;else if(Yr(ve))if(Xg)nt=O4;else{nt=D4;var Dt=R4}else _e=ve.nodeName,!_e||_e.toLowerCase()!=="input"||ve.type!=="checkbox"&&ve.type!=="radio"?me&&Dc(me.elementType)&&(nt=qg):nt=I4;if(nt&&(nt=nt(i,me))){Ni(Re,nt,c,Ae);break e}Dt&&Dt(i,ve,me),i==="focusout"&&me&&ve.type==="number"&&me.memoizedProps.value!=null&&fs(ve,"number",ve.value)}switch(Dt=me?de(me):window,i){case"focusin":(Yr(Dt)||Dt.contentEditable==="true")&&(vl=Dt,Cd=me,Uc=null);break;case"focusout":Uc=Cd=vl=null;break;case"mousedown":Rd=!0;break;case"contextmenu":case"mouseup":case"dragend":Rd=!1,tx(Re,c,Ae);break;case"selectionchange":if(N4)break;case"keydown":case"keyup":tx(Re,c,Ae)}var it;if(si)e:{switch(i){case"compositionstart":var mt="onCompositionStart";break e;case"compositionend":mt="onCompositionEnd";break e;case"compositionupdate":mt="onCompositionUpdate";break e}mt=void 0}else Bt?Te(i,c)&&(mt="onCompositionEnd"):i==="keydown"&&c.keyCode===229&&(mt="onCompositionStart");mt&&(A&&c.locale!=="ko"&&(Bt||mt!=="onCompositionStart"?mt==="onCompositionEnd"&&Bt&&(it=Oc()):(ri=Ae,hs="value"in ri?ri.value:ri.textContent,Bt=!0)),Dt=O0(me,mt),0<Dt.length&&(mt=new Mc(mt,i,null,c,Ae),Re.push({event:mt,listeners:Dt}),it?mt.data=it:(it=qe(c),it!==null&&(mt.data=it)))),(it=T?Xr(i,c):Vt(i,c))&&(mt=O0(me,"onBeforeInput"),0<mt.length&&(Dt=new Mc("onBeforeInput","beforeinput",null,c,Ae),Re.push({event:Dt,listeners:mt}),Dt.data=it)),gA(Re,i,me,c,Ae)}A2(Re,s)})}function mu(i,s,c){return{instance:i,listener:s,currentTarget:c}}function O0(i,s){for(var c=s+"Capture",f=[];i!==null;){var g=i,x=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||x===null||(g=uo(i,c),g!=null&&f.unshift(mu(i,g,x)),g=uo(i,s),g!=null&&f.push(mu(i,g,x))),i.tag===3)return f;i=i.return}return[]}function zl(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function b2(i,s,c,f,g){for(var x=s._reactName,b=[];c!==null&&c!==f;){var P=c,re=P.alternate,me=P.stateNode;if(P=P.tag,re!==null&&re===f)break;P!==5&&P!==26&&P!==27||me===null||(re=me,g?(me=uo(c,x),me!=null&&b.unshift(mu(c,me,re))):g||(me=uo(c,x),me!=null&&b.push(mu(c,me,re)))),c=c.return}b.length!==0&&i.push({event:s,listeners:b})}var yA=/\r\n?/g,TA=/\u0000|\uFFFD/g;function C2(i){return(typeof i=="string"?i:""+i).replace(yA,`
`).replace(TA,"")}function R2(i,s){return s=C2(s),C2(i)===s}function F0(){}function cr(i,s,c,f,g,x){switch(c){case"children":typeof f=="string"?s==="body"||s==="textarea"&&f===""||pa(i,f):(typeof f=="number"||typeof f=="bigint")&&s!=="body"&&pa(i,""+f);break;case"className":Pt(i,"class",f);break;case"tabIndex":Pt(i,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":Pt(i,c,f);break;case"style":Rc(i,f,x);break;case"data":if(s!=="object"){Pt(i,"data",f);break}case"src":case"href":if(f===""&&(s!=="a"||c!=="href")){i.removeAttribute(c);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){i.removeAttribute(c);break}f=cl(""+f),i.setAttribute(c,f);break;case"action":case"formAction":if(typeof f=="function"){i.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof x=="function"&&(c==="formAction"?(s!=="input"&&cr(i,s,"name",g.name,g,null),cr(i,s,"formEncType",g.formEncType,g,null),cr(i,s,"formMethod",g.formMethod,g,null),cr(i,s,"formTarget",g.formTarget,g,null)):(cr(i,s,"encType",g.encType,g,null),cr(i,s,"method",g.method,g,null),cr(i,s,"target",g.target,g,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){i.removeAttribute(c);break}f=cl(""+f),i.setAttribute(c,f);break;case"onClick":f!=null&&(i.onclick=F0);break;case"onScroll":f!=null&&Ft("scroll",i);break;case"onScrollEnd":f!=null&&Ft("scrollend",i);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(c=f.__html,c!=null){if(g.children!=null)throw Error(n(60));i.innerHTML=c}}break;case"multiple":i.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":i.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){i.removeAttribute("xlink:href");break}c=cl(""+f),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(c,""+f):i.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(c,""):i.removeAttribute(c);break;case"capture":case"download":f===!0?i.setAttribute(c,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?i.setAttribute(c,f):i.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?i.setAttribute(c,f):i.removeAttribute(c);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?i.removeAttribute(c):i.setAttribute(c,f);break;case"popover":Ft("beforetoggle",i),Ft("toggle",i),qt(i,"popover",f);break;case"xlinkActuate":Lt(i,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":Lt(i,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":Lt(i,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":Lt(i,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":Lt(i,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":Lt(i,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":Lt(i,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":Lt(i,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":Lt(i,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":qt(i,"is",f);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=Td.get(c)||c,qt(i,c,f))}}function Z1(i,s,c,f,g,x){switch(c){case"style":Rc(i,f,x);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(n(61));if(c=f.__html,c!=null){if(g.children!=null)throw Error(n(60));i.innerHTML=c}}break;case"children":typeof f=="string"?pa(i,f):(typeof f=="number"||typeof f=="bigint")&&pa(i,""+f);break;case"onScroll":f!=null&&Ft("scroll",i);break;case"onScrollEnd":f!=null&&Ft("scrollend",i);break;case"onClick":f!=null&&(i.onclick=F0);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!xe.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(g=c.endsWith("Capture"),s=c.slice(2,g?c.length-7:void 0),x=i[yr]||null,x=x!=null?x[c]:null,typeof x=="function"&&i.removeEventListener(s,x,g),typeof f=="function")){typeof x!="function"&&x!==null&&(c in i?i[c]=null:i.hasAttribute(c)&&i.removeAttribute(c)),i.addEventListener(s,f,g);break e}c in i?i[c]=f:f===!0?i.setAttribute(c,""):qt(i,c,f)}}}function pn(i,s,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ft("error",i),Ft("load",i);var f=!1,g=!1,x;for(x in c)if(c.hasOwnProperty(x)){var b=c[x];if(b!=null)switch(x){case"src":f=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:cr(i,s,x,b,c,null)}}g&&cr(i,s,"srcSet",c.srcSet,c,null),f&&cr(i,s,"src",c.src,c,null);return;case"input":Ft("invalid",i);var P=x=b=g=null,re=null,me=null;for(f in c)if(c.hasOwnProperty(f)){var Ae=c[f];if(Ae!=null)switch(f){case"name":g=Ae;break;case"type":b=Ae;break;case"checked":re=Ae;break;case"defaultChecked":me=Ae;break;case"value":x=Ae;break;case"defaultValue":P=Ae;break;case"children":case"dangerouslySetInnerHTML":if(Ae!=null)throw Error(n(137,s));break;default:cr(i,s,f,Ae,c,null)}}oo(i,x,P,re,me,b,g,!1),ll(i);return;case"select":Ft("invalid",i),f=b=x=null;for(g in c)if(c.hasOwnProperty(g)&&(P=c[g],P!=null))switch(g){case"value":x=P;break;case"defaultValue":b=P;break;case"multiple":f=P;default:cr(i,s,g,P,c,null)}s=x,c=b,i.multiple=!!f,s!=null?Ci(i,!!f,s,!1):c!=null&&Ci(i,!!f,c,!0);return;case"textarea":Ft("invalid",i),x=g=f=null;for(b in c)if(c.hasOwnProperty(b)&&(P=c[b],P!=null))switch(b){case"value":f=P;break;case"defaultValue":g=P;break;case"children":x=P;break;case"dangerouslySetInnerHTML":if(P!=null)throw Error(n(91));break;default:cr(i,s,b,P,c,null)}lo(i,f,g,x),ll(i);return;case"option":for(re in c)if(c.hasOwnProperty(re)&&(f=c[re],f!=null))switch(re){case"selected":i.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:cr(i,s,re,f,c,null)}return;case"dialog":Ft("beforetoggle",i),Ft("toggle",i),Ft("cancel",i),Ft("close",i);break;case"iframe":case"object":Ft("load",i);break;case"video":case"audio":for(f=0;f<du.length;f++)Ft(du[f],i);break;case"image":Ft("error",i),Ft("load",i);break;case"details":Ft("toggle",i);break;case"embed":case"source":case"link":Ft("error",i),Ft("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(me in c)if(c.hasOwnProperty(me)&&(f=c[me],f!=null))switch(me){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,s));default:cr(i,s,me,f,c,null)}return;default:if(Dc(s)){for(Ae in c)c.hasOwnProperty(Ae)&&(f=c[Ae],f!==void 0&&Z1(i,s,Ae,f,c,void 0));return}}for(P in c)c.hasOwnProperty(P)&&(f=c[P],f!=null&&cr(i,s,P,f,c,null))}function EA(i,s,c,f){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,x=null,b=null,P=null,re=null,me=null,Ae=null;for(_e in c){var Re=c[_e];if(c.hasOwnProperty(_e)&&Re!=null)switch(_e){case"checked":break;case"value":break;case"defaultValue":re=Re;default:f.hasOwnProperty(_e)||cr(i,s,_e,null,f,Re)}}for(var ve in f){var _e=f[ve];if(Re=c[ve],f.hasOwnProperty(ve)&&(_e!=null||Re!=null))switch(ve){case"type":x=_e;break;case"name":g=_e;break;case"checked":me=_e;break;case"defaultChecked":Ae=_e;break;case"value":b=_e;break;case"defaultValue":P=_e;break;case"children":case"dangerouslySetInnerHTML":if(_e!=null)throw Error(n(137,s));break;default:_e!==Re&&cr(i,s,ve,_e,f,Re)}}ta(i,b,P,re,me,Ae,x,g);return;case"select":_e=b=P=ve=null;for(x in c)if(re=c[x],c.hasOwnProperty(x)&&re!=null)switch(x){case"value":break;case"multiple":_e=re;default:f.hasOwnProperty(x)||cr(i,s,x,null,f,re)}for(g in f)if(x=f[g],re=c[g],f.hasOwnProperty(g)&&(x!=null||re!=null))switch(g){case"value":ve=x;break;case"defaultValue":P=x;break;case"multiple":b=x;default:x!==re&&cr(i,s,g,x,f,re)}s=P,c=b,f=_e,ve!=null?Ci(i,!!c,ve,!1):!!f!=!!c&&(s!=null?Ci(i,!!c,s,!0):Ci(i,!!c,c?[]:"",!1));return;case"textarea":_e=ve=null;for(P in c)if(g=c[P],c.hasOwnProperty(P)&&g!=null&&!f.hasOwnProperty(P))switch(P){case"value":break;case"children":break;default:cr(i,s,P,null,f,g)}for(b in f)if(g=f[b],x=c[b],f.hasOwnProperty(b)&&(g!=null||x!=null))switch(b){case"value":ve=g;break;case"defaultValue":_e=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(n(91));break;default:g!==x&&cr(i,s,b,g,f,x)}or(i,ve,_e);return;case"option":for(var _t in c)if(ve=c[_t],c.hasOwnProperty(_t)&&ve!=null&&!f.hasOwnProperty(_t))switch(_t){case"selected":i.selected=!1;break;default:cr(i,s,_t,null,f,ve)}for(re in f)if(ve=f[re],_e=c[re],f.hasOwnProperty(re)&&ve!==_e&&(ve!=null||_e!=null))switch(re){case"selected":i.selected=ve&&typeof ve!="function"&&typeof ve!="symbol";break;default:cr(i,s,re,ve,f,_e)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ht in c)ve=c[ht],c.hasOwnProperty(ht)&&ve!=null&&!f.hasOwnProperty(ht)&&cr(i,s,ht,null,f,ve);for(me in f)if(ve=f[me],_e=c[me],f.hasOwnProperty(me)&&ve!==_e&&(ve!=null||_e!=null))switch(me){case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(n(137,s));break;default:cr(i,s,me,ve,f,_e)}return;default:if(Dc(s)){for(var ur in c)ve=c[ur],c.hasOwnProperty(ur)&&ve!==void 0&&!f.hasOwnProperty(ur)&&Z1(i,s,ur,void 0,f,ve);for(Ae in f)ve=f[Ae],_e=c[Ae],!f.hasOwnProperty(Ae)||ve===_e||ve===void 0&&_e===void 0||Z1(i,s,Ae,ve,f,_e);return}}for(var oe in c)ve=c[oe],c.hasOwnProperty(oe)&&ve!=null&&!f.hasOwnProperty(oe)&&cr(i,s,oe,null,f,ve);for(Re in f)ve=f[Re],_e=c[Re],!f.hasOwnProperty(Re)||ve===_e||ve==null&&_e==null||cr(i,s,Re,ve,f,_e)}var J1=null,em=null;function N0(i){return i.nodeType===9?i:i.ownerDocument}function D2(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function I2(i,s){if(i===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&s==="foreignObject"?0:i}function tm(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var rm=null;function wA(){var i=window.event;return i&&i.type==="popstate"?i===rm?!1:(rm=i,!0):(rm=null,!1)}var O2=typeof setTimeout=="function"?setTimeout:void 0,SA=typeof clearTimeout=="function"?clearTimeout:void 0,F2=typeof Promise=="function"?Promise:void 0,AA=typeof queueMicrotask=="function"?queueMicrotask:typeof F2<"u"?function(i){return F2.resolve(null).then(i).catch(kA)}:O2;function kA(i){setTimeout(function(){throw i})}function Cs(i){return i==="head"}function N2(i,s){var c=s,f=0,g=0;do{var x=c.nextSibling;if(i.removeChild(c),x&&x.nodeType===8)if(c=x.data,c==="/$"){if(0<f&&8>f){c=f;var b=i.ownerDocument;if(c&1&&pu(b.documentElement),c&2&&pu(b.body),c&4)for(c=b.head,pu(c),b=c.firstChild;b;){var P=b.nextSibling,re=b.nodeName;b[j]||re==="SCRIPT"||re==="STYLE"||re==="LINK"&&b.rel.toLowerCase()==="stylesheet"||c.removeChild(b),b=P}}if(g===0){i.removeChild(x),wu(s);return}g--}else c==="$"||c==="$?"||c==="$!"?g++:f=c.charCodeAt(0)-48;else f=0;c=x}while(c);wu(s)}function nm(i){var s=i.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var c=s;switch(s=s.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":nm(c),H(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}i.removeChild(c)}}function bA(i,s,c,f){for(;i.nodeType===1;){var g=c;if(i.nodeName.toLowerCase()!==s.toLowerCase()){if(!f&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(f){if(!i[j])switch(s){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(x=i.getAttribute("rel"),x==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(x!==g.rel||i.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||i.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||i.getAttribute("title")!==(g.title==null?null:g.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(x=i.getAttribute("src"),(x!==(g.src==null?null:g.src)||i.getAttribute("type")!==(g.type==null?null:g.type)||i.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&x&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(s==="input"&&i.type==="hidden"){var x=g.name==null?null:""+g.name;if(g.type==="hidden"&&i.getAttribute("name")===x)return i}else return i;if(i=za(i.nextSibling),i===null)break}return null}function CA(i,s,c){if(s==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!c||(i=za(i.nextSibling),i===null))return null;return i}function am(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState==="complete"}function RA(i,s){var c=i.ownerDocument;if(i.data!=="$?"||c.readyState==="complete")s();else{var f=function(){s(),c.removeEventListener("DOMContentLoaded",f)};c.addEventListener("DOMContentLoaded",f),i._reactRetry=f}}function za(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return i}var im=null;function M2(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var c=i.data;if(c==="$"||c==="$!"||c==="$?"){if(s===0)return i;s--}else c==="/$"&&s++}i=i.previousSibling}return null}function P2(i,s,c){switch(s=N0(c),i){case"html":if(i=s.documentElement,!i)throw Error(n(452));return i;case"head":if(i=s.head,!i)throw Error(n(453));return i;case"body":if(i=s.body,!i)throw Error(n(454));return i;default:throw Error(n(451))}}function pu(i){for(var s=i.attributes;s.length;)i.removeAttributeNode(s[0]);H(i)}var Aa=new Map,L2=new Set;function M0(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Xi=se.d;se.d={f:DA,r:IA,D:OA,C:FA,L:NA,m:MA,X:LA,S:PA,M:BA};function DA(){var i=Xi.f(),s=k0();return i||s}function IA(i){var s=K(i);s!==null&&s.tag===5&&s.type==="form"?nv(s):Xi.r(i)}var Hl=typeof document>"u"?null:document;function B2(i,s,c){var f=Hl;if(f&&typeof s=="string"&&s){var g=Vr(s);g='link[rel="'+i+'"][href="'+g+'"]',typeof c=="string"&&(g+='[crossorigin="'+c+'"]'),L2.has(g)||(L2.add(g),i={rel:i,crossOrigin:c,href:s},f.querySelector(g)===null&&(s=f.createElement("link"),pn(s,"link",i),ce(s),f.head.appendChild(s)))}}function OA(i){Xi.D(i),B2("dns-prefetch",i,null)}function FA(i,s){Xi.C(i,s),B2("preconnect",i,s)}function NA(i,s,c){Xi.L(i,s,c);var f=Hl;if(f&&i&&s){var g='link[rel="preload"][as="'+Vr(s)+'"]';s==="image"&&c&&c.imageSrcSet?(g+='[imagesrcset="'+Vr(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(g+='[imagesizes="'+Vr(c.imageSizes)+'"]')):g+='[href="'+Vr(i)+'"]';var x=g;switch(s){case"style":x=Wl(i);break;case"script":x=Gl(i)}Aa.has(x)||(i=p({rel:"preload",href:s==="image"&&c&&c.imageSrcSet?void 0:i,as:s},c),Aa.set(x,i),f.querySelector(g)!==null||s==="style"&&f.querySelector(gu(x))||s==="script"&&f.querySelector(xu(x))||(s=f.createElement("link"),pn(s,"link",i),ce(s),f.head.appendChild(s)))}}function MA(i,s){Xi.m(i,s);var c=Hl;if(c&&i){var f=s&&typeof s.as=="string"?s.as:"script",g='link[rel="modulepreload"][as="'+Vr(f)+'"][href="'+Vr(i)+'"]',x=g;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":x=Gl(i)}if(!Aa.has(x)&&(i=p({rel:"modulepreload",href:i},s),Aa.set(x,i),c.querySelector(g)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(xu(x)))return}f=c.createElement("link"),pn(f,"link",i),ce(f),c.head.appendChild(f)}}}function PA(i,s,c){Xi.S(i,s,c);var f=Hl;if(f&&i){var g=ye(f).hoistableStyles,x=Wl(i);s=s||"default";var b=g.get(x);if(!b){var P={loading:0,preload:null};if(b=f.querySelector(gu(x)))P.loading=5;else{i=p({rel:"stylesheet",href:i,"data-precedence":s},c),(c=Aa.get(x))&&sm(i,c);var re=b=f.createElement("link");ce(re),pn(re,"link",i),re._p=new Promise(function(me,Ae){re.onload=me,re.onerror=Ae}),re.addEventListener("load",function(){P.loading|=1}),re.addEventListener("error",function(){P.loading|=2}),P.loading|=4,P0(b,s,f)}b={type:"stylesheet",instance:b,count:1,state:P},g.set(x,b)}}}function LA(i,s){Xi.X(i,s);var c=Hl;if(c&&i){var f=ye(c).hoistableScripts,g=Gl(i),x=f.get(g);x||(x=c.querySelector(xu(g)),x||(i=p({src:i,async:!0},s),(s=Aa.get(g))&&om(i,s),x=c.createElement("script"),ce(x),pn(x,"link",i),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},f.set(g,x))}}function BA(i,s){Xi.M(i,s);var c=Hl;if(c&&i){var f=ye(c).hoistableScripts,g=Gl(i),x=f.get(g);x||(x=c.querySelector(xu(g)),x||(i=p({src:i,async:!0,type:"module"},s),(s=Aa.get(g))&&om(i,s),x=c.createElement("script"),ce(x),pn(x,"link",i),c.head.appendChild(x)),x={type:"script",instance:x,count:1,state:null},f.set(g,x))}}function V2(i,s,c,f){var g=(g=ue.current)?M0(g):null;if(!g)throw Error(n(446));switch(i){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(s=Wl(c.href),c=ye(g).hoistableStyles,f=c.get(s),f||(f={type:"style",instance:null,count:0,state:null},c.set(s,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){i=Wl(c.href);var x=ye(g).hoistableStyles,b=x.get(i);if(b||(g=g.ownerDocument||g,b={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},x.set(i,b),(x=g.querySelector(gu(i)))&&!x._p&&(b.instance=x,b.state.loading=5),Aa.has(i)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},Aa.set(i,c),x||VA(g,i,c,b.state))),s&&f===null)throw Error(n(528,""));return b}if(s&&f!==null)throw Error(n(529,""));return null;case"script":return s=c.async,c=c.src,typeof c=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=Gl(c),c=ye(g).hoistableScripts,f=c.get(s),f||(f={type:"script",instance:null,count:0,state:null},c.set(s,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,i))}}function Wl(i){return'href="'+Vr(i)+'"'}function gu(i){return'link[rel="stylesheet"]['+i+"]"}function U2(i){return p({},i,{"data-precedence":i.precedence,precedence:null})}function VA(i,s,c,f){i.querySelector('link[rel="preload"][as="style"]['+s+"]")?f.loading=1:(s=i.createElement("link"),f.preload=s,s.addEventListener("load",function(){return f.loading|=1}),s.addEventListener("error",function(){return f.loading|=2}),pn(s,"link",c),ce(s),i.head.appendChild(s))}function Gl(i){return'[src="'+Vr(i)+'"]'}function xu(i){return"script[async]"+i}function j2(i,s,c){if(s.count++,s.instance===null)switch(s.type){case"style":var f=i.querySelector('style[data-href~="'+Vr(c.href)+'"]');if(f)return s.instance=f,ce(f),f;var g=p({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return f=(i.ownerDocument||i).createElement("style"),ce(f),pn(f,"style",g),P0(f,c.precedence,i),s.instance=f;case"stylesheet":g=Wl(c.href);var x=i.querySelector(gu(g));if(x)return s.state.loading|=4,s.instance=x,ce(x),x;f=U2(c),(g=Aa.get(g))&&sm(f,g),x=(i.ownerDocument||i).createElement("link"),ce(x);var b=x;return b._p=new Promise(function(P,re){b.onload=P,b.onerror=re}),pn(x,"link",f),s.state.loading|=4,P0(x,c.precedence,i),s.instance=x;case"script":return x=Gl(c.src),(g=i.querySelector(xu(x)))?(s.instance=g,ce(g),g):(f=c,(g=Aa.get(x))&&(f=p({},c),om(f,g)),i=i.ownerDocument||i,g=i.createElement("script"),ce(g),pn(g,"link",f),i.head.appendChild(g),s.instance=g);case"void":return null;default:throw Error(n(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(f=s.instance,s.state.loading|=4,P0(f,c.precedence,i));return s.instance}function P0(i,s,c){for(var f=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=f.length?f[f.length-1]:null,x=g,b=0;b<f.length;b++){var P=f[b];if(P.dataset.precedence===s)x=P;else if(x!==g)break}x?x.parentNode.insertBefore(i,x.nextSibling):(s=c.nodeType===9?c.head:c,s.insertBefore(i,s.firstChild))}function sm(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.title==null&&(i.title=s.title)}function om(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.integrity==null&&(i.integrity=s.integrity)}var L0=null;function z2(i,s,c){if(L0===null){var f=new Map,g=L0=new Map;g.set(c,f)}else g=L0,f=g.get(c),f||(f=new Map,g.set(c,f));if(f.has(i))return f;for(f.set(i,null),c=c.getElementsByTagName(i),g=0;g<c.length;g++){var x=c[g];if(!(x[j]||x[Or]||i==="link"&&x.getAttribute("rel")==="stylesheet")&&x.namespaceURI!=="http://www.w3.org/2000/svg"){var b=x.getAttribute(s)||"";b=i+b;var P=f.get(b);P?P.push(x):f.set(b,[x])}}return f}function H2(i,s,c){i=i.ownerDocument||i,i.head.insertBefore(c,s==="title"?i.querySelector("head > title"):null)}function UA(i,s,c){if(c===1||s.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return i=s.disabled,typeof s.precedence=="string"&&i==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function W2(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}var vu=null;function jA(){}function zA(i,s,c){if(vu===null)throw Error(n(475));var f=vu;if(s.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var g=Wl(c.href),x=i.querySelector(gu(g));if(x){i=x._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(f.count++,f=B0.bind(f),i.then(f,f)),s.state.loading|=4,s.instance=x,ce(x);return}x=i.ownerDocument||i,c=U2(c),(g=Aa.get(g))&&sm(c,g),x=x.createElement("link"),ce(x);var b=x;b._p=new Promise(function(P,re){b.onload=P,b.onerror=re}),pn(x,"link",c),s.instance=x}f.stylesheets===null&&(f.stylesheets=new Map),f.stylesheets.set(s,i),(i=s.state.preload)&&(s.state.loading&3)===0&&(f.count++,s=B0.bind(f),i.addEventListener("load",s),i.addEventListener("error",s))}}function HA(){if(vu===null)throw Error(n(475));var i=vu;return i.stylesheets&&i.count===0&&lm(i,i.stylesheets),0<i.count?function(s){var c=setTimeout(function(){if(i.stylesheets&&lm(i,i.stylesheets),i.unsuspend){var f=i.unsuspend;i.unsuspend=null,f()}},6e4);return i.unsuspend=s,function(){i.unsuspend=null,clearTimeout(c)}}:null}function B0(){if(this.count--,this.count===0){if(this.stylesheets)lm(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var V0=null;function lm(i,s){i.stylesheets=null,i.unsuspend!==null&&(i.count++,V0=new Map,s.forEach(WA,i),V0=null,B0.call(i))}function WA(i,s){if(!(s.state.loading&4)){var c=V0.get(i);if(c)var f=c.get(null);else{c=new Map,V0.set(i,c);for(var g=i.querySelectorAll("link[data-precedence],style[data-precedence]"),x=0;x<g.length;x++){var b=g[x];(b.nodeName==="LINK"||b.getAttribute("media")!=="not all")&&(c.set(b.dataset.precedence,b),f=b)}f&&c.set(null,f)}g=s.instance,b=g.getAttribute("data-precedence"),x=c.get(b)||f,x===f&&c.set(null,g),c.set(b,g),this.count++,f=B0.bind(this),g.addEventListener("load",f),g.addEventListener("error",f),x?x.parentNode.insertBefore(g,x.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(g,i.firstChild)),s.state.loading|=4}}var _u={$$typeof:O,Provider:null,Consumer:null,_currentValue:Le,_currentValue2:Le,_threadCount:0};function GA(i,s,c,f,g,x,b,P){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=La(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=La(0),this.hiddenUpdates=La(null),this.identifierPrefix=f,this.onUncaughtError=g,this.onCaughtError=x,this.onRecoverableError=b,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=P,this.incompleteTransitions=new Map}function G2(i,s,c,f,g,x,b,P,re,me,Ae,Re){return i=new GA(i,s,c,b,P,re,me,Re),s=1,x===!0&&(s|=24),x=na(3,null,null,s),i.current=x,x.stateNode=i,s=Hd(),s.refCount++,i.pooledCache=s,s.refCount++,x.memoizedState={element:f,isDehydrated:c,cache:s},Xd(x),i}function q2(i){return i?(i=El,i):El}function X2(i,s,c,f,g,x){g=q2(g),f.context===null?f.context=g:f.pendingContext=g,f=ps(s),f.payload={element:c},x=x===void 0?null:x,x!==null&&(f.callback=x),c=gs(i,f,s),c!==null&&(la(c,i,s),Kc(c,i,s))}function Y2(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var c=i.retryLane;i.retryLane=c!==0&&c<s?c:s}}function cm(i,s){Y2(i,s),(i=i.alternate)&&Y2(i,s)}function K2(i){if(i.tag===13){var s=Tl(i,67108864);s!==null&&la(s,i,67108864),cm(i,67108864)}}var U0=!0;function qA(i,s,c,f){var g=ne.T;ne.T=null;var x=se.p;try{se.p=2,um(i,s,c,f)}finally{se.p=x,ne.T=g}}function XA(i,s,c,f){var g=ne.T;ne.T=null;var x=se.p;try{se.p=8,um(i,s,c,f)}finally{se.p=x,ne.T=g}}function um(i,s,c,f){if(U0){var g=fm(f);if(g===null)Q1(i,s,f,j0,c),Q2(i,f);else if(KA(g,i,s,c,f))f.stopPropagation();else if(Q2(i,f),s&4&&-1<YA.indexOf(i)){for(;g!==null;){var x=K(g);if(x!==null)switch(x.tag){case 3:if(x=x.stateNode,x.current.memoizedState.isDehydrated){var b=Wn(x.pendingLanes);if(b!==0){var P=x;for(P.pendingLanes|=2,P.entangledLanes|=2;b;){var re=1<<31-Tt(b);P.entanglements[1]|=re,b&=~re}hi(x),(rr&6)===0&&(S0=be()+500,hu(0))}}break;case 13:P=Tl(x,2),P!==null&&la(P,x,2),k0(),cm(x,2)}if(x=fm(f),x===null&&Q1(i,s,f,j0,c),x===g)break;g=x}g!==null&&f.stopPropagation()}else Q1(i,s,f,null,c)}}function fm(i){return i=ga(i),hm(i)}var j0=null;function hm(i){if(j0=null,i=q(i),i!==null){var s=o(i);if(s===null)i=null;else{var c=s.tag;if(c===13){if(i=l(s),i!==null)return i;i=null}else if(c===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null)}}return j0=i,null}function $2(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ee()){case ze:return 2;case Ke:return 8;case We:case Be:return 32;case Ye:return 268435456;default:return 32}default:return 32}}var dm=!1,Rs=null,Ds=null,Is=null,yu=new Map,Tu=new Map,Os=[],YA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Q2(i,s){switch(i){case"focusin":case"focusout":Rs=null;break;case"dragenter":case"dragleave":Ds=null;break;case"mouseover":case"mouseout":Is=null;break;case"pointerover":case"pointerout":yu.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":Tu.delete(s.pointerId)}}function Eu(i,s,c,f,g,x){return i===null||i.nativeEvent!==x?(i={blockedOn:s,domEventName:c,eventSystemFlags:f,nativeEvent:x,targetContainers:[g]},s!==null&&(s=K(s),s!==null&&K2(s)),i):(i.eventSystemFlags|=f,s=i.targetContainers,g!==null&&s.indexOf(g)===-1&&s.push(g),i)}function KA(i,s,c,f,g){switch(s){case"focusin":return Rs=Eu(Rs,i,s,c,f,g),!0;case"dragenter":return Ds=Eu(Ds,i,s,c,f,g),!0;case"mouseover":return Is=Eu(Is,i,s,c,f,g),!0;case"pointerover":var x=g.pointerId;return yu.set(x,Eu(yu.get(x)||null,i,s,c,f,g)),!0;case"gotpointercapture":return x=g.pointerId,Tu.set(x,Eu(Tu.get(x)||null,i,s,c,f,g)),!0}return!1}function Z2(i){var s=q(i.target);if(s!==null){var c=o(s);if(c!==null){if(s=c.tag,s===13){if(s=l(c),s!==null){i.blockedOn=s,sl(i.priority,function(){if(c.tag===13){var f=oa();f=Qa(f);var g=Tl(c,f);g!==null&&la(g,c,f),cm(c,f)}});return}}else if(s===3&&c.stateNode.current.memoizedState.isDehydrated){i.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}i.blockedOn=null}function z0(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var c=fm(i.nativeEvent);if(c===null){c=i.nativeEvent;var f=new c.constructor(c.type,c);Ri=f,c.target.dispatchEvent(f),Ri=null}else return s=K(c),s!==null&&K2(s),i.blockedOn=c,!1;s.shift()}return!0}function J2(i,s,c){z0(i)&&c.delete(s)}function $A(){dm=!1,Rs!==null&&z0(Rs)&&(Rs=null),Ds!==null&&z0(Ds)&&(Ds=null),Is!==null&&z0(Is)&&(Is=null),yu.forEach(J2),Tu.forEach(J2)}function H0(i,s){i.blockedOn===s&&(i.blockedOn=null,dm||(dm=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,$A)))}var W0=null;function e_(i){W0!==i&&(W0=i,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){W0===i&&(W0=null);for(var s=0;s<i.length;s+=3){var c=i[s],f=i[s+1],g=i[s+2];if(typeof f!="function"){if(hm(f||c)===null)continue;break}var x=K(c);x!==null&&(i.splice(s,3),s-=3,h1(x,{pending:!0,data:g,method:c.method,action:f},f,g))}}))}function wu(i){function s(re){return H0(re,i)}Rs!==null&&H0(Rs,i),Ds!==null&&H0(Ds,i),Is!==null&&H0(Is,i),yu.forEach(s),Tu.forEach(s);for(var c=0;c<Os.length;c++){var f=Os[c];f.blockedOn===i&&(f.blockedOn=null)}for(;0<Os.length&&(c=Os[0],c.blockedOn===null);)Z2(c),c.blockedOn===null&&Os.shift();if(c=(i.ownerDocument||i).$$reactFormReplay,c!=null)for(f=0;f<c.length;f+=3){var g=c[f],x=c[f+1],b=g[yr]||null;if(typeof x=="function")b||e_(c);else if(b){var P=null;if(x&&x.hasAttribute("formAction")){if(g=x,b=x[yr]||null)P=b.formAction;else if(hm(g)!==null)continue}else P=b.action;typeof P=="function"?c[f+1]=P:(c.splice(f,3),f-=3),e_(c)}}}function mm(i){this._internalRoot=i}G0.prototype.render=mm.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(n(409));var c=s.current,f=oa();X2(c,f,i,s,null,null)},G0.prototype.unmount=mm.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;X2(i.current,2,null,i,null,null),k0(),s[Gn]=null}};function G0(i){this._internalRoot=i}G0.prototype.unstable_scheduleHydration=function(i){if(i){var s=Za();i={blockedOn:null,target:i,priority:s};for(var c=0;c<Os.length&&s!==0&&s<Os[c].priority;c++);Os.splice(c,0,i),c===0&&Z2(i)}};var t_=e.version;if(t_!=="19.1.1")throw Error(n(527,t_,"19.1.1"));se.findDOMNode=function(i){var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(n(188)):(i=Object.keys(i).join(","),Error(n(268,i)));return i=h(s),i=i!==null?d(i):null,i=i===null?null:i.stateNode,i};var QA={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:ne,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var q0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!q0.isDisabled&&q0.supportsFiber)try{rt=q0.inject(QA),lt=q0}catch{}}return Au.createRoot=function(i,s){if(!a(i))throw Error(n(299));var c=!1,f="",g=xv,x=vv,b=_v,P=null;return s!=null&&(s.unstable_strictMode===!0&&(c=!0),s.identifierPrefix!==void 0&&(f=s.identifierPrefix),s.onUncaughtError!==void 0&&(g=s.onUncaughtError),s.onCaughtError!==void 0&&(x=s.onCaughtError),s.onRecoverableError!==void 0&&(b=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(P=s.unstable_transitionCallbacks)),s=G2(i,1,!1,null,null,c,f,g,x,b,P,null),i[Gn]=s.current,$1(i),new mm(s)},Au.hydrateRoot=function(i,s,c){if(!a(i))throw Error(n(299));var f=!1,g="",x=xv,b=vv,P=_v,re=null,me=null;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(g=c.identifierPrefix),c.onUncaughtError!==void 0&&(x=c.onUncaughtError),c.onCaughtError!==void 0&&(b=c.onCaughtError),c.onRecoverableError!==void 0&&(P=c.onRecoverableError),c.unstable_transitionCallbacks!==void 0&&(re=c.unstable_transitionCallbacks),c.formState!==void 0&&(me=c.formState)),s=G2(i,1,!0,s,c??null,f,g,x,b,P,re,me),s.context=q2(null),c=s.current,f=oa(),f=Qa(f),g=ps(f),g.callback=null,gs(c,g,f),c=f,s.current.lanes=c,Ba(s,c),hi(s),i[Gn]=s.current,$1(i),new G0(s)},Au.version="19.1.1",Au}var f_;function o3(){if(f_)return xm.exports;f_=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),xm.exports=s3(),xm.exports}var l3=o3();const Ns={navbar:{display:"flex",justifyContent:"center",marginBottom:"2rem"},buttonContainer:{backgroundColor:"white",borderRadius:"15px",padding:"8px",boxShadow:"0 8px 25px rgba(0, 0, 0, 0.1)",border:"2px solid #548235",display:"flex",gap:"8px"},button:{color:"#548235",textDecoration:"none",fontSize:"1rem",fontWeight:"600",padding:"12px 20px",borderRadius:"10px",transition:"all 0.3s ease",border:"none",cursor:"pointer",backgroundColor:"transparent",display:"flex",alignItems:"center",gap:"8px",minWidth:"120px",justifyContent:"center"},activeButton:{backgroundColor:"#548235",color:"white",boxShadow:"0 4px 15px rgba(84, 130, 53, 0.3)"}};function c3({setCurrentPage:t,currentPage:e}){return k.jsx("nav",{style:Ns.navbar,children:k.jsxs("div",{style:Ns.buttonContainer,children:[k.jsx("button",{onClick:()=>t("schedule"),style:e==="schedule"?{...Ns.button,...Ns.activeButton}:Ns.button,onMouseOver:r=>{e!=="schedule"&&(r.target.style.backgroundColor="#DAF2D0",r.target.style.transform="translateY(-2px)")},onMouseOut:r=>{e!=="schedule"&&(r.target.style.backgroundColor="transparent",r.target.style.transform="translateY(0)")},children:" Schedule"}),k.jsx("button",{onClick:()=>t("clients"),style:e==="clients"?{...Ns.button,...Ns.activeButton}:Ns.button,onMouseOver:r=>{e!=="clients"&&(r.target.style.backgroundColor="#DAF2D0",r.target.style.transform="translateY(-2px)")},onMouseOut:r=>{e!=="clients"&&(r.target.style.backgroundColor="transparent",r.target.style.transform="translateY(0)")},children:" Clients"})]})})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var yh={};yh.version="0.18.5";var FT=1252,u3=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Ap={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},kp=function(t){u3.indexOf(t)!=-1&&(FT=Ap[0]=t)};function f3(){kp(1252)}var Ga=function(t){kp(t)};function bp(){Ga(1200),f3()}function h_(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function h3(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function NT(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var bu=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?h3(t.slice(2)):e==254&&r==255?NT(t.slice(2)):e==65279?t.slice(1):t},Y0=function(e){return String.fromCharCode(e)},d_=function(e){return String.fromCharCode(e)},Yu,Ls="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ku(t){for(var e="",r=0,n=0,a=0,o=0,l=0,u=0,h=0,d=0;d<t.length;)r=t.charCodeAt(d++),o=r>>2,n=t.charCodeAt(d++),l=(r&3)<<4|n>>4,a=t.charCodeAt(d++),u=(n&15)<<2|a>>6,h=a&63,isNaN(n)?u=h=64:isNaN(a)&&(h=64),e+=Ls.charAt(o)+Ls.charAt(l)+Ls.charAt(u)+Ls.charAt(h);return e}function da(t){var e="",r=0,n=0,a=0,o=0,l=0,u=0,h=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<t.length;)o=Ls.indexOf(t.charAt(d++)),l=Ls.indexOf(t.charAt(d++)),r=o<<2|l>>4,e+=String.fromCharCode(r),u=Ls.indexOf(t.charAt(d++)),n=(l&15)<<4|u>>2,u!==64&&(e+=String.fromCharCode(n)),h=Ls.indexOf(t.charAt(d++)),a=(u&3)<<6|h,h!==64&&(e+=String.fromCharCode(a));return e}var Rt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),ns=(function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function Gs(t){return Rt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function m_(t){return Rt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var fa=function(e){return Rt?ns(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function $h(t){if(typeof ArrayBuffer>"u")return fa(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function to(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function d3(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function Cp(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Cp(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var cn=Rt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:ns(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),a=0;for(e=0,r=0;e<t.length;r+=a,++e)if(a=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function m3(t){for(var e=[],r=0,n=t.length+250,a=Gs(t.length+255),o=0;o<t.length;++o){var l=t.charCodeAt(o);if(l<128)a[r++]=l;else if(l<2048)a[r++]=192|l>>6&31,a[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var u=t.charCodeAt(++o)&1023;a[r++]=240|l>>8&7,a[r++]=128|l>>2&63,a[r++]=128|u>>6&15|(l&3)<<4,a[r++]=128|u&63}else a[r++]=224|l>>12&15,a[r++]=128|l>>6&63,a[r++]=128|l&63;r>n&&(e.push(a.slice(0,r)),r=0,a=Gs(65535),n=65530)}return e.push(a.slice(0,r)),cn(e)}var Hn=/\u0000/g,Cu=/[\u0001-\u0006]/g;function rc(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function qa(t,e){var r=""+t;return r.length>=e?r:Rr("0",e-r.length)+r}function Rp(t,e){var r=""+t;return r.length>=e?r:Rr(" ",e-r.length)+r}function Th(t,e){var r=""+t;return r.length>=e?r:r+Rr(" ",e-r.length)}function p3(t,e){var r=""+Math.round(t);return r.length>=e?r:Rr("0",e-r.length)+r}function g3(t,e){var r=""+t;return r.length>=e?r:Rr("0",e-r.length)+r}var p_=Math.pow(2,32);function ql(t,e){if(t>p_||t<-p_)return p3(t,e);var r=Math.round(t);return g3(r,e)}function Eh(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var g_=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Tm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function x3(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var pt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},x_={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},v3={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function wh(t,e,r){for(var n=t<0?-1:1,a=t*n,o=0,l=1,u=0,h=1,d=0,p=0,v=Math.floor(a);d<e&&(v=Math.floor(a),u=v*l+o,p=v*d+h,!(a-v<5e-8));)a=1/(a-v),o=l,l=u,h=d,d=p;if(p>e&&(d>e?(p=h,u=o):(p=d,u=l)),!r)return[0,n*u,p];var _=Math.floor(n*u/p);return[_,n*u-_*p,p]}function Mo(t,e,r){if(t>2958465||t<0)return null;var n=t|0,a=Math.floor(86400*(t-n)),o=0,l=[],u={D:n,T:a,u:86400*(t-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(u.u)<1e-6&&(u.u=0),e&&e.date1904&&(n+=1462),u.u>.9999&&(u.u=0,++a==86400&&(u.T=a=0,++n,++u.D)),n===60)l=r?[1317,10,29]:[1900,2,29],o=3;else if(n===0)l=r?[1317,8,29]:[1900,1,0],o=6;else{n>60&&--n;var h=new Date(1900,0,1);h.setDate(h.getDate()+n-1),l=[h.getFullYear(),h.getMonth()+1,h.getDate()],o=h.getDay(),n<60&&(o=(o+6)%7),r&&(o=S3(h,l))}return u.y=l[0],u.m=l[1],u.d=l[2],u.S=a%60,a=Math.floor(a/60),u.M=a%60,a=Math.floor(a/60),u.H=a,u.q=o,u}var MT=new Date(1899,11,31,0,0,0),_3=MT.getTime(),y3=new Date(1900,2,1,0,0,0);function PT(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=y3&&(r+=1440*60*1e3),(r-(_3+(t.getTimezoneOffset()-MT.getTimezoneOffset())*6e4))/(1440*60*1e3)}function Dp(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function T3(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function E3(t){var e=t<0?12:11,r=Dp(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function w3(t){var e=Dp(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function $u(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=E3(t):e===10?r=t.toFixed(10).substr(0,12):r=w3(t),Dp(T3(r.toUpperCase()))}function zo(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):$u(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Ma(14,PT(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function S3(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function A3(t,e,r,n){var a="",o=0,l=0,u=r.y,h,d=0;switch(t){case 98:u=r.y+543;case 121:switch(e.length){case 1:case 2:h=u%100,d=2;break;default:h=u%1e4,d=4;break}break;case 109:switch(e.length){case 1:case 2:h=r.m,d=e.length;break;case 3:return Tm[r.m-1][1];case 5:return Tm[r.m-1][0];default:return Tm[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:h=r.d,d=e.length;break;case 3:return g_[r.q][0];default:return g_[r.q][1]}break;case 104:switch(e.length){case 1:case 2:h=1+(r.H+11)%12,d=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:h=r.H,d=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:h=r.M,d=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?qa(r.S,e.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,o=Math.round(l*(r.S+r.u)),o>=60*l&&(o=0),e==="s"?o===0?"0":""+o/l:(a=qa(o,2+n),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":h=r.D*24+r.H;break;case"[m]":case"[mm]":h=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":h=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}d=e.length===3?1:2;break;case 101:h=u,d=1;break}var p=d>0?qa(h,d):"";return p}function Bs(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var LT=/%/g;function k3(t,e,r){var n=e.replace(LT,""),a=e.length-n.length;return Ki(t,n,r*Math.pow(10,2*a))+Rr("%",a)}function b3(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ki(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function BT(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+BT(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%a;if(o<0&&(o+=a),r=(e/Math.pow(10,o)).toPrecision(n+1+(a+o)%a),r.indexOf("e")===-1){var l=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+o):r+="E+"+(l-o);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,p){return h+d+p.substr(0,(a+o)%a)+"."+p.substr(o)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var VT=/# (\?+)( ?)\/( ?)(\d+)/;function C3(t,e,r){var n=parseInt(t[4],10),a=Math.round(e*n),o=Math.floor(a/n),l=a-o*n,u=n;return r+(o===0?"":""+o)+" "+(l===0?Rr(" ",t[1].length+1+t[4].length):Rp(l,t[1].length)+t[2]+"/"+t[3]+qa(u,t[4].length))}function R3(t,e,r){return r+(e===0?"":""+e)+Rr(" ",t[1].length+2+t[4].length)}var UT=/^#*0*\.([0#]+)/,jT=/\).*[0#]/,zT=/\(###\) ###\\?-####/;function jn(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function v_(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function __(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function D3(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function I3(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function ba(t,e,r){if(t.charCodeAt(0)===40&&!e.match(jT)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ba("n",n,r):"("+ba("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return b3(t,e,r);if(e.indexOf("%")!==-1)return k3(t,e,r);if(e.indexOf("E")!==-1)return BT(e,r);if(e.charCodeAt(0)===36)return"$"+ba(t,e.substr(e.charAt(1)==" "?2:1),r);var a,o,l,u,h=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+ql(h,e.length);if(e.match(/^[#?]+$/))return a=ql(r,0),a==="0"&&(a=""),a.length>e.length?a:jn(e.substr(0,e.length-a.length))+a;if(o=e.match(VT))return C3(o,h,d);if(e.match(/^#+0+$/))return d+ql(h,e.length-e.indexOf("0"));if(o=e.match(UT))return a=v_(r,o[1].length).replace(/^([^\.]+)$/,"$1."+jn(o[1])).replace(/\.$/,"."+jn(o[1])).replace(/\.(\d*)$/,function(w,E){return"."+E+Rr("0",jn(o[1]).length-E.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return d+v_(h,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return d+Bs(ql(h,0));if(o=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ba(t,e,-r):Bs(""+(Math.floor(r)+D3(r,o[1].length)))+"."+qa(__(r,o[1].length),o[1].length);if(o=e.match(/^#,#*,#0/))return ba(t,e.replace(/^#,#*,/,""),r);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=rc(ba(t,e.replace(/[\\-]/g,""),r)),l=0,rc(rc(e.replace(/\\/g,"")).replace(/[0#]/g,function(w){return l<a.length?a.charAt(l++):w==="0"?"0":""}));if(e.match(zT))return a=ba(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),u=wh(h,Math.pow(10,l)-1,!1),a=""+d,p=Ki("n",o[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+o[2]+"/"+o[3],p=Th(u[2],l),p.length<o[4].length&&(p=jn(o[4].substr(o[4].length-p.length))+p),a+=p,a;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),u=wh(h,Math.pow(10,l)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Rp(u[1],l)+o[2]+"/"+o[3]+Th(u[2],l):Rr(" ",2*l+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return a=ql(r,0),e.length<=a.length?a:jn(e.substr(0,e.length-a.length))+a;if(o=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var v=e.indexOf(".")-l,_=e.length-a.length-v;return jn(e.substr(0,v)+a+e.substr(e.length-_))}if(o=e.match(/^00,000\.([#0]*0)$/))return l=__(r,o[1].length),r<0?"-"+ba(t,e,-r):Bs(I3(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?qa(0,3-w.length):"")+w})+"."+qa(l,o[1].length);switch(e){case"###,##0.00":return ba(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var y=Bs(ql(h,0));return y!=="0"?d+y:"";case"###,###.00":return ba(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ba(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function O3(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Ki(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function F3(t,e,r){var n=e.replace(LT,""),a=e.length-n.length;return Ki(t,n,r*Math.pow(10,2*a))+Rr("%",a)}function HT(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+HT(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%a;if(o<0&&(o+=a),r=(e/Math.pow(10,o)).toPrecision(n+1+(a+o)%a),!r.match(/[Ee]/)){var l=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+o):r+="E+"+(l-o),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(u,h,d,p){return h+d+p.substr(0,(a+o)%a)+"."+p.substr(o)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function mi(t,e,r){if(t.charCodeAt(0)===40&&!e.match(jT)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?mi("n",n,r):"("+mi("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return O3(t,e,r);if(e.indexOf("%")!==-1)return F3(t,e,r);if(e.indexOf("E")!==-1)return HT(e,r);if(e.charCodeAt(0)===36)return"$"+mi(t,e.substr(e.charAt(1)==" "?2:1),r);var a,o,l,u,h=Math.abs(r),d=r<0?"-":"";if(e.match(/^00+$/))return d+qa(h,e.length);if(e.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>e.length?a:jn(e.substr(0,e.length-a.length))+a;if(o=e.match(VT))return R3(o,h,d);if(e.match(/^#+0+$/))return d+qa(h,e.length-e.indexOf("0"));if(o=e.match(UT))return a=(""+r).replace(/^([^\.]+)$/,"$1."+jn(o[1])).replace(/\.$/,"."+jn(o[1])),a=a.replace(/\.(\d*)$/,function(w,E){return"."+E+Rr("0",jn(o[1]).length-E.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return d+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return d+Bs(""+h);if(o=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+mi(t,e,-r):Bs(""+r)+"."+Rr("0",o[1].length);if(o=e.match(/^#,#*,#0/))return mi(t,e.replace(/^#,#*,/,""),r);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=rc(mi(t,e.replace(/[\\-]/g,""),r)),l=0,rc(rc(e.replace(/\\/g,"")).replace(/[0#]/g,function(w){return l<a.length?a.charAt(l++):w==="0"?"0":""}));if(e.match(zT))return a=mi(t,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var p="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(o[4].length,7),u=wh(h,Math.pow(10,l)-1,!1),a=""+d,p=Ki("n",o[1],u[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),a+=p+o[2]+"/"+o[3],p=Th(u[2],l),p.length<o[4].length&&(p=jn(o[4].substr(o[4].length-p.length))+p),a+=p,a;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(o[1].length,o[4].length),7),u=wh(h,Math.pow(10,l)-1,!0),d+(u[0]||(u[1]?"":"0"))+" "+(u[1]?Rp(u[1],l)+o[2]+"/"+o[3]+Th(u[2],l):Rr(" ",2*l+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return a=""+r,e.length<=a.length?a:jn(e.substr(0,e.length-a.length))+a;if(o=e.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var v=e.indexOf(".")-l,_=e.length-a.length-v;return jn(e.substr(0,v)+a+e.substr(e.length-_))}if(o=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+mi(t,e,-r):Bs(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?qa(0,3-w.length):"")+w})+"."+qa(0,o[1].length);switch(e){case"###,###":case"##,###":case"#,###":var y=Bs(""+h);return y!=="0"?d+y:"";default:if(e.match(/\.[0#?]*$/))return mi(t,e.slice(0,e.lastIndexOf(".")),r)+jn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Ki(t,e,r){return(r|0)===r?mi(t,e,r):ba(t,e,r)}function N3(t){for(var e=[],r=!1,n=0,a=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(a,n-a),a=n+1}if(e[e.length]=t.substr(a),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var WT=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function xc(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":Eh(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(WT))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function M3(t,e,r,n){for(var a=[],o="",l=0,u="",h="t",d,p,v,_="H";l<t.length;)switch(u=t.charAt(l)){case"G":if(!Eh(t,l))throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(o="";(v=t.charCodeAt(++l))!==34&&l<t.length;)o+=String.fromCharCode(v);a[a.length]={t:"t",v:o},++l;break;case"\\":var y=t.charAt(++l),w=y==="("||y===")"?y:"t";a[a.length]={t:w,v:y},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:e},++l;break;case"B":case"b":if(t.charAt(l+1)==="1"||t.charAt(l+1)==="2"){if(d==null&&(d=Mo(e,r,t.charAt(l+1)==="2"),d==null))return"";a[a.length]={t:"X",v:t.substr(l,2)},h=u,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":u=u.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||d==null&&(d=Mo(e,r),d==null))return"";for(o=u;++l<t.length&&t.charAt(l).toLowerCase()===u;)o+=u;u==="m"&&h.toLowerCase()==="h"&&(u="M"),u==="h"&&(u=_),a[a.length]={t:u,v:o},h=u;break;case"A":case"a":case"":var E={t:u,v:u};if(d==null&&(d=Mo(e,r)),t.substr(l,3).toUpperCase()==="A/P"?(d!=null&&(E.v=d.H>=12?"P":"A"),E.t="T",_="h",l+=3):t.substr(l,5).toUpperCase()==="AM/PM"?(d!=null&&(E.v=d.H>=12?"PM":"AM"),E.t="T",l+=5,_="h"):t.substr(l,5).toUpperCase()==="/"?(d!=null&&(E.v=d.H>=12?"":""),E.t="T",l+=5,_="h"):(E.t="t",++l),d==null&&E.t==="T")return"";a[a.length]=E,h=u;break;case"[":for(o=u;t.charAt(l++)!=="]"&&l<t.length;)o+=t.charAt(l);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(WT)){if(d==null&&(d=Mo(e,r),d==null))return"";a[a.length]={t:"Z",v:o.toLowerCase()},h=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",xc(t)||(a[a.length]={t:"t",v:o}));break;case".":if(d!=null){for(o=u;++l<t.length&&(u=t.charAt(l))==="0";)o+=u;a[a.length]={t:"s",v:o};break}case"0":case"#":for(o=u;++l<t.length&&"0#?.,E+-%".indexOf(u=t.charAt(l))>-1;)o+=u;a[a.length]={t:"n",v:o};break;case"?":for(o=u;t.charAt(++l)===u;)o+=u;a[a.length]={t:u,v:o},h=u;break;case"*":++l,(t.charAt(l)==" "||t.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:n===1?"t":u,v:u},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=u;l<t.length&&"0123456789".indexOf(t.charAt(++l))>-1;)o+=t.charAt(l);a[a.length]={t:"D",v:o};break;case" ":a[a.length]={t:u,v:u},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(u)===-1)throw new Error("unrecognized character "+u+" in "+t);a[a.length]={t:"t",v:u},++l;break}var S=0,L=0,z;for(l=a.length-1,h="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=_,h="h",S<1&&(S=1);break;case"s":(z=a[l].v.match(/\.0+$/))&&(L=Math.max(L,z[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":h=a[l].t;break;case"m":h==="s"&&(a[l].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&a[l].v.match(/[Hh]/)&&(S=1),S<2&&a[l].v.match(/[Mm]/)&&(S=2),S<3&&a[l].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var O="",ee;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=A3(a[l].t.charCodeAt(0),a[l].v,d,L),a[l].t="t";break;case"n":case"?":for(ee=l+1;a[ee]!=null&&((u=a[ee].t)==="?"||u==="D"||(u===" "||u==="t")&&a[ee+1]!=null&&(a[ee+1].t==="?"||a[ee+1].t==="t"&&a[ee+1].v==="/")||a[l].t==="("&&(u===" "||u==="n"||u===")")||u==="t"&&(a[ee].v==="/"||a[ee].v===" "&&a[ee+1]!=null&&a[ee+1].t=="?"));)a[l].v+=a[ee].v,a[ee]={v:"",t:";"},++ee;O+=a[l].v,l=ee-1;break;case"G":a[l].t="t",a[l].v=zo(e,r);break}var te="",Z,C;if(O.length>0){O.charCodeAt(0)==40?(Z=e<0&&O.charCodeAt(0)===45?-e:e,C=Ki("n",O,Z)):(Z=e<0&&n>1?-e:e,C=Ki("n",O,Z),Z<0&&a[0]&&a[0].t=="t"&&(C=C.substr(1),a[0].v="-"+a[0].v)),ee=C.length-1;var I=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){I=l;break}var R=a.length;if(I===a.length&&C.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(ee>=a[l].v.length-1?(ee-=a[l].v.length,a[l].v=C.substr(ee+1,a[l].v.length)):ee<0?a[l].v="":(a[l].v=C.substr(0,ee+1),ee=-1),a[l].t="t",R=l);ee>=0&&R<a.length&&(a[R].v=C.substr(0,ee+1)+a[R].v)}else if(I!==a.length&&C.indexOf("E")===-1){for(ee=C.indexOf(".")-1,l=I;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(p=a[l].v.indexOf(".")>-1&&l===I?a[l].v.indexOf(".")-1:a[l].v.length-1,te=a[l].v.substr(p+1);p>=0;--p)ee>=0&&(a[l].v.charAt(p)==="0"||a[l].v.charAt(p)==="#")&&(te=C.charAt(ee--)+te);a[l].v=te,a[l].t="t",R=l}for(ee>=0&&R<a.length&&(a[R].v=C.substr(0,ee+1)+a[R].v),ee=C.indexOf(".")+1,l=I;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==I)){for(p=a[l].v.indexOf(".")>-1&&l===I?a[l].v.indexOf(".")+1:0,te=a[l].v.substr(0,p);p<a[l].v.length;++p)ee<C.length&&(te+=C.charAt(ee++));a[l].v=te,a[l].t="t",R=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(Z=n>1&&e<0&&l>0&&a[l-1].v==="-"?-e:e,a[l].v=Ki(a[l].t,a[l].v,Z),a[l].t="t");var B="";for(l=0;l!==a.length;++l)a[l]!=null&&(B+=a[l].v);return B}var y_=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function T_(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function P3(t,e){var r=N3(t),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var o=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,o];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(y_),u=r[1].match(y_);return T_(e,l)?[n,r[0]]:T_(e,u)?[n,r[1]]:[n,r[l!=null&&u!=null?2:1]]}return[n,o]}function Ma(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:pt)[t],n==null&&(n=r.table&&r.table[x_[t]]||pt[x_[t]]),n==null&&(n=v3[t]||"General");break}if(Eh(n,0))return zo(e,r);e instanceof Date&&(e=PT(e,r.date1904));var a=P3(n,e);if(Eh(a[1]))return zo(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return M3(a[1],e,r,a[0])}function $i(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(pt[r]==null){e<0&&(e=r);continue}if(pt[r]==t){e=r;break}}e<0&&(e=391)}return pt[e]=t,e}function Qh(t){for(var e=0;e!=392;++e)t[e]!==void 0&&$i(t[e],e)}function vc(){pt=x3()}var L3={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},GT=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function B3(t){var e=typeof t=="number"?pt[t]:t;return e=e.replace(GT,"(\\d+)"),new RegExp("^"+e+"$")}function V3(t,e,r){var n=-1,a=-1,o=-1,l=-1,u=-1,h=-1;(e.match(GT)||[]).forEach(function(v,_){var y=parseInt(r[_+1],10);switch(v.toLowerCase().charAt(0)){case"y":n=y;break;case"d":o=y;break;case"h":l=y;break;case"s":h=y;break;case"m":l>=0?u=y:a=y;break}}),h>=0&&u==-1&&a>=0&&(u=a,a=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var p=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return l==-1&&u==-1&&h==-1?d:n==-1&&a==-1&&o==-1?p:d+"T"+p}var U3=(function(){var t={};t.version="1.2.0";function e(){for(var C=0,I=new Array(256),R=0;R!=256;++R)C=R,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,I[R]=C;return typeof Int32Array<"u"?new Int32Array(I):I}var r=e();function n(C){var I=0,R=0,B=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)D[B]=C[B];for(B=0;B!=256;++B)for(R=C[B],I=256+B;I<4096;I+=256)R=D[I]=R>>>8^C[R&255];var F=[];for(B=1;B!=16;++B)F[B-1]=typeof Int32Array<"u"?D.subarray(B*256,B*256+256):D.slice(B*256,B*256+256);return F}var a=n(r),o=a[0],l=a[1],u=a[2],h=a[3],d=a[4],p=a[5],v=a[6],_=a[7],y=a[8],w=a[9],E=a[10],S=a[11],L=a[12],z=a[13],O=a[14];function ee(C,I){for(var R=I^-1,B=0,D=C.length;B<D;)R=R>>>8^r[(R^C.charCodeAt(B++))&255];return~R}function te(C,I){for(var R=I^-1,B=C.length-15,D=0;D<B;)R=O[C[D++]^R&255]^z[C[D++]^R>>8&255]^L[C[D++]^R>>16&255]^S[C[D++]^R>>>24]^E[C[D++]]^w[C[D++]]^y[C[D++]]^_[C[D++]]^v[C[D++]]^p[C[D++]]^d[C[D++]]^h[C[D++]]^u[C[D++]]^l[C[D++]]^o[C[D++]]^r[C[D++]];for(B+=15;D<B;)R=R>>>8^r[(R^C[D++])&255];return~R}function Z(C,I){for(var R=I^-1,B=0,D=C.length,F=0,M=0;B<D;)F=C.charCodeAt(B++),F<128?R=R>>>8^r[(R^F)&255]:F<2048?(R=R>>>8^r[(R^(192|F>>6&31))&255],R=R>>>8^r[(R^(128|F&63))&255]):F>=55296&&F<57344?(F=(F&1023)+64,M=C.charCodeAt(B++)&1023,R=R>>>8^r[(R^(240|F>>8&7))&255],R=R>>>8^r[(R^(128|F>>2&63))&255],R=R>>>8^r[(R^(128|M>>6&15|(F&3)<<4))&255],R=R>>>8^r[(R^(128|M&63))&255]):(R=R>>>8^r[(R^(224|F>>12&15))&255],R=R>>>8^r[(R^(128|F>>6&63))&255],R=R>>>8^r[(R^(128|F&63))&255]);return~R}return t.table=r,t.bstr=ee,t.buf=te,t.str=Z,t})(),ot=(function(){var e={};e.version="1.2.1";function r(N,X){for(var j=N.split("/"),H=X.split("/"),q=0,K=0,de=Math.min(j.length,H.length);q<de;++q){if(K=j[q].length-H[q].length)return K;if(j[q]!=H[q])return j[q]<H[q]?-1:1}return j.length-H.length}function n(N){if(N.charAt(N.length-1)=="/")return N.slice(0,-1).indexOf("/")===-1?N:n(N.slice(0,-1));var X=N.lastIndexOf("/");return X===-1?N:N.slice(0,X+1)}function a(N){if(N.charAt(N.length-1)=="/")return a(N.slice(0,-1));var X=N.lastIndexOf("/");return X===-1?N:N.slice(X+1)}function o(N,X){typeof X=="string"&&(X=new Date(X));var j=X.getHours();j=j<<6|X.getMinutes(),j=j<<5|X.getSeconds()>>>1,N.write_shift(2,j);var H=X.getFullYear()-1980;H=H<<4|X.getMonth()+1,H=H<<5|X.getDate(),N.write_shift(2,H)}function l(N){var X=N.read_shift(2)&65535,j=N.read_shift(2)&65535,H=new Date,q=j&31;j>>>=5;var K=j&15;j>>>=4,H.setMilliseconds(0),H.setFullYear(j+1980),H.setMonth(K-1),H.setDate(q);var de=X&31;X>>>=5;var ye=X&63;return X>>>=6,H.setHours(X),H.setMinutes(ye),H.setSeconds(de<<1),H}function u(N){vn(N,0);for(var X={},j=0;N.l<=N.length-4;){var H=N.read_shift(2),q=N.read_shift(2),K=N.l+q,de={};switch(H){case 21589:j=N.read_shift(1),j&1&&(de.mtime=N.read_shift(4)),q>5&&(j&2&&(de.atime=N.read_shift(4)),j&4&&(de.ctime=N.read_shift(4))),de.mtime&&(de.mt=new Date(de.mtime*1e3));break}N.l=K,X[H]=de}return X}var h;function d(){return h||(h={})}function p(N,X){if(N[0]==80&&N[1]==75)return cs(N,X);if((N[0]|32)==109&&(N[1]|32)==105)return sl(N,X);if(N.length<512)throw new Error("CFB file size "+N.length+" < 512");var j=3,H=512,q=0,K=0,de=0,ye=0,ce=0,ge=[],xe=N.slice(0,512);vn(xe,0);var Me=v(xe);switch(j=Me[0],j){case 3:H=512;break;case 4:H=4096;break;case 0:if(Me[1]==0)return cs(N,X);default:throw new Error("Major Version: Expected 3 or 4 saw "+j)}H!==512&&(xe=N.slice(0,H),vn(xe,28));var He=N.slice(0,H);_(xe,j);var Je=xe.read_shift(4,"i");if(j===3&&Je!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Je);xe.l+=4,de=xe.read_shift(4,"i"),xe.l+=4,xe.chk("00100000","Mini Stream Cutoff Size: "),ye=xe.read_shift(4,"i"),q=xe.read_shift(4,"i"),ce=xe.read_shift(4,"i"),K=xe.read_shift(4,"i");for(var Ue=-1,$e=0;$e<109&&(Ue=xe.read_shift(4,"i"),!(Ue<0));++$e)ge[$e]=Ue;var vt=y(N,H);S(ce,K,vt,H,ge);var qt=z(vt,de,ge,H);qt[de].name="!Directory",q>0&&ye!==M&&(qt[ye].name="!MiniFAT"),qt[ge[0]].name="!FAT",qt.fat_addrs=ge,qt.ssz=H;var Pt={},Lt=[],ea=[],Ja=[];O(de,qt,vt,Lt,q,Pt,ea,ye),w(ea,Ja,Lt),Lt.shift();var Pn={FileIndex:ea,FullPaths:Ja};return X&&X.raw&&(Pn.raw={header:He,sectors:vt}),Pn}function v(N){if(N[N.l]==80&&N[N.l+1]==75)return[0,0];N.chk(Fe,"Header Signature: "),N.l+=16;var X=N.read_shift(2,"u");return[N.read_shift(2,"u"),X]}function _(N,X){var j=9;switch(N.l+=2,j=N.read_shift(2)){case 9:if(X!=3)throw new Error("Sector Shift: Expected 9 saw "+j);break;case 12:if(X!=4)throw new Error("Sector Shift: Expected 12 saw "+j);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+j)}N.chk("0600","Mini Sector Shift: "),N.chk("000000000000","Reserved: ")}function y(N,X){for(var j=Math.ceil(N.length/X)-1,H=[],q=1;q<j;++q)H[q-1]=N.slice(q*X,(q+1)*X);return H[j-1]=N.slice(j*X),H}function w(N,X,j){for(var H=0,q=0,K=0,de=0,ye=0,ce=j.length,ge=[],xe=[];H<ce;++H)ge[H]=xe[H]=H,X[H]=j[H];for(;ye<xe.length;++ye)H=xe[ye],q=N[H].L,K=N[H].R,de=N[H].C,ge[H]===H&&(q!==-1&&ge[q]!==q&&(ge[H]=ge[q]),K!==-1&&ge[K]!==K&&(ge[H]=ge[K])),de!==-1&&(ge[de]=H),q!==-1&&H!=ge[H]&&(ge[q]=ge[H],xe.lastIndexOf(q)<ye&&xe.push(q)),K!==-1&&H!=ge[H]&&(ge[K]=ge[H],xe.lastIndexOf(K)<ye&&xe.push(K));for(H=1;H<ce;++H)ge[H]===H&&(K!==-1&&ge[K]!==K?ge[H]=ge[K]:q!==-1&&ge[q]!==q&&(ge[H]=ge[q]));for(H=1;H<ce;++H)if(N[H].type!==0){if(ye=H,ye!=ge[ye])do ye=ge[ye],X[H]=X[ye]+"/"+X[H];while(ye!==0&&ge[ye]!==-1&&ye!=ge[ye]);ge[H]=-1}for(X[0]+="/",H=1;H<ce;++H)N[H].type!==2&&(X[H]+="/")}function E(N,X,j){for(var H=N.start,q=N.size,K=[],de=H;j&&q>0&&de>=0;)K.push(X.slice(de*F,de*F+F)),q-=F,de=No(j,de*4);return K.length===0?we(0):cn(K).slice(0,N.size)}function S(N,X,j,H,q){var K=M;if(N===M){if(X!==0)throw new Error("DIFAT chain shorter than expected")}else if(N!==-1){var de=j[N],ye=(H>>>2)-1;if(!de)return;for(var ce=0;ce<ye&&(K=No(de,ce*4))!==M;++ce)q.push(K);S(No(de,H-4),X-1,j,H,q)}}function L(N,X,j,H,q){var K=[],de=[];q||(q=[]);var ye=H-1,ce=0,ge=0;for(ce=X;ce>=0;){q[ce]=!0,K[K.length]=ce,de.push(N[ce]);var xe=j[Math.floor(ce*4/H)];if(ge=ce*4&ye,H<4+ge)throw new Error("FAT boundary crossed: "+ce+" 4 "+H);if(!N[xe])break;ce=No(N[xe],ge)}return{nodes:K,data:F_([de])}}function z(N,X,j,H){var q=N.length,K=[],de=[],ye=[],ce=[],ge=H-1,xe=0,Me=0,He=0,Je=0;for(xe=0;xe<q;++xe)if(ye=[],He=xe+X,He>=q&&(He-=q),!de[He]){ce=[];var Ue=[];for(Me=He;Me>=0;){Ue[Me]=!0,de[Me]=!0,ye[ye.length]=Me,ce.push(N[Me]);var $e=j[Math.floor(Me*4/H)];if(Je=Me*4&ge,H<4+Je)throw new Error("FAT boundary crossed: "+Me+" 4 "+H);if(!N[$e]||(Me=No(N[$e],Je),Ue[Me]))break}K[He]={nodes:ye,data:F_([ce])}}return K}function O(N,X,j,H,q,K,de,ye){for(var ce=0,ge=H.length?2:0,xe=X[N].data,Me=0,He=0,Je;Me<xe.length;Me+=128){var Ue=xe.slice(Me,Me+128);vn(Ue,64),He=Ue.read_shift(2),Je=Lp(Ue,0,He-ge),H.push(Je);var $e={name:Je,type:Ue.read_shift(1),color:Ue.read_shift(1),L:Ue.read_shift(4,"i"),R:Ue.read_shift(4,"i"),C:Ue.read_shift(4,"i"),clsid:Ue.read_shift(16),state:Ue.read_shift(4,"i"),start:0,size:0},vt=Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2);vt!==0&&($e.ct=ee(Ue,Ue.l-8));var qt=Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2)+Ue.read_shift(2);qt!==0&&($e.mt=ee(Ue,Ue.l-8)),$e.start=Ue.read_shift(4,"i"),$e.size=Ue.read_shift(4,"i"),$e.size<0&&$e.start<0&&($e.size=$e.type=0,$e.start=M,$e.name=""),$e.type===5?(ce=$e.start,q>0&&ce!==M&&(X[ce].name="!StreamData")):$e.size>=4096?($e.storage="fat",X[$e.start]===void 0&&(X[$e.start]=L(j,$e.start,X.fat_addrs,X.ssz)),X[$e.start].name=$e.name,$e.content=X[$e.start].data.slice(0,$e.size)):($e.storage="minifat",$e.size<0?$e.size=0:ce!==M&&$e.start!==M&&X[ce]&&($e.content=E($e,X[ce].data,(X[ye]||{}).data))),$e.content&&vn($e.content,0),K[Je]=$e,de.push($e)}}function ee(N,X){return new Date((ua(N,X+4)/1e7*Math.pow(2,32)+ua(N,X)/1e7-11644473600)*1e3)}function te(N,X){return d(),p(h.readFileSync(N),X)}function Z(N,X){var j=X&&X.type;switch(j||Rt&&Buffer.isBuffer(N)&&(j="buffer"),j||"base64"){case"file":return te(N,X);case"base64":return p(fa(da(N)),X);case"binary":return p(fa(N),X)}return p(N,X)}function C(N,X){var j=X||{},H=j.root||"Root Entry";if(N.FullPaths||(N.FullPaths=[]),N.FileIndex||(N.FileIndex=[]),N.FullPaths.length!==N.FileIndex.length)throw new Error("inconsistent CFB structure");N.FullPaths.length===0&&(N.FullPaths[0]=H+"/",N.FileIndex[0]={name:H,type:5}),j.CLSID&&(N.FileIndex[0].clsid=j.CLSID),I(N)}function I(N){var X="Sh33tJ5";if(!ot.find(N,"/"+X)){var j=we(4);j[0]=55,j[1]=j[3]=50,j[2]=54,N.FileIndex.push({name:X,type:2,content:j,size:4,L:69,R:69,C:69}),N.FullPaths.push(N.FullPaths[0]+X),R(N)}}function R(N,X){C(N);for(var j=!1,H=!1,q=N.FullPaths.length-1;q>=0;--q){var K=N.FileIndex[q];switch(K.type){case 0:H?j=!0:(N.FileIndex.pop(),N.FullPaths.pop());break;case 1:case 2:case 5:H=!0,isNaN(K.R*K.L*K.C)&&(j=!0),K.R>-1&&K.L>-1&&K.R==K.L&&(j=!0);break;default:j=!0;break}}if(!(!j&&!X)){var de=new Date(1987,1,19),ye=0,ce=Object.create?Object.create(null):{},ge=[];for(q=0;q<N.FullPaths.length;++q)ce[N.FullPaths[q]]=!0,N.FileIndex[q].type!==0&&ge.push([N.FullPaths[q],N.FileIndex[q]]);for(q=0;q<ge.length;++q){var xe=n(ge[q][0]);H=ce[xe],H||(ge.push([xe,{name:a(xe).replace("/",""),type:1,clsid:ne,ct:de,mt:de,content:null}]),ce[xe]=!0)}for(ge.sort(function(Je,Ue){return r(Je[0],Ue[0])}),N.FullPaths=[],N.FileIndex=[],q=0;q<ge.length;++q)N.FullPaths[q]=ge[q][0],N.FileIndex[q]=ge[q][1];for(q=0;q<ge.length;++q){var Me=N.FileIndex[q],He=N.FullPaths[q];if(Me.name=a(He).replace("/",""),Me.L=Me.R=Me.C=-(Me.color=1),Me.size=Me.content?Me.content.length:0,Me.start=0,Me.clsid=Me.clsid||ne,q===0)Me.C=ge.length>1?1:-1,Me.size=0,Me.type=5;else if(He.slice(-1)=="/"){for(ye=q+1;ye<ge.length&&n(N.FullPaths[ye])!=He;++ye);for(Me.C=ye>=ge.length?-1:ye,ye=q+1;ye<ge.length&&n(N.FullPaths[ye])!=n(He);++ye);Me.R=ye>=ge.length?-1:ye,Me.type=1}else n(N.FullPaths[q+1]||"")==n(He)&&(Me.R=q+1),Me.type=2}}}function B(N,X){var j=X||{};if(j.fileType=="mad")return dr(N,j);switch(R(N),j.fileType){case"zip":return Ba(N,j)}var H=(function(Je){for(var Ue=0,$e=0,vt=0;vt<Je.FileIndex.length;++vt){var qt=Je.FileIndex[vt];if(qt.content){var Pt=qt.content.length;Pt>0&&(Pt<4096?Ue+=Pt+63>>6:$e+=Pt+511>>9)}}for(var Lt=Je.FullPaths.length+3>>2,ea=Ue+7>>3,Ja=Ue+127>>7,Pn=ea+$e+Lt+Ja,qn=Pn+127>>7,ei=qn<=109?0:Math.ceil((qn-109)/127);Pn+qn+ei+127>>7>qn;)ei=++qn<=109?0:Math.ceil((qn-109)/127);var Ln=[1,ei,qn,Ja,Lt,$e,Ue,0];return Je.FileIndex[0].size=Ue<<6,Ln[7]=(Je.FileIndex[0].start=Ln[0]+Ln[1]+Ln[2]+Ln[3]+Ln[4]+Ln[5])+(Ln[6]+7>>3),Ln})(N),q=we(H[7]<<9),K=0,de=0;{for(K=0;K<8;++K)q.write_shift(1,Se[K]);for(K=0;K<8;++K)q.write_shift(2,0);for(q.write_shift(2,62),q.write_shift(2,3),q.write_shift(2,65534),q.write_shift(2,9),q.write_shift(2,6),K=0;K<3;++K)q.write_shift(2,0);for(q.write_shift(4,0),q.write_shift(4,H[2]),q.write_shift(4,H[0]+H[1]+H[2]+H[3]-1),q.write_shift(4,0),q.write_shift(4,4096),q.write_shift(4,H[3]?H[0]+H[1]+H[2]-1:M),q.write_shift(4,H[3]),q.write_shift(-4,H[1]?H[0]-1:M),q.write_shift(4,H[1]),K=0;K<109;++K)q.write_shift(-4,K<H[2]?H[1]+K:-1)}if(H[1])for(de=0;de<H[1];++de){for(;K<236+de*127;++K)q.write_shift(-4,K<H[2]?H[1]+K:-1);q.write_shift(-4,de===H[1]-1?M:de+1)}var ye=function(Je){for(de+=Je;K<de-1;++K)q.write_shift(-4,K+1);Je&&(++K,q.write_shift(-4,M))};for(de=K=0,de+=H[1];K<de;++K)q.write_shift(-4,se.DIFSECT);for(de+=H[2];K<de;++K)q.write_shift(-4,se.FATSECT);ye(H[3]),ye(H[4]);for(var ce=0,ge=0,xe=N.FileIndex[0];ce<N.FileIndex.length;++ce)xe=N.FileIndex[ce],xe.content&&(ge=xe.content.length,!(ge<4096)&&(xe.start=de,ye(ge+511>>9)));for(ye(H[6]+7>>3);q.l&511;)q.write_shift(-4,se.ENDOFCHAIN);for(de=K=0,ce=0;ce<N.FileIndex.length;++ce)xe=N.FileIndex[ce],xe.content&&(ge=xe.content.length,!(!ge||ge>=4096)&&(xe.start=de,ye(ge+63>>6)));for(;q.l&511;)q.write_shift(-4,se.ENDOFCHAIN);for(K=0;K<H[4]<<2;++K){var Me=N.FullPaths[K];if(!Me||Me.length===0){for(ce=0;ce<17;++ce)q.write_shift(4,0);for(ce=0;ce<3;++ce)q.write_shift(4,-1);for(ce=0;ce<12;++ce)q.write_shift(4,0);continue}xe=N.FileIndex[K],K===0&&(xe.start=xe.size?xe.start-1:M);var He=K===0&&j.root||xe.name;if(ge=2*(He.length+1),q.write_shift(64,He,"utf16le"),q.write_shift(2,ge),q.write_shift(1,xe.type),q.write_shift(1,xe.color),q.write_shift(-4,xe.L),q.write_shift(-4,xe.R),q.write_shift(-4,xe.C),xe.clsid)q.write_shift(16,xe.clsid,"hex");else for(ce=0;ce<4;++ce)q.write_shift(4,0);q.write_shift(4,xe.state||0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,0),q.write_shift(4,xe.start),q.write_shift(4,xe.size),q.write_shift(4,0)}for(K=1;K<N.FileIndex.length;++K)if(xe=N.FileIndex[K],xe.size>=4096)if(q.l=xe.start+1<<9,Rt&&Buffer.isBuffer(xe.content))xe.content.copy(q,q.l,0,xe.size),q.l+=xe.size+511&-512;else{for(ce=0;ce<xe.size;++ce)q.write_shift(1,xe.content[ce]);for(;ce&511;++ce)q.write_shift(1,0)}for(K=1;K<N.FileIndex.length;++K)if(xe=N.FileIndex[K],xe.size>0&&xe.size<4096)if(Rt&&Buffer.isBuffer(xe.content))xe.content.copy(q,q.l,0,xe.size),q.l+=xe.size+63&-64;else{for(ce=0;ce<xe.size;++ce)q.write_shift(1,xe.content[ce]);for(;ce&63;++ce)q.write_shift(1,0)}if(Rt)q.l=q.length;else for(;q.l<q.length;)q.write_shift(1,0);return q}function D(N,X){var j=N.FullPaths.map(function(ce){return ce.toUpperCase()}),H=j.map(function(ce){var ge=ce.split("/");return ge[ge.length-(ce.slice(-1)=="/"?2:1)]}),q=!1;X.charCodeAt(0)===47?(q=!0,X=j[0].slice(0,-1)+X):q=X.indexOf("/")!==-1;var K=X.toUpperCase(),de=q===!0?j.indexOf(K):H.indexOf(K);if(de!==-1)return N.FileIndex[de];var ye=!K.match(Cu);for(K=K.replace(Hn,""),ye&&(K=K.replace(Cu,"!")),de=0;de<j.length;++de)if((ye?j[de].replace(Cu,"!"):j[de]).replace(Hn,"")==K||(ye?H[de].replace(Cu,"!"):H[de]).replace(Hn,"")==K)return N.FileIndex[de];return null}var F=64,M=-2,Fe="d0cf11e0a1b11ae1",Se=[208,207,17,224,161,177,26,225],ne="00000000000000000000000000000000",se={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:M,FREESECT:-1,HEADER_SIGNATURE:Fe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ne,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Le(N,X,j){d();var H=B(N,j);h.writeFileSync(X,H)}function ae(N){for(var X=new Array(N.length),j=0;j<N.length;++j)X[j]=String.fromCharCode(N[j]);return X.join("")}function W(N,X){var j=B(N,X);switch(X&&X.type||"buffer"){case"file":return d(),h.writeFileSync(X.filename,j),j;case"binary":return typeof j=="string"?j:ae(j);case"base64":return Ku(typeof j=="string"?j:ae(j));case"buffer":if(Rt)return Buffer.isBuffer(j)?j:ns(j);case"array":return typeof j=="string"?fa(j):j}return j}var pe;function V(N){try{var X=N.InflateRaw,j=new X;if(j._processChunk(new Uint8Array([3,0]),j._finishFlushFlag),j.bytesRead)pe=N;else throw new Error("zlib does not expose bytesRead")}catch(H){console.error("cannot use native zlib: "+(H.message||H))}}function Y(N,X){if(!pe)return os(N,X);var j=pe.InflateRaw,H=new j,q=H._processChunk(N.slice(N.l),H._finishFlushFlag);return N.l+=H.bytesRead,q}function Q(N){return pe?pe.deflateRawSync(N):ft(N)}var J=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ue=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Ie=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ke(N){var X=(N<<1|N<<11)&139536|(N<<5|N<<15)&558144;return(X>>16|X>>8|X)&255}for(var Oe=typeof Uint8Array<"u",le=Oe?new Uint8Array(256):[],Qe=0;Qe<256;++Qe)le[Qe]=ke(Qe);function G(N,X){var j=le[N&255];return X<=8?j>>>8-X:(j=j<<8|le[N>>8&255],X<=16?j>>>16-X:(j=j<<8|le[N>>16&255],j>>>24-X))}function et(N,X){var j=X&7,H=X>>>3;return(N[H]|(j<=6?0:N[H+1]<<8))>>>j&3}function Ve(N,X){var j=X&7,H=X>>>3;return(N[H]|(j<=5?0:N[H+1]<<8))>>>j&7}function at(N,X){var j=X&7,H=X>>>3;return(N[H]|(j<=4?0:N[H+1]<<8))>>>j&15}function Ze(N,X){var j=X&7,H=X>>>3;return(N[H]|(j<=3?0:N[H+1]<<8))>>>j&31}function be(N,X){var j=X&7,H=X>>>3;return(N[H]|(j<=1?0:N[H+1]<<8))>>>j&127}function Ee(N,X,j){var H=X&7,q=X>>>3,K=(1<<j)-1,de=N[q]>>>H;return j<8-H||(de|=N[q+1]<<8-H,j<16-H)||(de|=N[q+2]<<16-H,j<24-H)||(de|=N[q+3]<<24-H),de&K}function ze(N,X,j){var H=X&7,q=X>>>3;return H<=5?N[q]|=(j&7)<<H:(N[q]|=j<<H&255,N[q+1]=(j&7)>>8-H),X+3}function Ke(N,X,j){var H=X&7,q=X>>>3;return j=(j&1)<<H,N[q]|=j,X+1}function We(N,X,j){var H=X&7,q=X>>>3;return j<<=H,N[q]|=j&255,j>>>=8,N[q+1]=j,X+8}function Be(N,X,j){var H=X&7,q=X>>>3;return j<<=H,N[q]|=j&255,j>>>=8,N[q+1]=j&255,N[q+2]=j>>>8,X+16}function Ye(N,X){var j=N.length,H=2*j>X?2*j:X+5,q=0;if(j>=X)return N;if(Rt){var K=m_(H);if(N.copy)N.copy(K);else for(;q<N.length;++q)K[q]=N[q];return K}else if(Oe){var de=new Uint8Array(H);if(de.set)de.set(N);else for(;q<j;++q)de[q]=N[q];return de}return N.length=H,N}function je(N){for(var X=new Array(N),j=0;j<N;++j)X[j]=0;return X}function dt(N,X,j){var H=1,q=0,K=0,de=0,ye=0,ce=N.length,ge=Oe?new Uint16Array(32):je(32);for(K=0;K<32;++K)ge[K]=0;for(K=ce;K<j;++K)N[K]=0;ce=N.length;var xe=Oe?new Uint16Array(ce):je(ce);for(K=0;K<ce;++K)ge[q=N[K]]++,H<q&&(H=q),xe[K]=0;for(ge[0]=0,K=1;K<=H;++K)ge[K+16]=ye=ye+ge[K-1]<<1;for(K=0;K<ce;++K)ye=N[K],ye!=0&&(xe[K]=ge[ye+16]++);var Me=0;for(K=0;K<ce;++K)if(Me=N[K],Me!=0)for(ye=G(xe[K],H)>>H-Me,de=(1<<H+4-Me)-1;de>=0;--de)X[ye|de<<Me]=Me&15|K<<4;return H}var rt=Oe?new Uint16Array(512):je(512),lt=Oe?new Uint16Array(32):je(32);if(!Oe){for(var ut=0;ut<512;++ut)rt[ut]=0;for(ut=0;ut<32;++ut)lt[ut]=0}(function(){for(var N=[],X=0;X<32;X++)N.push(5);dt(N,lt,32);var j=[];for(X=0;X<=143;X++)j.push(8);for(;X<=255;X++)j.push(9);for(;X<=279;X++)j.push(7);for(;X<=287;X++)j.push(8);dt(j,rt,288)})();var Tt=(function(){for(var X=Oe?new Uint8Array(32768):[],j=0,H=0;j<Ie.length-1;++j)for(;H<Ie[j+1];++H)X[H]=j;for(;H<32768;++H)X[H]=29;var q=Oe?new Uint8Array(259):[];for(j=0,H=0;j<ue.length-1;++j)for(;H<ue[j+1];++H)q[H]=j;function K(ye,ce){for(var ge=0;ge<ye.length;){var xe=Math.min(65535,ye.length-ge),Me=ge+xe==ye.length;for(ce.write_shift(1,+Me),ce.write_shift(2,xe),ce.write_shift(2,~xe&65535);xe-- >0;)ce[ce.l++]=ye[ge++]}return ce.l}function de(ye,ce){for(var ge=0,xe=0,Me=Oe?new Uint16Array(32768):[];xe<ye.length;){var He=Math.min(65535,ye.length-xe);if(He<10){for(ge=ze(ce,ge,+(xe+He==ye.length)),ge&7&&(ge+=8-(ge&7)),ce.l=ge/8|0,ce.write_shift(2,He),ce.write_shift(2,~He&65535);He-- >0;)ce[ce.l++]=ye[xe++];ge=ce.l*8;continue}ge=ze(ce,ge,+(xe+He==ye.length)+2);for(var Je=0;He-- >0;){var Ue=ye[xe];Je=(Je<<5^Ue)&32767;var $e=-1,vt=0;if(($e=Me[Je])&&($e|=xe&-32768,$e>xe&&($e-=32768),$e<xe))for(;ye[$e+vt]==ye[xe+vt]&&vt<250;)++vt;if(vt>2){Ue=q[vt],Ue<=22?ge=We(ce,ge,le[Ue+1]>>1)-1:(We(ce,ge,3),ge+=5,We(ce,ge,le[Ue-23]>>5),ge+=3);var qt=Ue<8?0:Ue-4>>2;qt>0&&(Be(ce,ge,vt-ue[Ue]),ge+=qt),Ue=X[xe-$e],ge=We(ce,ge,le[Ue]>>3),ge-=3;var Pt=Ue<4?0:Ue-2>>1;Pt>0&&(Be(ce,ge,xe-$e-Ie[Ue]),ge+=Pt);for(var Lt=0;Lt<vt;++Lt)Me[Je]=xe&32767,Je=(Je<<5^ye[xe])&32767,++xe;He-=vt-1}else Ue<=143?Ue=Ue+48:ge=Ke(ce,ge,1),ge=We(ce,ge,le[Ue]),Me[Je]=xe&32767,++xe}ge=We(ce,ge,0)-1}return ce.l=(ge+7)/8|0,ce.l}return function(ce,ge){return ce.length<8?K(ce,ge):de(ce,ge)}})();function ft(N){var X=we(50+Math.floor(N.length*1.1)),j=Tt(N,X);return X.slice(0,j)}var er=Oe?new Uint16Array(32768):je(32768),pr=Oe?new Uint16Array(32768):je(32768),tr=Oe?new Uint16Array(128):je(128),En=1,Wn=1;function ss(N,X){var j=Ze(N,X)+257;X+=5;var H=Ze(N,X)+1;X+=5;var q=at(N,X)+4;X+=4;for(var K=0,de=Oe?new Uint8Array(19):je(19),ye=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ce=1,ge=Oe?new Uint8Array(8):je(8),xe=Oe?new Uint8Array(8):je(8),Me=de.length,He=0;He<q;++He)de[J[He]]=K=Ve(N,X),ce<K&&(ce=K),ge[K]++,X+=3;var Je=0;for(ge[0]=0,He=1;He<=ce;++He)xe[He]=Je=Je+ge[He-1]<<1;for(He=0;He<Me;++He)(Je=de[He])!=0&&(ye[He]=xe[Je]++);var Ue=0;for(He=0;He<Me;++He)if(Ue=de[He],Ue!=0){Je=le[ye[He]]>>8-Ue;for(var $e=(1<<7-Ue)-1;$e>=0;--$e)tr[Je|$e<<Ue]=Ue&7|He<<3}var vt=[];for(ce=1;vt.length<j+H;)switch(Je=tr[be(N,X)],X+=Je&7,Je>>>=3){case 16:for(K=3+et(N,X),X+=2,Je=vt[vt.length-1];K-- >0;)vt.push(Je);break;case 17:for(K=3+Ve(N,X),X+=3;K-- >0;)vt.push(0);break;case 18:for(K=11+be(N,X),X+=7;K-- >0;)vt.push(0);break;default:vt.push(Je),ce<Je&&(ce=Je);break}var qt=vt.slice(0,j),Pt=vt.slice(j);for(He=j;He<286;++He)qt[He]=0;for(He=H;He<30;++He)Pt[He]=0;return En=dt(qt,er,286),Wn=dt(Pt,pr,30),X}function bi(N,X){if(N[0]==3&&!(N[1]&3))return[Gs(X),2];for(var j=0,H=0,q=m_(X||1<<18),K=0,de=q.length>>>0,ye=0,ce=0;(H&1)==0;){if(H=Ve(N,j),j+=3,H>>>1)H>>1==1?(ye=9,ce=5):(j=ss(N,j),ye=En,ce=Wn);else{j&7&&(j+=8-(j&7));var ge=N[j>>>3]|N[(j>>>3)+1]<<8;if(j+=32,ge>0)for(!X&&de<K+ge&&(q=Ye(q,K+ge),de=q.length);ge-- >0;)q[K++]=N[j>>>3],j+=8;continue}for(;;){!X&&de<K+32767&&(q=Ye(q,K+32767),de=q.length);var xe=Ee(N,j,ye),Me=H>>>1==1?rt[xe]:er[xe];if(j+=Me&15,Me>>>=4,(Me>>>8&255)===0)q[K++]=Me;else{if(Me==256)break;Me-=257;var He=Me<8?0:Me-4>>2;He>5&&(He=0);var Je=K+ue[Me];He>0&&(Je+=Ee(N,j,He),j+=He),xe=Ee(N,j,ce),Me=H>>>1==1?lt[xe]:pr[xe],j+=Me&15,Me>>>=4;var Ue=Me<4?0:Me-2>>1,$e=Ie[Me];for(Ue>0&&($e+=Ee(N,j,Ue),j+=Ue),!X&&de<Je&&(q=Ye(q,Je+100),de=q.length);K<Je;)q[K]=q[K-$e],++K}}}return X?[q,j+7>>>3]:[q.slice(0,K),j+7>>>3]}function os(N,X){var j=N.slice(N.l||0),H=bi(j,X);return N.l+=H[1],H[0]}function ls(N,X){if(N)typeof console<"u"&&console.error(X);else throw new Error(X)}function cs(N,X){var j=N;vn(j,0);var H=[],q=[],K={FileIndex:H,FullPaths:q};C(K,{root:X.root});for(var de=j.length-4;(j[de]!=80||j[de+1]!=75||j[de+2]!=5||j[de+3]!=6)&&de>=0;)--de;j.l=de+4,j.l+=4;var ye=j.read_shift(2);j.l+=6;var ce=j.read_shift(4);for(j.l=ce,de=0;de<ye;++de){j.l+=20;var ge=j.read_shift(4),xe=j.read_shift(4),Me=j.read_shift(2),He=j.read_shift(2),Je=j.read_shift(2);j.l+=8;var Ue=j.read_shift(4),$e=u(j.slice(j.l+Me,j.l+Me+He));j.l+=Me+He+Je;var vt=j.l;j.l=Ue+4,La(j,ge,xe,K,$e),j.l=vt}return K}function La(N,X,j,H,q){N.l+=2;var K=N.read_shift(2),de=N.read_shift(2),ye=l(N);if(K&8257)throw new Error("Unsupported ZIP encryption");for(var ce=N.read_shift(4),ge=N.read_shift(4),xe=N.read_shift(4),Me=N.read_shift(2),He=N.read_shift(2),Je="",Ue=0;Ue<Me;++Ue)Je+=String.fromCharCode(N[N.l++]);if(He){var $e=u(N.slice(N.l,N.l+He));($e[21589]||{}).mt&&(ye=$e[21589].mt),((q||{})[21589]||{}).mt&&(ye=q[21589].mt)}N.l+=He;var vt=N.slice(N.l,N.l+ge);switch(de){case 8:vt=Y(N,xe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+de)}var qt=!1;K&8&&(ce=N.read_shift(4),ce==134695760&&(ce=N.read_shift(4),qt=!0),ge=N.read_shift(4),xe=N.read_shift(4)),ge!=X&&ls(qt,"Bad compressed size: "+X+" != "+ge),xe!=j&&ls(qt,"Bad uncompressed size: "+j+" != "+xe),yr(H,Je,vt,{unsafe:!0,mt:ye})}function Ba(N,X){var j=X||{},H=[],q=[],K=we(1),de=j.compression?8:0,ye=0,ce=0,ge=0,xe=0,Me=0,He=N.FullPaths[0],Je=He,Ue=N.FileIndex[0],$e=[],vt=0;for(ce=1;ce<N.FullPaths.length;++ce)if(Je=N.FullPaths[ce].slice(He.length),Ue=N.FileIndex[ce],!(!Ue.size||!Ue.content||Je=="Sh33tJ5")){var qt=xe,Pt=we(Je.length);for(ge=0;ge<Je.length;++ge)Pt.write_shift(1,Je.charCodeAt(ge)&127);Pt=Pt.slice(0,Pt.l),$e[Me]=U3.buf(Ue.content,0);var Lt=Ue.content;de==8&&(Lt=Q(Lt)),K=we(30),K.write_shift(4,67324752),K.write_shift(2,20),K.write_shift(2,ye),K.write_shift(2,de),Ue.mt?o(K,Ue.mt):K.write_shift(4,0),K.write_shift(-4,$e[Me]),K.write_shift(4,Lt.length),K.write_shift(4,Ue.content.length),K.write_shift(2,Pt.length),K.write_shift(2,0),xe+=K.length,H.push(K),xe+=Pt.length,H.push(Pt),xe+=Lt.length,H.push(Lt),K=we(46),K.write_shift(4,33639248),K.write_shift(2,0),K.write_shift(2,20),K.write_shift(2,ye),K.write_shift(2,de),K.write_shift(4,0),K.write_shift(-4,$e[Me]),K.write_shift(4,Lt.length),K.write_shift(4,Ue.content.length),K.write_shift(2,Pt.length),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(4,0),K.write_shift(4,qt),vt+=K.l,q.push(K),vt+=Pt.length,q.push(Pt),++Me}return K=we(22),K.write_shift(4,101010256),K.write_shift(2,0),K.write_shift(2,0),K.write_shift(2,Me),K.write_shift(2,Me),K.write_shift(4,vt),K.write_shift(4,xe),K.write_shift(2,0),cn([cn(H),cn(q),K])}var $a={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ma(N,X){if(N.ctype)return N.ctype;var j=N.name||"",H=j.match(/\.([^\.]+)$/);return H&&$a[H[1]]||X&&(H=(j=X).match(/[\.\\]([^\.\\])+$/),H&&$a[H[1]])?$a[H[1]]:"application/octet-stream"}function ao(N){for(var X=Ku(N),j=[],H=0;H<X.length;H+=76)j.push(X.slice(H,H+76));return j.join(`\r
`)+`\r
`}function Qa(N){var X=N.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ge){var xe=ge.charCodeAt(0).toString(16).toUpperCase();return"="+(xe.length==1?"0"+xe:xe)});X=X.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),X.charAt(0)==`
`&&(X="=0D"+X.slice(1)),X=X.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var j=[],H=X.split(`\r
`),q=0;q<H.length;++q){var K=H[q];if(K.length==0){j.push("");continue}for(var de=0;de<K.length;){var ye=76,ce=K.slice(de,de+ye);ce.charAt(ye-1)=="="?ye--:ce.charAt(ye-2)=="="?ye-=2:ce.charAt(ye-3)=="="&&(ye-=3),ce=K.slice(de,de+ye),de+=ye,de<K.length&&(ce+="="),j.push(ce)}}return j.join(`\r
`)}function us(N){for(var X=[],j=0;j<N.length;++j){for(var H=N[j];j<=N.length&&H.charAt(H.length-1)=="=";)H=H.slice(0,H.length-1)+N[++j];X.push(H)}for(var q=0;q<X.length;++q)X[q]=X[q].replace(/[=][0-9A-Fa-f]{2}/g,function(K){return String.fromCharCode(parseInt(K.slice(1),16))});return fa(X.join(`\r
`))}function Za(N,X,j){for(var H="",q="",K="",de,ye=0;ye<10;++ye){var ce=X[ye];if(!ce||ce.match(/^\s*$/))break;var ge=ce.match(/^(.*?):\s*([^\s].*)$/);if(ge)switch(ge[1].toLowerCase()){case"content-location":H=ge[2].trim();break;case"content-type":K=ge[2].trim();break;case"content-transfer-encoding":q=ge[2].trim();break}}switch(++ye,q.toLowerCase()){case"base64":de=fa(da(X.slice(ye).join("")));break;case"quoted-printable":de=us(X.slice(ye));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+q)}var xe=yr(N,H.slice(j.length),de,{unsafe:!0});K&&(xe.ctype=K)}function sl(N,X){if(ae(N.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var j=X&&X.root||"",H=(Rt&&Buffer.isBuffer(N)?N.toString("binary"):ae(N)).split(`\r
`),q=0,K="";for(q=0;q<H.length;++q)if(K=H[q],!!/^Content-Location:/i.test(K)&&(K=K.slice(K.indexOf("file")),j||(j=K.slice(0,K.lastIndexOf("/")+1)),K.slice(0,j.length)!=j))for(;j.length>0&&(j=j.slice(0,j.length-1),j=j.slice(0,j.lastIndexOf("/")+1),K.slice(0,j.length)!=j););var de=(H[1]||"").match(/boundary="(.*?)"/);if(!de)throw new Error("MAD cannot find boundary");var ye="--"+(de[1]||""),ce=[],ge=[],xe={FileIndex:ce,FullPaths:ge};C(xe);var Me,He=0;for(q=0;q<H.length;++q){var Je=H[q];Je!==ye&&Je!==ye+"--"||(He++&&Za(xe,H.slice(Me,q),j),Me=q)}return xe}function dr(N,X){var j=X||{},H=j.boundary||"SheetJS";H="------="+H;for(var q=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+H.slice(2)+'"',"","",""],K=N.FullPaths[0],de=K,ye=N.FileIndex[0],ce=1;ce<N.FullPaths.length;++ce)if(de=N.FullPaths[ce].slice(K.length),ye=N.FileIndex[ce],!(!ye.size||!ye.content||de=="Sh33tJ5")){de=de.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(vt){return"_x"+vt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(vt){return"_u"+vt.charCodeAt(0).toString(16)+"_"});for(var ge=ye.content,xe=Rt&&Buffer.isBuffer(ge)?ge.toString("binary"):ae(ge),Me=0,He=Math.min(1024,xe.length),Je=0,Ue=0;Ue<=He;++Ue)(Je=xe.charCodeAt(Ue))>=32&&Je<128&&++Me;var $e=Me>=He*4/5;q.push(H),q.push("Content-Location: "+(j.root||"file:///C:/SheetJS/")+de),q.push("Content-Transfer-Encoding: "+($e?"quoted-printable":"base64")),q.push("Content-Type: "+ma(ye,de)),q.push(""),q.push($e?Qa(xe):ao(xe))}return q.push(H+`--\r
`),q.join(`\r
`)}function Or(N){var X={};return C(X,N),X}function yr(N,X,j,H){var q=H&&H.unsafe;q||C(N);var K=!q&&ot.find(N,X);if(!K){var de=N.FullPaths[0];X.slice(0,de.length)==de?de=X:(de.slice(-1)!="/"&&(de+="/"),de=(de+X).replace("//","/")),K={name:a(X),type:2},N.FileIndex.push(K),N.FullPaths.push(de),q||ot.utils.cfb_gc(N)}return K.content=j,K.size=j?j.length:0,H&&(H.CLSID&&(K.clsid=H.CLSID),H.mt&&(K.mt=H.mt),H.ct&&(K.ct=H.ct)),K}function Gn(N,X){C(N);var j=ot.find(N,X);if(j){for(var H=0;H<N.FileIndex.length;++H)if(N.FileIndex[H]==j)return N.FileIndex.splice(H,1),N.FullPaths.splice(H,1),!0}return!1}function io(N,X,j){C(N);var H=ot.find(N,X);if(H){for(var q=0;q<N.FileIndex.length;++q)if(N.FileIndex[q]==H)return N.FileIndex[q].name=a(j),N.FullPaths[q]=j,!0}return!1}function kc(N){R(N,!0)}return e.find=D,e.read=Z,e.parse=p,e.write=W,e.writeFile=Le,e.utils={cfb_new:Or,cfb_add:yr,cfb_del:Gn,cfb_mov:io,cfb_gc:kc,ReadShift:Nu,CheckField:dE,prep_blob:vn,bconcat:cn,use_zlib:V,_deflateRaw:ft,_inflateRaw:os,consts:se},e})();function j3(t){return typeof t=="string"?$h(t):Array.isArray(t)?d3(t):t}function _f(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=$h(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?vi(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var a=new Blob([j3(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,t);if(typeof saveAs<"u")return saveAs(a,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:t,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=t,l.href=o,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var u=File(t);return u.open("w"),u.encoding="binary",Array.isArray(e)&&(e=to(e)),u.write(e),u.close(),e}catch(h){if(!h.message||!h.message.match(/onstruct/))throw h}throw new Error("cannot save file "+t)}function z3(t){if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Ir(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function E_(t,e){for(var r=[],n=Ir(t),a=0;a!==n.length;++a)r[t[n[a]][e]]==null&&(r[t[n[a]][e]]=n[a]);return r}function Zh(t){for(var e=[],r=Ir(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Jh(t){for(var e=[],r=Ir(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function H3(t){for(var e=[],r=Ir(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Sh=new Date(1899,11,30,0,0,0);function en(t,e){var r=t.getTime(),n=Sh.getTime()+(t.getTimezoneOffset()-Sh.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var qT=new Date,W3=Sh.getTime()+(qT.getTimezoneOffset()-Sh.getTimezoneOffset())*6e4,w_=qT.getTimezoneOffset();function ed(t){var e=new Date;return e.setTime(t*24*60*60*1e3+W3),e.getTimezoneOffset()!==w_&&e.setTime(e.getTime()+(e.getTimezoneOffset()-w_)*6e4),e}function G3(t){var e=0,r=0,n=!1,a=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var o=1;o!=a.length;++o)if(a[o]){switch(r=1,o>3&&(n=!0),a[o].slice(a[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[o].slice(a[o].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}e+=r*parseInt(a[o],10)}return e}var S_=new Date("2017-02-19T19:06:09.000Z"),XT=isNaN(S_.getFullYear())?new Date("2/19/17"):S_,q3=XT.getFullYear()==2017;function vr(t,e){var r=new Date(t);if(q3)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(XT.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function Ho(t,e){if(Rt&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return vi(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return vi(NT(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return vi(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return vi(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(o){return r[o]||o})}catch{}for(var n=[],a=0;a!=t.length;++a)n.push(String.fromCharCode(t[a]));return n.join("")}function _r(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=_r(t[r]));return e}function Rr(t,e){for(var r="";r.length<e;)r+=t;return r}function Ya(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,o){return r=-r,o}),!isNaN(e=Number(n)))?e/r:e}var X3=["january","february","march","april","may","june","july","august","september","october","november","december"];function lc(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),a=e.getMonth(),o=e.getDate();if(isNaN(o))return r;var l=t.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&X3.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||o>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var Y3=(function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(t||typeof n=="string")return r.split(n);for(var o=r.split(n),l=[o[0]],u=1;u<o.length;++u)l.push(a),l.push(o[u]);return l}})();function YT(t){return t?t.content&&t.type?Ho(t.content,!0):t.data?bu(t.data):t.asNodeBuffer&&Rt?bu(t.asNodeBuffer().toString("binary")):t.asBinary?bu(t.asBinary()):t._data&&t._data.getContent?bu(Ho(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function KT(t){if(!t)return null;if(t.data)return h_(t.data);if(t.asNodeBuffer&&Rt)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?h_(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function K3(t){return t&&t.name.slice(-4)===".bin"?KT(t):YT(t)}function Da(t,e){for(var r=t.FullPaths||Ir(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),o=0;o<r.length;++o){var l=r[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==l||a==l)return t.files?t.files[r[o]]:t.FileIndex[o]}return null}function Ip(t,e){var r=Da(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function Wr(t,e,r){if(!r)return K3(Ip(t,e));if(!e)return null;try{return Wr(t,e)}catch{return null}}function ha(t,e,r){if(!r)return YT(Ip(t,e));if(!e)return null;try{return ha(t,e)}catch{return null}}function $3(t,e,r){return KT(Ip(t,e))}function A_(t){for(var e=t.FullPaths||Ir(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function kt(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Rt?n=ns(r):n=m3(r),ot.utils.cfb_add(t,e,n)}ot.utils.cfb_add(t,e,r)}else t.file(e,r)}function Op(){return ot.utils.cfb_new()}function $T(t,e){switch(e.type){case"base64":return ot.read(t,{type:"base64"});case"binary":return ot.read(t,{type:"binary"});case"buffer":case"array":return ot.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Ru(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var Br=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Q3=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,k_=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Z3=/<[^>]*>/g,Mn=Br.match(k_)?k_:Z3,J3=/<\w*:/,ek=/<(\/?)\w+:/;function yt(t,e,r){for(var n={},a=0,o=0;a!==t.length&&!((o=t.charCodeAt(a))===32||o===10||o===13);++a);if(e||(n[0]=t.slice(0,a)),a===t.length)return n;var l=t.match(Q3),u=0,h="",d=0,p="",v="",_=1;if(l)for(d=0;d!=l.length;++d){for(v=l[d],o=0;o!=v.length&&v.charCodeAt(o)!==61;++o);for(p=v.slice(0,o).trim();v.charCodeAt(o+1)==32;)++o;for(_=(a=v.charCodeAt(o+1))==34||a==39?1:0,h=v.slice(o+1+_,v.length-_),u=0;u!=p.length&&p.charCodeAt(u)!==58;++u);if(u===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),n[p]=h,n[p.toLowerCase()]=h;else{var y=(u===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(u+1);if(n[y]&&p.slice(u-3,u)=="ext")continue;n[y]=h,n[y.toLowerCase()]=h}}return n}function Ai(t){return t.replace(ek,"<$1")}var QT={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Fp=Zh(QT),Wt=(function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",o=a.indexOf("<![CDATA[");if(o==-1)return a.replace(t,function(u,h){return QT[u]||String.fromCharCode(parseInt(h,u.indexOf("x")>-1?16:10))||u}).replace(e,function(u,h){return String.fromCharCode(parseInt(h,16))});var l=a.indexOf("]]>");return r(a.slice(0,o))+a.slice(o+9,l)+r(a.slice(l+3))}})(),Np=/[&<>'"]/g,tk=/[\u0000-\u0008\u000b-\u001f]/g;function sr(t){var e=t+"";return e.replace(Np,function(r){return Fp[r]}).replace(tk,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function b_(t){return sr(t).replace(/ /g,"_x0020_")}var ZT=/[\u0000-\u001f]/g;function Mp(t){var e=t+"";return e.replace(Np,function(r){return Fp[r]}).replace(/\n/g,"<br/>").replace(ZT,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function rk(t){var e=t+"";return e.replace(Np,function(r){return Fp[r]}).replace(ZT,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var C_=(function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}})();function nk(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function gr(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Em(t){for(var e="",r=0,n=0,a=0,o=0,l=0,u=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(a=t.charCodeAt(r++),n>191&&n<224){l=(n&31)<<6,l|=a&63,e+=String.fromCharCode(l);continue}if(o=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(a&63)<<6|o&63);continue}l=t.charCodeAt(r++),u=((n&7)<<18|(a&63)<<12|(o&63)<<6|l&63)-65536,e+=String.fromCharCode(55296+(u>>>10&1023)),e+=String.fromCharCode(56320+(u&1023))}return e}function R_(t){var e=Gs(2*t.length),r,n,a=1,o=0,l=0,u;for(n=0;n<t.length;n+=a)a=1,(u=t.charCodeAt(n))<128?r=u:u<224?(r=(u&31)*64+(t.charCodeAt(n+1)&63),a=2):u<240?(r=(u&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),a=3):(a=4,r=(u&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(e[o++]=l&255,e[o++]=l>>>8,l=0),e[o++]=r%256,e[o++]=r>>>8;return e.slice(0,o).toString("ucs2")}function D_(t){return ns(t,"binary").toString("utf8")}var K0="foo bar baz",fr=Rt&&(D_(K0)==Em(K0)&&D_||R_(K0)==Em(K0)&&R_)||Em,vi=Rt?function(t){return ns(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,a=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Qu=(function(){var t={};return function(r,n){var a=r+"|"+(n||"");return t[a]?t[a]:t[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),JT=(function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)n=n.replace(t[a][0],t[a][1]);return n}})(),ak=(function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),ik=/<\/?(?:vt:)?variant>/g,sk=/<(?:vt:)([^>]*)>([\s\S]*)</;function I_(t,e){var r=yt(t),n=t.match(ak(r.baseType))||[],a=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(o){var l=o.replace(ik,"").match(sk);l&&a.push({v:fr(l[2]),t:l[1]})}),a}var eE=/(^\s|\s$|\n)/;function _n(t,e){return"<"+t+(e.match(eE)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function Zu(t){return Ir(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Ge(t,e,r){return"<"+t+(r!=null?Zu(r):"")+(e!=null?(e.match(eE)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Gm(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function ok(t,e){switch(typeof t){case"string":var r=Ge("vt:lpwstr",sr(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ge((t|0)==t?"vt:i4":"vt:r8",sr(String(t)));case"boolean":return Ge("vt:bool",t?"true":"false")}if(t instanceof Date)return Ge("vt:filetime",Gm(t));throw new Error("Unable to serialize "+t)}function Pp(t){if(Rt&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return fr(to(Cp(t)));throw new Error("Bad input format: expected Buffer or string")}var Ju=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Qr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},$o=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ca={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function lk(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),a=t[e+6]&15,o=5;o>=0;--o)a=a*256+t[e+o];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function ck(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,a=0,o=0,l=n?-e:e;isFinite(l)?l==0?a=o=0:(a=Math.floor(Math.log(l)/Math.LN2),o=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?a=-1022:(o-=Math.pow(2,52),a+=1023)):(a=2047,o=isNaN(e)?26985:0);for(var u=0;u<=5;++u,o/=256)t[r+u]=o&255;t[r+6]=(a&15)<<4|o&15,t[r+7]=a>>4|n}var O_=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var a=0,o=t[0][n].length;a<o;a+=r)e.push.apply(e,t[0][n].slice(a,a+r));return e},F_=Rt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:ns(e)})):O_(t)}:O_,N_=function(t,e,r){for(var n=[],a=e;a<r;a+=2)n.push(String.fromCharCode(Yi(t,a)));return n.join("").replace(Hn,"")},Lp=Rt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Hn,""):N_(t,e,r)}:N_,M_=function(t,e,r){for(var n=[],a=e;a<e+r;++a)n.push(("0"+t[a].toString(16)).slice(-2));return n.join("")},tE=Rt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):M_(t,e,r)}:M_,P_=function(t,e,r){for(var n=[],a=e;a<r;a++)n.push(String.fromCharCode($l(t,a)));return n.join("")},yf=Rt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):P_(e,r,n)}:P_,rE=function(t,e){var r=ua(t,e);return r>0?yf(t,e+4,e+4+r-1):""},nE=rE,aE=function(t,e){var r=ua(t,e);return r>0?yf(t,e+4,e+4+r-1):""},iE=aE,sE=function(t,e){var r=2*ua(t,e);return r>0?yf(t,e+4,e+4+r-1):""},oE=sE,lE=function(e,r){var n=ua(e,r);return n>0?Lp(e,r+4,r+4+n):""},cE=lE,uE=function(t,e){var r=ua(t,e);return r>0?yf(t,e+4,e+4+r):""},fE=uE,hE=function(t,e){return lk(t,e)},Ah=hE,Bp=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Rt&&(nE=function(e,r){if(!Buffer.isBuffer(e))return rE(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},iE=function(e,r){if(!Buffer.isBuffer(e))return aE(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},oE=function(e,r){if(!Buffer.isBuffer(e))return sE(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},cE=function(e,r){if(!Buffer.isBuffer(e))return lE(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},fE=function(e,r){if(!Buffer.isBuffer(e))return uE(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Ah=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):hE(e,r)},Bp=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var $l=function(t,e){return t[e]},Yi=function(t,e){return t[e+1]*256+t[e]},uk=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},ua=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},No=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},fk=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Nu(t,e){var r="",n,a,o=[],l,u,h,d;switch(e){case"dbcs":if(d=this.l,Rt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(h=0;h<t;++h)r+=String.fromCharCode(Yi(this,d)),d+=2;t*=2;break;case"utf8":r=yf(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Lp(this,this.l,this.l+t);break;case"wstr":return Nu.call(this,t,"dbcs");case"lpstr-ansi":r=nE(this,this.l),t=4+ua(this,this.l);break;case"lpstr-cp":r=iE(this,this.l),t=4+ua(this,this.l);break;case"lpwstr":r=oE(this,this.l),t=4+2*ua(this,this.l);break;case"lpp4":t=4+ua(this,this.l),r=cE(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+ua(this,this.l),r=fE(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(l=$l(this,this.l+t++))!==0;)o.push(Y0(l));r=o.join("");break;case"_wstr":for(t=0,r="";(l=Yi(this,this.l+t))!==0;)o.push(Y0(l)),t+=2;t+=2,r=o.join("");break;case"dbcs-cont":for(r="",d=this.l,h=0;h<t;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return l=$l(this,d),this.l=d+1,u=Nu.call(this,t-h,l?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(Y0(Yi(this,d))),d+=2}r=o.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,h=0;h!=t;++h){if(this.lens&&this.lens.indexOf(d)!==-1)return l=$l(this,d),this.l=d+1,u=Nu.call(this,t-h,l?"dbcs-cont":"sbcs-cont"),o.join("")+u;o.push(Y0($l(this,d))),d+=1}r=o.join("");break;default:switch(t){case 1:return n=$l(this,this.l),this.l++,n;case 2:return n=(e==="i"?uk:Yi)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(n=(t>0?No:fk)(this,this.l),this.l+=4,n):(a=ua(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return t==8?a=Ah(this,this.l):a=Ah([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:r=tE(this,this.l,t);break}}return this.l+=t,r}var hk=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},dk=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},mk=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function pk(t,e,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=e.length;++a)mk(this,e.charCodeAt(a),this.l+2*a);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;n=e.length}else if(r==="hex"){for(;a<t;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var o=Math.min(this.l+t,this.length);for(a=0;a<Math.min(e.length,t);++a){var l=e.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,hk(this,e,this.l);break;case 8:if(n=8,r==="f"){ck(this,e,this.l);break}case 16:break;case-4:n=4,dk(this,e,this.l);break}return this.l+=n,this}function dE(t,e){var r=tE(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function vn(t,e){t.l=e,t.read_shift=Nu,t.chk=dE,t.write_shift=pk}function Nn(t,e){t.l+=e}function we(t){var e=Gs(t);return vn(e,0),e}function as(t,e,r){if(t){var n,a,o;vn(t,t.l||0);for(var l=t.length,u=0,h=0;t.l<l;){u=t.read_shift(1),u&128&&(u=(u&127)+((t.read_shift(1)&127)<<7));var d=sf[u]||sf[65535];for(n=t.read_shift(1),o=n&127,a=1;a<4&&n&128;++a)o+=((n=t.read_shift(1))&127)<<7*a;h=t.l+o;var p=d.f&&d.f(t,o,r);if(t.l=h,e(p,d,u))return}}}function Zn(){var t=[],e=Rt?256:2048,r=function(d){var p=we(d);return vn(p,0),p},n=r(e),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},o=function(d){return n&&d<n.length-n.l?n:(a(),n=r(Math.max(d+1,e)))},l=function(){return a(),cn(t)},u=function(d){a(),n=d,n.l==null&&(n.l=n.length),o(e)};return{next:o,push:u,end:l,_bufs:t}}function Ne(t,e,r,n){var a=+e,o;if(!isNaN(a)){n||(n=sf[a].p||(r||[]).length||0),o=1+(a>=128?1:0)+1,n>=128&&++o,n>=16384&&++o,n>=2097152&&++o;var l=t.next(o);a<=127?l.write_shift(1,a):(l.write_shift(1,(a&127)+128),l.write_shift(1,a>>7));for(var u=0;u!=4;++u)if(n>=128)l.write_shift(1,(n&127)+128),n>>=7;else{l.write_shift(1,n);break}n>0&&Bp(r)&&t.push(r)}}function Mu(t,e,r){var n=_r(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function L_(t,e,r){var n=_r(t);return n.s=Mu(n.s,e.s,r),n.e=Mu(n.e,e.s,r),n}function Pu(t,e){if(t.cRel&&t.c<0)for(t=_r(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=_r(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=gt(t);return!t.cRel&&t.cRel!=null&&(r=vk(r)),!t.rRel&&t.rRel!=null&&(r=gk(r)),r}function wm(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Sr(t.s.c)+":"+(t.e.cRel?"":"$")+Sr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Lr(t.s.r)+":"+(t.e.rRel?"":"$")+Lr(t.e.r):Pu(t.s,e.biff)+":"+Pu(t.e,e.biff)}function Vp(t){return parseInt(xk(t),10)-1}function Lr(t){return""+(t+1)}function gk(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function xk(t){return t.replace(/\$(\d+)$/,"$1")}function Up(t){for(var e=_k(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Sr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function vk(t){return t.replace(/^([A-Z])/,"$$$1")}function _k(t){return t.replace(/^\$([A-Z])/,"$1")}function yk(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ar(t){for(var e=0,r=0,n=0;n<t.length;++n){var a=t.charCodeAt(n);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:e-1}}function gt(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Jn(t){var e=t.indexOf(":");return e==-1?{s:Ar(t),e:Ar(t)}:{s:Ar(t.slice(0,e)),e:Ar(t.slice(e+1))}}function St(t,e){return typeof e>"u"||typeof e=="number"?St(t.s,t.e):(typeof t!="string"&&(t=gt(t)),typeof e!="string"&&(e=gt(e)),t==e?t:t+":"+e)}function Gt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,o=t.length;for(r=0;n<o&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.s.c=--r,r=0;n<o&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(e.s.r=--r,n===o||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=o&&!((a=t.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(e.e.c=--r,r=0;n!=o&&!((a=t.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return e.e.r=--r,e}function B_(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Ma(t.z,r?en(e):e)}catch{}try{return t.w=Ma((t.XF||{}).numFmtId||(r?14:0),r?en(e):e)}catch{return""+e}}function Ji(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?is[t.v]||t.v:e==null?B_(t,t.v):B_(t,e))}function ro(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function mE(t,e,r){var n=r||{},a=t?Array.isArray(t):n.dense,o=t||(a?[]:{}),l=0,u=0;if(o&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var h=typeof n.origin=="string"?Ar(n.origin):n.origin;l=h.r,u=h.c}o["!ref"]||(o["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var p=Gt(o["!ref"]);d.s.c=p.s.c,d.s.r=p.s.r,d.e.c=Math.max(d.e.c,p.e.c),d.e.r=Math.max(d.e.r,p.e.r),l==-1&&(d.e.r=l=p.e.r+1)}for(var v=0;v!=e.length;++v)if(e[v]){if(!Array.isArray(e[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=e[v].length;++_)if(!(typeof e[v][_]>"u")){var y={v:e[v][_]},w=l+v,E=u+_;if(d.s.r>w&&(d.s.r=w),d.s.c>E&&(d.s.c=E),d.e.r<w&&(d.e.r=w),d.e.c<E&&(d.e.c=E),e[v][_]&&typeof e[v][_]=="object"&&!Array.isArray(e[v][_])&&!(e[v][_]instanceof Date))y=e[v][_];else if(Array.isArray(y.v)&&(y.f=e[v][_][1],y.v=y.v[0]),y.v===null)if(y.f)y.t="n";else if(n.nullError)y.t="e",y.v=0;else if(n.sheetStubs)y.t="z";else continue;else typeof y.v=="number"?y.t="n":typeof y.v=="boolean"?y.t="b":y.v instanceof Date?(y.z=n.dateNF||pt[14],n.cellDates?(y.t="d",y.w=Ma(y.z,en(y.v))):(y.t="n",y.v=en(y.v),y.w=Ma(y.z,y.v))):y.t="s";if(a)o[w]||(o[w]=[]),o[w][E]&&o[w][E].z&&(y.z=o[w][E].z),o[w][E]=y;else{var S=gt({c:E,r:w});o[S]&&o[S].z&&(y.z=o[S].z),o[S]=y}}}return d.s.c<1e7&&(o["!ref"]=St(d)),o}function _c(t,e){return mE(null,t,e)}function Tk(t){return t.read_shift(4,"i")}function Ka(t,e){return e||(e=we(4)),e.write_shift(4,t),e}function Fn(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function un(t,e){var r=!1;return e==null&&(r=!0,e=we(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function Ek(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function wk(t,e){return e||(e=we(4)),e.write_shift(2,0),e.write_shift(2,0),e}function jp(t,e){var r=t.l,n=t.read_shift(1),a=Fn(t),o=[],l={t:a,h:a};if((n&1)!==0){for(var u=t.read_shift(4),h=0;h!=u;++h)o.push(Ek(t));l.r=o}else l.r=[{ich:0,ifnt:0}];return t.l=r+e,l}function Sk(t,e){var r=!1;return e==null&&(r=!0,e=we(15+4*t.t.length)),e.write_shift(1,0),un(t.t,e),r?e.slice(0,e.l):e}var Ak=jp;function kk(t,e){var r=!1;return e==null&&(r=!0,e=we(23+4*t.t.length)),e.write_shift(1,1),un(t.t,e),e.write_shift(4,1),wk({},e),r?e.slice(0,e.l):e}function Pa(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Qo(t,e){return e==null&&(e=we(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Zo(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Jo(t,e){return e==null&&(e=we(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var bk=Fn,pE=un;function zp(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function kh(t,e){var r=!1;return e==null&&(r=!0,e=we(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var Ck=Fn,qm=zp,Hp=kh;function Wp(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var a=n===0?Ah([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):No(e,0)>>2;return r?a/100:a}function gE(t,e){e==null&&(e=we(4));var r=0,n=0,a=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?a:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function xE(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function Rk(t,e){return e||(e=we(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var el=xE,yc=Rk;function On(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Wo(t,e){return(e||we(8)).write_shift(8,t,"f")}function Dk(t){var e={},r=t.read_shift(1),n=r>>>1,a=t.read_shift(1),o=t.read_shift(2,"i"),l=t.read_shift(1),u=t.read_shift(1),h=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=a;var d=Lo[a];d&&(e.rgb=tf(d));break;case 2:e.rgb=tf([l,u,h]);break;case 3:e.theme=a;break}return o!=0&&(e.tint=o>0?o/32767:o/32768),e}function bh(t,e){if(e||(e=we(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function Ik(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function Ok(t,e){e||(e=we(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function vE(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function Fk(t){return vE(t,1)}function Nk(t){return vE(t,2)}var Gp=2,$n=3,$0=11,V_=12,Ch=19,Q0=64,Mk=65,Pk=71,Lk=4108,Bk=4126,on=80,_E=81,Vk=[on,_E],Xm={1:{n:"CodePage",t:Gp},2:{n:"Category",t:on},3:{n:"PresentationFormat",t:on},4:{n:"ByteCount",t:$n},5:{n:"LineCount",t:$n},6:{n:"ParagraphCount",t:$n},7:{n:"SlideCount",t:$n},8:{n:"NoteCount",t:$n},9:{n:"HiddenCount",t:$n},10:{n:"MultimediaClipCount",t:$n},11:{n:"ScaleCrop",t:$0},12:{n:"HeadingPairs",t:Lk},13:{n:"TitlesOfParts",t:Bk},14:{n:"Manager",t:on},15:{n:"Company",t:on},16:{n:"LinksUpToDate",t:$0},17:{n:"CharacterCount",t:$n},19:{n:"SharedDoc",t:$0},22:{n:"HyperlinksChanged",t:$0},23:{n:"AppVersion",t:$n,p:"version"},24:{n:"DigSig",t:Mk},26:{n:"ContentType",t:on},27:{n:"ContentStatus",t:on},28:{n:"Language",t:on},29:{n:"Version",t:on},255:{},2147483648:{n:"Locale",t:Ch},2147483651:{n:"Behavior",t:Ch},1919054434:{}},Ym={1:{n:"CodePage",t:Gp},2:{n:"Title",t:on},3:{n:"Subject",t:on},4:{n:"Author",t:on},5:{n:"Keywords",t:on},6:{n:"Comments",t:on},7:{n:"Template",t:on},8:{n:"LastAuthor",t:on},9:{n:"RevNumber",t:on},10:{n:"EditTime",t:Q0},11:{n:"LastPrinted",t:Q0},12:{n:"CreatedDate",t:Q0},13:{n:"ModifiedDate",t:Q0},14:{n:"PageCount",t:$n},15:{n:"WordCount",t:$n},16:{n:"CharCount",t:$n},17:{n:"Thumbnail",t:Pk},18:{n:"Application",t:on},19:{n:"DocSecurity",t:$n},255:{},2147483648:{n:"Locale",t:Ch},2147483651:{n:"Behavior",t:Ch},1919054434:{}},U_={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Uk=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function jk(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var zk=jk([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Lo=_r(zk),is={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},yE={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Km={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Z0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function qp(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Hk(t){var e=qp();if(!t||!t.match)return e;var r={};if((t.match(Mn)||[]).forEach(function(n){var a=yt(n);switch(a[0].replace(J3,"<")){case"<?xml":break;case"<Types":e.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":e[Km[a.ContentType]]!==void 0&&e[Km[a.ContentType]].push(a.PartName);break}}),e.xmlns!==Qr.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function TE(t,e){var r=H3(Km),n=[],a;n[n.length]=Br,n[n.length]=Ge("Types",null,{xmlns:Qr.CT,"xmlns:xsd":Qr.xsd,"xmlns:xsi":Qr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(h){return Ge("Default",null,{Extension:h[0],ContentType:h[1]})}));var o=function(h){t[h]&&t[h].length>0&&(a=t[h][0],n[n.length]=Ge("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:Z0[h][e.bookType]||Z0[h].xlsx}))},l=function(h){(t[h]||[]).forEach(function(d){n[n.length]=Ge("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:Z0[h][e.bookType]||Z0[h].xlsx})})},u=function(h){(t[h]||[]).forEach(function(d){n[n.length]=Ge("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[h][0]})})};return o("workbooks"),l("sheets"),l("charts"),u("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(u),u("vba"),u("comments"),u("threadedcomments"),u("drawings"),l("metadata"),u("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var It={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ef(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Lu(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Mn)||[]).forEach(function(a){var o=yt(a);if(o[0]==="<Relationship"){var l={};l.Type=o.Type,l.Target=o.Target,l.Id=o.Id,o.TargetMode&&(l.TargetMode=o.TargetMode);var u=o.TargetMode==="External"?o.Target:Ru(o.Target,e);r[u]=l,n[o.Id]=l}}),r["!id"]=n,r}function nc(t){var e=[Br,Ge("Relationships",null,{xmlns:Qr.RELS})];return Ir(t["!id"]).forEach(function(r){e[e.length]=Ge("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function ir(t,e,r,n,a,o){if(a||(a={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,a.Id="rId"+e,a.Type=n,a.Target=r,[It.HLINK,It.XPATH,It.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),t["!id"][a.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][a.Id]=a,t[("/"+a.Target).replace("//","/")]=a,e}var Wk="application/vnd.oasis.opendocument.spreadsheet";function Gk(t,e){for(var r=Pp(t),n,a;n=Ju.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=yt(n[0],!1),a.path=="/"&&a.type!==Wk)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function qk(t){var e=[Br];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function j_(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function Xk(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function Yk(t){var e=[Br];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(j_(t[r][0],t[r][1])),e.push(Xk("",t[r][0]));return e.push(j_("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function EE(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+yh.version+"</meta:generator></office:meta></office:document-meta>"}var Na=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Kk=(function(){for(var t=new Array(Na.length),e=0;e<Na.length;++e){var r=Na[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t})();function wE(t){var e={};t=fr(t);for(var r=0;r<Na.length;++r){var n=Na[r],a=t.match(Kk[r]);a!=null&&a.length>0&&(e[n[1]]=Wt(a[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=vr(e[n[1]]))}return e}function Sm(t,e,r,n,a){a[t]!=null||e==null||e===""||(a[t]=e,e=sr(e),n[n.length]=r?Ge(t,e,r):_n(t,e))}function SE(t,e){var r=e||{},n=[Br,Ge("cp:coreProperties",null,{"xmlns:cp":Qr.CORE_PROPS,"xmlns:dc":Qr.dc,"xmlns:dcterms":Qr.dcterms,"xmlns:dcmitype":Qr.dcmitype,"xmlns:xsi":Qr.xsi})],a={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&Sm("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Gm(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),t.ModifiedDate!=null&&Sm("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Gm(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var o=0;o!=Na.length;++o){var l=Na[o],u=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:t?t[l[1]]:null;u===!0?u="1":u===!1?u="0":typeof u=="number"&&(u=String(u)),u!=null&&Sm(l[0],u,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Bo=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],AE=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function kE(t,e,r,n){var a=[];if(typeof t=="string")a=I_(t,n);else for(var o=0;o<t.length;++o)a=a.concat(t[o].map(function(p){return{v:p}}));var l=typeof e=="string"?I_(e,n).map(function(p){return p.v}):e,u=0,h=0;if(l.length>0)for(var d=0;d!==a.length;d+=2){switch(h=+a[d+1].v,a[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=h,r.SheetNames=l.slice(u,u+h);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=h,r.DefinedNames=l.slice(u,u+h);break;case"Charts":case"Diagramme":r.Chartsheets=h,r.ChartNames=l.slice(u,u+h);break}u+=h}}function $k(t,e,r){var n={};return e||(e={}),t=fr(t),Bo.forEach(function(a){var o=(t.match(Qu(a[0]))||[])[1];switch(a[2]){case"string":o&&(e[a[1]]=Wt(o));break;case"bool":e[a[1]]=o==="true";break;case"raw":var l=t.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(n[a[1]]=l[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&kE(n.HeadingPairs,n.TitlesOfParts,e,r),e}function bE(t){var e=[],r=Ge;return t||(t={}),t.Application="SheetJS",e[e.length]=Br,e[e.length]=Ge("Properties",null,{xmlns:Qr.EXT_PROPS,"xmlns:vt":Qr.vt}),Bo.forEach(function(n){if(t[n[1]]!==void 0){var a;switch(n[2]){case"string":a=sr(String(t[n[1]]));break;case"bool":a=t[n[1]]?"true":"false";break}a!==void 0&&(e[e.length]=r(n[0],a))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+sr(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Qk=/<[^>]+>[^<]*/g;function Zk(t,e){var r={},n="",a=t.match(Qk);if(a)for(var o=0;o!=a.length;++o){var l=a[o],u=yt(l);switch(u[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Wt(u.name);break;case"</property>":n=null;break;default:if(l.indexOf("<vt:")===0){var h=l.split(">"),d=h[0].slice(4),p=h[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=Wt(p);break;case"bool":r[n]=gr(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(p,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(p);break;case"filetime":case"date":r[n]=vr(p);break;case"cy":case"error":r[n]=Wt(p);break;default:if(d.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",l,d,h)}}else if(l.slice(0,2)!=="</"){if(e.WTF)throw new Error(l)}}}return r}function CE(t){var e=[Br,Ge("Properties",null,{xmlns:Qr.CUST_PROPS,"xmlns:vt":Qr.vt})];if(!t)return e.join("");var r=1;return Ir(t).forEach(function(a){++r,e[e.length]=Ge("property",ok(t[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:sr(a)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var $m={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Am;function Jk(t,e,r){Am||(Am=Zh($m)),e=Am[e]||e,t[e]=r}function eb(t,e){var r=[];return Ir($m).map(function(n){for(var a=0;a<Na.length;++a)if(Na[a][1]==n)return Na[a];for(a=0;a<Bo.length;++a)if(Bo[a][1]==n)return Bo[a];throw n}).forEach(function(n){if(t[n[1]]!=null){var a=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(_n($m[n[1]]||n[1],a))}}),Ge("DocumentProperties",r.join(""),{xmlns:ca.o})}function tb(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return t&&Ir(t).forEach(function(o){if(Object.prototype.hasOwnProperty.call(t,o)){for(var l=0;l<Na.length;++l)if(o==Na[l][1])return;for(l=0;l<Bo.length;++l)if(o==Bo[l][1])return;for(l=0;l<r.length;++l)if(o==r[l])return;var u=t[o],h="string";typeof u=="number"?(h="float",u=String(u)):u===!0||u===!1?(h="boolean",u=u?"1":"0"):u=String(u),a.push(Ge(b_(o),u,{"dt:dt":h}))}}),e&&Ir(e).forEach(function(o){if(Object.prototype.hasOwnProperty.call(e,o)&&!(t&&Object.prototype.hasOwnProperty.call(t,o))){var l=e[o],u="string";typeof l=="number"?(u="float",l=String(l)):l===!0||l===!1?(u="boolean",l=l?"1":"0"):l instanceof Date?(u="dateTime.tz",l=l.toISOString()):l=String(l),a.push(Ge(b_(o),l,{"dt:dt":u}))}}),"<"+n+' xmlns="'+ca.o+'">'+a.join("")+"</"+n+">"}function Xp(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function rb(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var o=n/Math.pow(2,32)|0;o>0&&(n=n%Math.pow(2,32),a+=o);var l=we(8);return l.write_shift(4,n),l.write_shift(4,a),l}function RE(t,e,r){var n=t.l,a=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return a}function DE(t,e,r){var n=t.read_shift(0,"lpwstr");return n}function IE(t,e,r){return e===31?DE(t):RE(t,e,r)}function Qm(t,e,r){return IE(t,e,r===!1?0:4)}function nb(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return IE(t,e,0)}function ab(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var a=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Hn,""),t.l-a&2&&(t.l+=2)}return r}function ib(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Hn,"");return r}function sb(t){var e=t.l,r=Rh(t,_E);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Rh(t,$n);return[r,n]}function ob(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(sb(t));return r}function z_(t,e){for(var r=t.read_shift(4),n={},a=0;a!=r;++a){var o=t.read_shift(4),l=t.read_shift(4);n[o]=t.read_shift(l,e===1200?"utf16le":"utf8").replace(Hn,"").replace(Cu,"!"),e===1200&&l%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function OE(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function lb(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Rh(t,e,r){var n=t.read_shift(2),a,o=r||{};if(t.l+=2,e!==V_&&n!==e&&Vk.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===V_?n:e){case 2:return a=t.read_shift(2,"i"),o.raw||(t.l+=2),a;case 3:return a=t.read_shift(4,"i"),a;case 11:return t.read_shift(4)!==0;case 19:return a=t.read_shift(4),a;case 30:return RE(t,n,4).replace(Hn,"");case 31:return DE(t);case 64:return Xp(t);case 65:return OE(t);case 71:return lb(t);case 80:return Qm(t,n,!o.raw).replace(Hn,"");case 81:return nb(t,n).replace(Hn,"");case 4108:return ob(t);case 4126:case 4127:return n==4127?ab(t):ib(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function H_(t,e){var r=we(4),n=we(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=we(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=rb(e);break;case 31:case 80:for(n=we(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return cn([r,n])}function W_(t,e){var r=t.l,n=t.read_shift(4),a=t.read_shift(4),o=[],l=0,u=0,h=-1,d={};for(l=0;l!=a;++l){var p=t.read_shift(4),v=t.read_shift(4);o[l]=[p,v+r]}o.sort(function(z,O){return z[1]-O[1]});var _={};for(l=0;l!=a;++l){if(t.l!==o[l][1]){var y=!0;if(l>0&&e)switch(e[o[l-1][0]].t){case 2:t.l+2===o[l][1]&&(t.l+=2,y=!1);break;case 80:t.l<=o[l][1]&&(t.l=o[l][1],y=!1);break;case 4108:t.l<=o[l][1]&&(t.l=o[l][1],y=!1);break}if((!e||l==0)&&t.l<=o[l][1]&&(y=!1,t.l=o[l][1]),y)throw new Error("Read Error: Expected address "+o[l][1]+" at "+t.l+" :"+l)}if(e){var w=e[o[l][0]];if(_[w.n]=Rh(t,w.t,{raw:!0}),w.p==="version"&&(_[w.n]=String(_[w.n]>>16)+"."+("0000"+String(_[w.n]&65535)).slice(-4)),w.n=="CodePage")switch(_[w.n]){case 0:_[w.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ga(u=_[w.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+_[w.n])}}else if(o[l][0]===1){if(u=_.CodePage=Rh(t,Gp),Ga(u),h!==-1){var E=t.l;t.l=o[h][1],d=z_(t,u),t.l=E}}else if(o[l][0]===0){if(u===0){h=l,t.l=o[l+1][1];continue}d=z_(t,u)}else{var S=d[o[l][0]],L;switch(t[t.l]){case 65:t.l+=4,L=OE(t);break;case 30:t.l+=4,L=Qm(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,L=Qm(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,L=t.read_shift(4,"i");break;case 19:t.l+=4,L=t.read_shift(4);break;case 5:t.l+=4,L=t.read_shift(8,"f");break;case 11:t.l+=4,L=Mr(t,4);break;case 64:t.l+=4,L=vr(Xp(t));break;default:throw new Error("unparsed value: "+t[t.l])}_[S]=L}}return t.l=r+n,_}var FE=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function cb(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function G_(t,e,r){var n=we(8),a=[],o=[],l=8,u=0,h=we(8),d=we(8);if(h.write_shift(4,2),h.write_shift(4,1200),d.write_shift(4,1),o.push(h),a.push(d),l+=8+h.length,!e){d=we(8),d.write_shift(4,0),a.unshift(d);var p=[we(4)];for(p[0].write_shift(4,t.length),u=0;u<t.length;++u){var v=t[u][0];for(h=we(8+2*(v.length+1)+(v.length%2?0:2)),h.write_shift(4,u+2),h.write_shift(4,v.length+1),h.write_shift(0,v,"dbcs");h.l!=h.length;)h.write_shift(1,0);p.push(h)}h=cn(p),o.unshift(h),l+=8+h.length}for(u=0;u<t.length;++u)if(!(e&&!e[t[u][0]])&&!(FE.indexOf(t[u][0])>-1||AE.indexOf(t[u][0])>-1)&&t[u][1]!=null){var _=t[u][1],y=0;if(e){y=+e[t[u][0]];var w=r[y];if(w.p=="version"&&typeof _=="string"){var E=_.split(".");_=(+E[0]<<16)+(+E[1]||0)}h=H_(w.t,_)}else{var S=cb(_);S==-1&&(S=31,_=String(_)),h=H_(S,_)}o.push(h),d=we(8),d.write_shift(4,e?y:2+u),a.push(d),l+=8+h.length}var L=8*(o.length+1);for(u=0;u<o.length;++u)a[u].write_shift(4,L),L+=o[u].length;return n.write_shift(4,l),n.write_shift(4,o.length),cn([n].concat(a).concat(o))}function q_(t,e,r){var n=t.content;if(!n)return{};vn(n,0);var a,o,l,u,h=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),p=n.read_shift(16);if(p!==ot.utils.consts.HEADER_CLSID&&p!==r)throw new Error("Bad PropertySet CLSID "+p);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(o=n.read_shift(16),u=n.read_shift(4),a===1&&u!==n.l)throw new Error("Length mismatch: "+u+" !== "+n.l);a===2&&(l=n.read_shift(16),h=n.read_shift(4));var v=W_(n,e),_={SystemIdentifier:d};for(var y in v)_[y]=v[y];if(_.FMTID=o,a===1)return _;if(h-n.l==2&&(n.l+=2),n.l!==h)throw new Error("Length mismatch 2: "+n.l+" !== "+h);var w;try{w=W_(n,null)}catch{}for(y in w)_[y]=w[y];return _.FMTID=[o,l],_}function X_(t,e,r,n,a,o){var l=we(a?68:48),u=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,ot.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,a?2:1),l.write_shift(16,e,"hex"),l.write_shift(4,a?68:48);var h=G_(t,r,n);if(u.push(h),a){var d=G_(a,null,null);l.write_shift(16,o,"hex"),l.write_shift(4,68+h.length),u.push(d)}return cn(u)}function Ms(t,e){return t.read_shift(e),null}function ub(t,e){e||(e=we(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function fb(t,e,r){for(var n=[],a=t.l+e;t.l<a;)n.push(r(t,a-t.l));if(a!==t.l)throw new Error("Slurp error");return n}function Mr(t,e){return t.read_shift(e)===1}function zn(t,e){return e||(e=we(2)),e.write_shift(2,+!!t),e}function Gr(t){return t.read_shift(2,"u")}function Ia(t,e){return e||(e=we(2)),e.write_shift(2,t),e}function NE(t,e){return fb(t,e,Gr)}function hb(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function ME(t,e,r){return r||(r=we(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function Tf(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var o=t.read_shift(1);o&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var l=n?t.read_shift(n,a):"";return l}function db(t){var e=t.read_shift(2),r=t.read_shift(1),n=r&4,a=r&8,o=1+(r&1),l=0,u,h={};a&&(l=t.read_shift(2)),n&&(u=t.read_shift(4));var d=o==2?"dbcs-cont":"sbcs-cont",p=e===0?"":t.read_shift(e,d);return a&&(t.l+=4*l),n&&(t.l+=u),h.t=p,a||(h.raw="<t>"+h.t+"</t>",h.r=h.t),h}function mb(t){var e=t.t||"",r=we(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=we(2*e.length);n.write_shift(2*e.length,e,"utf16le");var a=[r,n];return cn(a)}function Go(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var a=t.read_shift(1);return a===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Ef(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Go(t,n,r)}function tl(t,e,r){if(r.biff>5)return Ef(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function PE(t,e,r){return r||(r=we(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function pb(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function gb(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var a=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Hn,"");return n&&(t.l+=24),a}function xb(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=t.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var o=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=t.read_shift(o>>1,"utf16le").replace(Hn,"");return r+l}function vb(t,e){var r=t.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return gb(t);case"0303000000000000c000000000000046":return xb(t);default:throw new Error("Unsupported Moniker "+r)}}function J0(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Hn,""):"";return r}function Y_(t,e){e||(e=we(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function _b(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=t.read_shift(2);t.l+=2;var o,l,u,h,d="",p,v;a&16&&(o=J0(t,r-t.l)),a&128&&(l=J0(t,r-t.l)),(a&257)===257&&(u=J0(t,r-t.l)),(a&257)===1&&(h=vb(t,r-t.l)),a&8&&(d=J0(t,r-t.l)),a&32&&(p=t.read_shift(16)),a&64&&(v=Xp(t)),t.l=r;var _=l||u||h||"";_&&d&&(_+="#"+d),_||(_="#"+d),a&2&&_.charAt(0)=="/"&&_.charAt(1)!="/"&&(_="file://"+_);var y={Target:_};return p&&(y.guid=p),v&&(y.time=v),o&&(y.Tooltip=o),y}function yb(t){var e=we(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),o=a>-1?31:23;switch(n.charAt(0)){case"#":o=28;break;case".":o&=-3;break}e.write_shift(4,2),e.write_shift(4,o);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)e.write_shift(4,l[r]);if(o==28)n=n.slice(1),Y_(n,e);else if(o&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)e.write_shift(1,parseInt(l[r],16));var u=a>-1?n.slice(0,a):n;for(e.write_shift(4,2*(u.length+1)),r=0;r<u.length;++r)e.write_shift(2,u.charCodeAt(r));e.write_shift(2,0),o&8&&Y_(a>-1?n.slice(a+1):"",e)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)e.write_shift(1,parseInt(l[r],16));for(var h=0;n.slice(h*3,h*3+3)=="../"||n.slice(h*3,h*3+3)=="..\\";)++h;for(e.write_shift(2,h),e.write_shift(4,n.length-3*h+1),r=0;r<n.length-3*h;++r)e.write_shift(1,n.charCodeAt(r+3*h)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function LE(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),a=t.read_shift(1);return[e,r,n,a]}function BE(t,e){var r=LE(t);return r[3]=0,r}function ki(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function qo(t,e,r,n){return n||(n=we(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function Tb(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function Eb(t,e,r){return e===0?"":tl(t,e,r)}function wb(t,e,r){var n=r.biff>8?4:2,a=t.read_shift(n),o=t.read_shift(n,"i"),l=t.read_shift(n,"i");return[a,o,l]}function VE(t){var e=t.read_shift(2),r=Wp(t);return[e,r]}function Sb(t,e,r){t.l+=4,e-=4;var n=t.l+e,a=Tf(t,e,r),o=t.read_shift(2);if(n-=t.l,o!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+o);return t.l+=o,a}function td(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2);return{s:{c:n,r:e},e:{c:a,r}}}function UE(t,e){return e||(e=we(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function jE(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),a=t.read_shift(1);return{s:{c:n,r:e},e:{c:a,r}}}var Ab=jE;function zE(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function kb(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function bb(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function An(t){t.l+=2,t.l+=t.read_shift(2)}var Cb={0:An,4:An,5:An,6:An,7:bb,8:An,9:An,10:An,11:An,12:An,13:kb,14:An,15:An,16:An,17:An,18:An,19:An,20:An,21:zE};function Rb(t,e){for(var r=t.l+e,n=[];t.l<r;){var a=t.read_shift(2);t.l-=2;try{n.push(Cb[a](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function eh(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function Yp(t,e,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var o=we(a);return o.write_shift(2,n),o.write_shift(2,e),a>4&&o.write_shift(2,29282),a>6&&o.write_shift(2,1997),a>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function Db(t,e){return e===0||t.read_shift(2),1200}function Ib(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,a=tl(t,0,r);return t.read_shift(e+n-t.l),a}function Ob(t,e){var r=!e||e.biff==8,n=we(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function Fb(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function Nb(t,e,r){var n=t.read_shift(4),a=t.read_shift(1)&3,o=t.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var l=Tf(t,0,r);return l.length===0&&(l="Sheet1"),{pos:n,hs:a,dt:o,name:l}}function Mb(t,e){var r=!e||e.biff>=8?2:1,n=we(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function Pb(t,e){for(var r=t.l+e,n=t.read_shift(4),a=t.read_shift(4),o=[],l=0;l!=a&&t.l<r;++l)o.push(db(t));return o.Count=n,o.Unique=a,o}function Lb(t,e){var r=we(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],a=0;a<t.length;++a)n[a]=mb(t[a]);var o=cn([r].concat(n));return o.parts=[r.length].concat(n.map(function(l){return l.length})),o}function Bb(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function Vb(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function Ub(t){var e=Tb(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function jb(t){return t.read_shift(2),t.read_shift(4)}function K_(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var a=t.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var o={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[o,a]}function zb(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),u=t.read_shift(2),h=t.read_shift(2),d=t.read_shift(2);return{Pos:[e,r],Dim:[n,a],Flags:o,CurTab:l,FirstTab:u,Selected:h,TabRatio:d}}function Hb(){var t=we(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function Wb(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function Gb(t){var e=we(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function qb(){}function Xb(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Tf(t,0,r),n}function Yb(t,e){var r=t.name||"Arial",n=e&&e.biff==5,a=n?15+r.length:16+2*r.length,o=we(a);return o.write_shift(2,t.sz*20),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,r.length),n||o.write_shift(1,1),o.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),o}function Kb(t){var e=ki(t);return e.isst=t.read_shift(4),e}function $b(t,e,r,n){var a=we(10);return qo(t,e,n,a),a.write_shift(4,r),a}function Qb(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,a=ki(t);r.biff==2&&t.l++;var o=Ef(t,n-t.l,r);return a.val=o,a}function Zb(t,e,r,n,a){var o=!a||a.biff==8,l=we(8+ +o+(1+o)*r.length);return qo(t,e,n,l),l.write_shift(2,r.length),o&&l.write_shift(1,1),l.write_shift((1+o)*r.length,r,o?"utf16le":"sbcs"),l}function Jb(t,e,r){var n=t.read_shift(2),a=tl(t,0,r);return[n,a]}function eC(t,e,r,n){var a=r&&r.biff==5;n||(n=we(a?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(a?1:2,e.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*e.length,e,a?"sbcs":"utf16le");var o=n.length>n.l?n.slice(0,n.l):n;return o.l==null&&(o.l=o.length),o}var tC=tl;function $_(t,e,r){var n=t.l+e,a=r.biff==8||!r.biff?4:2,o=t.read_shift(a),l=t.read_shift(a),u=t.read_shift(2),h=t.read_shift(2);return t.l=n,{s:{r:o,c:u},e:{r:l,c:h}}}function rC(t,e){var r=e.biff==8||!e.biff?4:2,n=we(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function nC(t){var e=t.read_shift(2),r=t.read_shift(2),n=VE(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function aC(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),o=[];t.l<r;)o.push(VE(t));if(t.l!==r)throw new Error("MulRK read error");var l=t.read_shift(2);if(o.length!=l-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:l,rkrec:o}}function iC(t,e){for(var r=t.l+e-2,n=t.read_shift(2),a=t.read_shift(2),o=[];t.l<r;)o.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var l=t.read_shift(2);if(o.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:l,ixfe:o}}function sC(t,e,r,n){var a={},o=t.read_shift(4),l=t.read_shift(4),u=t.read_shift(4),h=t.read_shift(2);return a.patternType=Uk[u>>26],n.cellStyles&&(a.alc=o&7,a.fWrap=o>>3&1,a.alcV=o>>4&7,a.fJustLast=o>>7&1,a.trot=o>>8&255,a.cIndent=o>>16&15,a.fShrinkToFit=o>>20&1,a.iReadOrder=o>>22&2,a.fAtrNum=o>>26&1,a.fAtrFnt=o>>27&1,a.fAtrAlc=o>>28&1,a.fAtrBdr=o>>29&1,a.fAtrPat=o>>30&1,a.fAtrProt=o>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=u&127,a.icvBottom=u>>7&127,a.icvDiag=u>>14&127,a.dgDiag=u>>21&15,a.icvFore=h&127,a.icvBack=h>>7&127,a.fsxButton=h>>14&1),a}function oC(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=sC(t,e,n.fStyle,r),n}function Q_(t,e,r,n){var a=r&&r.biff==5;n||(n=we(a?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var o=0;return t.numFmtId>0&&a&&(o|=1024),n.write_shift(4,o),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function lC(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function cC(t){var e=we(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function Z_(t,e,r){var n=ki(t);(r.biff==2||e==9)&&++t.l;var a=hb(t);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function uC(t,e,r,n,a,o){var l=we(8);return qo(t,e,n,l),ME(r,o,l),l}function fC(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=ki(t),a=On(t);return n.val=a,n}function hC(t,e,r,n){var a=we(14);return qo(t,e,n,a),Wo(r,a),a}var J_=Eb;function dC(t,e,r){var n=t.l+e,a=t.read_shift(2),o=t.read_shift(2);if(r.sbcch=o,o==1025||o==14849)return[o,a];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var l=Go(t,o),u=[];n>t.l;)u.push(Ef(t));return[o,a,l,u]}function ey(t,e,r){var n=t.read_shift(2),a,o={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=Sb(t,e-2,r)),o.body=a||t.read_shift(e-2),typeof a=="string"&&(o.Name=a),o}var mC=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function ty(t,e,r){var n=t.l+e,a=t.read_shift(2),o=t.read_shift(1),l=t.read_shift(1),u=t.read_shift(r&&r.biff==2?1:2),h=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),h=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var d=Go(t,l,r);a&32&&(d=mC[d.charCodeAt(0)]);var p=n-t.l;r&&r.biff==2&&--p;var v=n==t.l||u===0||!(p>0)?[]:R8(t,p,r,u);return{chKey:o,Name:d,itab:h,rgce:v}}function HE(t,e,r){if(r.biff<8)return pC(t,e,r);for(var n=[],a=t.l+e,o=t.read_shift(r.biff>8?4:2);o--!==0;)n.push(wb(t,r.biff>8?12:6,r));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return n}function pC(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Tf(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function gC(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),a=t.read_shift(2),o=Go(t,n,r),l=Go(t,a,r);return[o,l]}function xC(t,e,r){var n=jE(t);t.l++;var a=t.read_shift(1);return e-=8,[D8(t,e,r),a,n]}function ry(t,e,r){var n=Ab(t);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,b8(t,e,r)]}function vC(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function _C(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),l=t.read_shift(2),u=tl(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:a},u,l,o]}}function yC(t,e,r){return _C(t,e,r)}function TC(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(td(t));return r}function EC(t){var e=we(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)UE(t[r],e);return e}function wC(t,e,r){if(r&&r.biff<8)return AC(t,e,r);var n=zE(t),a=Rb(t,e-22,n[1]);return{cmo:n,ft:a}}var SC={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var a=t.read_shift(1);return t.l+=a,t.l=r,{fmt:n}}};function AC(t,e,r){t.l+=4;var n=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var l=[];return l.push((SC[n]||Nn)(t,e,r)),{cmo:[a,n,o],ft:l}}function kC(t,e,r){var n=t.l,a="";try{t.l+=4;var o=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(o)==-1?t.l+=6:l=pb(t,6,r);var u=t.read_shift(2);t.read_shift(2),Gr(t,2);var h=t.read_shift(2);t.l+=h;for(var d=1;d<t.lens.length-1;++d){if(t.l-n!=t.lens[d])throw new Error("TxO: bad continue record");var p=t[t.l],v=Go(t,t.lens[d+1]-t.lens[d]-1);if(a+=v,a.length>=(p?u:2*u))break}if(a.length!==u&&a.length!==u*2)throw new Error("cchText: "+u+" != "+a.length);return t.l=n+e,{t:a}}catch{return t.l=n+e,{t:a}}}function bC(t,e){var r=td(t);t.l+=16;var n=_b(t,e-24);return[r,n]}function CC(t){var e=we(24),r=Ar(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)e.write_shift(1,parseInt(n[a],16));return cn([e,yb(t[1])])}function RC(t,e){t.read_shift(2);var r=td(t),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Hn,""),[r,n]}function DC(t){var e=t[1].Tooltip,r=we(10+2*(e.length+1));r.write_shift(2,2048);var n=Ar(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<e.length;++a)r.write_shift(2,e.charCodeAt(a));return r.write_shift(2,0),r}function IC(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=U_[r]||r,r=t.read_shift(2),e[1]=U_[r]||r,e}function OC(t){return t||(t=we(4)),t.write_shift(2,1),t.write_shift(2,1),t}function FC(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(BE(t));return r}function NC(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(BE(t));return r}function MC(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function WE(t,e,r){if(!r.cellStyles)return Nn(t,e);var n=r&&r.biff>=12?4:2,a=t.read_shift(n),o=t.read_shift(n),l=t.read_shift(n),u=t.read_shift(n),h=t.read_shift(2);n==2&&(t.l+=2);var d={s:a,e:o,w:l,ixfe:u,flags:h};return(r.biff>=5||!r.biff)&&(d.level=h>>8&7),d}function PC(t,e){var r=we(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function LC(t,e){var r={};return e<32||(t.l+=16,r.header=On(t),r.footer=On(t),t.l+=2),r}function BC(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var a=t.read_shift(1);return t.l+=3,a&16&&(n.area=!0),n}function VC(t){for(var e=we(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var UC=ki,jC=NE,zC=Ef;function HC(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,a}function WC(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=ki(t);++t.l;var a=tl(t,e-7,r);return n.t="str",n.val=a,n}function GC(t){var e=ki(t);++t.l;var r=On(t);return e.t="n",e.val=r,e}function qC(t,e,r){var n=we(15);return kf(n,t,e),n.write_shift(8,r,"f"),n}function XC(t){var e=ki(t);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function YC(t,e,r){var n=we(9);return kf(n,t,e),n.write_shift(2,r),n}function KC(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function $C(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function QC(t,e,r){var n=t.l+e,a=ki(t),o=t.read_shift(2),l=Go(t,o,r);return t.l=n,a.t="str",a.val=l,a}var ZC=[2,3,48,49,131,139,140,245],Zm=(function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Zh({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(u,h){var d=[],p=Gs(1);switch(h.type){case"base64":p=fa(da(u));break;case"binary":p=fa(u);break;case"buffer":case"array":p=u;break}vn(p,0);var v=p.read_shift(1),_=!!(v&136),y=!1,w=!1;switch(v){case 2:break;case 3:break;case 48:y=!0,_=!0;break;case 49:y=!0,_=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var E=0,S=521;v==2&&(E=p.read_shift(2)),p.l+=3,v!=2&&(E=p.read_shift(4)),E>1048576&&(E=1e6),v!=2&&(S=p.read_shift(2));var L=p.read_shift(2),z=h.codepage||1252;v!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(z=t[p[p.l]]),p.l+=1,p.l+=2),w&&(p.l+=36);for(var O=[],ee={},te=Math.min(p.length,v==2?521:S-10-(y?264:0)),Z=w?32:11;p.l<te&&p[p.l]!=13;)switch(ee={},ee.name=Yu.utils.decode(z,p.slice(p.l,p.l+Z)).replace(/[\u0000\r\n].*$/g,""),p.l+=Z,ee.type=String.fromCharCode(p.read_shift(1)),v!=2&&!w&&(ee.offset=p.read_shift(4)),ee.len=p.read_shift(1),v==2&&(ee.offset=p.read_shift(2)),ee.dec=p.read_shift(1),ee.name.length&&O.push(ee),v!=2&&(p.l+=w?13:14),ee.type){case"B":(!y||ee.len!=8)&&h.WTF&&console.log("Skipping "+ee.name+":"+ee.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+ee.name+":"+ee.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+ee.type)}if(p[p.l]!==13&&(p.l=S-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=S;var C=0,I=0;for(d[0]=[],I=0;I!=O.length;++I)d[0][I]=O[I].name;for(;E-- >0;){if(p[p.l]===42){p.l+=L;continue}for(++p.l,d[++C]=[],I=0,I=0;I!=O.length;++I){var R=p.slice(p.l,p.l+O[I].len);p.l+=O[I].len,vn(R,0);var B=Yu.utils.decode(z,R);switch(O[I].type){case"C":B.trim().length&&(d[C][I]=B.replace(/\s+$/,""));break;case"D":B.length===8?d[C][I]=new Date(+B.slice(0,4),+B.slice(4,6)-1,+B.slice(6,8)):d[C][I]=B;break;case"F":d[C][I]=parseFloat(B.trim());break;case"+":case"I":d[C][I]=w?R.read_shift(-4,"i")^2147483648:R.read_shift(4,"i");break;case"L":switch(B.trim().toUpperCase()){case"Y":case"T":d[C][I]=!0;break;case"N":case"F":d[C][I]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+B+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));d[C][I]="##MEMO##"+(w?parseInt(B.trim(),10):R.read_shift(4));break;case"N":B=B.replace(/\u0000/g,"").trim(),B&&B!="."&&(d[C][I]=+B||0);break;case"@":d[C][I]=new Date(R.read_shift(-8,"f")-621356832e5);break;case"T":d[C][I]=new Date((R.read_shift(4)-2440588)*864e5+R.read_shift(4));break;case"Y":d[C][I]=R.read_shift(4,"i")/1e4+R.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[C][I]=-R.read_shift(-8,"f");break;case"B":if(y&&O[I].len==8){d[C][I]=R.read_shift(8,"f");break}case"G":case"P":R.l+=O[I].len;break;case"0":if(O[I].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+O[I].type)}}}if(v!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return h&&h.sheetRows&&(d=d.slice(0,h.sheetRows)),h.DBF=O,d}function n(u,h){var d=h||{};d.dateNF||(d.dateNF="yyyymmdd");var p=_c(r(u,d),d);return p["!cols"]=d.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete d.DBF,p}function a(u,h){try{return ro(n(u,h),h)}catch(d){if(h&&h.WTF)throw d}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function l(u,h){var d=h||{};if(+d.codepage>=0&&Ga(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var p=Zn(),v=Oh(u,{header:1,raw:!0,cellDates:!0}),_=v[0],y=v.slice(1),w=u["!cols"]||[],E=0,S=0,L=0,z=1;for(E=0;E<_.length;++E){if(((w[E]||{}).DBF||{}).name){_[E]=w[E].DBF.name,++L;continue}if(_[E]!=null){if(++L,typeof _[E]=="number"&&(_[E]=_[E].toString(10)),typeof _[E]!="string")throw new Error("DBF Invalid column name "+_[E]+" |"+typeof _[E]+"|");if(_.indexOf(_[E])!==E){for(S=0;S<1024;++S)if(_.indexOf(_[E]+"_"+S)==-1){_[E]+="_"+S;break}}}}var O=Gt(u["!ref"]),ee=[],te=[],Z=[];for(E=0;E<=O.e.c-O.s.c;++E){var C="",I="",R=0,B=[];for(S=0;S<y.length;++S)y[S][E]!=null&&B.push(y[S][E]);if(B.length==0||_[E]==null){ee[E]="?";continue}for(S=0;S<B.length;++S){switch(typeof B[S]){case"number":I="B";break;case"string":I="C";break;case"boolean":I="L";break;case"object":I=B[S]instanceof Date?"D":"C";break;default:I="C"}R=Math.max(R,String(B[S]).length),C=C&&C!=I?"C":I}R>250&&(R=250),I=((w[E]||{}).DBF||{}).type,I=="C"&&w[E].DBF.len>R&&(R=w[E].DBF.len),C=="B"&&I=="N"&&(C="N",Z[E]=w[E].DBF.dec,R=w[E].DBF.len),te[E]=C=="C"||I=="N"?R:o[C]||0,z+=te[E],ee[E]=C}var D=p.next(32);for(D.write_shift(4,318902576),D.write_shift(4,y.length),D.write_shift(2,296+32*L),D.write_shift(2,z),E=0;E<4;++E)D.write_shift(4,0);for(D.write_shift(4,0|(+e[FT]||3)<<8),E=0,S=0;E<_.length;++E)if(_[E]!=null){var F=p.next(32),M=(_[E].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);F.write_shift(1,M,"sbcs"),F.write_shift(1,ee[E]=="?"?"C":ee[E],"sbcs"),F.write_shift(4,S),F.write_shift(1,te[E]||o[ee[E]]||0),F.write_shift(1,Z[E]||0),F.write_shift(1,2),F.write_shift(4,0),F.write_shift(1,0),F.write_shift(4,0),F.write_shift(4,0),S+=te[E]||o[ee[E]]||0}var Fe=p.next(264);for(Fe.write_shift(4,13),E=0;E<65;++E)Fe.write_shift(4,0);for(E=0;E<y.length;++E){var Se=p.next(z);for(Se.write_shift(1,0),S=0;S<_.length;++S)if(_[S]!=null)switch(ee[S]){case"L":Se.write_shift(1,y[E][S]==null?63:y[E][S]?84:70);break;case"B":Se.write_shift(8,y[E][S]||0,"f");break;case"N":var ne="0";for(typeof y[E][S]=="number"&&(ne=y[E][S].toFixed(Z[S]||0)),L=0;L<te[S]-ne.length;++L)Se.write_shift(1,32);Se.write_shift(1,ne,"sbcs");break;case"D":y[E][S]?(Se.write_shift(4,("0000"+y[E][S].getFullYear()).slice(-4),"sbcs"),Se.write_shift(2,("00"+(y[E][S].getMonth()+1)).slice(-2),"sbcs"),Se.write_shift(2,("00"+y[E][S].getDate()).slice(-2),"sbcs")):Se.write_shift(8,"00000000","sbcs");break;case"C":var se=String(y[E][S]!=null?y[E][S]:"").slice(0,te[S]);for(Se.write_shift(1,se,"sbcs"),L=0;L<te[S]-se.length;++L)Se.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:a,to_sheet:n,from_sheet:l}})(),GE=(function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Ir(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(_,y){var w=t[y];return typeof w=="number"?d_(w):w},n=function(_,y,w){var E=y.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return E==59?_:d_(E)};t["|"]=254;function a(_,y){switch(y.type){case"base64":return o(da(_),y);case"binary":return o(_,y);case"buffer":return o(Rt&&Buffer.isBuffer(_)?_.toString("binary"):to(_),y);case"array":return o(Ho(_),y)}throw new Error("Unrecognized type "+y.type)}function o(_,y){var w=_.split(/[\n\r]+/),E=-1,S=-1,L=0,z=0,O=[],ee=[],te=null,Z={},C=[],I=[],R=[],B=0,D;for(+y.codepage>=0&&Ga(+y.codepage);L!==w.length;++L){B=0;var F=w[L].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),M=F.replace(/;;/g,"\0").split(";").map(function(J){return J.replace(/\u0000/g,";")}),Fe=M[0],Se;if(F.length>0)switch(Fe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":M[1].charAt(0)=="P"&&ee.push(F.slice(3).replace(/;;/g,";"));break;case"C":var ne=!1,se=!1,Le=!1,ae=!1,W=-1,pe=-1;for(z=1;z<M.length;++z)switch(M[z].charAt(0)){case"A":break;case"X":S=parseInt(M[z].slice(1))-1,se=!0;break;case"Y":for(E=parseInt(M[z].slice(1))-1,se||(S=0),D=O.length;D<=E;++D)O[D]=[];break;case"K":Se=M[z].slice(1),Se.charAt(0)==='"'?Se=Se.slice(1,Se.length-1):Se==="TRUE"?Se=!0:Se==="FALSE"?Se=!1:isNaN(Ya(Se))?isNaN(lc(Se).getDate())||(Se=vr(Se)):(Se=Ya(Se),te!==null&&xc(te)&&(Se=ed(Se))),ne=!0;break;case"E":ae=!0;var V=ac(M[z].slice(1),{r:E,c:S});O[E][S]=[O[E][S],V];break;case"S":Le=!0,O[E][S]=[O[E][S],"S5S"];break;case"G":break;case"R":W=parseInt(M[z].slice(1))-1;break;case"C":pe=parseInt(M[z].slice(1))-1;break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+F)}if(ne&&(O[E][S]&&O[E][S].length==2?O[E][S][0]=Se:O[E][S]=Se,te=null),Le){if(ae)throw new Error("SYLK shared formula cannot have own formula");var Y=W>-1&&O[W][pe];if(!Y||!Y[1])throw new Error("SYLK shared formula cannot find base");O[E][S][1]=cw(Y[1],{r:E-W,c:S-pe})}break;case"F":var Q=0;for(z=1;z<M.length;++z)switch(M[z].charAt(0)){case"X":S=parseInt(M[z].slice(1))-1,++Q;break;case"Y":for(E=parseInt(M[z].slice(1))-1,D=O.length;D<=E;++D)O[D]=[];break;case"M":B=parseInt(M[z].slice(1))/20;break;case"F":break;case"G":break;case"P":te=ee[parseInt(M[z].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(R=M[z].slice(1).split(" "),D=parseInt(R[0],10);D<=parseInt(R[1],10);++D)B=parseInt(R[2],10),I[D-1]=B===0?{hidden:!0}:{wch:B},qs(I[D-1]);break;case"C":S=parseInt(M[z].slice(1))-1,I[S]||(I[S]={});break;case"R":E=parseInt(M[z].slice(1))-1,C[E]||(C[E]={}),B>0?(C[E].hpt=B,C[E].hpx=uc(B)):B===0&&(C[E].hidden=!0);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+F)}Q<1&&(te=null);break;default:if(y&&y.WTF)throw new Error("SYLK bad record "+F)}}return C.length>0&&(Z["!rows"]=C),I.length>0&&(Z["!cols"]=I),y&&y.sheetRows&&(O=O.slice(0,y.sheetRows)),[O,Z]}function l(_,y){var w=a(_,y),E=w[0],S=w[1],L=_c(E,y);return Ir(S).forEach(function(z){L[z]=S[z]}),L}function u(_,y){return ro(l(_,y),y)}function h(_,y,w,E){var S="C;Y"+(w+1)+";X"+(E+1)+";K";switch(_.t){case"n":S+=_.v||0,_.f&&!_.F&&(S+=";E"+eg(_.f,{r:w,c:E}));break;case"b":S+=_.v?"TRUE":"FALSE";break;case"e":S+=_.w||_.v;break;case"d":S+='"'+(_.w||_.v)+'"';break;case"s":S+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function d(_,y){y.forEach(function(w,E){var S="F;W"+(E+1)+" "+(E+1)+" ";w.hidden?S+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=rf(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=nf(w.wpx)),typeof w.wch=="number"&&(S+=Math.round(w.wch))),S.charAt(S.length-1)!=" "&&_.push(S)})}function p(_,y){y.forEach(function(w,E){var S="F;";w.hidden?S+="M0;":w.hpt?S+="M"+20*w.hpt+";":w.hpx&&(S+="M"+20*af(w.hpx)+";"),S.length>2&&_.push(S+"R"+(E+1))})}function v(_,y){var w=["ID;PWXL;N;E"],E=[],S=Gt(_["!ref"]),L,z=Array.isArray(_),O=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),_["!cols"]&&d(w,_["!cols"]),_["!rows"]&&p(w,_["!rows"]),w.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var ee=S.s.r;ee<=S.e.r;++ee)for(var te=S.s.c;te<=S.e.c;++te){var Z=gt({r:ee,c:te});L=z?(_[ee]||[])[te]:_[Z],!(!L||L.v==null&&(!L.f||L.F))&&E.push(h(L,_,ee,te))}return w.join(O)+O+E.join(O)+O+"E"+O}return{to_workbook:u,to_sheet:l,from_sheet:v}})(),qE=(function(){function t(o,l){switch(l.type){case"base64":return e(da(o),l);case"binary":return e(o,l);case"buffer":return e(Rt&&Buffer.isBuffer(o)?o.toString("binary"):to(o),l);case"array":return e(Ho(o),l)}throw new Error("Unrecognized type "+l.type)}function e(o,l){for(var u=o.split(`
`),h=-1,d=-1,p=0,v=[];p!==u.length;++p){if(u[p].trim()==="BOT"){v[++h]=[],d=0;continue}if(!(h<0)){var _=u[p].trim().split(","),y=_[0],w=_[1];++p;for(var E=u[p]||"";(E.match(/["]/g)||[]).length&1&&p<u.length-1;)E+=`
`+u[++p];switch(E=E.trim(),+y){case-1:if(E==="BOT"){v[++h]=[],d=0;continue}else if(E!=="EOD")throw new Error("Unrecognized DIF special command "+E);break;case 0:E==="TRUE"?v[h][d]=!0:E==="FALSE"?v[h][d]=!1:isNaN(Ya(w))?isNaN(lc(w).getDate())?v[h][d]=w:v[h][d]=vr(w):v[h][d]=Ya(w),++d;break;case 1:E=E.slice(1,E.length-1),E=E.replace(/""/g,'"'),E&&E.match(/^=".*"$/)&&(E=E.slice(2,-1)),v[h][d++]=E!==""?E:null;break}if(E==="EOD")break}}return l&&l.sheetRows&&(v=v.slice(0,l.sheetRows)),v}function r(o,l){return _c(t(o,l),l)}function n(o,l){return ro(r(o,l),l)}var a=(function(){var o=function(h,d,p,v,_){h.push(d),h.push(p+","+v),h.push('"'+_.replace(/"/g,'""')+'"')},l=function(h,d,p,v){h.push(d+","+p),h.push(d==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(h){var d=[],p=Gt(h["!ref"]),v,_=Array.isArray(h);o(d,"TABLE",0,1,"sheetjs"),o(d,"VECTORS",0,p.e.r-p.s.r+1,""),o(d,"TUPLES",0,p.e.c-p.s.c+1,""),o(d,"DATA",0,0,"");for(var y=p.s.r;y<=p.e.r;++y){l(d,-1,0,"BOT");for(var w=p.s.c;w<=p.e.c;++w){var E=gt({r:y,c:w});if(v=_?(h[y]||[])[w]:h[E],!v){l(d,1,0,"");continue}switch(v.t){case"n":var S=v.w;!S&&v.v!=null&&(S=v.v),S==null?v.f&&!v.F?l(d,1,0,"="+v.f):l(d,1,0,""):l(d,0,S,"V");break;case"b":l(d,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":l(d,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=Ma(v.z||pt[14],en(vr(v.v)))),l(d,0,v.w,"V");break;default:l(d,1,0,"")}}}l(d,-1,0,"EOD");var L=`\r
`,z=d.join(L);return z}})();return{to_workbook:n,to_sheet:r,from_sheet:a}})(),XE=(function(){function t(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(v,_){for(var y=v.split(`
`),w=-1,E=-1,S=0,L=[];S!==y.length;++S){var z=y[S].trim().split(":");if(z[0]==="cell"){var O=Ar(z[1]);if(L.length<=O.r)for(w=L.length;w<=O.r;++w)L[w]||(L[w]=[]);switch(w=O.r,E=O.c,z[2]){case"t":L[w][E]=t(z[3]);break;case"v":L[w][E]=+z[3];break;case"vtf":var ee=z[z.length-1];case"vtc":switch(z[3]){case"nl":L[w][E]=!!+z[4];break;default:L[w][E]=+z[4];break}z[2]=="vtf"&&(L[w][E]=[L[w][E],ee])}}}return _&&_.sheetRows&&(L=L.slice(0,_.sheetRows)),L}function n(v,_){return _c(r(v,_),_)}function a(v,_){return ro(n(v,_),_)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,u=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function d(v){if(!v||!v["!ref"])return"";for(var _=[],y=[],w,E="",S=Jn(v["!ref"]),L=Array.isArray(v),z=S.s.r;z<=S.e.r;++z)for(var O=S.s.c;O<=S.e.c;++O)if(E=gt({r:z,c:O}),w=L?(v[z]||[])[O]:v[E],!(!w||w.v==null||w.t==="z")){switch(y=["cell",E,"t"],w.t){case"s":case"str":y.push(e(w.v));break;case"n":w.f?(y[2]="vtf",y[3]="n",y[4]=w.v,y[5]=e(w.f)):(y[2]="v",y[3]=w.v);break;case"b":y[2]="vt"+(w.f?"f":"c"),y[3]="nl",y[4]=w.v?"1":"0",y[5]=e(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var ee=en(vr(w.v));y[2]="vtc",y[3]="nd",y[4]=""+ee,y[5]=w.w||Ma(w.z||pt[14],ee);break;case"e":continue}_.push(y.join(":"))}return _.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function p(v){return[o,l,u,l,d(v),h].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:p}})(),cc=(function(){function t(p,v,_,y,w){w.raw?v[_][y]=p:p===""||(p==="TRUE"?v[_][y]=!0:p==="FALSE"?v[_][y]=!1:isNaN(Ya(p))?isNaN(lc(p).getDate())?v[_][y]=p:v[_][y]=vr(p):v[_][y]=Ya(p))}function e(p,v){var _=v||{},y=[];if(!p||p.length===0)return y;for(var w=p.split(/[\r\n]/),E=w.length-1;E>=0&&w[E].length===0;)--E;for(var S=10,L=0,z=0;z<=E;++z)L=w[z].indexOf(" "),L==-1?L=w[z].length:L++,S=Math.max(S,L);for(z=0;z<=E;++z){y[z]=[];var O=0;for(t(w[z].slice(0,S).trim(),y,z,O,_),O=1;O<=(w[z].length-S)/10+1;++O)t(w[z].slice(S+(O-1)*10,S+O*10).trim(),y,z,O,_)}return _.sheetRows&&(y=y.slice(0,_.sheetRows)),y}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(p){for(var v={},_=!1,y=0,w=0;y<p.length;++y)(w=p.charCodeAt(y))==34?_=!_:!_&&w in r&&(v[w]=(v[w]||0)+1);w=[];for(y in v)Object.prototype.hasOwnProperty.call(v,y)&&w.push([v[y],y]);if(!w.length){v=n;for(y in v)Object.prototype.hasOwnProperty.call(v,y)&&w.push([v[y],y])}return w.sort(function(E,S){return E[0]-S[0]||n[E[1]]-n[S[1]]}),r[w.pop()[1]]||44}function o(p,v){var _=v||{},y="",w=_.dense?[]:{},E={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(y=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(y=p.charAt(4),p=p.slice(6)):y=a(p.slice(0,1024)):_&&_.FS?y=_.FS:y=a(p.slice(0,1024));var S=0,L=0,z=0,O=0,ee=0,te=y.charCodeAt(0),Z=!1,C=0,I=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var R=_.dateNF!=null?B3(_.dateNF):null;function B(){var D=p.slice(O,ee),F={};if(D.charAt(0)=='"'&&D.charAt(D.length-1)=='"'&&(D=D.slice(1,-1).replace(/""/g,'"')),D.length===0)F.t="z";else if(_.raw)F.t="s",F.v=D;else if(D.trim().length===0)F.t="s",F.v=D;else if(D.charCodeAt(0)==61)D.charCodeAt(1)==34&&D.charCodeAt(D.length-1)==34?(F.t="s",F.v=D.slice(2,-1).replace(/""/g,'"')):d5(D)?(F.t="n",F.f=D.slice(1)):(F.t="s",F.v=D);else if(D=="TRUE")F.t="b",F.v=!0;else if(D=="FALSE")F.t="b",F.v=!1;else if(!isNaN(z=Ya(D)))F.t="n",_.cellText!==!1&&(F.w=D),F.v=z;else if(!isNaN(lc(D).getDate())||R&&D.match(R)){F.z=_.dateNF||pt[14];var M=0;R&&D.match(R)&&(D=V3(D,_.dateNF,D.match(R)||[]),M=1),_.cellDates?(F.t="d",F.v=vr(D,M)):(F.t="n",F.v=en(vr(D,M))),_.cellText!==!1&&(F.w=Ma(F.z,F.v instanceof Date?en(F.v):F.v)),_.cellNF||delete F.z}else F.t="s",F.v=D;if(F.t=="z"||(_.dense?(w[S]||(w[S]=[]),w[S][L]=F):w[gt({c:L,r:S})]=F),O=ee+1,I=p.charCodeAt(O),E.e.c<L&&(E.e.c=L),E.e.r<S&&(E.e.r=S),C==te)++L;else if(L=0,++S,_.sheetRows&&_.sheetRows<=S)return!0}e:for(;ee<p.length;++ee)switch(C=p.charCodeAt(ee)){case 34:I===34&&(Z=!Z);break;case te:case 10:case 13:if(!Z&&B())break e;break}return ee-O>0&&B(),w["!ref"]=St(E),w}function l(p,v){return!(v&&v.PRN)||v.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?o(p,v):_c(e(p,v),v)}function u(p,v){var _="",y=v.type=="string"?[0,0,0,0]:lg(p,v);switch(v.type){case"base64":_=da(p);break;case"binary":_=p;break;case"buffer":v.codepage==65001?_=p.toString("utf8"):v.codepage&&typeof Yu<"u"||(_=Rt&&Buffer.isBuffer(p)?p.toString("binary"):to(p));break;case"array":_=Ho(p);break;case"string":_=p;break;default:throw new Error("Unrecognized type "+v.type)}return y[0]==239&&y[1]==187&&y[2]==191?_=fr(_.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?_=fr(_):v.type=="binary"&&typeof Yu<"u",_.slice(0,19)=="socialcalc:version:"?XE.to_sheet(v.type=="string"?_:fr(_),v):l(_,v)}function h(p,v){return ro(u(p,v),v)}function d(p){for(var v=[],_=Gt(p["!ref"]),y,w=Array.isArray(p),E=_.s.r;E<=_.e.r;++E){for(var S=[],L=_.s.c;L<=_.e.c;++L){var z=gt({r:E,c:L});if(y=w?(p[E]||[])[L]:p[z],!y||y.v==null){S.push("          ");continue}for(var O=(y.w||(Ji(y),y.w)||"").slice(0,10);O.length<10;)O+=" ";S.push(O+(L===0?" ":""))}v.push(S.join(""))}return v.join(`
`)}return{to_workbook:h,to_sheet:u,from_sheet:d}})();function JC(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var a=GE.to_workbook(t,r);return r.WTF=n,a}catch(o){if(r.WTF=n,!o.message.match(/SYLK bad record ID/)&&n)throw o;return cc.to_workbook(t,e)}}var Vo=(function(){function t(V,Y,Q){if(V){vn(V,V.l||0);for(var J=Q.Enum||W;V.l<V.length;){var ue=V.read_shift(2),Ie=J[ue]||J[65535],ke=V.read_shift(2),Oe=V.l+ke,le=Ie.f&&Ie.f(V,ke,Q);if(V.l=Oe,Y(le,Ie,ue))return}}}function e(V,Y){switch(Y.type){case"base64":return r(fa(da(V)),Y);case"binary":return r(fa(V),Y);case"buffer":case"array":return r(V,Y)}throw"Unsupported type "+Y.type}function r(V,Y){if(!V)return V;var Q=Y||{},J=Q.dense?[]:{},ue="Sheet1",Ie="",ke=0,Oe={},le=[],Qe=[],G={s:{r:0,c:0},e:{r:0,c:0}},et=Q.sheetRows||0;if(V[2]==0&&(V[3]==8||V[3]==9)&&V.length>=16&&V[14]==5&&V[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(V[2]==2)Q.Enum=W,t(V,function(be,Ee,ze){switch(ze){case 0:Q.vers=be,be>=4096&&(Q.qpro=!0);break;case 6:G=be;break;case 204:be&&(Ie=be);break;case 222:Ie=be;break;case 15:case 51:Q.qpro||(be[1].v=be[1].v.slice(1));case 13:case 14:case 16:ze==14&&(be[2]&112)==112&&(be[2]&15)>1&&(be[2]&15)<15&&(be[1].z=Q.dateNF||pt[14],Q.cellDates&&(be[1].t="d",be[1].v=ed(be[1].v))),Q.qpro&&be[3]>ke&&(J["!ref"]=St(G),Oe[ue]=J,le.push(ue),J=Q.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},ke=be[3],ue=Ie||"Sheet"+(ke+1),Ie="");var Ke=Q.dense?(J[be[0].r]||[])[be[0].c]:J[gt(be[0])];if(Ke){Ke.t=be[1].t,Ke.v=be[1].v,be[1].z!=null&&(Ke.z=be[1].z),be[1].f!=null&&(Ke.f=be[1].f);break}Q.dense?(J[be[0].r]||(J[be[0].r]=[]),J[be[0].r][be[0].c]=be[1]):J[gt(be[0])]=be[1];break}},Q);else if(V[2]==26||V[2]==14)Q.Enum=pe,V[2]==14&&(Q.qpro=!0,V.l=0),t(V,function(be,Ee,ze){switch(ze){case 204:ue=be;break;case 22:be[1].v=be[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(be[3]>ke&&(J["!ref"]=St(G),Oe[ue]=J,le.push(ue),J=Q.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},ke=be[3],ue="Sheet"+(ke+1)),et>0&&be[0].r>=et)break;Q.dense?(J[be[0].r]||(J[be[0].r]=[]),J[be[0].r][be[0].c]=be[1]):J[gt(be[0])]=be[1],G.e.c<be[0].c&&(G.e.c=be[0].c),G.e.r<be[0].r&&(G.e.r=be[0].r);break;case 27:be[14e3]&&(Qe[be[14e3][0]]=be[14e3][1]);break;case 1537:Qe[be[0]]=be[1],be[0]==ke&&(ue=be[1]);break}},Q);else throw new Error("Unrecognized LOTUS BOF "+V[2]);if(J["!ref"]=St(G),Oe[Ie||ue]=J,le.push(Ie||ue),!Qe.length)return{SheetNames:le,Sheets:Oe};for(var Ve={},at=[],Ze=0;Ze<Qe.length;++Ze)Oe[le[Ze]]?(at.push(Qe[Ze]||le[Ze]),Ve[Qe[Ze]]=Oe[Qe[Ze]]||Oe[le[Ze]]):(at.push(Qe[Ze]),Ve[Qe[Ze]]={"!ref":"A1"});return{SheetNames:at,Sheets:Ve}}function n(V,Y){var Q=Y||{};if(+Q.codepage>=0&&Ga(+Q.codepage),Q.type=="string")throw new Error("Cannot write WK1 to JS string");var J=Zn(),ue=Gt(V["!ref"]),Ie=Array.isArray(V),ke=[];Xe(J,0,o(1030)),Xe(J,6,h(ue));for(var Oe=Math.min(ue.e.r,8191),le=ue.s.r;le<=Oe;++le)for(var Qe=Lr(le),G=ue.s.c;G<=ue.e.c;++G){le===ue.s.r&&(ke[G]=Sr(G));var et=ke[G]+Qe,Ve=Ie?(V[le]||[])[G]:V[et];if(!(!Ve||Ve.t=="z"))if(Ve.t=="n")(Ve.v|0)==Ve.v&&Ve.v>=-32768&&Ve.v<=32767?Xe(J,13,y(le,G,Ve.v)):Xe(J,14,E(le,G,Ve.v));else{var at=Ji(Ve);Xe(J,15,v(le,G,at.slice(0,239)))}}return Xe(J,1),J.end()}function a(V,Y){var Q=Y||{};if(+Q.codepage>=0&&Ga(+Q.codepage),Q.type=="string")throw new Error("Cannot write WK3 to JS string");var J=Zn();Xe(J,0,l(V));for(var ue=0,Ie=0;ue<V.SheetNames.length;++ue)(V.Sheets[V.SheetNames[ue]]||{})["!ref"]&&Xe(J,27,ae(V.SheetNames[ue],Ie++));var ke=0;for(ue=0;ue<V.SheetNames.length;++ue){var Oe=V.Sheets[V.SheetNames[ue]];if(!(!Oe||!Oe["!ref"])){for(var le=Gt(Oe["!ref"]),Qe=Array.isArray(Oe),G=[],et=Math.min(le.e.r,8191),Ve=le.s.r;Ve<=et;++Ve)for(var at=Lr(Ve),Ze=le.s.c;Ze<=le.e.c;++Ze){Ve===le.s.r&&(G[Ze]=Sr(Ze));var be=G[Ze]+at,Ee=Qe?(Oe[Ve]||[])[Ze]:Oe[be];if(!(!Ee||Ee.t=="z"))if(Ee.t=="n")Xe(J,23,B(Ve,Ze,ke,Ee.v));else{var ze=Ji(Ee);Xe(J,22,C(Ve,Ze,ke,ze.slice(0,239)))}}++ke}}return Xe(J,1),J.end()}function o(V){var Y=we(2);return Y.write_shift(2,V),Y}function l(V){var Y=we(26);Y.write_shift(2,4096),Y.write_shift(2,4),Y.write_shift(4,0);for(var Q=0,J=0,ue=0,Ie=0;Ie<V.SheetNames.length;++Ie){var ke=V.SheetNames[Ie],Oe=V.Sheets[ke];if(!(!Oe||!Oe["!ref"])){++ue;var le=Jn(Oe["!ref"]);Q<le.e.r&&(Q=le.e.r),J<le.e.c&&(J=le.e.c)}}return Q>8191&&(Q=8191),Y.write_shift(2,Q),Y.write_shift(1,ue),Y.write_shift(1,J),Y.write_shift(2,0),Y.write_shift(2,0),Y.write_shift(1,1),Y.write_shift(1,2),Y.write_shift(4,0),Y.write_shift(4,0),Y}function u(V,Y,Q){var J={s:{c:0,r:0},e:{c:0,r:0}};return Y==8&&Q.qpro?(J.s.c=V.read_shift(1),V.l++,J.s.r=V.read_shift(2),J.e.c=V.read_shift(1),V.l++,J.e.r=V.read_shift(2),J):(J.s.c=V.read_shift(2),J.s.r=V.read_shift(2),Y==12&&Q.qpro&&(V.l+=2),J.e.c=V.read_shift(2),J.e.r=V.read_shift(2),Y==12&&Q.qpro&&(V.l+=2),J.s.c==65535&&(J.s.c=J.e.c=J.s.r=J.e.r=0),J)}function h(V){var Y=we(8);return Y.write_shift(2,V.s.c),Y.write_shift(2,V.s.r),Y.write_shift(2,V.e.c),Y.write_shift(2,V.e.r),Y}function d(V,Y,Q){var J=[{c:0,r:0},{t:"n",v:0},0,0];return Q.qpro&&Q.vers!=20768?(J[0].c=V.read_shift(1),J[3]=V.read_shift(1),J[0].r=V.read_shift(2),V.l+=2):(J[2]=V.read_shift(1),J[0].c=V.read_shift(2),J[0].r=V.read_shift(2)),J}function p(V,Y,Q){var J=V.l+Y,ue=d(V,Y,Q);if(ue[1].t="s",Q.vers==20768){V.l++;var Ie=V.read_shift(1);return ue[1].v=V.read_shift(Ie,"utf8"),ue}return Q.qpro&&V.l++,ue[1].v=V.read_shift(J-V.l,"cstr"),ue}function v(V,Y,Q){var J=we(7+Q.length);J.write_shift(1,255),J.write_shift(2,Y),J.write_shift(2,V),J.write_shift(1,39);for(var ue=0;ue<J.length;++ue){var Ie=Q.charCodeAt(ue);J.write_shift(1,Ie>=128?95:Ie)}return J.write_shift(1,0),J}function _(V,Y,Q){var J=d(V,Y,Q);return J[1].v=V.read_shift(2,"i"),J}function y(V,Y,Q){var J=we(7);return J.write_shift(1,255),J.write_shift(2,Y),J.write_shift(2,V),J.write_shift(2,Q,"i"),J}function w(V,Y,Q){var J=d(V,Y,Q);return J[1].v=V.read_shift(8,"f"),J}function E(V,Y,Q){var J=we(13);return J.write_shift(1,255),J.write_shift(2,Y),J.write_shift(2,V),J.write_shift(8,Q,"f"),J}function S(V,Y,Q){var J=V.l+Y,ue=d(V,Y,Q);if(ue[1].v=V.read_shift(8,"f"),Q.qpro)V.l=J;else{var Ie=V.read_shift(2);ee(V.slice(V.l,V.l+Ie),ue),V.l+=Ie}return ue}function L(V,Y,Q){var J=Y&32768;return Y&=-32769,Y=(J?V:0)+(Y>=8192?Y-16384:Y),(J?"":"$")+(Q?Sr(Y):Lr(Y))}var z={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},O=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function ee(V,Y){vn(V,0);for(var Q=[],J=0,ue="",Ie="",ke="",Oe="";V.l<V.length;){var le=V[V.l++];switch(le){case 0:Q.push(V.read_shift(8,"f"));break;case 1:Ie=L(Y[0].c,V.read_shift(2),!0),ue=L(Y[0].r,V.read_shift(2),!1),Q.push(Ie+ue);break;case 2:{var Qe=L(Y[0].c,V.read_shift(2),!0),G=L(Y[0].r,V.read_shift(2),!1);Ie=L(Y[0].c,V.read_shift(2),!0),ue=L(Y[0].r,V.read_shift(2),!1),Q.push(Qe+G+":"+Ie+ue)}break;case 3:if(V.l<V.length){console.error("WK1 premature formula end");return}break;case 4:Q.push("("+Q.pop()+")");break;case 5:Q.push(V.read_shift(2));break;case 6:{for(var et="";le=V[V.l++];)et+=String.fromCharCode(le);Q.push('"'+et.replace(/"/g,'""')+'"')}break;case 8:Q.push("-"+Q.pop());break;case 23:Q.push("+"+Q.pop());break;case 22:Q.push("NOT("+Q.pop()+")");break;case 20:case 21:Oe=Q.pop(),ke=Q.pop(),Q.push(["AND","OR"][le-20]+"("+ke+","+Oe+")");break;default:if(le<32&&O[le])Oe=Q.pop(),ke=Q.pop(),Q.push(ke+O[le]+Oe);else if(z[le]){if(J=z[le][1],J==69&&(J=V[V.l++]),J>Q.length){console.error("WK1 bad formula parse 0x"+le.toString(16)+":|"+Q.join("|")+"|");return}var Ve=Q.slice(-J);Q.length-=J,Q.push(z[le][0]+"("+Ve.join(",")+")")}else return le<=7?console.error("WK1 invalid opcode "+le.toString(16)):le<=24?console.error("WK1 unsupported op "+le.toString(16)):le<=30?console.error("WK1 invalid opcode "+le.toString(16)):le<=115?console.error("WK1 unsupported function opcode "+le.toString(16)):console.error("WK1 unrecognized opcode "+le.toString(16))}}Q.length==1?Y[1].f=""+Q[0]:console.error("WK1 bad formula parse |"+Q.join("|")+"|")}function te(V){var Y=[{c:0,r:0},{t:"n",v:0},0];return Y[0].r=V.read_shift(2),Y[3]=V[V.l++],Y[0].c=V[V.l++],Y}function Z(V,Y){var Q=te(V);return Q[1].t="s",Q[1].v=V.read_shift(Y-4,"cstr"),Q}function C(V,Y,Q,J){var ue=we(6+J.length);ue.write_shift(2,V),ue.write_shift(1,Q),ue.write_shift(1,Y),ue.write_shift(1,39);for(var Ie=0;Ie<J.length;++Ie){var ke=J.charCodeAt(Ie);ue.write_shift(1,ke>=128?95:ke)}return ue.write_shift(1,0),ue}function I(V,Y){var Q=te(V);Q[1].v=V.read_shift(2);var J=Q[1].v>>1;if(Q[1].v&1)switch(J&7){case 0:J=(J>>3)*5e3;break;case 1:J=(J>>3)*500;break;case 2:J=(J>>3)/20;break;case 3:J=(J>>3)/200;break;case 4:J=(J>>3)/2e3;break;case 5:J=(J>>3)/2e4;break;case 6:J=(J>>3)/16;break;case 7:J=(J>>3)/64;break}return Q[1].v=J,Q}function R(V,Y){var Q=te(V),J=V.read_shift(4),ue=V.read_shift(4),Ie=V.read_shift(2);if(Ie==65535)return J===0&&ue===3221225472?(Q[1].t="e",Q[1].v=15):J===0&&ue===3489660928?(Q[1].t="e",Q[1].v=42):Q[1].v=0,Q;var ke=Ie&32768;return Ie=(Ie&32767)-16446,Q[1].v=(1-ke*2)*(ue*Math.pow(2,Ie+32)+J*Math.pow(2,Ie)),Q}function B(V,Y,Q,J){var ue=we(14);if(ue.write_shift(2,V),ue.write_shift(1,Q),ue.write_shift(1,Y),J==0)return ue.write_shift(4,0),ue.write_shift(4,0),ue.write_shift(2,65535),ue;var Ie=0,ke=0,Oe=0,le=0;return J<0&&(Ie=1,J=-J),ke=Math.log2(J)|0,J/=Math.pow(2,ke-31),le=J>>>0,(le&2147483648)==0&&(J/=2,++ke,le=J>>>0),J-=le,le|=2147483648,le>>>=0,J*=Math.pow(2,32),Oe=J>>>0,ue.write_shift(4,Oe),ue.write_shift(4,le),ke+=16383+(Ie?32768:0),ue.write_shift(2,ke),ue}function D(V,Y){var Q=R(V);return V.l+=Y-14,Q}function F(V,Y){var Q=te(V),J=V.read_shift(4);return Q[1].v=J>>6,Q}function M(V,Y){var Q=te(V),J=V.read_shift(8,"f");return Q[1].v=J,Q}function Fe(V,Y){var Q=M(V);return V.l+=Y-10,Q}function Se(V,Y){return V[V.l+Y-1]==0?V.read_shift(Y,"cstr"):""}function ne(V,Y){var Q=V[V.l++];Q>Y-1&&(Q=Y-1);for(var J="";J.length<Q;)J+=String.fromCharCode(V[V.l++]);return J}function se(V,Y,Q){if(!(!Q.qpro||Y<21)){var J=V.read_shift(1);V.l+=17,V.l+=1,V.l+=2;var ue=V.read_shift(Y-21,"cstr");return[J,ue]}}function Le(V,Y){for(var Q={},J=V.l+Y;V.l<J;){var ue=V.read_shift(2);if(ue==14e3){for(Q[ue]=[0,""],Q[ue][0]=V.read_shift(2);V[V.l];)Q[ue][1]+=String.fromCharCode(V[V.l]),V.l++;V.l++}}return Q}function ae(V,Y){var Q=we(5+V.length);Q.write_shift(2,14e3),Q.write_shift(2,Y);for(var J=0;J<V.length;++J){var ue=V.charCodeAt(J);Q[Q.l++]=ue>127?95:ue}return Q[Q.l++]=0,Q}var W={0:{n:"BOF",f:Gr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:u},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Se},222:{n:"SHEETNAMELP",f:ne},65535:{n:""}},pe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:Z},23:{n:"NUMBER17",f:R},24:{n:"NUMBER18",f:I},25:{n:"FORMULA19",f:D},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Le},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:F},38:{n:"??"},39:{n:"NUMBER27",f:M},40:{n:"FORMULA28",f:Fe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Se},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:se},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:e}})();function e6(t){var e={},r=t.match(Mn),n=0,a=!1;if(r)for(;n!=r.length;++n){var o=yt(r[n]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;e.cp=Ap[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=o.val;break;case"<sz":e.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":o.rgb&&(e.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(o[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+o[0])}}return e}var t6=(function(){var t=Qu("t"),e=Qu("rPr");function r(o){var l=o.match(t);if(!l)return{t:"s",v:""};var u={t:"s",v:Wt(l[1])},h=o.match(e);return h&&(u.s=e6(h[1])),u}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(n,"").split(a).map(r).filter(function(u){return u.v})}})(),r6=(function(){var e=/(\r\n|\n)/g;function r(a,o,l){var u=[];a.u&&u.push("text-decoration: underline;"),a.uval&&u.push("text-underline-style:"+a.uval+";"),a.sz&&u.push("font-size:"+a.sz+"pt;"),a.outline&&u.push("text-effect: outline;"),a.shadow&&u.push("text-shadow: auto;"),o.push('<span style="'+u.join("")+'">'),a.b&&(o.push("<b>"),l.push("</b>")),a.i&&(o.push("<i>"),l.push("</i>")),a.strike&&(o.push("<s>"),l.push("</s>"));var h=a.valign||"";return h=="superscript"||h=="super"?h="sup":h=="subscript"&&(h="sub"),h!=""&&(o.push("<"+h+">"),l.push("</"+h+">")),l.push("</span>"),a}function n(a){var o=[[],a.v,[]];return a.v?(a.s&&r(a.s,o[0],o[2]),o[0].join("")+o[1].replace(e,"<br/>")+o[2].join("")):""}return function(o){return o.map(n).join("")}})(),n6=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,a6=/<(?:\w+:)?r>/,i6=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Kp(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Wt(fr(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=fr(t),r&&(n.h=Mp(n.t))):t.match(a6)&&(n.r=fr(t),n.t=Wt(fr((t.replace(i6,"").match(n6)||[]).join("").replace(Mn,""))),r&&(n.h=r6(t6(n.r)))),n):{t:""}}var s6=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,o6=/<(?:\w+:)?(?:si|sstItem)>/g,l6=/<\/(?:\w+:)?(?:si|sstItem)>/;function c6(t,e){var r=[],n="";if(!t)return r;var a=t.match(s6);if(a){n=a[2].replace(o6,"").split(l6);for(var o=0;o!=n.length;++o){var l=Kp(n[o].trim(),e);l!=null&&(r[r.length]=l)}a=yt(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var u6=/^\s|\s$|[\t\n\r]/;function YE(t,e){if(!e.bookSST)return"";var r=[Br];r[r.length]=Ge("sst",null,{xmlns:$o[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var a=t[n],o="<si>";a.r?o+=a.r:(o+="<t",a.t||(a.t=""),a.t.match(u6)&&(o+=' xml:space="preserve"'),o+=">"+sr(a.t)+"</t>"),o+="</si>",r[r.length]=o}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function f6(t){return[t.read_shift(4),t.read_shift(4)]}function h6(t,e){var r=[],n=!1;return as(t,function(o,l,u){switch(u){case 159:r.Count=o[0],r.Unique=o[1];break;case 19:r.push(o);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(l.T,!n||e.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}),r}function d6(t,e){return e||(e=we(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var m6=Sk;function p6(t){var e=Zn();Ne(e,159,d6(t));for(var r=0;r<t.length;++r)Ne(e,19,m6(t[r]));return Ne(e,160),e.end()}function KE(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Qi(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function g6(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Qi(t,4),e.U=Qi(t,4),e.W=Qi(t,4),e}function x6(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},a=t.read_shift(4),o=[];a-- >0;)o.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=o,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function v6(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(x6(t));return e}function _6(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function y6(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Qi(t,4),e.U=Qi(t,4),e.W=Qi(t,4),e}function T6(t){var e=y6(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function $E(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function QE(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function E6(t){var e=Qi(t);switch(e.Minor){case 2:return[e.Minor,w6(t)];case 3:return[e.Minor,S6()];case 4:return[e.Minor,A6(t)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function w6(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=$E(t,r),a=QE(t,t.length-t.l);return{t:"Std",h:n,v:a}}function S6(){throw new Error("File is password-protected: ECMA-376 Extensible")}function A6(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Mn,function(o){var l=yt(o);switch(Ai(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(u){n[u]=l[u]});break;case"<dataIntegrity":n.encryptedHmacKey=l.encryptedHmacKey,n.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(l);break;default:throw l[0]}}),n}function k6(t,e){var r={},n=r.EncryptionVersionInfo=Qi(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var a=t.read_shift(4);return e-=4,r.EncryptionHeader=$E(t,a),e-=a,r.EncryptionVerifier=QE(t,e),r}function b6(t){var e={},r=e.EncryptionVersionInfo=Qi(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function $p(t){var e=0,r,n=KE(t),a=n.length+1,o,l,u,h,d;for(r=Gs(a),r[0]=n.length,o=1;o!=a;++o)r[o]=n[o-1];for(o=a-1;o>=0;--o)l=r[o],u=(e&16384)===0?0:1,h=e<<1&32767,d=u|h,e=d^l;return e^52811}var ZE=(function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(l){return(l/2|l*128)&255},a=function(l,u){return n(l^u)},o=function(l){for(var u=e[l.length-1],h=104,d=l.length-1;d>=0;--d)for(var p=l[d],v=0;v!=7;++v)p&64&&(u^=r[h]),p*=2,--h;return u};return function(l){for(var u=KE(l),h=o(u),d=u.length,p=Gs(16),v=0;v!=16;++v)p[v]=0;var _,y,w;for((d&1)===1&&(_=h>>8,p[d]=a(t[0],_),--d,_=h&255,y=u[u.length-1],p[d]=a(y,_));d>0;)--d,_=h>>8,p[d]=a(u[d],_),--d,_=h&255,p[d]=a(u[d],_);for(d=15,w=15-u.length;w>0;)_=h>>8,p[d]=a(t[w],_),--d,--w,_=h&255,p[d]=a(u[d],_),--d,--w;return p}})(),C6=function(t,e,r,n,a){a||(a=e),n||(n=ZE(t));var o,l;for(o=0;o!=e.length;++o)l=e[o],l^=n[r],l=(l>>5|l<<3)&255,a[o]=l,++r;return[a,r,n]},R6=function(t){var e=0,r=ZE(t);return function(n){var a=C6("",n,e,r);return e=a[1],a[0]}};function D6(t,e,r,n){var a={key:Gr(t),verificationBytes:Gr(t)};return r.password&&(a.verifier=$p(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=R6(r.password)),a}function I6(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=b6(t):n.Data=k6(t,e),n}function O6(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?I6(t,e-2,n):D6(t,r.biff>=8?e:e-2,r,n),n}var JE=(function(){function t(a,o){switch(o.type){case"base64":return e(da(a),o);case"binary":return e(a,o);case"buffer":return e(Rt&&Buffer.isBuffer(a)?a.toString("binary"):to(a),o);case"array":return e(Ho(a),o)}throw new Error("Unrecognized type "+o.type)}function e(a,o){var l=o||{},u=l.dense?[]:{},h=a.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(p,v){Array.isArray(u)&&(u[v]=[]);for(var _=/\\\w+\b/g,y=0,w,E=-1;w=_.exec(p);){switch(w[0]){case"\\cell":var S=p.slice(y,_.lastIndex-w[0].length);if(S[0]==" "&&(S=S.slice(1)),++E,S.length){var L={v:S,t:"s"};Array.isArray(u)?u[v][E]=L:u[gt({r:v,c:E})]=L}break}y=_.lastIndex}E>d.e.c&&(d.e.c=E)}),u["!ref"]=St(d),u}function r(a,o){return ro(t(a,o),o)}function n(a){for(var o=["{\\rtf1\\ansi"],l=Gt(a["!ref"]),u,h=Array.isArray(a),d=l.s.r;d<=l.e.r;++d){o.push("\\trowd\\trautofit1");for(var p=l.s.c;p<=l.e.c;++p)o.push("\\cellx"+(p+1));for(o.push("\\pard\\intbl"),p=l.s.c;p<=l.e.c;++p){var v=gt({r:d,c:p});u=h?(a[d]||[])[p]:a[v],!(!u||u.v==null&&(!u.f||u.F))&&(o.push(" "+(u.w||(Ji(u),u.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}})();function F6(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function tf(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function N6(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,a=Math.max(e,r,n),o=Math.min(e,r,n),l=a-o;if(l===0)return[0,0,e];var u=0,h=0,d=a+o;switch(h=l/(d>1?2-d:d),a){case e:u=((r-n)/l+6)%6;break;case r:u=(n-e)/l+2;break;case n:u=(e-r)/l+4;break}return[u/6,h,d/2]}function M6(t){var e=t[0],r=t[1],n=t[2],a=r*2*(n<.5?n:1-n),o=n-a/2,l=[o,o,o],u=6*e,h;if(r!==0)switch(u|0){case 0:case 6:h=a*u,l[0]+=a,l[1]+=h;break;case 1:h=a*(2-u),l[0]+=h,l[1]+=a;break;case 2:h=a*(u-2),l[1]+=a,l[2]+=h;break;case 3:h=a*(4-u),l[1]+=h,l[2]+=a;break;case 4:h=a*(u-4),l[2]+=a,l[0]+=h;break;case 5:h=a*(6-u),l[2]+=h,l[0]+=a;break}for(var d=0;d!=3;++d)l[d]=Math.round(l[d]*255);return l}function Dh(t,e){if(e===0)return t;var r=N6(F6(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),tf(M6(r))}var ew=6,P6=15,L6=1,Dn=ew;function rf(t){return Math.floor((t+Math.round(128/Dn)/256)*Dn)}function nf(t){return Math.floor((t-5)/Dn*100+.5)/100}function Ih(t){return Math.round((t*Dn+5)/Dn*256)/256}function km(t){return Ih(nf(rf(t)))}function Qp(t){var e=Math.abs(t-km(t)),r=Dn;if(e>.005)for(Dn=L6;Dn<P6;++Dn)Math.abs(t-km(t))<=e&&(e=Math.abs(t-km(t)),r=Dn);Dn=r}function qs(t){t.width?(t.wpx=rf(t.width),t.wch=nf(t.wpx),t.MDW=Dn):t.wpx?(t.wch=nf(t.wpx),t.width=Ih(t.wch),t.MDW=Dn):typeof t.wch=="number"&&(t.width=Ih(t.wch),t.wpx=rf(t.width),t.MDW=Dn),t.customWidth&&delete t.customWidth}var B6=96,tw=B6;function af(t){return t*96/tw}function uc(t){return t*tw/96}var V6={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function U6(t,e,r,n){e.Borders=[];var a={},o=!1;(t[0].match(Mn)||[]).forEach(function(l){var u=yt(l);switch(Ai(u[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},u.diagonalUp&&(a.diagonalUp=gr(u.diagonalUp)),u.diagonalDown&&(a.diagonalDown=gr(u.diagonalDown)),e.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in borders")}})}function j6(t,e,r,n){e.Fills=[];var a={},o=!1;(t[0].match(Mn)||[]).forEach(function(l){var u=yt(l);switch(Ai(u[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},e.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":u.patternType&&(a.patternType=u.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),u.indexed&&(a.bgColor.indexed=parseInt(u.indexed,10)),u.theme&&(a.bgColor.theme=parseInt(u.theme,10)),u.tint&&(a.bgColor.tint=parseFloat(u.tint)),u.rgb&&(a.bgColor.rgb=u.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),u.theme&&(a.fgColor.theme=parseInt(u.theme,10)),u.tint&&(a.fgColor.tint=parseFloat(u.tint)),u.rgb!=null&&(a.fgColor.rgb=u.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fills")}})}function z6(t,e,r,n){e.Fonts=[];var a={},o=!1;(t[0].match(Mn)||[]).forEach(function(l){var u=yt(l);switch(Ai(u[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(a),a={};break;case"<name":u.val&&(a.name=fr(u.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=u.val?gr(u.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=u.val?gr(u.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(u.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=u.val?gr(u.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=u.val?gr(u.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=u.val?gr(u.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=u.val?gr(u.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=u.val?gr(u.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":u.val&&(a.sz=+u.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":u.val&&(a.vertAlign=u.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":u.val&&(a.family=parseInt(u.val,10));break;case"<family/>":case"</family>":break;case"<scheme":u.val&&(a.scheme=u.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(u.val=="1")break;u.codepage=Ap[parseInt(u.val,10)];break;case"<color":if(a.color||(a.color={}),u.auto&&(a.color.auto=gr(u.auto)),u.rgb)a.color.rgb=u.rgb.slice(-6);else if(u.indexed){a.color.index=parseInt(u.indexed,10);var h=Lo[a.color.index];a.color.index==81&&(h=Lo[1]),h||(h=Lo[1]),a.color.rgb=h[0].toString(16)+h[1].toString(16)+h[2].toString(16)}else u.theme&&(a.color.theme=parseInt(u.theme,10),u.tint&&(a.color.tint=parseFloat(u.tint)),u.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Dh(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(n&&n.WTF&&!o)throw new Error("unrecognized "+u[0]+" in fonts")}})}function H6(t,e,r){e.NumberFmt=[];for(var n=Ir(pt),a=0;a<n.length;++a)e.NumberFmt[n[a]]=pt[n[a]];var o=t[0].match(Mn);if(o)for(a=0;a<o.length;++a){var l=yt(o[a]);switch(Ai(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var u=Wt(fr(l.formatCode)),h=parseInt(l.numFmtId,10);if(e.NumberFmt[h]=u,h>0){if(h>392){for(h=392;h>60&&e.NumberFmt[h]!=null;--h);e.NumberFmt[h]=u}$i(u,h)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function W6(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Ge("numFmt",null,{numFmtId:n,formatCode:sr(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Ge("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var th=["numFmtId","fillId","fontId","borderId","xfId"],rh=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function G6(t,e,r){e.CellXf=[];var n,a=!1;(t[0].match(Mn)||[]).forEach(function(o){var l=yt(o),u=0;switch(Ai(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=l,delete n[0],u=0;u<th.length;++u)n[th[u]]&&(n[th[u]]=parseInt(n[th[u]],10));for(u=0;u<rh.length;++u)n[rh[u]]&&(n[rh[u]]=gr(n[rh[u]]));if(e.NumberFmt&&n.numFmtId>392){for(u=392;u>60;--u)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[u]){n.numFmtId=u;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var h={};l.vertical&&(h.vertical=l.vertical),l.horizontal&&(h.horizontal=l.horizontal),l.textRotation!=null&&(h.textRotation=l.textRotation),l.indent&&(h.indent=l.indent),l.wrapText&&(h.wrapText=gr(l.wrapText)),n.alignment=h;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function q6(t){var e=[];return e[e.length]=Ge("cellXfs",null),t.forEach(function(r){e[e.length]=Ge("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Ge("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var X6=(function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(u,h,d){var p={};if(!u)return p;u=u.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var v;return(v=u.match(e))&&H6(v,p,d),(v=u.match(a))&&z6(v,p,h,d),(v=u.match(n))&&j6(v,p,h,d),(v=u.match(o))&&U6(v,p,h,d),(v=u.match(r))&&G6(v,p,d),p}})();function rw(t,e){var r=[Br,Ge("styleSheet",null,{xmlns:$o[0],"xmlns:vt":Qr.vt})],n;return t.SSF&&(n=W6(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=q6(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Y6(t,e){var r=t.read_shift(2),n=Fn(t);return[r,n]}function K6(t,e,r){r||(r=we(6+4*e.length)),r.write_shift(2,t),un(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function $6(t,e,r){var n={};n.sz=t.read_shift(2)/20;var a=Ik(t);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var o=t.read_shift(2);switch(o===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=t.read_shift(1);l!=0&&(n.underline=l);var u=t.read_shift(1);u>0&&(n.family=u);var h=t.read_shift(1);switch(h>0&&(n.charset=h),t.l++,n.color=Dk(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Fn(t),n}function Q6(t,e){e||(e=we(153)),e.write_shift(2,t.sz*20),Ok(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),bh(t.color,e);var n=0;return n=2,e.write_shift(1,n),un(t.name,e),e.length>e.l?e.slice(0,e.l):e}var Z6=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],bm,J6=Nn;function ny(t,e){e||(e=we(84)),bm||(bm=Zh(Z6));var r=bm[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(bh({auto:1},e),bh({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function eR(t,e){var r=t.l+e,n=t.read_shift(2),a=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:a}}function nw(t,e,r){r||(r=we(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function ku(t,e){return e||(e=we(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var tR=Nn;function rR(t,e){return e||(e=we(51)),e.write_shift(1,0),ku(null,e),ku(null,e),ku(null,e),ku(null,e),ku(null,e),e.length>e.l?e.slice(0,e.l):e}function nR(t,e){return e||(e=we(52)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),kh(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function aR(t,e,r){var n=we(2052);return n.write_shift(4,t),kh(e,n),kh(r,n),n.length>n.l?n.slice(0,n.l):n}function iR(t,e,r){var n={};n.NumberFmt=[];for(var a in pt)n.NumberFmt[a]=pt[a];n.CellXf=[],n.Fonts=[];var o=[],l=!1;return as(t,function(h,d,p){switch(p){case 44:n.NumberFmt[h[0]]=h[1],$i(h[1],h[0]);break;case 43:n.Fonts.push(h),h.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(h.color.rgb=Dh(e.themeElements.clrScheme[h.color.theme].rgb,h.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&n.CellXf.push(h);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:o.push(p),l=!0;break;case 38:o.pop(),l=!1;break;default:if(d.T>0)o.push(p);else if(d.T<0)o.pop();else if(!l||r.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),n}function sR(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&++r}),r!=0&&(Ne(t,615,Ka(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&Ne(t,44,K6(a,e[a]))}),Ne(t,616))}}function oR(t){var e=1;Ne(t,611,Ka(e)),Ne(t,43,Q6({sz:12,color:{theme:1},name:"Calibri",family:2})),Ne(t,612)}function lR(t){var e=2;Ne(t,603,Ka(e)),Ne(t,45,ny({patternType:"none"})),Ne(t,45,ny({patternType:"gray125"})),Ne(t,604)}function cR(t){var e=1;Ne(t,613,Ka(e)),Ne(t,46,rR()),Ne(t,614)}function uR(t){var e=1;Ne(t,626,Ka(e)),Ne(t,47,nw({numFmtId:0},65535)),Ne(t,627)}function fR(t,e){Ne(t,617,Ka(e.length)),e.forEach(function(r){Ne(t,47,nw(r,0))}),Ne(t,618)}function hR(t){var e=1;Ne(t,619,Ka(e)),Ne(t,48,nR({xfId:0,name:"Normal"})),Ne(t,620)}function dR(t){var e=0;Ne(t,505,Ka(e)),Ne(t,506)}function mR(t){var e=0;Ne(t,508,aR(e,"TableStyleMedium9","PivotStyleMedium4")),Ne(t,509)}function pR(t,e){var r=Zn();return Ne(r,278),sR(r,t.SSF),oR(r),lR(r),cR(r),uR(r),fR(r,e.cellXfs),hR(r),dR(r),mR(r),Ne(r,279),r.end()}var gR=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function xR(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Mn)||[]).forEach(function(a){var o=yt(a);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=o.val;break;case"<a:sysClr":n.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(e.themeElements.clrScheme[gR.indexOf(o[0])]=n,n={}):n.name=o[0].slice(3,o[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function vR(){}function _R(){}var yR=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,TR=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,ER=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function wR(t,e,r){e.themeElements={};var n;[["clrScheme",yR,xR],["fontScheme",TR,vR],["fmtScheme",ER,_R]].forEach(function(a){if(!(n=t.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,e,r)})}var SR=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function aw(t,e){(!t||t.length===0)&&(t=Zp());var r,n={};if(!(r=t.match(SR)))throw new Error("themeElements not found in theme");return wR(r[0],n,e),n.raw=t,n}function Zp(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Br];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function AR(t,e,r){var n=t.l+e,a=t.read_shift(4);if(a!==124226){if(!r.cellStyles){t.l=n;return}var o=t.slice(t.l);t.l=n;var l;try{l=$T(o,{type:"array"})}catch{return}var u=ha(l,"theme/theme/theme1.xml",!0);if(u)return aw(u,r)}}function kR(t){return t.read_shift(4)}function bR(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=CR(t,4);break;case 2:e.xclrValue=LE(t);break;case 3:e.xclrValue=kR(t);break;case 4:t.l+=4;break}return t.l+=8,e}function CR(t,e){return Nn(t,e)}function RR(t,e){return Nn(t,e)}function DR(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=bR(t);break;case 6:n[1]=RR(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function IR(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var a=t.read_shift(2),o=[];a-- >0;)o.push(DR(t,r-t.l));return{ixfe:n,ext:o}}function OR(t,e){e.forEach(function(r){r[0]})}function FR(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Fn(t)}}function NR(t){var e=we(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),un(t.name,e),e.slice(0,e.l)}function MR(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function PR(t){var e=we(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function LR(t,e){var r=we(8+2*e.length);return r.write_shift(4,t),un(e,r),r.slice(0,r.l)}function BR(t){return t.l+=4,t.read_shift(4)!=0}function VR(t,e){var r=we(8);return r.write_shift(4,t),r.write_shift(4,1),r}function UR(t,e,r){var n={Types:[],Cell:[],Value:[]},a=r||{},o=[],l=!1,u=2;return as(t,function(h,d,p){switch(p){case 335:n.Types.push({name:h.name});break;case 51:h.forEach(function(v){u==1?n.Cell.push({type:n.Types[v[0]-1].name,index:v[1]}):u==0&&n.Value.push({type:n.Types[v[0]-1].name,index:v[1]})});break;case 337:u=h?1:0;break;case 338:u=2;break;case 35:o.push(p),l=!0;break;case 36:o.pop(),l=!1;break;default:if(!d.T){if(!l||a.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),n}function jR(){var t=Zn();return Ne(t,332),Ne(t,334,Ka(1)),Ne(t,335,NR({name:"XLDAPR",version:12e4,flags:3496657072})),Ne(t,336),Ne(t,339,LR(1,"XLDAPR")),Ne(t,52),Ne(t,35,Ka(514)),Ne(t,4096,Ka(0)),Ne(t,4097,Ia(1)),Ne(t,36),Ne(t,53),Ne(t,340),Ne(t,337,VR(1)),Ne(t,51,PR([[1,0]])),Ne(t,338),Ne(t,333),t.end()}function zR(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var a=!1,o=2,l;return t.replace(Mn,function(u){var h=yt(u);switch(Ai(h[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:h.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==h.name&&(l=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?n.Cell.push({type:n.Types[h.t-1].name,index:+h.v}):o==0&&n.Value.push({type:n.Types[h.t-1].name,index:+h.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+h.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+h[0]+" in metadata")}return u}),n}function iw(){var t=[Br];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function HR(t){var e=[];if(!t)return e;var r=1;return(t.match(Mn)||[]).forEach(function(n){var a=yt(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,e.push(a);break}}),e}function WR(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=gt(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function GR(t,e,r){var n=[];return as(t,function(o,l,u){switch(u){case 63:n.push(o);break;default:if(!l.T)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function qR(t,e,r,n){if(!t)return t;var a=n||{},o=!1;as(t,function(u,h,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!h.T){if(!o||a.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},a)}function XR(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var tc=1024;function sw(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Ge("xml",null,{"xmlns:v":ca.v,"xmlns:o":ca.o,"xmlns:x":ca.x,"xmlns:mv":ca.mv}).replace(/\/>/,">"),Ge("o:shapelayout",Ge("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Ge("v:shapetype",[Ge("v:stroke",null,{joinstyle:"miter"}),Ge("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];tc<t*1e3;)tc+=1e3;return e.forEach(function(o){var l=Ar(o[0]),u={color2:"#BEFF82",type:"gradient"};u.type=="gradient"&&(u.angle="-180");var h=u.type=="gradient"?Ge("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Ge("v:fill",h,u),p={on:"t",obscured:"t"};++tc,a=a.concat(["<v:shape"+Zu({id:"_x0000_s"+tc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(o[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Ge("v:shadow",null,p),Ge("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",_n("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),_n("x:AutoFill","False"),_n("x:Row",String(l.r)),_n("x:Column",String(l.c)),o[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function ay(t,e,r,n){var a=Array.isArray(t),o;e.forEach(function(l){var u=Ar(l.ref);if(a?(t[u.r]||(t[u.r]=[]),o=t[u.r][u.c]):o=t[l.ref],!o){o={t:"z"},a?t[u.r][u.c]=o:t[l.ref]=o;var h=Gt(t["!ref"]||"BDWGO1000001:A1");h.s.r>u.r&&(h.s.r=u.r),h.e.r<u.r&&(h.e.r=u.r),h.s.c>u.c&&(h.s.c=u.c),h.e.c<u.c&&(h.e.c=u.c);var d=St(h);d!==t["!ref"]&&(t["!ref"]=d)}o.c||(o.c=[]);var p={a:l.author,t:l.t,r:l.r,T:r};l.h&&(p.h=l.h);for(var v=o.c.length-1;v>=0;--v){if(!r&&o.c[v].T)return;r&&!o.c[v].T&&o.c.splice(v,1)}if(r&&n){for(v=0;v<n.length;++v)if(p.a==n[v].id){p.a=n[v].name||p.a;break}}o.c.push(p)})}function YR(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?author[^>]*>(.*)/);u&&r.push(u[1])}});var o=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var u=l.match(/<(?:\w+:)?comment[^>]*>/);if(u){var h=yt(u[0]),d={author:h.authorId&&r[h.authorId]||"sheetjsghost",ref:h.ref,guid:h.guid},p=Ar(h.ref);if(!(e.sheetRows&&e.sheetRows<=p.r)){var v=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),_=!!v&&!!v[1]&&Kp(v[1])||{r:"",t:"",h:""};d.r=_.r,_.r=="<t></t>"&&(_.t=_.h=""),d.t=(_.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(d.h=_.h),n.push(d)}}}}),n}function ow(t){var e=[Br,Ge("comments",null,{xmlns:$o[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(a){var o=sr(a.a);r.indexOf(o)==-1&&(r.push(o),e.push("<author>"+o+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),e.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var a=0,o=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(h){h.a&&(a=r.indexOf(sr(h.a))),o.push(h.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),o.length<=1)e.push(_n("t",sr(o[0]||"")));else{for(var l=`Comment:
    `+o[0]+`
`,u=1;u<o.length;++u)l+=`Reply:
    `+o[u]+`
`;e.push(_n("t",sr(l)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function KR(t,e){var r=[],n=!1,a={},o=0;return t.replace(Mn,function(u,h){var d=yt(u);switch(Ai(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":o=h+u.length;break;case"</text>":a.t=t.slice(o,h).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return u}),r}function $R(t,e,r){var n=[Br,Ge("ThreadedComments",null,{xmlns:Qr.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(a){var o="";(a[1]||[]).forEach(function(l,u){if(!l.T){delete l.ID;return}l.a&&e.indexOf(l.a)==-1&&e.push(l.a);var h={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};u==0?o=h.id:h.parentId=o,l.ID=h.id,l.a&&(h.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(l.a)).slice(-12)+"}"),n.push(Ge("threadedComment",_n("text",l.t||""),h))})}),n.push("</ThreadedComments>"),n.join("")}function QR(t,e){var r=[],n=!1;return t.replace(Mn,function(o){var l=yt(o);switch(Ai(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),r}function ZR(t){var e=[Br,Ge("personList",null,{xmlns:Qr.TCMNT,"xmlns:x":$o[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Ge("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function JR(t){var e={};e.iauthor=t.read_shift(4);var r=el(t);return e.rfx=r.s,e.ref=gt(r.s),t.l+=16,e}function e5(t,e){return e==null&&(e=we(36)),e.write_shift(4,t[1].iauthor),yc(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var t5=Fn;function r5(t){return un(t.slice(0,54))}function n5(t,e){var r=[],n=[],a={},o=!1;return as(t,function(u,h,d){switch(d){case 632:n.push(u);break;case 635:a=u;break;case 637:a.t=u.t,a.h=u.h,a.r=u.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,e.sheetRows&&a.rfx&&e.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!h.T){if(!o||e.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function a5(t){var e=Zn(),r=[];return Ne(e,628),Ne(e,630),t.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),Ne(e,632,r5(a.a)))})}),Ne(e,631),Ne(e,633),t.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var o={s:Ar(n[0]),e:Ar(n[0])};Ne(e,635,e5([o,a])),a.t&&a.t.length>0&&Ne(e,637,kk(a)),Ne(e,636),delete a.iauthor})}),Ne(e,634),Ne(e,629),e.end()}var i5="application/vnd.ms-office.vbaProject";function s5(t){var e=ot.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");ot.utils.cfb_add(e,a,t.FileIndex[n].content)}}),ot.write(e)}function o5(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&ot.utils.cfb_add(t,a,e.FileIndex[n].content)}})}var lw=["xlsb","xlsm","xlam","biff8","xla"];function l5(){return{"!type":"dialog"}}function c5(){return{"!type":"dialog"}}function u5(){return{"!type":"macro"}}function f5(){return{"!type":"macro"}}var ac=(function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,a,o,l){var u=!1,h=!1;o.length==0?h=!0:o.charAt(0)=="["&&(h=!0,o=o.slice(1,-1)),l.length==0?u=!0:l.charAt(0)=="["&&(u=!0,l=l.slice(1,-1));var d=o.length>0?parseInt(o,10)|0:0,p=l.length>0?parseInt(l,10)|0:0;return u?p+=e.c:--p,h?d+=e.r:--d,a+(u?"":"$")+Sr(p)+(h?"":"$")+Lr(d)}return function(a,o){return e=o,a.replace(t,r)}})(),Jp=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,eg=(function(){return function(e,r){return e.replace(Jp,function(n,a,o,l,u,h){var d=Up(l)-(o?0:r.c),p=Vp(h)-(u?0:r.r),v=p==0?"":u?p+1:"["+p+"]",_=d==0?"":o?d+1:"["+d+"]";return a+"R"+v+"C"+_})}})();function cw(t,e){return t.replace(Jp,function(r,n,a,o,l,u){return n+(a=="$"?a+o:Sr(Up(o)+e.c))+(l=="$"?l+u:Lr(Vp(u)+e.r))})}function h5(t,e,r){var n=Jn(e),a=n.s,o=Ar(r),l={r:o.r-a.r,c:o.c-a.c};return cw(t,l)}function d5(t){return t.length!=1}function iy(t){return t.replace(/_xlfn\./g,"")}function zr(t){t.l+=1}function Xs(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function uw(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return fw(t);r.biff==12&&(n=4)}var a=t.read_shift(n),o=t.read_shift(n),l=Xs(t),u=Xs(t);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:o,c:u[0],cRel:u[1],rRel:u[2]}}}function fw(t){var e=Xs(t),r=Xs(t),n=t.read_shift(1),a=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function m5(t,e,r){if(r.biff<8)return fw(t);var n=t.read_shift(r.biff==12?4:2),a=t.read_shift(r.biff==12?4:2),o=Xs(t),l=Xs(t);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function hw(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return p5(t);var n=t.read_shift(r&&r.biff==12?4:2),a=Xs(t);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function p5(t){var e=Xs(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function g5(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function x5(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return v5(t);var a=t.read_shift(n>=12?4:2),o=t.read_shift(2),l=(o&16384)>>14,u=(o&32768)>>15;if(o&=16383,u==1)for(;a>524287;)a-=1048576;if(l==1)for(;o>8191;)o=o-16384;return{r:a,c:o,cRel:l,rRel:u}}function v5(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),a==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:a,rRel:n}}function _5(t,e,r){var n=(t[t.l++]&96)>>5,a=uw(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function y5(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),o=8;if(r)switch(r.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}var l=uw(t,o,r);return[n,a,l]}function T5(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function E5(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),o=8;if(r)switch(r.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}return t.l+=o,[n,a]}function w5(t,e,r){var n=(t[t.l++]&96)>>5,a=m5(t,e-1,r);return[n,a]}function S5(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function sy(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function A5(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),a=[],o=0;o<=n;++o)a.push(t.read_shift(r&&r.biff==2?1:2));return a}function k5(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function b5(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function C5(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function R5(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function dw(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function D5(t){return t.read_shift(2),dw(t)}function I5(t){return t.read_shift(2),dw(t)}function O5(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=hw(t,0,r);return[n,a]}function F5(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=x5(t,0,r);return[n,a]}function N5(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var o=hw(t,0,r);return[n,a,o]}function M5(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(r&&r.biff<=3?1:2);return[B8[a],gw[a],n]}function P5(t,e,r){var n=t[t.l++],a=t.read_shift(1),o=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:L5(t);return[a,(o[0]===0?gw:L8)[o[1]]]}function L5(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function B5(t,e,r){t.l+=r&&r.biff==2?3:4}function V5(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function U5(t){return t.l++,is[t.read_shift(1)]}function j5(t){return t.l++,t.read_shift(2)}function z5(t){return t.l++,t.read_shift(1)!==0}function H5(t){return t.l++,On(t)}function W5(t,e,r){return t.l++,Tf(t,e-1,r)}function G5(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Mr(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=is[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=On(t);break;case 2:r[1]=tl(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function q5(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),a=[],o=0;o!=n;++o)a.push((r.biff==12?el:td)(t));return a}function X5(t,e,r){var n=0,a=0;r.biff==12?(n=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var o=0,l=[];o!=n&&(l[o]=[]);++o)for(var u=0;u!=a;++u)l[o][u]=G5(t,r.biff);return l}function Y5(t,e,r){var n=t.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,o=t.read_shift(a);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,o]}function K5(t,e,r){if(r.biff==5)return $5(t);var n=t.read_shift(1)>>>5&3,a=t.read_shift(2),o=t.read_shift(4);return[n,a,o]}function $5(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function Q5(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function Z5(t,e,r){var n=t.read_shift(1)>>>5&3,a=t.read_shift(r&&r.biff==2?1:2);return[n,a]}function J5(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function e8(t,e,r){var n=(t[t.l++]&96)>>5,a=t.read_shift(2),o=4;if(r)switch(r.biff){case 5:o=15;break;case 12:o=6;break}return t.l+=o,[n,a]}var t8=Nn,r8=Nn,n8=Nn;function wf(t,e,r){return t.l+=2,[g5(t)]}function tg(t){return t.l+=6,[]}var a8=wf,i8=tg,s8=tg,o8=wf;function mw(t){return t.l+=2,[Gr(t),t.read_shift(2)&1]}var l8=wf,c8=mw,u8=tg,f8=wf,h8=wf,d8=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function m8(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),a=t.read_shift(2),o=t.read_shift(2),l=d8[r>>2&31];return{ixti:e,coltype:r&3,rt:l,idx:n,c:a,C:o}}function p8(t){return t.l+=2,[t.read_shift(4)]}function g8(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function x8(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function v8(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function _8(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function y8(t){return t.l+=4,[0,0]}var oy={1:{n:"PtgExp",f:V5},2:{n:"PtgTbl",f:n8},3:{n:"PtgAdd",f:zr},4:{n:"PtgSub",f:zr},5:{n:"PtgMul",f:zr},6:{n:"PtgDiv",f:zr},7:{n:"PtgPower",f:zr},8:{n:"PtgConcat",f:zr},9:{n:"PtgLt",f:zr},10:{n:"PtgLe",f:zr},11:{n:"PtgEq",f:zr},12:{n:"PtgGe",f:zr},13:{n:"PtgGt",f:zr},14:{n:"PtgNe",f:zr},15:{n:"PtgIsect",f:zr},16:{n:"PtgUnion",f:zr},17:{n:"PtgRange",f:zr},18:{n:"PtgUplus",f:zr},19:{n:"PtgUminus",f:zr},20:{n:"PtgPercent",f:zr},21:{n:"PtgParen",f:zr},22:{n:"PtgMissArg",f:zr},23:{n:"PtgStr",f:W5},26:{n:"PtgSheet",f:g8},27:{n:"PtgEndSheet",f:x8},28:{n:"PtgErr",f:U5},29:{n:"PtgBool",f:z5},30:{n:"PtgInt",f:j5},31:{n:"PtgNum",f:H5},32:{n:"PtgArray",f:S5},33:{n:"PtgFunc",f:M5},34:{n:"PtgFuncVar",f:P5},35:{n:"PtgName",f:Y5},36:{n:"PtgRef",f:O5},37:{n:"PtgArea",f:_5},38:{n:"PtgMemArea",f:Q5},39:{n:"PtgMemErr",f:t8},40:{n:"PtgMemNoMem",f:r8},41:{n:"PtgMemFunc",f:Z5},42:{n:"PtgRefErr",f:J5},43:{n:"PtgAreaErr",f:T5},44:{n:"PtgRefN",f:F5},45:{n:"PtgAreaN",f:w5},46:{n:"PtgMemAreaN",f:v8},47:{n:"PtgMemNoMemN",f:_8},57:{n:"PtgNameX",f:K5},58:{n:"PtgRef3d",f:N5},59:{n:"PtgArea3d",f:y5},60:{n:"PtgRefErr3d",f:e8},61:{n:"PtgAreaErr3d",f:E5},255:{}},T8={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},E8={1:{n:"PtgElfLel",f:mw},2:{n:"PtgElfRw",f:f8},3:{n:"PtgElfCol",f:a8},6:{n:"PtgElfRwV",f:h8},7:{n:"PtgElfColV",f:o8},10:{n:"PtgElfRadical",f:l8},11:{n:"PtgElfRadicalS",f:u8},13:{n:"PtgElfColS",f:i8},15:{n:"PtgElfColSV",f:s8},16:{n:"PtgElfRadicalLel",f:c8},25:{n:"PtgList",f:m8},29:{n:"PtgSxName",f:p8},255:{}},w8={0:{n:"PtgAttrNoop",f:y8},1:{n:"PtgAttrSemi",f:R5},2:{n:"PtgAttrIf",f:b5},4:{n:"PtgAttrChoose",f:A5},8:{n:"PtgAttrGoto",f:k5},16:{n:"PtgAttrSum",f:B5},32:{n:"PtgAttrBaxcel",f:sy},33:{n:"PtgAttrBaxcel",f:sy},64:{n:"PtgAttrSpace",f:D5},65:{n:"PtgAttrSpaceSemi",f:I5},128:{n:"PtgAttrIfError",f:C5},255:{}};function Sf(t,e,r,n){if(n.biff<8)return Nn(t,e);for(var a=t.l+e,o=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=X5(t,0,n),o.push(r[l][1]);break;case"PtgMemArea":r[l][2]=q5(t,r[l][1],n),o.push(r[l][2]);break;case"PtgExp":n&&n.biff==12&&(r[l][1][1]=t.read_shift(4),o.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return e=a-t.l,e!==0&&o.push(Nn(t,e)),o}function Af(t,e,r){for(var n=t.l+e,a,o,l=[];n!=t.l;)e=n-t.l,o=t[t.l],a=oy[o]||oy[T8[o]],(o===24||o===25)&&(a=(o===24?E8:w8)[t[t.l+1]]),!a||!a.f?Nn(t,e):l.push([a.n,a.f(t,e,r)]);return l}function S8(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],a=[],o=0;o<n.length;++o){var l=n[o];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var A8={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function k8(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function pw(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(t[n[0]][0]){case 357:return a=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return t[n[0]][0][3]?(a=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function ly(t,e,r){var n=pw(t,e,r);return n=="#REF"?n:k8(n,r)}function Rn(t,e,r,n,a){var o=a&&a.biff||8,l={s:{c:0,r:0}},u=[],h,d,p,v=0,_=0,y,w="";if(!t[0]||!t[0][0])return"";for(var E=-1,S="",L=0,z=t[0].length;L<z;++L){var O=t[0][L];switch(O[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=u.pop(),d=u.pop(),E>=0){switch(t[0][E][1][0]){case 0:S=Rr(" ",t[0][E][1][1]);break;case 1:S=Rr("\r",t[0][E][1][1]);break;default:if(S="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][E][1][0])}d=d+S,E=-1}u.push(d+A8[O[0]]+h);break;case"PtgIsect":h=u.pop(),d=u.pop(),u.push(d+" "+h);break;case"PtgUnion":h=u.pop(),d=u.pop(),u.push(d+","+h);break;case"PtgRange":h=u.pop(),d=u.pop(),u.push(d+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=Mu(O[1][1],l,a),u.push(Pu(p,o));break;case"PtgRefN":p=r?Mu(O[1][1],r,a):O[1][1],u.push(Pu(p,o));break;case"PtgRef3d":v=O[1][1],p=Mu(O[1][2],l,a),w=ly(n,v,a),u.push(w+"!"+Pu(p,o));break;case"PtgFunc":case"PtgFuncVar":var ee=O[1][0],te=O[1][1];ee||(ee=0),ee&=127;var Z=ee==0?[]:u.slice(-ee);u.length-=ee,te==="User"&&(te=Z.shift()),u.push(te+"("+Z.join(",")+")");break;case"PtgBool":u.push(O[1]?"TRUE":"FALSE");break;case"PtgInt":u.push(O[1]);break;case"PtgNum":u.push(String(O[1]));break;case"PtgStr":u.push('"'+O[1].replace(/"/g,'""')+'"');break;case"PtgErr":u.push(O[1]);break;case"PtgAreaN":y=L_(O[1][1],r?{s:r}:l,a),u.push(wm(y,a));break;case"PtgArea":y=L_(O[1][1],l,a),u.push(wm(y,a));break;case"PtgArea3d":v=O[1][1],y=O[1][2],w=ly(n,v,a),u.push(w+"!"+wm(y,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=O[1][2];var C=(n.names||[])[_-1]||(n[0]||[])[_],I=C?C.Name:"SH33TJSNAME"+String(_);I&&I.slice(0,6)=="_xlfn."&&!a.xlfn&&(I=I.slice(6)),u.push(I);break;case"PtgNameX":var R=O[1][1];_=O[1][2];var B;if(a.biff<=5)R<0&&(R=-R),n[R]&&(B=n[R][_]);else{var D="";if(((n[R]||[])[0]||[])[0]==14849||(((n[R]||[])[0]||[])[0]==1025?n[R][_]&&n[R][_].itab>0&&(D=n.SheetNames[n[R][_].itab-1]+"!"):D=n.SheetNames[_-1]+"!"),n[R]&&n[R][_])D+=n[R][_].Name;else if(n[0]&&n[0][_])D+=n[0][_].Name;else{var F=(pw(n,R,a)||"").split(";;");F[_-1]?D=F[_-1]:D+="SH33TJSERRX"}u.push(D);break}B||(B={Name:"SH33TJSERRY"}),u.push(B.Name);break;case"PtgParen":var M="(",Fe=")";if(E>=0){switch(S="",t[0][E][1][0]){case 2:M=Rr(" ",t[0][E][1][1])+M;break;case 3:M=Rr("\r",t[0][E][1][1])+M;break;case 4:Fe=Rr(" ",t[0][E][1][1])+Fe;break;case 5:Fe=Rr("\r",t[0][E][1][1])+Fe;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][E][1][0])}E=-1}u.push(M+u.pop()+Fe);break;case"PtgRefErr":u.push("#REF!");break;case"PtgRefErr3d":u.push("#REF!");break;case"PtgExp":p={c:O[1][1],r:O[1][0]};var Se={c:r.c,r:r.r};if(n.sharedf[gt(p)]){var ne=n.sharedf[gt(p)];u.push(Rn(ne,l,Se,n,a))}else{var se=!1;for(h=0;h!=n.arrayf.length;++h)if(d=n.arrayf[h],!(p.c<d[0].s.c||p.c>d[0].e.c)&&!(p.r<d[0].s.r||p.r>d[0].e.r)){u.push(Rn(d[1],l,Se,n,a)),se=!0;break}se||u.push(O[1])}break;case"PtgArray":u.push("{"+S8(O[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":E=L;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":u.push("");break;case"PtgAreaErr":u.push("#REF!");break;case"PtgAreaErr3d":u.push("#REF!");break;case"PtgList":u.push("Table"+O[1].idx+"[#"+O[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(O));default:throw new Error("Unrecognized Formula Token: "+String(O))}var Le=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&E>=0&&Le.indexOf(t[0][L][0])==-1){O=t[0][E];var ae=!0;switch(O[1][0]){case 4:ae=!1;case 0:S=Rr(" ",O[1][1]);break;case 5:ae=!1;case 1:S=Rr("\r",O[1][1]);break;default:if(S="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+O[1][0])}u.push((ae?S:"")+u.pop()+(ae?"":S)),E=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function b8(t,e,r){var n=t.l+e,a=r.biff==2?1:2,o,l=t.read_shift(a);if(l==65535)return[[],Nn(t,e-2)];var u=Af(t,l,r);return e!==l+a&&(o=Sf(t,e-l-a,u,r)),t.l=n,[u,o]}function C8(t,e,r){var n=t.l+e,a=r.biff==2?1:2,o,l=t.read_shift(a);if(l==65535)return[[],Nn(t,e-2)];var u=Af(t,l,r);return e!==l+a&&(o=Sf(t,e-l-a,u,r)),t.l=n,[u,o]}function R8(t,e,r,n){var a=t.l+e,o=Af(t,n,r),l;return a!==t.l&&(l=Sf(t,a-t.l,o,r)),[o,l]}function D8(t,e,r){var n=t.l+e,a,o=t.read_shift(2),l=Af(t,o,r);return o==65535?[[],Nn(t,e-2)]:(e!==o+2&&(a=Sf(t,n-o-2,l,r)),[l,a])}function I8(t){var e;if(Yi(t,t.l+6)!==65535)return[On(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function O8(t){if(t==null){var e=we(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Wo(t);return Wo(0)}function Cm(t,e,r){var n=t.l+e,a=ki(t);r.biff==2&&++t.l;var o=I8(t),l=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var u=C8(t,n-t.l,r);return{cell:a,val:o[0],formula:u,shared:l>>3&1,tt:o[1]}}function F8(t,e,r,n,a){var o=qo(e,r,a),l=O8(t.v),u=we(6),h=33;u.write_shift(2,h),u.write_shift(4,0);for(var d=we(t.bf.length),p=0;p<t.bf.length;++p)d[p]=t.bf[p];var v=cn([o,l,u,d]);return v}function rd(t,e,r){var n=t.read_shift(4),a=Af(t,n,r),o=t.read_shift(4),l=o>0?Sf(t,o,a,r):null;return[a,l]}var N8=rd,nd=rd,M8=rd,P8=rd,L8={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},gw={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},B8={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function cy(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function V8(t){var e="of:="+t.replace(Jp,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function Rm(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function U8(t){return t.replace(/\./,"!")}var Bu={},ic={},Vu=typeof Map<"u";function rg(t,e,r){var n=0,a=t.length;if(r){if(Vu?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var o=Vu?r.get(e):r[e];n<o.length;++n)if(t[o[n]].t===e)return t.Count++,o[n]}}else for(;n<a;++n)if(t[n].t===e)return t.Count++,n;return t[a]={t:e},t.Count++,t.Unique++,r&&(Vu?(r.has(e)||r.set(e,[]),r.get(e).push(a)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(a))),a}function ad(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Dn=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=nf(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=Ih(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function Uo(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function no(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],a=60,o=t.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){$i(e.z,a),r.ssf[a]=e.z,r.revssf[e.z]=n=a;break}}for(a=0;a!=o;++a)if(t[a].numFmtId===n)return a;return t[o]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function xw(t,e,r,n,a,o){try{n.cellNF&&(t.z=pt[e])}catch(u){if(n.WTF)throw u}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=vr(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(pt[e]==null&&$i(L3[e]||"General",e),t.t==="e")t.w=t.w||is[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=$u(t.v);else if(t.t==="d"){var l=en(t.v);(l|0)===l?t.w=l.toString(10):t.w=$u(l)}else{if(t.v===void 0)return"";t.w=zo(t.v,ic)}else t.t==="d"?t.w=Ma(e,en(t.v),ic):t.w=Ma(e,t.v,ic)}catch(u){if(n.WTF)throw u}if(n.cellStyles&&r!=null)try{t.s=o.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Dh(a.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=a.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Dh(a.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=a.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(u){if(n.WTF&&o.Fills)throw u}}}function j8(t,e,r){if(t&&t["!ref"]){var n=Gt(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function z8(t,e){var r=Gt(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=St(r))}var H8=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,W8=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,G8=/<(?:\w:)?hyperlink [^>]*>/mg,q8=/"(\w*:\w*)"/,X8=/<(?:\w:)?col\b[^>]*[\/]?>/g,Y8=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,K8=/<(?:\w:)?pageMargins[^>]*\/>/g,vw=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,$8=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Q8=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Z8(t,e,r,n,a,o,l){if(!t)return t;n||(n={"!id":{}});var u=e.dense?[]:{},h={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",p="",v=t.match(W8);v?(d=t.slice(0,v.index),p=t.slice(v.index+v[0].length)):d=p=t;var _=d.match(vw);_?ng(_[0],u,a,r):(_=d.match($8))&&eD(_[0],_[1]||"",u,a,r);var y=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(y>0){var w=d.slice(y,y+50).match(q8);w&&z8(u,w[1])}var E=d.match(Q8);E&&E[1]&&dD(E[1],a);var S=[];if(e.cellStyles){var L=d.match(X8);L&&lD(S,L)}v&&gD(v[1],u,e,h,o,l);var z=p.match(Y8);z&&(u["!autofilter"]=uD(z[0]));var O=[],ee=p.match(H8);if(ee)for(y=0;y!=ee.length;++y)O[y]=Gt(ee[y].slice(ee[y].indexOf('"')+1));var te=p.match(G8);te&&iD(u,te,n);var Z=p.match(K8);if(Z&&(u["!margins"]=sD(yt(Z[0]))),!u["!ref"]&&h.e.c>=h.s.c&&h.e.r>=h.s.r&&(u["!ref"]=St(h)),e.sheetRows>0&&u["!ref"]){var C=Gt(u["!ref"]);e.sheetRows<=+C.e.r&&(C.e.r=e.sheetRows-1,C.e.r>h.e.r&&(C.e.r=h.e.r),C.e.r<C.s.r&&(C.s.r=C.e.r),C.e.c>h.e.c&&(C.e.c=h.e.c),C.e.c<C.s.c&&(C.s.c=C.e.c),u["!fullref"]=u["!ref"],u["!ref"]=St(C))}return S.length>0&&(u["!cols"]=S),O.length>0&&(u["!merges"]=O),u}function J8(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+St(t[r])+'"/>';return e+"</mergeCells>"}function ng(t,e,r,n){var a=yt(t);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Wt(fr(a.codeName)))}function eD(t,e,r,n,a){ng(t.slice(0,t.indexOf(">")),r,n,a)}function tD(t,e,r,n,a){var o=!1,l={},u=null;if(n.bookType!=="xlsx"&&e.vbaraw){var h=e.SheetNames[r];try{e.Workbook&&(h=e.Workbook.Sheets[r].CodeName||h)}catch{}o=!0,l.codeName=vi(sr(h))}if(t&&t["!outline"]){var d={summaryBelow:1,summaryRight:1};t["!outline"].above&&(d.summaryBelow=0),t["!outline"].left&&(d.summaryRight=0),u=(u||"")+Ge("outlinePr",null,d)}!o&&!u||(a[a.length]=Ge("sheetPr",u,l))}var rD=["objects","scenarios","selectLockedCells","selectUnlockedCells"],nD=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function aD(t){var e={sheet:1};return rD.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),nD.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=$p(t.password).toString(16).toUpperCase()),Ge("sheetProtection",null,e)}function iD(t,e,r){for(var n=Array.isArray(t),a=0;a!=e.length;++a){var o=yt(fr(e[a]),!0);if(!o.ref)return;var l=((r||{})["!id"]||[])[o.id];l?(o.Target=l.Target,o.location&&(o.Target+="#"+Wt(o.location))):(o.Target="#"+Wt(o.location),l={Target:o.Target,TargetMode:"Internal"}),o.Rel=l,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var u=Gt(o.ref),h=u.s.r;h<=u.e.r;++h)for(var d=u.s.c;d<=u.e.c;++d){var p=gt({c:d,r:h});n?(t[h]||(t[h]=[]),t[h][d]||(t[h][d]={t:"z",v:void 0}),t[h][d].l=o):(t[p]||(t[p]={t:"z",v:void 0}),t[p].l=o)}}}function sD(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function oD(t){return Uo(t),Ge("pageMargins",null,t)}function lD(t,e){for(var r=!1,n=0;n!=e.length;++n){var a=yt(e[n],!0);a.hidden&&(a.hidden=gr(a.hidden));var o=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,Qp(a.width)),qs(a);o<=l;)t[o++]=_r(a)}}function cD(t,e){for(var r=["<cols>"],n,a=0;a!=e.length;++a)(n=e[a])&&(r[r.length]=Ge("col",null,ad(a,n)));return r[r.length]="</cols>",r.join("")}function uD(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function fD(t,e,r,n){var a=typeof t.ref=="string"?t.ref:St(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,l=Jn(a);l.s.r==l.e.r&&(l.e.r=Jn(e["!ref"]).e.r,a=St(l));for(var u=0;u<o.length;++u){var h=o[u];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==n){h.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return u==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Ge("autoFilter",null,{ref:a})}var hD=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function dD(t,e){e.Views||(e.Views=[{}]),(t.match(hD)||[]).forEach(function(r,n){var a=yt(r);e.Views[n]||(e.Views[n]={}),+a.zoomScale&&(e.Views[n].zoom=+a.zoomScale),gr(a.rightToLeft)&&(e.Views[n].RTL=!0)})}function mD(t,e,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ge("sheetViews",Ge("sheetView",null,a),{})}function pD(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var a="",o=t.t,l=t.v;if(t.t!=="z")switch(t.t){case"b":a=t.v?"1":"0";break;case"n":a=""+t.v;break;case"e":a=is[t.v];break;case"d":n&&n.cellDates?a=vr(t.v,-1).toISOString():(t=_r(t),t.t="n",a=""+(t.v=en(vr(t.v)))),typeof t.z>"u"&&(t.z=pt[14]);break;default:a=t.v;break}var u=_n("v",sr(a)),h={r:e},d=no(n.cellXfs,t,n);switch(d!==0&&(h.s=d),t.t){case"n":break;case"d":h.t="d";break;case"b":h.t="b";break;case"e":h.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){u=_n("v",""+rg(n.Strings,t.v,n.revStrings)),h.t="s";break}h.t="str";break}if(t.t!=o&&(t.t=o,t.v=l),typeof t.f=="string"&&t.f){var p=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;u=Ge("f",sr(t.f),p)+(t.v!=null?u:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(h.cm=1),Ge("c",u,h)}var gD=(function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,o=Qu("v"),l=Qu("f");return function(h,d,p,v,_,y){for(var w=0,E="",S=[],L=[],z=0,O=0,ee=0,te="",Z,C,I=0,R=0,B,D,F=0,M=0,Fe=Array.isArray(y.CellXf),Se,ne=[],se=[],Le=Array.isArray(d),ae=[],W={},pe=!1,V=!!p.sheetStubs,Y=h.split(e),Q=0,J=Y.length;Q!=J;++Q){E=Y[Q].trim();var ue=E.length;if(ue!==0){var Ie=0;e:for(w=0;w<ue;++w)switch(E[w]){case">":if(E[w-1]!="/"){++w;break e}if(p&&p.cellStyles){if(C=yt(E.slice(Ie,w),!0),I=C.r!=null?parseInt(C.r,10):I+1,R=-1,p.sheetRows&&p.sheetRows<I)continue;W={},pe=!1,C.ht&&(pe=!0,W.hpt=parseFloat(C.ht),W.hpx=uc(W.hpt)),C.hidden=="1"&&(pe=!0,W.hidden=!0),C.outlineLevel!=null&&(pe=!0,W.level=+C.outlineLevel),pe&&(ae[I-1]=W)}break;case"<":Ie=w;break}if(Ie>=w)break;if(C=yt(E.slice(Ie,w),!0),I=C.r!=null?parseInt(C.r,10):I+1,R=-1,!(p.sheetRows&&p.sheetRows<I)){v.s.r>I-1&&(v.s.r=I-1),v.e.r<I-1&&(v.e.r=I-1),p&&p.cellStyles&&(W={},pe=!1,C.ht&&(pe=!0,W.hpt=parseFloat(C.ht),W.hpx=uc(W.hpt)),C.hidden=="1"&&(pe=!0,W.hidden=!0),C.outlineLevel!=null&&(pe=!0,W.level=+C.outlineLevel),pe&&(ae[I-1]=W)),S=E.slice(w).split(t);for(var ke=0;ke!=S.length&&S[ke].trim().charAt(0)=="<";++ke);for(S=S.slice(ke),w=0;w!=S.length;++w)if(E=S[w].trim(),E.length!==0){if(L=E.match(r),z=w,O=0,ee=0,E="<c "+(E.slice(0,1)=="<"?">":"")+E,L!=null&&L.length===2){for(z=0,te=L[1],O=0;O!=te.length&&!((ee=te.charCodeAt(O)-64)<1||ee>26);++O)z=26*z+ee;--z,R=z}else++R;for(O=0;O!=E.length&&E.charCodeAt(O)!==62;++O);if(++O,C=yt(E.slice(0,O),!0),C.r||(C.r=gt({r:I-1,c:R})),te=E.slice(O),Z={t:""},(L=te.match(o))!=null&&L[1]!==""&&(Z.v=Wt(L[1])),p.cellFormula){if((L=te.match(l))!=null&&L[1]!==""){if(Z.f=Wt(fr(L[1])).replace(/\r\n/g,`
`),p.xlfn||(Z.f=iy(Z.f)),L[0].indexOf('t="array"')>-1)Z.F=(te.match(a)||[])[1],Z.F.indexOf(":")>-1&&ne.push([Gt(Z.F),Z.F]);else if(L[0].indexOf('t="shared"')>-1){D=yt(L[0]);var Oe=Wt(fr(L[1]));p.xlfn||(Oe=iy(Oe)),se[parseInt(D.si,10)]=[D,Oe,C.r]}}else(L=te.match(/<f[^>]*\/>/))&&(D=yt(L[0]),se[D.si]&&(Z.f=h5(se[D.si][1],se[D.si][2],C.r)));var le=Ar(C.r);for(O=0;O<ne.length;++O)le.r>=ne[O][0].s.r&&le.r<=ne[O][0].e.r&&le.c>=ne[O][0].s.c&&le.c<=ne[O][0].e.c&&(Z.F=ne[O][1])}if(C.t==null&&Z.v===void 0)if(Z.f||Z.F)Z.v=0,Z.t="n";else if(V)Z.t="z";else continue;else Z.t=C.t||"n";switch(v.s.c>R&&(v.s.c=R),v.e.c<R&&(v.e.c=R),Z.t){case"n":if(Z.v==""||Z.v==null){if(!V)continue;Z.t="z"}else Z.v=parseFloat(Z.v);break;case"s":if(typeof Z.v>"u"){if(!V)continue;Z.t="z"}else B=Bu[parseInt(Z.v,10)],Z.v=B.t,Z.r=B.r,p.cellHTML&&(Z.h=B.h);break;case"str":Z.t="s",Z.v=Z.v!=null?fr(Z.v):"",p.cellHTML&&(Z.h=Mp(Z.v));break;case"inlineStr":L=te.match(n),Z.t="s",L!=null&&(B=Kp(L[1]))?(Z.v=B.t,p.cellHTML&&(Z.h=B.h)):Z.v="";break;case"b":Z.v=gr(Z.v);break;case"d":p.cellDates?Z.v=vr(Z.v,1):(Z.v=en(vr(Z.v,1)),Z.t="n");break;case"e":(!p||p.cellText!==!1)&&(Z.w=Z.v),Z.v=yE[Z.v];break}if(F=M=0,Se=null,Fe&&C.s!==void 0&&(Se=y.CellXf[C.s],Se!=null&&(Se.numFmtId!=null&&(F=Se.numFmtId),p.cellStyles&&Se.fillId!=null&&(M=Se.fillId))),xw(Z,F,M,p,_,y),p.cellDates&&Fe&&Z.t=="n"&&xc(pt[F])&&(Z.t="d",Z.v=ed(Z.v)),C.cm&&p.xlmeta){var Qe=(p.xlmeta.Cell||[])[+C.cm-1];Qe&&Qe.type=="XLDAPR"&&(Z.D=!0)}if(Le){var G=Ar(C.r);d[G.r]||(d[G.r]=[]),d[G.r][G.c]=Z}else d[C.r]=Z}}}}ae.length>0&&(d["!rows"]=ae)}})();function xD(t,e,r,n){var a=[],o=[],l=Gt(t["!ref"]),u="",h,d="",p=[],v=0,_=0,y=t["!rows"],w=Array.isArray(t),E={r:d},S,L=-1;for(_=l.s.c;_<=l.e.c;++_)p[_]=Sr(_);for(v=l.s.r;v<=l.e.r;++v){for(o=[],d=Lr(v),_=l.s.c;_<=l.e.c;++_){h=p[_]+d;var z=w?(t[v]||[])[_]:t[h];z!==void 0&&(u=pD(z,h,t,e))!=null&&o.push(u)}(o.length>0||y&&y[v])&&(E={r:d},y&&y[v]&&(S=y[v],S.hidden&&(E.hidden=1),L=-1,S.hpx?L=af(S.hpx):S.hpt&&(L=S.hpt),L>-1&&(E.ht=L,E.customHeight=1),S.level&&(E.outlineLevel=S.level)),a[a.length]=Ge("row",o.join(""),E))}if(y)for(;v<y.length;++v)y&&y[v]&&(E={r:v+1},S=y[v],S.hidden&&(E.hidden=1),L=-1,S.hpx?L=af(S.hpx):S.hpt&&(L=S.hpt),L>-1&&(E.ht=L,E.customHeight=1),S.level&&(E.outlineLevel=S.level),a[a.length]=Ge("row","",E));return a.join("")}function _w(t,e,r,n){var a=[Br,Ge("worksheet",null,{xmlns:$o[0],"xmlns:r":Qr.r})],o=r.SheetNames[t],l=0,u="",h=r.Sheets[o];h==null&&(h={});var d=h["!ref"]||"A1",p=Gt(d);if(p.e.c>16383||p.e.r>1048575){if(e.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575),d=St(p)}n||(n={}),h["!comments"]=[];var v=[];tD(h,r,t,e,a),a[a.length]=Ge("dimension",null,{ref:d}),a[a.length]=mD(h,e,t,r),e.sheetFormat&&(a[a.length]=Ge("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),h["!cols"]!=null&&h["!cols"].length>0&&(a[a.length]=cD(h,h["!cols"])),a[l=a.length]="<sheetData/>",h["!links"]=[],h["!ref"]!=null&&(u=xD(h,e),u.length>0&&(a[a.length]=u)),a.length>l+1&&(a[a.length]="</sheetData>",a[l]=a[l].replace("/>",">")),h["!protect"]&&(a[a.length]=aD(h["!protect"])),h["!autofilter"]!=null&&(a[a.length]=fD(h["!autofilter"],h,r,t)),h["!merges"]!=null&&h["!merges"].length>0&&(a[a.length]=J8(h["!merges"]));var _=-1,y,w=-1;return h["!links"].length>0&&(a[a.length]="<hyperlinks>",h["!links"].forEach(function(E){E[1].Target&&(y={ref:E[0]},E[1].Target.charAt(0)!="#"&&(w=ir(n,-1,sr(E[1].Target).replace(/#.*$/,""),It.HLINK),y["r:id"]="rId"+w),(_=E[1].Target.indexOf("#"))>-1&&(y.location=sr(E[1].Target.slice(_+1))),E[1].Tooltip&&(y.tooltip=sr(E[1].Tooltip)),a[a.length]=Ge("hyperlink",null,y))}),a[a.length]="</hyperlinks>"),delete h["!links"],h["!margins"]!=null&&(a[a.length]=oD(h["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(a[a.length]=_n("ignoredErrors",Ge("ignoredError",null,{numberStoredAsText:1,sqref:d}))),v.length>0&&(w=ir(n,-1,"../drawings/drawing"+(t+1)+".xml",It.DRAW),a[a.length]=Ge("drawing",null,{"r:id":"rId"+w}),h["!drawing"]=v),h["!comments"].length>0&&(w=ir(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",It.VML),a[a.length]=Ge("legacyDrawing",null,{"r:id":"rId"+w}),h["!legacy"]=w),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function vD(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var o=t.read_shift(1);return t.l=n,o&7&&(r.level=o&7),o&16&&(r.hidden=!0),o&32&&(r.hpt=a/20),r}function _D(t,e,r){var n=we(145),a=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var o=320;a.hpx?o=af(a.hpx)*20:a.hpt&&(o=a.hpt*20),n.write_shift(2,o),n.write_shift(1,0);var l=0;a.level&&(l|=a.level),a.hidden&&(l|=16),(a.hpx||a.hpt)&&(l|=32),n.write_shift(1,l),n.write_shift(1,0);var u=0,h=n.l;n.l+=4;for(var d={r:t,c:0},p=0;p<16;++p)if(!(e.s.c>p+1<<10||e.e.c<p<<10)){for(var v=-1,_=-1,y=p<<10;y<p+1<<10;++y){d.c=y;var w=Array.isArray(r)?(r[d.r]||[])[d.c]:r[gt(d)];w&&(v<0&&(v=y),_=y)}v<0||(++u,n.write_shift(4,v),n.write_shift(4,_))}var E=n.l;return n.l=h,n.write_shift(4,u),n.l=E,n.length>n.l?n.slice(0,n.l):n}function yD(t,e,r,n){var a=_D(n,r,e);(a.length>17||(e["!rows"]||[])[n])&&Ne(t,0,a)}var TD=el,ED=yc;function wD(){}function SD(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=bk(t),r}function AD(t,e,r){r==null&&(r=we(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return bh({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),pE(t,r),r.slice(0,r.l)}function kD(t){var e=Pa(t);return[e]}function bD(t,e,r){return r==null&&(r=we(8)),Qo(e,r)}function CD(t){var e=Zo(t);return[e]}function RD(t,e,r){return r==null&&(r=we(4)),Jo(e,r)}function DD(t){var e=Pa(t),r=t.read_shift(1);return[e,r,"b"]}function ID(t,e,r){return r==null&&(r=we(9)),Qo(e,r),r.write_shift(1,t.v?1:0),r}function OD(t){var e=Zo(t),r=t.read_shift(1);return[e,r,"b"]}function FD(t,e,r){return r==null&&(r=we(5)),Jo(e,r),r.write_shift(1,t.v?1:0),r}function ND(t){var e=Pa(t),r=t.read_shift(1);return[e,r,"e"]}function MD(t,e,r){return r==null&&(r=we(9)),Qo(e,r),r.write_shift(1,t.v),r}function PD(t){var e=Zo(t),r=t.read_shift(1);return[e,r,"e"]}function LD(t,e,r){return r==null&&(r=we(8)),Jo(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function BD(t){var e=Pa(t),r=t.read_shift(4);return[e,r,"s"]}function VD(t,e,r){return r==null&&(r=we(12)),Qo(e,r),r.write_shift(4,e.v),r}function UD(t){var e=Zo(t),r=t.read_shift(4);return[e,r,"s"]}function jD(t,e,r){return r==null&&(r=we(8)),Jo(e,r),r.write_shift(4,e.v),r}function zD(t){var e=Pa(t),r=On(t);return[e,r,"n"]}function HD(t,e,r){return r==null&&(r=we(16)),Qo(e,r),Wo(t.v,r),r}function yw(t){var e=Zo(t),r=On(t);return[e,r,"n"]}function WD(t,e,r){return r==null&&(r=we(12)),Jo(e,r),Wo(t.v,r),r}function GD(t){var e=Pa(t),r=Wp(t);return[e,r,"n"]}function qD(t,e,r){return r==null&&(r=we(12)),Qo(e,r),gE(t.v,r),r}function XD(t){var e=Zo(t),r=Wp(t);return[e,r,"n"]}function YD(t,e,r){return r==null&&(r=we(8)),Jo(e,r),gE(t.v,r),r}function KD(t){var e=Pa(t),r=jp(t);return[e,r,"is"]}function $D(t){var e=Pa(t),r=Fn(t);return[e,r,"str"]}function QD(t,e,r){return r==null&&(r=we(12+4*t.v.length)),Qo(e,r),un(t.v,r),r.length>r.l?r.slice(0,r.l):r}function ZD(t){var e=Zo(t),r=Fn(t);return[e,r,"str"]}function JD(t,e,r){return r==null&&(r=we(8+4*t.v.length)),Jo(e,r),un(t.v,r),r.length>r.l?r.slice(0,r.l):r}function eI(t,e,r){var n=t.l+e,a=Pa(t);a.r=r["!row"];var o=t.read_shift(1),l=[a,o,"b"];if(r.cellFormula){t.l+=2;var u=nd(t,n-t.l,r);l[3]=Rn(u,null,a,r.supbooks,r)}else t.l=n;return l}function tI(t,e,r){var n=t.l+e,a=Pa(t);a.r=r["!row"];var o=t.read_shift(1),l=[a,o,"e"];if(r.cellFormula){t.l+=2;var u=nd(t,n-t.l,r);l[3]=Rn(u,null,a,r.supbooks,r)}else t.l=n;return l}function rI(t,e,r){var n=t.l+e,a=Pa(t);a.r=r["!row"];var o=On(t),l=[a,o,"n"];if(r.cellFormula){t.l+=2;var u=nd(t,n-t.l,r);l[3]=Rn(u,null,a,r.supbooks,r)}else t.l=n;return l}function nI(t,e,r){var n=t.l+e,a=Pa(t);a.r=r["!row"];var o=Fn(t),l=[a,o,"str"];if(r.cellFormula){t.l+=2;var u=nd(t,n-t.l,r);l[3]=Rn(u,null,a,r.supbooks,r)}else t.l=n;return l}var aI=el,iI=yc;function sI(t,e){return e==null&&(e=we(4)),e.write_shift(4,t),e}function oI(t,e){var r=t.l+e,n=el(t),a=zp(t),o=Fn(t),l=Fn(t),u=Fn(t);t.l=r;var h={rfx:n,relId:a,loc:o,display:u};return l&&(h.Tooltip=l),h}function lI(t,e){var r=we(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));yc({s:Ar(t[0]),e:Ar(t[0])},r),Hp("rId"+e,r);var n=t[1].Target.indexOf("#"),a=n==-1?"":t[1].Target.slice(n+1);return un(a||"",r),un(t[1].Tooltip||"",r),un("",r),r.slice(0,r.l)}function cI(){}function uI(t,e,r){var n=t.l+e,a=xE(t),o=t.read_shift(1),l=[a];if(l[2]=o,r.cellFormula){var u=N8(t,n-t.l,r);l[1]=u}else t.l=n;return l}function fI(t,e,r){var n=t.l+e,a=el(t),o=[a];if(r.cellFormula){var l=P8(t,n-t.l,r);o[1]=l,t.l=n}else t.l=n;return o}function hI(t,e,r){r==null&&(r=we(18));var n=ad(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return e.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),e.level&&(a|=e.level<<8),r.write_shift(2,a),r}var Tw=["left","right","top","bottom","header","footer"];function dI(t){var e={};return Tw.forEach(function(r){e[r]=On(t)}),e}function mI(t,e){return e==null&&(e=we(48)),Uo(t),Tw.forEach(function(r){Wo(t[r],e)}),e}function pI(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function gI(t,e,r){r==null&&(r=we(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function xI(t){var e=we(24);return e.write_shift(4,4),e.write_shift(4,1),yc(t,e),e}function vI(t,e){return e==null&&(e=we(66)),e.write_shift(2,t.password?$p(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function _I(){}function yI(){}function TI(t,e,r,n,a,o,l){if(!t)return t;var u=e||{};n||(n={"!id":{}});var h=u.dense?[]:{},d,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=!1,_=!1,y,w,E,S,L,z,O,ee,te,Z=[];u.biff=12,u["!row"]=0;var C=0,I=!1,R=[],B={},D=u.supbooks||a.supbooks||[[]];if(D.sharedf=B,D.arrayf=R,D.SheetNames=a.SheetNames||a.Sheets.map(function(Le){return Le.name}),!u.supbooks&&(u.supbooks=D,a.Names))for(var F=0;F<a.Names.length;++F)D[0][F+1]=a.Names[F];var M=[],Fe=[],Se=!1;sf[16]={n:"BrtShortReal",f:yw};var ne;if(as(t,function(ae,W,pe){if(!_)switch(pe){case 148:d=ae;break;case 0:y=ae,u.sheetRows&&u.sheetRows<=y.r&&(_=!0),ee=Lr(S=y.r),u["!row"]=y.r,(ae.hidden||ae.hpt||ae.level!=null)&&(ae.hpt&&(ae.hpx=uc(ae.hpt)),Fe[ae.r]=ae);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(w={t:ae[2]},ae[2]){case"n":w.v=ae[1];break;case"s":O=Bu[ae[1]],w.v=O.t,w.r=O.r;break;case"b":w.v=!!ae[1];break;case"e":w.v=ae[1],u.cellText!==!1&&(w.w=is[w.v]);break;case"str":w.t="s",w.v=ae[1];break;case"is":w.t="s",w.v=ae[1].t;break}if((E=l.CellXf[ae[0].iStyleRef])&&xw(w,E.numFmtId,null,u,o,l),L=ae[0].c==-1?L+1:ae[0].c,u.dense?(h[S]||(h[S]=[]),h[S][L]=w):h[Sr(L)+ee]=w,u.cellFormula){for(I=!1,C=0;C<R.length;++C){var V=R[C];y.r>=V[0].s.r&&y.r<=V[0].e.r&&L>=V[0].s.c&&L<=V[0].e.c&&(w.F=St(V[0]),I=!0)}!I&&ae.length>3&&(w.f=ae[3])}if(p.s.r>y.r&&(p.s.r=y.r),p.s.c>L&&(p.s.c=L),p.e.r<y.r&&(p.e.r=y.r),p.e.c<L&&(p.e.c=L),u.cellDates&&E&&w.t=="n"&&xc(pt[E.numFmtId])){var Y=Mo(w.v);Y&&(w.t="d",w.v=new Date(Y.y,Y.m-1,Y.d,Y.H,Y.M,Y.S,Y.u))}ne&&(ne.type=="XLDAPR"&&(w.D=!0),ne=void 0);break;case 1:case 12:if(!u.sheetStubs||v)break;w={t:"z",v:void 0},L=ae[0].c==-1?L+1:ae[0].c,u.dense?(h[S]||(h[S]=[]),h[S][L]=w):h[Sr(L)+ee]=w,p.s.r>y.r&&(p.s.r=y.r),p.s.c>L&&(p.s.c=L),p.e.r<y.r&&(p.e.r=y.r),p.e.c<L&&(p.e.c=L),ne&&(ne.type=="XLDAPR"&&(w.D=!0),ne=void 0);break;case 176:Z.push(ae);break;case 49:ne=((u.xlmeta||{}).Cell||[])[ae-1];break;case 494:var Q=n["!id"][ae.relId];for(Q?(ae.Target=Q.Target,ae.loc&&(ae.Target+="#"+ae.loc),ae.Rel=Q):ae.relId==""&&(ae.Target="#"+ae.loc),S=ae.rfx.s.r;S<=ae.rfx.e.r;++S)for(L=ae.rfx.s.c;L<=ae.rfx.e.c;++L)u.dense?(h[S]||(h[S]=[]),h[S][L]||(h[S][L]={t:"z",v:void 0}),h[S][L].l=ae):(z=gt({c:L,r:S}),h[z]||(h[z]={t:"z",v:void 0}),h[z].l=ae);break;case 426:if(!u.cellFormula)break;R.push(ae),te=u.dense?h[S][L]:h[Sr(L)+ee],te.f=Rn(ae[1],p,{r:y.r,c:L},D,u),te.F=St(ae[0]);break;case 427:if(!u.cellFormula)break;B[gt(ae[0].s)]=ae[1],te=u.dense?h[S][L]:h[Sr(L)+ee],te.f=Rn(ae[1],p,{r:y.r,c:L},D,u);break;case 60:if(!u.cellStyles)break;for(;ae.e>=ae.s;)M[ae.e--]={width:ae.w/256,hidden:!!(ae.flags&1),level:ae.level},Se||(Se=!0,Qp(ae.w/256)),qs(M[ae.e+1]);break;case 161:h["!autofilter"]={ref:St(ae)};break;case 476:h["!margins"]=ae;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),ae.name&&(a.Sheets[r].CodeName=ae.name),(ae.above||ae.left)&&(h["!outline"]={above:ae.above,left:ae.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),ae.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:v=!0;break;case 36:v=!1;break;case 37:v=!0;break;case 38:v=!1;break;default:if(!W.T){if(!v||u.WTF)throw new Error("Unexpected record 0x"+pe.toString(16))}}},u),delete u.supbooks,delete u["!row"],!h["!ref"]&&(p.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(h["!ref"]=St(d||p)),u.sheetRows&&h["!ref"]){var se=Gt(h["!ref"]);u.sheetRows<=+se.e.r&&(se.e.r=u.sheetRows-1,se.e.r>p.e.r&&(se.e.r=p.e.r),se.e.r<se.s.r&&(se.s.r=se.e.r),se.e.c>p.e.c&&(se.e.c=p.e.c),se.e.c<se.s.c&&(se.s.c=se.e.c),h["!fullref"]=h["!ref"],h["!ref"]=St(se))}return Z.length>0&&(h["!merges"]=Z),M.length>0&&(h["!cols"]=M),Fe.length>0&&(h["!rows"]=Fe),h}function EI(t,e,r,n,a,o,l){if(e.v===void 0)return!1;var u="";switch(e.t){case"b":u=e.v?"1":"0";break;case"d":e=_r(e),e.z=e.z||pt[14],e.v=en(vr(e.v)),e.t="n";break;case"n":case"e":u=""+e.v;break;default:u=e.v;break}var h={r,c:n};switch(h.s=no(a.cellXfs,e,a),e.l&&o["!links"].push([gt(h),e.l]),e.c&&o["!comments"].push([gt(h),e.c]),e.t){case"s":case"str":return a.bookSST?(u=rg(a.Strings,e.v,a.revStrings),h.t="s",h.v=u,l?Ne(t,18,jD(e,h)):Ne(t,7,VD(e,h))):(h.t="str",l?Ne(t,17,JD(e,h)):Ne(t,6,QD(e,h))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?l?Ne(t,13,YD(e,h)):Ne(t,2,qD(e,h)):l?Ne(t,16,WD(e,h)):Ne(t,5,HD(e,h)),!0;case"b":return h.t="b",l?Ne(t,15,FD(e,h)):Ne(t,4,ID(e,h)),!0;case"e":return h.t="e",l?Ne(t,14,LD(e,h)):Ne(t,3,MD(e,h)),!0}return l?Ne(t,12,RD(e,h)):Ne(t,1,bD(e,h)),!0}function wI(t,e,r,n){var a=Gt(e["!ref"]||"A1"),o,l="",u=[];Ne(t,145);var h=Array.isArray(e),d=a.e.r;e["!rows"]&&(d=Math.max(a.e.r,e["!rows"].length-1));for(var p=a.s.r;p<=d;++p){l=Lr(p),yD(t,e,a,p);var v=!1;if(p<=a.e.r)for(var _=a.s.c;_<=a.e.c;++_){p===a.s.r&&(u[_]=Sr(_)),o=u[_]+l;var y=h?(e[p]||[])[_]:e[o];if(!y){v=!1;continue}v=EI(t,y,p,_,n,e,v)}}Ne(t,146)}function SI(t,e){!e||!e["!merges"]||(Ne(t,177,sI(e["!merges"].length)),e["!merges"].forEach(function(r){Ne(t,176,iI(r))}),Ne(t,178))}function AI(t,e){!e||!e["!cols"]||(Ne(t,390),e["!cols"].forEach(function(r,n){r&&Ne(t,60,hI(n,r))}),Ne(t,391))}function kI(t,e){!e||!e["!ref"]||(Ne(t,648),Ne(t,649,xI(Gt(e["!ref"]))),Ne(t,650))}function bI(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var a=ir(r,-1,n[1].Target.replace(/#.*$/,""),It.HLINK);Ne(t,494,lI(n,a))}}),delete e["!links"]}function CI(t,e,r,n){if(e["!comments"].length>0){var a=ir(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",It.VML);Ne(t,551,Hp("rId"+a)),e["!legacy"]=a}}function RI(t,e,r,n){if(e["!autofilter"]){var a=e["!autofilter"],o=typeof a.ref=="string"?a.ref:St(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,u=Jn(o);u.s.r==u.e.r&&(u.e.r=Jn(e["!ref"]).e.r,o=St(u));for(var h=0;h<l.length;++h){var d=l[h];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+o;break}}h==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+o}),Ne(t,161,yc(Gt(o))),Ne(t,162)}}function DI(t,e,r){Ne(t,133),Ne(t,137,gI(e,r)),Ne(t,138),Ne(t,134)}function II(t,e){e["!protect"]&&Ne(t,535,vI(e["!protect"]))}function OI(t,e,r,n){var a=Zn(),o=r.SheetNames[t],l=r.Sheets[o]||{},u=o;try{r&&r.Workbook&&(u=r.Workbook.Sheets[t].CodeName||u)}catch{}var h=Gt(l["!ref"]||"A1");if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],Ne(a,129),(r.vbaraw||l["!outline"])&&Ne(a,147,AD(u,l["!outline"])),Ne(a,148,ED(h)),DI(a,l,r.Workbook),AI(a,l),wI(a,l,t,e),II(a,l),RI(a,l,r,t),SI(a,l),bI(a,l,n),l["!margins"]&&Ne(a,476,mI(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&kI(a,l),CI(a,l,t,n),Ne(a,130),a.end()}function FI(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var l=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(e[+l[1]]=r?+l[2]:l[2])});var a=Wt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){n=o.replace(/<.*?>/g,"")}),[e,a,n]}function NI(t,e,r,n,a,o){var l=o||{"!type":"chart"};if(!t)return o;var u=0,h=0,d="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(v){var _=FI(v);p.s.r=p.s.c=0,p.e.c=u,d=Sr(u),_[0].forEach(function(y,w){l[d+Lr(w)]={t:"n",v:y,z:_[1]},h=w}),p.e.r<h&&(p.e.r=h),++u}),u>0&&(l["!ref"]=St(p)),l}function MI(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l,u=t.match(vw);return u&&ng(u[0],o,a,r),(l=t.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=l[1]),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}function PI(t,e){t.l+=10;var r=Fn(t);return{name:r}}function LI(t,e,r,n,a){if(!t)return t;n||(n={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},l=!1;return as(t,function(h,d,p){switch(p){case 550:o["!rel"]=h;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),h.name&&(a.Sheets[r].CodeName=h.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!l||e.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},e),n["!id"][o["!rel"]]&&(o["!drawel"]=n["!id"][o["!rel"]]),o}var ag=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],BI=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],VI=[],UI=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function uy(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],a=0;a!=e.length;++a){var o=e[a];if(n[o[0]]==null)n[o[0]]=o[1];else switch(o[2]){case"bool":typeof n[o[0]]=="string"&&(n[o[0]]=gr(n[o[0]]));break;case"int":typeof n[o[0]]=="string"&&(n[o[0]]=parseInt(n[o[0]],10));break}}}function fy(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=gr(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function Ew(t){fy(t.WBProps,ag),fy(t.CalcPr,UI),uy(t.WBView,BI),uy(t.Sheets,VI),ic.date1904=gr(t.WBProps.date1904)}function jI(t){return!t.Workbook||!t.Workbook.WBProps?"false":gr(t.Workbook.WBProps.date1904)?"true":"false"}var zI="][*?/\\".split("");function ww(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return zI.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function HI(t,e,r){t.forEach(function(n,a){ww(n);for(var o=0;o<a;++o)if(n==t[o])throw new Error("Duplicate Sheet Name: "+n);if(r){var l=e&&e[a]&&e[a].CodeName||n;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function WI(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];HI(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)j8(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var GI=/<\w+:workbook/;function qI(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",o={},l=0;if(t.replace(Mn,function(h,d){var p=yt(h);switch(Ai(p[0])){case"<?xml":break;case"<workbook":h.match(GI)&&(a="xmlns"+h.match(/<(\w+):/)[1]),r.xmlns=p[a];break;case"</workbook>":break;case"<fileVersion":delete p[0],r.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":ag.forEach(function(v){if(p[v[0]]!=null)switch(v[2]){case"bool":r.WBProps[v[0]]=gr(p[v[0]]);break;case"int":r.WBProps[v[0]]=parseInt(p[v[0]],10);break;default:r.WBProps[v[0]]=p[v[0]]}}),p.codeName&&(r.WBProps.CodeName=fr(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],r.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=Wt(fr(p.name)),delete p[0],r.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":o={},o.Name=fr(p.name),p.comment&&(o.Comment=p.comment),p.localSheetId&&(o.Sheet=+p.localSheetId),gr(p.hidden||"0")&&(o.Hidden=!0),l=d+h.length;break;case"</definedName>":o.Ref=Wt(fr(t.slice(l,d))),r.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete p[0],r.CalcPr=p;break;case"<calcPr/>":delete p[0],r.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return h}),$o.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return Ew(r),r}function Sw(t){var e=[Br];e[e.length]=Ge("workbook",null,{xmlns:$o[0],"xmlns:r":Qr.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(ag.forEach(function(u){t.Workbook.WBProps[u[0]]!=null&&t.Workbook.WBProps[u[0]]!=u[1]&&(n[u[0]]=t.Workbook.WBProps[u[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Ge("workbookPr",null,n);var a=t.Workbook&&t.Workbook.Sheets||[],o=0;if(a&&a[0]&&a[0].Hidden){for(e[e.length]="<bookViews>",o=0;o!=t.SheetNames.length&&!(!a[o]||!a[o].Hidden);++o);o==t.SheetNames.length&&(o=0),e[e.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",o=0;o!=t.SheetNames.length;++o){var l={name:sr(t.SheetNames[o].slice(0,31))};if(l.sheetId=""+(o+1),l["r:id"]="rId"+(o+1),a[o])switch(a[o].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}e[e.length]=Ge("sheet",null,l)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(u){var h={name:u.Name};u.Comment&&(h.comment=u.Comment),u.Sheet!=null&&(h.localSheetId=""+u.Sheet),u.Hidden&&(h.hidden="1"),u.Ref&&(e[e.length]=Ge("definedName",sr(u.Ref),h))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function XI(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=qm(t),r.name=Fn(t),r}function YI(t,e){return e||(e=we(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),Hp(t.strRelID,e),un(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function KI(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var a=e>8?Fn(t):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function $I(t,e){e||(e=we(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),pE(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function QI(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function ZI(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var a=t.read_shift(4),o=Ck(t),l=M8(t,0,r),u=zp(t);t.l=n;var h={Name:o,Ptg:l};return a<268435455&&(h.Sheet=a),u&&(h.Comment=u),h}function JI(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;e||(e={}),e.biff=12;var o=[],l=[[]];return l.SheetNames=[],l.XTI=[],sf[16]={n:"BrtFRTArchID$",f:QI},as(t,function(h,d,p){switch(p){case 156:l.SheetNames.push(h.name),r.Sheets.push(h);break;case 153:r.WBProps=h;break;case 39:h.Sheet!=null&&(e.SID=h.Sheet),h.Ref=Rn(h.Ptg,null,null,l,e),delete e.SID,delete h.Ptg,o.push(h);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([p,h]):l[0]=[p,h],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(h),l.XTI=l.XTI.concat(h);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(p),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(p),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!d.T){if(!a||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},e),Ew(r),r.Names=o,r.supbooks=l,r}function eO(t,e){Ne(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};Ne(t,156,YI(a))}Ne(t,144)}function tO(t,e){e||(e=we(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return un("SheetJS",e),un(yh.version,e),un(yh.version,e),un("7262",e),e.length>e.l?e.slice(0,e.l):e}function rO(t,e){e||(e=we(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function nO(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,a=-1,o=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&o==-1&&(o=n);o>a||(Ne(t,135),Ne(t,158,rO(a)),Ne(t,136))}}function aO(t,e){var r=Zn();return Ne(r,131),Ne(r,128,tO()),Ne(r,153,$I(t.Workbook&&t.Workbook.WBProps||null)),nO(r,t),eO(r,t),Ne(r,132),r.end()}function iO(t,e,r){return e.slice(-4)===".bin"?JI(t,r):qI(t,r)}function sO(t,e,r,n,a,o,l,u){return e.slice(-4)===".bin"?TI(t,n,r,a,o,l,u):Z8(t,n,r,a,o,l,u)}function oO(t,e,r,n,a,o,l,u){return e.slice(-4)===".bin"?LI(t,n,r,a,o):MI(t,n,r,a,o)}function lO(t,e,r,n,a,o,l,u){return e.slice(-4)===".bin"?u5():f5()}function cO(t,e,r,n,a,o,l,u){return e.slice(-4)===".bin"?l5():c5()}function uO(t,e,r,n){return e.slice(-4)===".bin"?iR(t,r,n):X6(t,r,n)}function fO(t,e,r){return aw(t,r)}function hO(t,e,r){return e.slice(-4)===".bin"?h6(t,r):c6(t,r)}function dO(t,e,r){return e.slice(-4)===".bin"?n5(t,r):YR(t,r)}function mO(t,e,r){return e.slice(-4)===".bin"?GR(t):HR(t)}function pO(t,e,r,n){return r.slice(-4)===".bin"?qR(t,e,r,n):void 0}function gO(t,e,r){return e.slice(-4)===".bin"?UR(t,e,r):zR(t,e,r)}function xO(t,e,r){return(e.slice(-4)===".bin"?aO:Sw)(t)}function vO(t,e,r,n,a){return(e.slice(-4)===".bin"?OI:_w)(t,r,n,a)}function _O(t,e,r){return(e.slice(-4)===".bin"?pR:rw)(t,r)}function yO(t,e,r){return(e.slice(-4)===".bin"?p6:YE)(t,r)}function TO(t,e,r){return(e.slice(-4)===".bin"?a5:ow)(t)}function EO(t){return(t.slice(-4)===".bin"?jR:iw)()}var Aw=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,kw=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ha(t,e){var r=t.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=t.match(Aw),o,l,u,h;if(a)for(h=0;h!=a.length;++h)o=a[h].match(kw),(l=o[1].indexOf(":"))===-1?n[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?u="xmlns"+o[1].slice(6):u=o[1].slice(l+1),n[u]=o[2].slice(1,o[2].length-1));return n}function wO(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(Aw),a,o,l,u;if(n)for(u=0;u!=n.length;++u)a=n[u].match(kw),(o=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(o+1),r[l]=a[2].slice(1,a[2].length-1));return r}var Uu;function SO(t,e){var r=Uu[t]||Wt(t);return r==="General"?zo(e):Ma(r,e)}function AO(t,e,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=gr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=vr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[Wt(e)]=a}function kO(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||is[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=$u(t.v):t.w=zo(t.v):t.w=SO(e||"General",t.v)}catch(o){if(r.WTF)throw o}try{var n=Uu[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&xc(n)){var a=Mo(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(o){if(r.WTF)throw o}}}function bO(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=V6[n.Pattern]||n.Pattern)}t[e.ID]=e}function CO(t,e,r,n,a,o,l,u,h,d){var p="General",v=n.StyleID,_={};d=d||{};var y=[],w=0;for(v===void 0&&u&&(v=u.StyleID),v===void 0&&l&&(v=l.StyleID);o[v]!==void 0&&(o[v].nf&&(p=o[v].nf),o[v].Interior&&y.push(o[v].Interior),!!o[v].Parent);)v=o[v].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=gr(t);break;case"String":n.t="s",n.r=C_(Wt(t)),n.v=t.indexOf("<")>-1?Wt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(vr(t)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=Wt(t):n.v<60&&(n.v=n.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=yE[t],d.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=C_(e||t));break}if(kO(n,p,d),d.cellFormula!==!1)if(n.Formula){var E=Wt(n.Formula);E.charCodeAt(0)==61&&(E=E.slice(1)),n.f=ac(E,a),delete n.Formula,n.ArrayRange=="RC"?n.F=ac("RC:RC",a):n.ArrayRange&&(n.F=ac(n.ArrayRange,a),h.push([Gt(n.F),n.F]))}else for(w=0;w<h.length;++w)a.r>=h[w][0].s.r&&a.r<=h[w][0].e.r&&a.c>=h[w][0].s.c&&a.c<=h[w][0].e.c&&(n.F=h[w][1]);d.cellStyles&&(y.forEach(function(S){!_.patternType&&S.patternType&&(_.patternType=S.patternType)}),n.s=_),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function RO(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Dm(t,e){var r=e||{};vc();var n=bu(Pp(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=fr(n));var a=n.slice(0,1024).toLowerCase(),o=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=_r(r);return l.type="string",cc.to_workbook(n,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ee){a.indexOf("<"+Ee)>=0&&(o=!0)}),o)return mF(n,r);Uu={"General Number":"General","General Date":pt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":pt[15],"Short Date":pt[14],"Long Time":pt[19],"Medium Time":pt[18],"Short Time":pt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:pt[2],Standard:pt[4],Percent:pt[10],Scientific:pt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var u,h=[],d,p={},v=[],_=r.dense?[]:{},y="",w={},E={},S=Ha('<Data ss:Type="String">'),L=0,z=0,O=0,ee={s:{r:2e6,c:2e6},e:{r:0,c:0}},te={},Z={},C="",I=0,R=[],B={},D={},F=0,M=[],Fe=[],Se={},ne=[],se,Le=!1,ae=[],W=[],pe={},V=0,Y=0,Q={Sheets:[],WBProps:{date1904:!1}},J={};Ju.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ue="";u=Ju.exec(n);)switch(u[3]=(ue=u[3]).toLowerCase()){case"data":if(ue=="data"){if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break}if(h[h.length-1][1])break;u[1]==="/"?CO(n.slice(L,u.index),C,S,h[h.length-1][0]=="comment"?Se:w,{c:z,r:O},te,ne[z],E,ae,r):(C="",S=Ha(u[0]),L=u.index+u[0].length);break;case"cell":if(u[1]==="/")if(Fe.length>0&&(w.c=Fe),(!r.sheetRows||r.sheetRows>O)&&w.v!==void 0&&(r.dense?(_[O]||(_[O]=[]),_[O][z]=w):_[Sr(z)+Lr(O)]=w),w.HRef&&(w.l={Target:Wt(w.HRef)},w.HRefScreenTip&&(w.l.Tooltip=w.HRefScreenTip),delete w.HRef,delete w.HRefScreenTip),(w.MergeAcross||w.MergeDown)&&(V=z+(parseInt(w.MergeAcross,10)|0),Y=O+(parseInt(w.MergeDown,10)|0),R.push({s:{c:z,r:O},e:{c:V,r:Y}})),!r.sheetStubs)w.MergeAcross?z=V+1:++z;else if(w.MergeAcross||w.MergeDown){for(var Ie=z;Ie<=V;++Ie)for(var ke=O;ke<=Y;++ke)(Ie>z||ke>O)&&(r.dense?(_[ke]||(_[ke]=[]),_[ke][Ie]={t:"z"}):_[Sr(Ie)+Lr(ke)]={t:"z"});z=V+1}else++z;else w=wO(u[0]),w.Index&&(z=+w.Index-1),z<ee.s.c&&(ee.s.c=z),z>ee.e.c&&(ee.e.c=z),u[0].slice(-2)==="/>"&&++z,Fe=[];break;case"row":u[1]==="/"||u[0].slice(-2)==="/>"?(O<ee.s.r&&(ee.s.r=O),O>ee.e.r&&(ee.e.r=O),u[0].slice(-2)==="/>"&&(E=Ha(u[0]),E.Index&&(O=+E.Index-1)),z=0,++O):(E=Ha(u[0]),E.Index&&(O=+E.Index-1),pe={},(E.AutoFitHeight=="0"||E.Height)&&(pe.hpx=parseInt(E.Height,10),pe.hpt=af(pe.hpx),W[O]=pe),E.Hidden=="1"&&(pe.hidden=!0,W[O]=pe));break;case"worksheet":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));v.push(y),ee.s.r<=ee.e.r&&ee.s.c<=ee.e.c&&(_["!ref"]=St(ee),r.sheetRows&&r.sheetRows<=ee.e.r&&(_["!fullref"]=_["!ref"],ee.e.r=r.sheetRows-1,_["!ref"]=St(ee))),R.length&&(_["!merges"]=R),ne.length>0&&(_["!cols"]=ne),W.length>0&&(_["!rows"]=W),p[y]=_}else ee={s:{r:2e6,c:2e6},e:{r:0,c:0}},O=z=0,h.push([u[3],!1]),d=Ha(u[0]),y=Wt(d.Name),_=r.dense?[]:{},R=[],ae=[],W=[],J={name:y,Hidden:0},Q.Sheets.push(J);break;case"table":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else{if(u[0].slice(-2)=="/>")break;h.push([u[3],!1]),ne=[],Le=!1}break;case"style":u[1]==="/"?bO(te,Z,r):Z=Ha(u[0]);break;case"numberformat":Z.nf=Wt(Ha(u[0]).Format||"General"),Uu[Z.nf]&&(Z.nf=Uu[Z.nf]);for(var Oe=0;Oe!=392&&pt[Oe]!=Z.nf;++Oe);if(Oe==392){for(Oe=57;Oe!=392;++Oe)if(pt[Oe]==null){$i(Z.nf,Oe);break}}break;case"column":if(h[h.length-1][0]!=="table")break;if(se=Ha(u[0]),se.Hidden&&(se.hidden=!0,delete se.Hidden),se.Width&&(se.wpx=parseInt(se.Width,10)),!Le&&se.wpx>10){Le=!0,Dn=ew;for(var le=0;le<ne.length;++le)ne[le]&&qs(ne[le])}Le&&qs(se),ne[se.Index-1||ne.length]=se;for(var Qe=0;Qe<+se.Span;++Qe)ne[ne.length]=_r(se);break;case"namedrange":if(u[1]==="/")break;Q.Names||(Q.Names=[]);var G=yt(u[0]),et={Name:G.Name,Ref:ac(G.RefersTo.slice(1),{r:0,c:0})};Q.Sheets.length>0&&(et.Sheet=Q.Sheets.length-1),Q.Names.push(et);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(u[0].slice(-2)==="/>")break;u[1]==="/"?C+=n.slice(I,u.index):I=u.index+u[0].length;break;case"interior":if(!r.cellStyles)break;Z.Interior=Ha(u[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(u[0].slice(-2)==="/>")break;u[1]==="/"?Jk(B,ue,n.slice(F,u.index)):F=u.index+u[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else h.push([u[3],!1]);break;case"comment":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"));RO(Se),Fe.push(Se)}else h.push([u[3],!1]),d=Ha(u[0]),Se={a:d.Author};break;case"autofilter":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else if(u[0].charAt(u[0].length-2)!=="/"){var Ve=Ha(u[0]);_["!autofilter"]={ref:ac(Ve.Range).replace(/\$/g,"")},h.push([u[3],!0])}break;case"name":break;case"datavalidation":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(u[1]==="/"){if((d=h.pop())[0]!==u[3])throw new Error("Bad state: "+d.join("|"))}else u[0].charAt(u[0].length-2)!=="/"&&h.push([u[3],!0]);break;case"null":break;default:if(h.length==0&&u[3]=="document"||h.length==0&&u[3]=="uof")return gy(n,r);var at=!0;switch(h[h.length-1][0]){case"officedocumentsettings":switch(u[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:at=!1}break;case"componentoptions":switch(u[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:at=!1}break;case"excelworkbook":switch(u[3]){case"date1904":Q.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:at=!1}break;case"workbookoptions":switch(u[3]){case"owcversion":break;case"height":break;case"width":break;default:at=!1}break;case"worksheetoptions":switch(u[3]){case"visible":if(u[0].slice(-2)!=="/>")if(u[1]==="/")switch(n.slice(F,u.index)){case"SheetHidden":J.Hidden=1;break;case"SheetVeryHidden":J.Hidden=2;break}else F=u.index+u[0].length;break;case"header":_["!margins"]||Uo(_["!margins"]={},"xlml"),isNaN(+yt(u[0]).Margin)||(_["!margins"].header=+yt(u[0]).Margin);break;case"footer":_["!margins"]||Uo(_["!margins"]={},"xlml"),isNaN(+yt(u[0]).Margin)||(_["!margins"].footer=+yt(u[0]).Margin);break;case"pagemargins":var Ze=yt(u[0]);_["!margins"]||Uo(_["!margins"]={},"xlml"),isNaN(+Ze.Top)||(_["!margins"].top=+Ze.Top),isNaN(+Ze.Left)||(_["!margins"].left=+Ze.Left),isNaN(+Ze.Right)||(_["!margins"].right=+Ze.Right),isNaN(+Ze.Bottom)||(_["!margins"].bottom=+Ze.Bottom);break;case"displayrighttoleft":Q.Views||(Q.Views=[]),Q.Views[0]||(Q.Views[0]={}),Q.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":_["!outline"]||(_["!outline"]={}),_["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:at=!1}break;case"pivottable":case"pivotcache":switch(u[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:at=!1}break;case"pagebreaks":switch(u[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:at=!1}break;case"autofilter":switch(u[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:at=!1}break;case"querytable":switch(u[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:at=!1}break;case"datavalidation":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:at=!1}break;case"sorting":case"conditionalformatting":switch(u[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:at=!1}break;case"mapinfo":case"schema":case"data":switch(u[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:at=!1}break;case"smarttags":break;default:at=!1;break}if(at||u[3].match(/!\[CDATA/))break;if(!h[h.length-1][1])throw"Unrecognized tag: "+u[3]+"|"+h.join("|");if(h[h.length-1][0]==="customdocumentproperties"){if(u[0].slice(-2)==="/>")break;u[1]==="/"?AO(D,ue,M,n.slice(F,u.index)):(M=u,F=u.index+u[0].length);break}if(r.WTF)throw"Unrecognized tag: "+u[3]+"|"+h.join("|")}var be={};return!r.bookSheets&&!r.bookProps&&(be.Sheets=p),be.SheetNames=v,be.Workbook=Q,be.SSF=_r(pt),be.Props=B,be.Custprops=D,be}function Jm(t,e){switch(sg(e=e||{}),e.type||"base64"){case"base64":return Dm(da(t),e);case"binary":case"buffer":case"file":return Dm(t,e);case"array":return Dm(to(t),e)}}function DO(t,e){var r=[];return t.Props&&r.push(eb(t.Props,e)),t.Custprops&&r.push(tb(t.Props,t.Custprops)),r.join("")}function IO(){return""}function OO(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,a){var o=[];o.push(Ge("NumberFormat",null,{"ss:Format":sr(pt[n.numFmtId])}));var l={"ss:ID":"s"+(21+a)};r.push(Ge("Style",o.join(""),l))}),Ge("Styles",r.join(""))}function bw(t){return Ge("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+eg(t.Ref,{r:0,c:0})})}function FO(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var a=e[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(bw(a)))}return Ge("Names",r.join(""))}function NO(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,o=[],l=0;l<a.length;++l){var u=a[l];u.Sheet==r&&(u.Name.match(/^_xlfn\./)||o.push(bw(u)))}return o.join("")}function MO(t,e,r,n){if(!t)return"";var a=[];if(t["!margins"]&&(a.push("<PageSetup>"),t["!margins"].header&&a.push(Ge("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&a.push(Ge("Footer",null,{"x:Margin":t["!margins"].footer})),a.push(Ge("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Ge("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<r&&!(n.Workbook.Sheets[o]&&!n.Workbook.Sheets[o].Hidden);++o);o==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),t["!protect"]&&(a.push(_n("ProtectContents","True")),t["!protect"].objects&&a.push(_n("ProtectObjects","True")),t["!protect"].scenarios&&a.push(_n("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?a.push(_n("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&a.push(_n("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){t["!protect"][l[0]]&&a.push("<"+l[1]+"/>")})),a.length==0?"":Ge("WorksheetOptions",a.join(""),{xmlns:ca.x})}function PO(t){return t.map(function(e){var r=nk(e.t||""),n=Ge("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ge("Comment",n,{"ss:Author":e.a})}).join("")}function LO(t,e,r,n,a,o,l){if(!t||t.v==null&&t.f==null)return"";var u={};if(t.f&&(u["ss:Formula"]="="+sr(eg(t.f,l))),t.F&&t.F.slice(0,e.length)==e){var h=Ar(t.F.slice(e.length+1));u["ss:ArrayRange"]="RC:R"+(h.r==l.r?"":"["+(h.r-l.r)+"]")+"C"+(h.c==l.c?"":"["+(h.c-l.c)+"]")}if(t.l&&t.l.Target&&(u["ss:HRef"]=sr(t.l.Target),t.l.Tooltip&&(u["x:HRefScreenTip"]=sr(t.l.Tooltip))),r["!merges"])for(var d=r["!merges"],p=0;p!=d.length;++p)d[p].s.c!=l.c||d[p].s.r!=l.r||(d[p].e.c>d[p].s.c&&(u["ss:MergeAcross"]=d[p].e.c-d[p].s.c),d[p].e.r>d[p].s.r&&(u["ss:MergeDown"]=d[p].e.r-d[p].s.r));var v="",_="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":v="Number",_=String(t.v);break;case"b":v="Boolean",_=t.v?"1":"0";break;case"e":v="Error",_=is[t.v];break;case"d":v="DateTime",_=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||pt[14]);break;case"s":v="String",_=rk(t.v||"");break}var y=no(n.cellXfs,t,n);u["ss:StyleID"]="s"+(21+y),u["ss:Index"]=l.c+1;var w=t.v!=null?_:"",E=t.t=="z"?"":'<Data ss:Type="'+v+'">'+w+"</Data>";return(t.c||[]).length>0&&(E+=PO(t.c)),Ge("Cell",E,u)}function BO(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=uc(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function VO(t,e,r,n){if(!t["!ref"])return"";var a=Gt(t["!ref"]),o=t["!merges"]||[],l=0,u=[];t["!cols"]&&t["!cols"].forEach(function(S,L){qs(S);var z=!!S.width,O=ad(L,S),ee={"ss:Index":L+1};z&&(ee["ss:Width"]=rf(O.width)),S.hidden&&(ee["ss:Hidden"]="1"),u.push(Ge("Column",null,ee))});for(var h=Array.isArray(t),d=a.s.r;d<=a.e.r;++d){for(var p=[BO(d,(t["!rows"]||[])[d])],v=a.s.c;v<=a.e.c;++v){var _=!1;for(l=0;l!=o.length;++l)if(!(o[l].s.c>v)&&!(o[l].s.r>d)&&!(o[l].e.c<v)&&!(o[l].e.r<d)){(o[l].s.c!=v||o[l].s.r!=d)&&(_=!0);break}if(!_){var y={r:d,c:v},w=gt(y),E=h?(t[d]||[])[v]:t[w];p.push(LO(E,w,t,e,r,n,y))}}p.push("</Row>"),p.length>2&&u.push(p.join(""))}return u.join("")}function UO(t,e,r){var n=[],a=r.SheetNames[t],o=r.Sheets[a],l=o?NO(o,e,t,r):"";return l.length>0&&n.push("<Names>"+l+"</Names>"),l=o?VO(o,e,t,r):"",l.length>0&&n.push("<Table>"+l+"</Table>"),n.push(MO(o,e,t,r)),n.join("")}function jO(t,e){e||(e={}),t.SSF||(t.SSF=_r(pt)),t.SSF&&(vc(),Qh(t.SSF),e.revssf=Jh(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],no(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(DO(t,e)),r.push(IO()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Ge("Worksheet",UO(n,e,t),{"ss:Name":sr(t.SheetNames[n])}));return r[2]=OO(t,e),r[3]=FO(t),Br+Ge("Workbook",r.join(""),{xmlns:ca.ss,"xmlns:o":ca.o,"xmlns:x":ca.x,"xmlns:ss":ca.ss,"xmlns:dt":ca.dt,"xmlns:html":ca.html})}function zO(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=Fk(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=Nk(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var HO=[60,1084,2066,2165,2175];function WO(t,e,r,n,a){var o=n,l=[],u=r.slice(r.l,r.l+o);if(a&&a.enc&&a.enc.insitu&&u.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(u)}l.push(u),r.l+=o;for(var h=Yi(r,r.l),d=ep[h],p=0;d!=null&&HO.indexOf(h)>-1;)o=Yi(r,r.l+2),p=r.l+4,h==2066?p+=4:(h==2165||h==2175)&&(p+=12),u=r.slice(p,r.l+4+o),l.push(u),r.l+=4+o,d=ep[h=Yi(r,r.l)];var v=cn(l);vn(v,0);var _=0;v.lens=[];for(var y=0;y<l.length;++y)v.lens.push(_),_+=l[y].length;if(v.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+v.length+" < "+n;return e.f(v,v.length,a)}function di(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=pt[n])}catch(o){if(e.WTF)throw o}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||is[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=$u(t.v):t.w=zo(t.v):t.w=Ma(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(o){if(e.WTF)throw o}if(e.cellDates&&n&&t.t=="n"&&xc(pt[n]||String(n))){var a=Mo(t.v);a&&(t.t="d",t.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function nh(t,e,r){return{v:t,ixfe:e,t:r}}function GO(t,e){var r={opts:{}},n={},a=e.dense?[]:{},o={},l={},u=null,h=[],d="",p={},v,_="",y,w,E,S,L={},z=[],O,ee,te=[],Z=[],C={Sheets:[],WBProps:{date1904:!1},Views:[{}]},I={},R=function(ft){return ft<8?Lo[ft]:ft<64&&Z[ft-8]||Lo[ft]},B=function(ft,er,pr){var tr=er.XF.data;if(!(!tr||!tr.patternType||!pr||!pr.cellStyles)){er.s={},er.s.patternType=tr.patternType;var En;(En=tf(R(tr.icvFore)))&&(er.s.fgColor={rgb:En}),(En=tf(R(tr.icvBack)))&&(er.s.bgColor={rgb:En})}},D=function(ft,er,pr){if(!(pe>1)&&!(pr.sheetRows&&ft.r>=pr.sheetRows)){if(pr.cellStyles&&er.XF&&er.XF.data&&B(ft,er,pr),delete er.ixfe,delete er.XF,v=ft,_=gt(ft),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),ft.r<l.s.r&&(l.s.r=ft.r),ft.c<l.s.c&&(l.s.c=ft.c),ft.r+1>l.e.r&&(l.e.r=ft.r+1),ft.c+1>l.e.c&&(l.e.c=ft.c+1),pr.cellFormula&&er.f){for(var tr=0;tr<z.length;++tr)if(!(z[tr][0].s.c>ft.c||z[tr][0].s.r>ft.r)&&!(z[tr][0].e.c<ft.c||z[tr][0].e.r<ft.r)){er.F=St(z[tr][0]),(z[tr][0].s.c!=ft.c||z[tr][0].s.r!=ft.r)&&delete er.f,er.f&&(er.f=""+Rn(z[tr][1],l,ft,ae,F));break}}pr.dense?(a[ft.r]||(a[ft.r]=[]),a[ft.r][ft.c]=er):a[_]=er}},F={enc:!1,sbcch:0,snames:[],sharedf:L,arrayf:z,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(F.password=e.password);var M,Fe=[],Se=[],ne=[],se=[],Le=!1,ae=[];ae.SheetNames=F.snames,ae.sharedf=F.sharedf,ae.arrayf=F.arrayf,ae.names=[],ae.XTI=[];var W=0,pe=0,V=0,Y=[],Q=[],J;F.codepage=1200,Ga(1200);for(var ue=!1;t.l<t.length-1;){var Ie=t.l,ke=t.read_shift(2);if(ke===0&&W===10)break;var Oe=t.l===t.length?0:t.read_shift(2),le=ep[ke];if(le&&le.f){if(e.bookSheets&&W===133&&ke!==133)break;if(W=ke,le.r===2||le.r==12){var Qe=t.read_shift(2);if(Oe-=2,!F.enc&&Qe!==ke&&((Qe&255)<<8|Qe>>8)!==ke)throw new Error("rt mismatch: "+Qe+"!="+ke);le.r==12&&(t.l+=10,Oe-=10)}var G={};if(ke===10?G=le.f(t,Oe,F):G=WO(ke,le,t,Oe,F),pe==0&&[9,521,1033,2057].indexOf(W)===-1)continue;switch(ke){case 34:r.opts.Date1904=C.WBProps.date1904=G;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(F.enc||(t.l=0),F.enc=G,!e.password)throw new Error("File is password-protected");if(G.valid==null)throw new Error("Encryption scheme unsupported");if(!G.valid)throw new Error("Password is incorrect");break;case 92:F.lastuser=G;break;case 66:var et=Number(G);switch(et){case 21010:et=1200;break;case 32768:et=1e4;break;case 32769:et=1252;break}Ga(F.codepage=et),ue=!0;break;case 317:F.rrtabid=G;break;case 25:F.winlocked=G;break;case 439:r.opts.RefreshAll=G;break;case 12:r.opts.CalcCount=G;break;case 16:r.opts.CalcDelta=G;break;case 17:r.opts.CalcIter=G;break;case 13:r.opts.CalcMode=G;break;case 14:r.opts.CalcPrecision=G;break;case 95:r.opts.CalcSaveRecalc=G;break;case 15:F.CalcRefMode=G;break;case 2211:r.opts.FullCalc=G;break;case 129:G.fDialog&&(a["!type"]="dialog"),G.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),G.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:te.push(G);break;case 430:ae.push([G]),ae[ae.length-1].XTI=[];break;case 35:case 547:ae[ae.length-1].push(G);break;case 24:case 536:J={Name:G.Name,Ref:Rn(G.rgce,l,null,ae,F)},G.itab>0&&(J.Sheet=G.itab-1),ae.names.push(J),ae[0]||(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].push(G),G.Name=="_xlnm._FilterDatabase"&&G.itab>0&&G.rgce&&G.rgce[0]&&G.rgce[0][0]&&G.rgce[0][0][0]=="PtgArea3d"&&(Q[G.itab-1]={ref:St(G.rgce[0][0][1][2])});break;case 22:F.ExternCount=G;break;case 23:ae.length==0&&(ae[0]=[],ae[0].XTI=[]),ae[ae.length-1].XTI=ae[ae.length-1].XTI.concat(G),ae.XTI=ae.XTI.concat(G);break;case 2196:if(F.biff<8)break;J!=null&&(J.Comment=G[1]);break;case 18:a["!protect"]=G;break;case 19:G!==0&&F.WTF&&console.error("Password verifier: "+G);break;case 133:o[G.pos]=G,F.snames.push(G.name);break;case 10:{if(--pe)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=St(l),e.sheetRows&&e.sheetRows<=l.e.r){var Ve=l.e.r;l.e.r=e.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=St(l),l.e.r=Ve}l.e.r++,l.e.c++}Fe.length>0&&(a["!merges"]=Fe),Se.length>0&&(a["!objects"]=Se),ne.length>0&&(a["!cols"]=ne),se.length>0&&(a["!rows"]=se),C.Sheets.push(I)}d===""?p=a:n[d]=a,a=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(F.biff===8&&(F.biff={9:2,521:3,1033:4}[ke]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[G.BIFFVer]||8),F.biffguess=G.BIFFVer==0,G.BIFFVer==0&&G.dt==4096&&(F.biff=5,ue=!0,Ga(F.codepage=28591)),F.biff==8&&G.BIFFVer==0&&G.dt==16&&(F.biff=2),pe++)break;if(a=e.dense?[]:{},F.biff<8&&!ue&&(ue=!0,Ga(F.codepage=e.codepage||1252)),F.biff<5||G.BIFFVer==0&&G.dt==4096){d===""&&(d="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var at={pos:t.l-Oe,name:d};o[at.pos]=at,F.snames.push(d)}else d=(o[Ie]||{name:""}).name;G.dt==32&&(a["!type"]="chart"),G.dt==64&&(a["!type"]="macro"),Fe=[],Se=[],F.arrayf=z=[],ne=[],se=[],Le=!1,I={Hidden:(o[Ie]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(e.dense?(a[G.r]||[])[G.c]:a[gt({c:G.c,r:G.r})])&&++G.c,O={ixfe:G.ixfe,XF:te[G.ixfe]||{},v:G.val,t:"n"},V>0&&(O.z=Y[O.ixfe>>8&63]),di(O,e,r.opts.Date1904),D({c:G.c,r:G.r},O,e);break;case 5:case 517:O={ixfe:G.ixfe,XF:te[G.ixfe],v:G.val,t:G.t},V>0&&(O.z=Y[O.ixfe>>8&63]),di(O,e,r.opts.Date1904),D({c:G.c,r:G.r},O,e);break;case 638:O={ixfe:G.ixfe,XF:te[G.ixfe],v:G.rknum,t:"n"},V>0&&(O.z=Y[O.ixfe>>8&63]),di(O,e,r.opts.Date1904),D({c:G.c,r:G.r},O,e);break;case 189:for(var Ze=G.c;Ze<=G.C;++Ze){var be=G.rkrec[Ze-G.c][0];O={ixfe:be,XF:te[be],v:G.rkrec[Ze-G.c][1],t:"n"},V>0&&(O.z=Y[O.ixfe>>8&63]),di(O,e,r.opts.Date1904),D({c:Ze,r:G.r},O,e)}break;case 6:case 518:case 1030:{if(G.val=="String"){u=G;break}if(O=nh(G.val,G.cell.ixfe,G.tt),O.XF=te[O.ixfe],e.cellFormula){var Ee=G.formula;if(Ee&&Ee[0]&&Ee[0][0]&&Ee[0][0][0]=="PtgExp"){var ze=Ee[0][0][1][0],Ke=Ee[0][0][1][1],We=gt({r:ze,c:Ke});L[We]?O.f=""+Rn(G.formula,l,G.cell,ae,F):O.F=((e.dense?(a[ze]||[])[Ke]:a[We])||{}).F}else O.f=""+Rn(G.formula,l,G.cell,ae,F)}V>0&&(O.z=Y[O.ixfe>>8&63]),di(O,e,r.opts.Date1904),D(G.cell,O,e),u=G}break;case 7:case 519:if(u)u.val=G,O=nh(G,u.cell.ixfe,"s"),O.XF=te[O.ixfe],e.cellFormula&&(O.f=""+Rn(u.formula,l,u.cell,ae,F)),V>0&&(O.z=Y[O.ixfe>>8&63]),di(O,e,r.opts.Date1904),D(u.cell,O,e),u=null;else throw new Error("String record expects Formula");break;case 33:case 545:{z.push(G);var Be=gt(G[0].s);if(y=e.dense?(a[G[0].s.r]||[])[G[0].s.c]:a[Be],e.cellFormula&&y){if(!u||!Be||!y)break;y.f=""+Rn(G[1],l,G[0],ae,F),y.F=St(G[0])}}break;case 1212:{if(!e.cellFormula)break;if(_){if(!u)break;L[gt(u.cell)]=G[0],y=e.dense?(a[u.cell.r]||[])[u.cell.c]:a[gt(u.cell)],(y||{}).f=""+Rn(G[0],l,v,ae,F)}}break;case 253:O=nh(h[G.isst].t,G.ixfe,"s"),h[G.isst].h&&(O.h=h[G.isst].h),O.XF=te[O.ixfe],V>0&&(O.z=Y[O.ixfe>>8&63]),di(O,e,r.opts.Date1904),D({c:G.c,r:G.r},O,e);break;case 513:e.sheetStubs&&(O={ixfe:G.ixfe,XF:te[G.ixfe],t:"z"},V>0&&(O.z=Y[O.ixfe>>8&63]),di(O,e,r.opts.Date1904),D({c:G.c,r:G.r},O,e));break;case 190:if(e.sheetStubs)for(var Ye=G.c;Ye<=G.C;++Ye){var je=G.ixfe[Ye-G.c];O={ixfe:je,XF:te[je],t:"z"},V>0&&(O.z=Y[O.ixfe>>8&63]),di(O,e,r.opts.Date1904),D({c:Ye,r:G.r},O,e)}break;case 214:case 516:case 4:O=nh(G.val,G.ixfe,"s"),O.XF=te[O.ixfe],V>0&&(O.z=Y[O.ixfe>>8&63]),di(O,e,r.opts.Date1904),D({c:G.c,r:G.r},O,e);break;case 0:case 512:pe===1&&(l=G);break;case 252:h=G;break;case 1054:if(F.biff==4){Y[V++]=G[1];for(var dt=0;dt<V+163&&pt[dt]!=G[1];++dt);dt>=163&&$i(G[1],V+163)}else $i(G[1],G[0]);break;case 30:{Y[V++]=G;for(var rt=0;rt<V+163&&pt[rt]!=G;++rt);rt>=163&&$i(G,V+163)}break;case 229:Fe=Fe.concat(G);break;case 93:Se[G.cmo[0]]=F.lastobj=G;break;case 438:F.lastobj.TxO=G;break;case 127:F.lastobj.ImData=G;break;case 440:for(S=G[0].s.r;S<=G[0].e.r;++S)for(E=G[0].s.c;E<=G[0].e.c;++E)y=e.dense?(a[S]||[])[E]:a[gt({c:E,r:S})],y&&(y.l=G[1]);break;case 2048:for(S=G[0].s.r;S<=G[0].e.r;++S)for(E=G[0].s.c;E<=G[0].e.c;++E)y=e.dense?(a[S]||[])[E]:a[gt({c:E,r:S})],y&&y.l&&(y.l.Tooltip=G[1]);break;case 28:{if(F.biff<=5&&F.biff>=2)break;y=e.dense?(a[G[0].r]||[])[G[0].c]:a[gt(G[0])];var lt=Se[G[2]];y||(e.dense?(a[G[0].r]||(a[G[0].r]=[]),y=a[G[0].r][G[0].c]={t:"z"}):y=a[gt(G[0])]={t:"z"},l.e.r=Math.max(l.e.r,G[0].r),l.s.r=Math.min(l.s.r,G[0].r),l.e.c=Math.max(l.e.c,G[0].c),l.s.c=Math.min(l.s.c,G[0].c)),y.c||(y.c=[]),w={a:G[1],t:lt.TxO.t},y.c.push(w)}break;case 2173:OR(te[G.ixfe],G.ext);break;case 125:{if(!F.cellStyles)break;for(;G.e>=G.s;)ne[G.e--]={width:G.w/256,level:G.level||0,hidden:!!(G.flags&1)},Le||(Le=!0,Qp(G.w/256)),qs(ne[G.e+1])}break;case 520:{var ut={};G.level!=null&&(se[G.r]=ut,ut.level=G.level),G.hidden&&(se[G.r]=ut,ut.hidden=!0),G.hpt&&(se[G.r]=ut,ut.hpt=G.hpt,ut.hpx=uc(G.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||Uo(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ke]]=G;break;case 161:a["!margins"]||Uo(a["!margins"]={}),a["!margins"].header=G.header,a["!margins"].footer=G.footer;break;case 574:G.RTL&&(C.Views[0].RTL=!0);break;case 146:Z=G;break;case 2198:M=G;break;case 140:ee=G;break;case 442:d?I.CodeName=G||I.name:C.WBProps.CodeName=G||"ThisWorkbook";break}}else le||console.error("Missing Info for XLS Record 0x"+ke.toString(16)),t.l+=Oe}return r.SheetNames=Ir(o).sort(function(Tt,ft){return Number(Tt)-Number(ft)}).map(function(Tt){return o[Tt].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&p["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=p)):r.Preamble=p,r.Sheets&&Q.forEach(function(Tt,ft){r.Sheets[r.SheetNames[ft]]["!autofilter"]=Tt}),r.Strings=h,r.SSF=_r(pt),F.enc&&(r.Encryption=F.enc),M&&(r.Themes=M),r.Metadata={},ee!==void 0&&(r.Metadata.Country=ee),ae.names.length>0&&(C.Names=ae.names),r.Workbook=C,r}var ju={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function qO(t,e,r){var n=ot.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=q_(n,Xm,ju.DSI);for(var o in a)e[o]=a[o]}catch(d){if(r.WTF)throw d}var l=ot.find(t,"/!SummaryInformation");if(l&&l.size>0)try{var u=q_(l,Ym,ju.SI);for(var h in u)e[h]==null&&(e[h]=u[h])}catch(d){if(r.WTF)throw d}e.HeadingPairs&&e.TitlesOfParts&&(kE(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function XO(t,e){var r=[],n=[],a=[],o=0,l,u=E_(Xm,"n"),h=E_(Ym,"n");if(t.Props)for(l=Ir(t.Props),o=0;o<l.length;++o)(Object.prototype.hasOwnProperty.call(u,l[o])?r:Object.prototype.hasOwnProperty.call(h,l[o])?n:a).push([l[o],t.Props[l[o]]]);if(t.Custprops)for(l=Ir(t.Custprops),o=0;o<l.length;++o)Object.prototype.hasOwnProperty.call(t.Props||{},l[o])||(Object.prototype.hasOwnProperty.call(u,l[o])?r:Object.prototype.hasOwnProperty.call(h,l[o])?n:a).push([l[o],t.Custprops[l[o]]]);var d=[];for(o=0;o<a.length;++o)FE.indexOf(a[o][0])>-1||AE.indexOf(a[o][0])>-1||a[o][1]!=null&&d.push(a[o]);n.length&&ot.utils.cfb_add(e,"/SummaryInformation",X_(n,ju.SI,h,Ym)),(r.length||d.length)&&ot.utils.cfb_add(e,"/DocumentSummaryInformation",X_(r,ju.DSI,u,Xm,d.length?d:null,ju.UDI))}function Cw(t,e){e||(e={}),sg(e),bp(),e.codepage&&kp(e.codepage);var r,n;if(t.FullPaths){if(ot.find(t,"/encryption"))throw new Error("File is password-protected");r=ot.find(t,"!CompObj"),n=ot.find(t,"/Workbook")||ot.find(t,"/Book")}else{switch(e.type){case"base64":t=fa(da(t));break;case"binary":t=fa(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}vn(t,0),n={content:t}}var a,o;if(r&&zO(r),e.bookProps&&!e.bookSheets)a={};else{var l=Rt?"buffer":"array";if(n&&n.content)a=GO(n.content,e);else if((o=ot.find(t,"PerfectOffice_MAIN"))&&o.content)a=Vo.to_workbook(o.content,(e.type=l,e));else if((o=ot.find(t,"NativeContent_MAIN"))&&o.content)a=Vo.to_workbook(o.content,(e.type=l,e));else throw(o=ot.find(t,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&ot.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=s5(t))}var u={};return t.FullPaths&&qO(t,u,e),a.Props=a.Custprops=u,e.bookFiles&&(a.cfb=t),a}function YO(t,e){var r=e||{},n=ot.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return ot.utils.cfb_add(n,a,Rw(t,r)),r.biff==8&&(t.Props||t.Custprops)&&XO(t,n),r.biff==8&&t.vbaraw&&o5(n,ot.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var sf={0:{f:vD},1:{f:kD},2:{f:GD},3:{f:ND},4:{f:DD},5:{f:zD},6:{f:$D},7:{f:BD},8:{f:nI},9:{f:rI},10:{f:eI},11:{f:tI},12:{f:CD},13:{f:XD},14:{f:PD},15:{f:OD},16:{f:yw},17:{f:ZD},18:{f:UD},19:{f:jp},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:ZI},40:{},42:{},43:{f:$6},44:{f:Y6},45:{f:J6},46:{f:tR},47:{f:eR},48:{},49:{f:Tk},50:{},51:{f:MR},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:WE},62:{f:KD},63:{f:WR},64:{f:_I},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Nn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:pI},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:SD},148:{f:TD,p:16},151:{f:cI},152:{},153:{f:KI},154:{},155:{},156:{f:XI},157:{},158:{},159:{T:1,f:f6},160:{T:-1},161:{T:1,f:el},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:aI},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:FR},336:{T:-1},337:{f:BR,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:qm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:HE},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:uI},427:{f:fI},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:dI},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:wD},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:oI},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:qm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:t5},633:{T:1},634:{T:-1},635:{T:1,f:JR},636:{T:-1},637:{f:Ak},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:PI},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:yI},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},ep={6:{f:Cm},10:{f:Ms},12:{f:Gr},13:{f:Gr},14:{f:Mr},15:{f:Mr},16:{f:On},17:{f:Mr},18:{f:Mr},19:{f:Gr},20:{f:J_},21:{f:J_},23:{f:HE},24:{f:ty},25:{f:Mr},26:{},27:{},28:{f:yC},29:{},34:{f:Mr},35:{f:ey},38:{f:On},39:{f:On},40:{f:On},41:{f:On},42:{f:Mr},43:{f:Mr},47:{f:O6},49:{f:Xb},51:{f:Gr},60:{},61:{f:zb},64:{f:Mr},65:{f:qb},66:{f:Gr},77:{},80:{},81:{},82:{},85:{f:Gr},89:{},90:{},91:{},92:{f:Ib},93:{f:wC},94:{},95:{f:Mr},96:{},97:{},99:{f:Mr},125:{f:WE},128:{f:lC},129:{f:Fb},130:{f:Gr},131:{f:Mr},132:{f:Mr},133:{f:Nb},134:{},140:{f:IC},141:{f:Gr},144:{},146:{f:NC},151:{},152:{},153:{},154:{},155:{},156:{f:Gr},157:{},158:{},160:{f:jC},161:{f:LC},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:aC},190:{f:iC},193:{f:Ms},197:{},198:{},199:{},200:{},201:{},202:{f:Mr},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Gr},220:{},221:{f:Mr},222:{},224:{f:oC},225:{f:Db},226:{f:Ms},227:{},229:{f:TC},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Pb},253:{f:Kb},255:{f:Bb},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:NE},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Mr},353:{f:Ms},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:dC},431:{f:Mr},432:{},433:{},434:{},437:{},438:{f:kC},439:{f:Mr},440:{f:bC},441:{},442:{f:Ef},443:{},444:{f:Gr},445:{},446:{},448:{f:Ms},449:{f:jb,r:2},450:{f:Ms},512:{f:$_},513:{f:UC},515:{f:fC},516:{f:Qb},517:{f:Z_},519:{f:zC},520:{f:Vb},523:{},545:{f:ry},549:{f:K_},566:{},574:{f:Wb},638:{f:nC},659:{},1048:{},1054:{f:Jb},1084:{},1212:{f:xC},2048:{f:RC},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:eh},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ms},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:MC,r:12},2173:{f:IR,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Mr,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:gC,r:12},2197:{},2198:{f:AR,r:12},2199:{},2200:{},2201:{},2202:{f:vC,r:12},2203:{f:Ms},2204:{},2205:{},2206:{},2207:{},2211:{f:Ub},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Gr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:BC},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:FC},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:$_},1:{},2:{f:XC},3:{f:GC},4:{f:WC},5:{f:Z_},7:{f:KC},8:{},9:{f:eh},11:{},22:{f:Gr},30:{f:tC},31:{},32:{},33:{f:ry},36:{},37:{f:K_},50:{f:$C},62:{},52:{},67:{},68:{f:Gr},69:{},86:{},126:{},127:{f:HC},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:QC},223:{},234:{},354:{},421:{},518:{f:Cm},521:{f:eh},536:{f:ty},547:{f:ey},561:{},579:{},1030:{f:Cm},1033:{f:eh},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Xe(t,e,r,n){var a=e;if(!isNaN(a)){var o=n||(r||[]).length||0,l=t.next(4);l.write_shift(2,a),l.write_shift(2,o),o>0&&Bp(r)&&t.push(r)}}function KO(t,e,r,n){var a=(r||[]).length||0;if(a<=8224)return Xe(t,e,r,a);var o=e;if(!isNaN(o)){for(var l=r.parts||[],u=0,h=0,d=0;d+(l[u]||8224)<=8224;)d+=l[u]||8224,u++;var p=t.next(4);for(p.write_shift(2,o),p.write_shift(2,d),t.push(r.slice(h,h+d)),h+=d;h<a;){for(p=t.next(4),p.write_shift(2,60),d=0;d+(l[u]||8224)<=8224;)d+=l[u]||8224,u++;p.write_shift(2,d),t.push(r.slice(h,h+d)),h+=d}}}function kf(t,e,r){return t||(t=we(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function $O(t,e,r,n){var a=we(9);return kf(a,t,e),ME(r,n||"b",a),a}function QO(t,e,r){var n=we(8+2*r.length);return kf(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function ZO(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var a=e.t=="d"?en(vr(e.v)):e.v;a==(a|0)&&a>=0&&a<65536?Xe(t,2,YC(r,n,a)):Xe(t,3,qC(r,n,a));return;case"b":case"e":Xe(t,5,$O(r,n,e.v,e.t));return;case"s":case"str":Xe(t,4,QO(r,n,(e.v||"").slice(0,255)));return}Xe(t,1,kf(null,r,n))}function JO(t,e,r,n){var a=Array.isArray(e),o=Gt(e["!ref"]||"A1"),l,u="",h=[];if(o.e.c>255||o.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),l=St(o)}for(var d=o.s.r;d<=o.e.r;++d){u=Lr(d);for(var p=o.s.c;p<=o.e.c;++p){d===o.s.r&&(h[p]=Sr(p)),l=h[p]+u;var v=a?(e[d]||[])[p]:e[l];v&&ZO(t,v,d,p)}}}function eF(t,e){for(var r=e||{},n=Zn(),a=0,o=0;o<t.SheetNames.length;++o)t.SheetNames[o]==r.sheet&&(a=o);if(a==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Xe(n,r.biff==4?1033:r.biff==3?521:9,Yp(t,16,r)),JO(n,t.Sheets[t.SheetNames[a]],a,r),Xe(n,10),n.end()}function tF(t,e,r){Xe(t,49,Yb({sz:12,name:"Arial"},r))}function rF(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)e[a]!=null&&Xe(t,1054,eC(a,e[a],r))})}function nF(t,e){var r=we(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Xe(t,2151,r),r=we(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),UE(Gt(e["!ref"]||"A1"),r),r.write_shift(4,4),Xe(t,2152,r)}function aF(t,e){for(var r=0;r<16;++r)Xe(t,224,Q_({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){Xe(t,224,Q_(n,0,e))})}function iF(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];Xe(t,440,CC(n)),n[1].Tooltip&&Xe(t,2048,DC(n))}delete e["!links"]}function sF(t,e){if(e){var r=0;e.forEach(function(n,a){++r<=256&&n&&Xe(t,125,PC(ad(a,n),a))})}}function oF(t,e,r,n,a){var o=16+no(a.cellXfs,e,a);if(e.v==null&&!e.bf){Xe(t,513,qo(r,n,o));return}if(e.bf)Xe(t,6,F8(e,r,n,a,o));else switch(e.t){case"d":case"n":var l=e.t=="d"?en(vr(e.v)):e.v;Xe(t,515,hC(r,n,l,o));break;case"b":case"e":Xe(t,517,uC(r,n,e.v,o,a,e.t));break;case"s":case"str":if(a.bookSST){var u=rg(a.Strings,e.v,a.revStrings);Xe(t,253,$b(r,n,u,o))}else Xe(t,516,Zb(r,n,(e.v||"").slice(0,255),o,a));break;default:Xe(t,513,qo(r,n,o))}}function lF(t,e,r){var n=Zn(),a=r.SheetNames[t],o=r.Sheets[a]||{},l=(r||{}).Workbook||{},u=(l.Sheets||[])[t]||{},h=Array.isArray(o),d=e.biff==8,p,v="",_=[],y=Gt(o["!ref"]||"A1"),w=d?65536:16384;if(y.e.c>255||y.e.r>=w){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");y.e.c=Math.min(y.e.c,255),y.e.r=Math.min(y.e.c,w-1)}Xe(n,2057,Yp(r,16,e)),Xe(n,13,Ia(1)),Xe(n,12,Ia(100)),Xe(n,15,zn(!0)),Xe(n,17,zn(!1)),Xe(n,16,Wo(.001)),Xe(n,95,zn(!0)),Xe(n,42,zn(!1)),Xe(n,43,zn(!1)),Xe(n,130,Ia(1)),Xe(n,128,cC()),Xe(n,131,zn(!1)),Xe(n,132,zn(!1)),d&&sF(n,o["!cols"]),Xe(n,512,rC(y,e)),d&&(o["!links"]=[]);for(var E=y.s.r;E<=y.e.r;++E){v=Lr(E);for(var S=y.s.c;S<=y.e.c;++S){E===y.s.r&&(_[S]=Sr(S)),p=_[S]+v;var L=h?(o[E]||[])[S]:o[p];L&&(oF(n,L,E,S,e),d&&L.l&&o["!links"].push([p,L.l]))}}var z=u.CodeName||u.name||a;return d&&Xe(n,574,Gb((l.Views||[])[0])),d&&(o["!merges"]||[]).length&&Xe(n,229,EC(o["!merges"])),d&&iF(n,o),Xe(n,442,PE(z)),d&&nF(n,o),Xe(n,10),n.end()}function cF(t,e,r){var n=Zn(),a=(t||{}).Workbook||{},o=a.Sheets||[],l=a.WBProps||{},u=r.biff==8,h=r.biff==5;if(Xe(n,2057,Yp(t,5,r)),r.bookType=="xla"&&Xe(n,135),Xe(n,225,u?Ia(1200):null),Xe(n,193,ub(2)),h&&Xe(n,191),h&&Xe(n,192),Xe(n,226),Xe(n,92,Ob("SheetJS",r)),Xe(n,66,Ia(u?1200:1252)),u&&Xe(n,353,Ia(0)),u&&Xe(n,448),Xe(n,317,VC(t.SheetNames.length)),u&&t.vbaraw&&Xe(n,211),u&&t.vbaraw){var d=l.CodeName||"ThisWorkbook";Xe(n,442,PE(d))}Xe(n,156,Ia(17)),Xe(n,25,zn(!1)),Xe(n,18,zn(!1)),Xe(n,19,Ia(0)),u&&Xe(n,431,zn(!1)),u&&Xe(n,444,Ia(0)),Xe(n,61,Hb()),Xe(n,64,zn(!1)),Xe(n,141,Ia(0)),Xe(n,34,zn(jI(t)=="true")),Xe(n,14,zn(!0)),u&&Xe(n,439,zn(!1)),Xe(n,218,Ia(0)),tF(n,t,r),rF(n,t.SSF,r),aF(n,r),u&&Xe(n,352,zn(!1));var p=n.end(),v=Zn();u&&Xe(v,140,OC()),u&&r.Strings&&KO(v,252,Lb(r.Strings)),Xe(v,10);var _=v.end(),y=Zn(),w=0,E=0;for(E=0;E<t.SheetNames.length;++E)w+=(u?12:11)+(u?2:1)*t.SheetNames[E].length;var S=p.length+w+_.length;for(E=0;E<t.SheetNames.length;++E){var L=o[E]||{};Xe(y,133,Mb({pos:S,hs:L.Hidden||0,dt:0,name:t.SheetNames[E]},r)),S+=e[E].length}var z=y.end();if(w!=z.length)throw new Error("BS8 "+w+" != "+z.length);var O=[];return p.length&&O.push(p),z.length&&O.push(z),_.length&&O.push(_),cn(O)}function uF(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=_r(pt)),t&&t.SSF&&(vc(),Qh(t.SSF),r.revssf=Jh(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,og(r),r.cellXfs=[],no(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var a=0;a<t.SheetNames.length;++a)n[n.length]=lF(a,r,t);return n.unshift(cF(t,n,r)),cn(n)}function Rw(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var a=Jn(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var o=e||{};switch(o.biff||2){case 8:case 5:return uF(t,e);case 4:case 3:case 2:return eF(t,e)}throw new Error("invalid type "+o.bookType+" for BIFF")}function hy(t,e){var r=e||{},n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var a=t.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var o=t.match(/<\/table/i),l=a.index,u=o&&o.index||t.length,h=Y3(t.slice(l,u),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,p=0,v=0,_=0,y={s:{r:1e7,c:1e7},e:{r:0,c:0}},w=[];for(l=0;l<h.length;++l){var E=h[l].trim(),S=E.slice(0,3).toLowerCase();if(S=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}p=0;continue}if(!(S!="<td"&&S!="<th")){var L=E.split(/<\/t[dh]>/i);for(u=0;u<L.length;++u){var z=L[u].trim();if(z.match(/<t[dh]/i)){for(var O=z,ee=0;O.charAt(0)=="<"&&(ee=O.indexOf(">"))>-1;)O=O.slice(ee+1);for(var te=0;te<w.length;++te){var Z=w[te];Z.s.c==p&&Z.s.r<d&&d<=Z.e.r&&(p=Z.e.c+1,te=-1)}var C=yt(z.slice(0,z.indexOf(">")));_=C.colspan?+C.colspan:1,((v=+C.rowspan)>1||_>1)&&w.push({s:{r:d,c:p},e:{r:d+(v||1)-1,c:p+_-1}});var I=C.t||C["data-t"]||"";if(!O.length){p+=_;continue}if(O=JT(O),y.s.r>d&&(y.s.r=d),y.e.r<d&&(y.e.r=d),y.s.c>p&&(y.s.c=p),y.e.c<p&&(y.e.c=p),!O.length){p+=_;continue}var R={t:"s",v:O};r.raw||!O.trim().length||I=="s"||(O==="TRUE"?R={t:"b",v:!0}:O==="FALSE"?R={t:"b",v:!1}:isNaN(Ya(O))?isNaN(lc(O).getDate())||(R={t:"d",v:vr(O)},r.cellDates||(R={t:"n",v:en(R.v)}),R.z=r.dateNF||pt[14]):R={t:"n",v:Ya(O)}),r.dense?(n[d]||(n[d]=[]),n[d][p]=R):n[gt({r:d,c:p})]=R,p+=_}}}}return n["!ref"]=St(y),w.length&&(n["!merges"]=w),n}function fF(t,e,r,n){for(var a=t["!merges"]||[],o=[],l=e.s.c;l<=e.e.c;++l){for(var u=0,h=0,d=0;d<a.length;++d)if(!(a[d].s.r>r||a[d].s.c>l)&&!(a[d].e.r<r||a[d].e.c<l)){if(a[d].s.r<r||a[d].s.c<l){u=-1;break}u=a[d].e.r-a[d].s.r+1,h=a[d].e.c-a[d].s.c+1;break}if(!(u<0)){var p=gt({r,c:l}),v=n.dense?(t[r]||[])[l]:t[p],_=v&&v.v!=null&&(v.h||Mp(v.w||(Ji(v),v.w)||""))||"",y={};u>1&&(y.rowspan=u),h>1&&(y.colspan=h),n.editable?_='<span contenteditable="true">'+_+"</span>":v&&(y["data-t"]=v&&v.t||"z",v.v!=null&&(y["data-v"]=v.v),v.z!=null&&(y["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+v.l.Target+'">'+_+"</a>")),y.id=(n.id||"sjs")+"-"+p,o.push(Ge("td",_,y))}}var w="<tr>";return w+o.join("")+"</tr>"}var hF='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',dF="</body></html>";function mF(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return ro(hy(r[0],e),e);var n=ug();return r.forEach(function(a,o){fg(n,hy(a,e),"Sheet"+(o+1))}),n}function pF(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Dw(t,e){var r=e||{},n=r.header!=null?r.header:hF,a=r.footer!=null?r.footer:dF,o=[n],l=Jn(t["!ref"]);r.dense=Array.isArray(t),o.push(pF(t,l,r));for(var u=l.s.r;u<=l.e.r;++u)o.push(fF(t,l,u,r));return o.push("</table>"+a),o.join("")}function Iw(t,e,r){var n=r||{},a=0,o=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?Ar(n.origin):n.origin;a=l.r,o=l.c}var u=e.getElementsByTagName("tr"),h=Math.min(n.sheetRows||1e7,u.length),d={s:{r:0,c:0},e:{r:a,c:o}};if(t["!ref"]){var p=Jn(t["!ref"]);d.s.r=Math.min(d.s.r,p.s.r),d.s.c=Math.min(d.s.c,p.s.c),d.e.r=Math.max(d.e.r,p.e.r),d.e.c=Math.max(d.e.c,p.e.c),a==-1&&(d.e.r=a=p.e.r+1)}var v=[],_=0,y=t["!rows"]||(t["!rows"]=[]),w=0,E=0,S=0,L=0,z=0,O=0;for(t["!cols"]||(t["!cols"]=[]);w<u.length&&E<h;++w){var ee=u[w];if(dy(ee)){if(n.display)continue;y[E]={hidden:!0}}var te=ee.children;for(S=L=0;S<te.length;++S){var Z=te[S];if(!(n.display&&dy(Z))){var C=Z.hasAttribute("data-v")?Z.getAttribute("data-v"):Z.hasAttribute("v")?Z.getAttribute("v"):JT(Z.innerHTML),I=Z.getAttribute("data-z")||Z.getAttribute("z");for(_=0;_<v.length;++_){var R=v[_];R.s.c==L+o&&R.s.r<E+a&&E+a<=R.e.r&&(L=R.e.c+1-o,_=-1)}O=+Z.getAttribute("colspan")||1,((z=+Z.getAttribute("rowspan")||1)>1||O>1)&&v.push({s:{r:E+a,c:L+o},e:{r:E+a+(z||1)-1,c:L+o+(O||1)-1}});var B={t:"s",v:C},D=Z.getAttribute("data-t")||Z.getAttribute("t")||"";C!=null&&(C.length==0?B.t=D||"z":n.raw||C.trim().length==0||D=="s"||(C==="TRUE"?B={t:"b",v:!0}:C==="FALSE"?B={t:"b",v:!1}:isNaN(Ya(C))?isNaN(lc(C).getDate())||(B={t:"d",v:vr(C)},n.cellDates||(B={t:"n",v:en(B.v)}),B.z=n.dateNF||pt[14]):B={t:"n",v:Ya(C)})),B.z===void 0&&I!=null&&(B.z=I);var F="",M=Z.getElementsByTagName("A");if(M&&M.length)for(var Fe=0;Fe<M.length&&!(M[Fe].hasAttribute("href")&&(F=M[Fe].getAttribute("href"),F.charAt(0)!="#"));++Fe);F&&F.charAt(0)!="#"&&(B.l={Target:F}),n.dense?(t[E+a]||(t[E+a]=[]),t[E+a][L+o]=B):t[gt({c:L+o,r:E+a})]=B,d.e.c<L+o&&(d.e.c=L+o),L+=O}}++E}return v.length&&(t["!merges"]=(t["!merges"]||[]).concat(v)),d.e.r=Math.max(d.e.r,E-1+a),t["!ref"]=St(d),E>=h&&(t["!fullref"]=St((d.e.r=u.length-w+E-1+a,d))),t}function Ow(t,e){var r=e||{},n=r.dense?[]:{};return Iw(n,t,e)}function gF(t,e){return ro(Ow(t,e),e)}function dy(t){var e="",r=xF(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function xF(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function vF(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Wt(e.replace(/<[^>]*>/g,""));return[r]}var my={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Fw(t,e){var r=e||{},n=Pp(t),a=[],o,l,u={name:""},h="",d=0,p,v,_={},y=[],w=r.dense?[]:{},E,S,L={value:""},z="",O=0,ee=[],te=-1,Z=-1,C={s:{r:1e6,c:1e7},e:{r:0,c:0}},I=0,R={},B=[],D={},F=0,M=0,Fe=[],Se=1,ne=1,se=[],Le={Names:[]},ae={},W=["",""],pe=[],V={},Y="",Q=0,J=!1,ue=!1,Ie=0;for(Ju.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");E=Ju.exec(n);)switch(E[3]=E[3].replace(/_.*$/,"")){case"table":case"":E[1]==="/"?(C.e.c>=C.s.c&&C.e.r>=C.s.r?w["!ref"]=St(C):w["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=C.e.r&&(w["!fullref"]=w["!ref"],C.e.r=r.sheetRows-1,w["!ref"]=St(C)),B.length&&(w["!merges"]=B),Fe.length&&(w["!rows"]=Fe),p.name=p.||p.name,typeof JSON<"u"&&JSON.stringify(p),y.push(p.name),_[p.name]=w,ue=!1):E[0].charAt(E[0].length-2)!=="/"&&(p=yt(E[0],!1),te=Z=-1,C.s.r=C.s.c=1e7,C.e.r=C.e.c=0,w=r.dense?[]:{},B=[],Fe=[],ue=!0);break;case"table-row-group":E[1]==="/"?--I:++I;break;case"table-row":case"":if(E[1]==="/"){te+=Se,Se=1;break}if(v=yt(E[0],!1),v.?te=v.-1:te==-1&&(te=0),Se=+v["number-rows-repeated"]||1,Se<10)for(Ie=0;Ie<Se;++Ie)I>0&&(Fe[te+Ie]={level:I});Z=-1;break;case"covered-table-cell":E[1]!=="/"&&++Z,r.sheetStubs&&(r.dense?(w[te]||(w[te]=[]),w[te][Z]={t:"z"}):w[gt({r:te,c:Z})]={t:"z"}),z="",ee=[];break;case"table-cell":case"":if(E[0].charAt(E[0].length-2)==="/")++Z,L=yt(E[0],!1),ne=parseInt(L["number-columns-repeated"]||"1",10),S={t:"z",v:null},L.formula&&r.cellFormula!=!1&&(S.f=cy(Wt(L.formula))),(L.||L["value-type"])=="string"&&(S.t="s",S.v=Wt(L["string-value"]||""),r.dense?(w[te]||(w[te]=[]),w[te][Z]=S):w[gt({r:te,c:Z})]=S),Z+=ne-1;else if(E[1]!=="/"){++Z,z="",O=0,ee=[],ne=1;var ke=Se?te+Se-1:te;if(Z>C.e.c&&(C.e.c=Z),Z<C.s.c&&(C.s.c=Z),te<C.s.r&&(C.s.r=te),ke>C.e.r&&(C.e.r=ke),L=yt(E[0],!1),pe=[],V={},S={t:L.||L["value-type"],v:null},r.cellFormula)if(L.formula&&(L.formula=Wt(L.formula)),L["number-matrix-columns-spanned"]&&L["number-matrix-rows-spanned"]&&(F=parseInt(L["number-matrix-rows-spanned"],10)||0,M=parseInt(L["number-matrix-columns-spanned"],10)||0,D={s:{r:te,c:Z},e:{r:te+F-1,c:Z+M-1}},S.F=St(D),se.push([D,S.F])),L.formula)S.f=cy(L.formula);else for(Ie=0;Ie<se.length;++Ie)te>=se[Ie][0].s.r&&te<=se[Ie][0].e.r&&Z>=se[Ie][0].s.c&&Z<=se[Ie][0].e.c&&(S.F=se[Ie][1]);switch((L["number-columns-spanned"]||L["number-rows-spanned"])&&(F=parseInt(L["number-rows-spanned"],10)||0,M=parseInt(L["number-columns-spanned"],10)||0,D={s:{r:te,c:Z},e:{r:te+F-1,c:Z+M-1}},B.push(D)),L["number-columns-repeated"]&&(ne=parseInt(L["number-columns-repeated"],10)),S.t){case"boolean":S.t="b",S.v=gr(L["boolean-value"]);break;case"float":S.t="n",S.v=parseFloat(L.value);break;case"percentage":S.t="n",S.v=parseFloat(L.value);break;case"currency":S.t="n",S.v=parseFloat(L.value);break;case"date":S.t="d",S.v=vr(L["date-value"]),r.cellDates||(S.t="n",S.v=en(S.v)),S.z="m/d/yy";break;case"time":S.t="n",S.v=G3(L["time-value"])/86400,r.cellDates&&(S.t="d",S.v=ed(S.v)),S.z="HH:MM:SS";break;case"number":S.t="n",S.v=parseFloat(L.);break;default:if(S.t==="string"||S.t==="text"||!S.t)S.t="s",L["string-value"]!=null&&(z=Wt(L["string-value"]),ee=[]);else throw new Error("Unsupported value type "+S.t)}}else{if(J=!1,S.t==="s"&&(S.v=z||"",ee.length&&(S.R=ee),J=O==0),ae.Target&&(S.l=ae),pe.length>0&&(S.c=pe,pe=[]),z&&r.cellText!==!1&&(S.w=z),J&&(S.t="z",delete S.v),(!J||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=te))for(var Oe=0;Oe<Se;++Oe){if(ne=parseInt(L["number-columns-repeated"]||"1",10),r.dense)for(w[te+Oe]||(w[te+Oe]=[]),w[te+Oe][Z]=Oe==0?S:_r(S);--ne>0;)w[te+Oe][Z+ne]=_r(S);else for(w[gt({r:te+Oe,c:Z})]=S;--ne>0;)w[gt({r:te+Oe,c:Z+ne})]=_r(S);C.e.c<=Z&&(C.e.c=Z)}ne=parseInt(L["number-columns-repeated"]||"1",10),Z+=ne-1,ne=0,S={},z="",ee=[]}ae={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(E[1]==="/"){if((o=a.pop())[0]!==E[3])throw"Bad state: "+o}else E[0].charAt(E[0].length-2)!=="/"&&a.push([E[3],!0]);break;case"annotation":if(E[1]==="/"){if((o=a.pop())[0]!==E[3])throw"Bad state: "+o;V.t=z,ee.length&&(V.R=ee),V.a=Y,pe.push(V)}else E[0].charAt(E[0].length-2)!=="/"&&a.push([E[3],!1]);Y="",Q=0,z="",O=0,ee=[];break;case"creator":E[1]==="/"?Y=n.slice(Q,E.index):Q=E.index+E[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(E[1]==="/"){if((o=a.pop())[0]!==E[3])throw"Bad state: "+o}else E[0].charAt(E[0].length-2)!=="/"&&a.push([E[3],!1]);z="",O=0,ee=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(E[1]==="/"){if(R[u.name]=h,(o=a.pop())[0]!==E[3])throw"Bad state: "+o}else E[0].charAt(E[0].length-2)!=="/"&&(h="",u=yt(E[0],!1),a.push([E[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=yt(E[0],!1),h+=my[E[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=yt(E[0],!1),h+=my[E[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(E[0].slice(-2)==="/>")break;if(E[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":h+=n.slice(d,E.index);break}else d=E.index+E[0].length;break;case"named-range":l=yt(E[0],!1),W=Rm(l["cell-range-address"]);var le={Name:l.name,Ref:W[0]+"!"+W[1]};ue&&(le.Sheet=y.length),Le.Names.push(le);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(E[1]==="/"&&(!L||!L["string-value"])){var Qe=vF(n.slice(O,E.index));z=(z.length>0?z+`
`:"")+Qe[0]}else yt(E[0],!1),O=E.index+E[0].length;break;case"s":break;case"database-range":if(E[1]==="/")break;try{W=Rm(yt(E[0])["target-range-address"]),_[W[0]]["!autofilter"]={ref:W[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(E[1]!=="/"){if(ae=yt(E[0],!1),!ae.href)break;ae.Target=Wt(ae.href),delete ae.href,ae.Target.charAt(0)=="#"&&ae.Target.indexOf(".")>-1?(W=Rm(ae.Target.slice(1)),ae.Target="#"+W[0]+"!"+W[1]):ae.Target.match(/^\.\.[\\\/]/)&&(ae.Target=ae.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(E[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(E)}}var G={Sheets:_,SheetNames:y,Workbook:Le};return r.bookSheets&&delete G.Sheets,G}function py(t,e){e=e||{},Da(t,"META-INF/manifest.xml")&&Gk(Wr(t,"META-INF/manifest.xml"),e);var r=ha(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Fw(fr(r),e);return Da(t,"meta.xml")&&(n.Props=wE(Wr(t,"meta.xml"))),n}function gy(t,e){return Fw(t,e)}var _F=(function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Zu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Br+e}})(),xy=(function(){var t=function(o){return sr(o).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(o,l,u){var h=[];h.push('      <table:table table:name="'+sr(l.SheetNames[u])+`" table:style-name="ta1">
`);var d=0,p=0,v=Jn(o["!ref"]||"A1"),_=o["!merges"]||[],y=0,w=Array.isArray(o);if(o["!cols"])for(p=0;p<=v.e.c;++p)h.push("        <table:table-column"+(o["!cols"][p]?' table:style-name="co'+o["!cols"][p].ods+'"':"")+`></table:table-column>
`);var E="",S=o["!rows"]||[];for(d=0;d<v.s.r;++d)E=S[d]?' table:style-name="ro'+S[d].ods+'"':"",h.push("        <table:table-row"+E+`></table:table-row>
`);for(;d<=v.e.r;++d){for(E=S[d]?' table:style-name="ro'+S[d].ods+'"':"",h.push("        <table:table-row"+E+`>
`),p=0;p<v.s.c;++p)h.push(e);for(;p<=v.e.c;++p){var L=!1,z={},O="";for(y=0;y!=_.length;++y)if(!(_[y].s.c>p)&&!(_[y].s.r>d)&&!(_[y].e.c<p)&&!(_[y].e.r<d)){(_[y].s.c!=p||_[y].s.r!=d)&&(L=!0),z["table:number-columns-spanned"]=_[y].e.c-_[y].s.c+1,z["table:number-rows-spanned"]=_[y].e.r-_[y].s.r+1;break}if(L){h.push(r);continue}var ee=gt({r:d,c:p}),te=w?(o[d]||[])[p]:o[ee];if(te&&te.f&&(z["table:formula"]=sr(V8(te.f)),te.F&&te.F.slice(0,ee.length)==ee)){var Z=Jn(te.F);z["table:number-matrix-columns-spanned"]=Z.e.c-Z.s.c+1,z["table:number-matrix-rows-spanned"]=Z.e.r-Z.s.r+1}if(!te){h.push(e);continue}switch(te.t){case"b":O=te.v?"TRUE":"FALSE",z["office:value-type"]="boolean",z["office:boolean-value"]=te.v?"true":"false";break;case"n":O=te.w||String(te.v||0),z["office:value-type"]="float",z["office:value"]=te.v||0;break;case"s":case"str":O=te.v==null?"":te.v,z["office:value-type"]="string";break;case"d":O=te.w||vr(te.v).toISOString(),z["office:value-type"]="date",z["office:date-value"]=vr(te.v).toISOString(),z["table:style-name"]="ce1";break;default:h.push(e);continue}var C=t(O);if(te.l&&te.l.Target){var I=te.l.Target;I=I.charAt(0)=="#"?"#"+U8(I.slice(1)):I,I.charAt(0)!="#"&&!I.match(/^\w+:/)&&(I="../"+I),C=Ge("text:a",C,{"xlink:href":I.replace(/&/g,"&amp;")})}h.push("          "+Ge("table:table-cell",Ge("text:p",C,{}),z)+`
`)}h.push(`        </table:table-row>
`)}return h.push(`      </table:table>
`),h.join("")},a=function(o,l){o.push(` <office:automatic-styles>
`),o.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),o.push(`   <number:month number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:day number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:year/>
`),o.push(`  </number:date-style>
`);var u=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var p=0;p<d["!cols"].length;++p)if(d["!cols"][p]){var v=d["!cols"][p];if(v.width==null&&v.wpx==null&&v.wch==null)continue;qs(v),v.ods=u;var _=d["!cols"][p].wpx+"px";o.push('  <style:style style:name="co'+u+`" style:family="table-column">
`),o.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+_+`"/>
`),o.push(`  </style:style>
`),++u}}});var h=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var p=0;p<d["!rows"].length;++p)if(d["!rows"][p]){d["!rows"][p].ods=h;var v=d["!rows"][p].hpx+"px";o.push('  <style:style style:name="ro'+h+`" style:family="table-row">
`),o.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+v+`"/>
`),o.push(`  </style:style>
`),++h}}}),o.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),o.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),o.push(`  </style:style>
`),o.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),o.push(` </office:automatic-styles>
`)};return function(l,u){var h=[Br],d=Zu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),p=Zu({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});u.bookType=="fods"?(h.push("<office:document"+d+p+`>
`),h.push(EE().replace(/office:document-meta/g,"office:meta"))):h.push("<office:document-content"+d+`>
`),a(h,l),h.push(`  <office:body>
`),h.push(`    <office:spreadsheet>
`);for(var v=0;v!=l.SheetNames.length;++v)h.push(n(l.Sheets[l.SheetNames[v]],l,v));return h.push(`    </office:spreadsheet>
`),h.push(`  </office:body>
`),u.bookType=="fods"?h.push("</office:document>"):h.push("</office:document-content>"),h.join("")}})();function Nw(t,e){if(e.bookType=="fods")return xy(t,e);var r=Op(),n="",a=[],o=[];return n="mimetype",kt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",kt(r,n,xy(t,e)),a.push([n,"text/xml"]),o.push([n,"ContentFile"]),n="styles.xml",kt(r,n,_F(t,e)),a.push([n,"text/xml"]),o.push([n,"StylesFile"]),n="meta.xml",kt(r,n,Br+EE()),a.push([n,"text/xml"]),o.push([n,"MetadataFile"]),n="manifest.rdf",kt(r,n,Yk(o)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",kt(r,n,qk(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Xo(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function tp(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):fr(to(t))}function yF(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):fa(vi(t))}function TF(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Ys(t){var e=t.reduce(function(a,o){return a+o.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(a){r.set(a,n),n+=a.length}),r}function vy(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function EF(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,a=e+13;a>=e;--a)n=n*256+t[a];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function wF(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var o=0;a>=1;++o,a/=256)t[e+o]=a&255;t[e+15]|=r>=0?0:128}function of(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function ar(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Dr(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Yt(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],a=of(t,r),o=a&7;a=Math.floor(a/8);var l=0,u;if(a==0)break;switch(o){case 0:{for(var h=r[0];t[r[0]++]>=128;);u=t.slice(h,r[0])}break;case 5:l=4,u=t.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,u=t.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=of(t,r),u=t.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(a," at offset ").concat(n))}var d={data:u,type:o};e[a]==null?e[a]=[d]:e[a].push(d)}return e}function gn(t){var e=[];return t.forEach(function(r,n){r.forEach(function(a){a.data&&(e.push(ar(n*8+a.type)),a.type==2&&e.push(ar(a.data.length)),e.push(a.data))})}),Ys(e)}function ig(t,e){return t?.map(function(r){return e(r.data)})||[]}function Ca(t){for(var e,r=[],n=[0];n[0]<t.length;){var a=of(t,n),o=Yt(t.slice(n[0],n[0]+a));n[0]+=a;var l={id:Dr(o[1][0].data),messages:[]};o[2].forEach(function(u){var h=Yt(u.data),d=Dr(h[3][0].data);l.messages.push({meta:h,data:t.slice(n[0],n[0]+d)}),n[0]+=d}),(e=o[3])!=null&&e[0]&&(l.merge=Dr(o[3][0].data)>>>0>0),r.push(l)}return r}function Xl(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:ar(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:ar(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(l){a.push(l.data),l.meta[3]=[{type:0,data:ar(l.data.length)}],n[2].push({data:gn(l.meta),type:2})});var o=gn(n);e.push(ar(o.length)),e.push(o),a.forEach(function(l){return e.push(l)})}),Ys(e)}function SF(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=of(e,r),a=[];r[0]<e.length;){var o=e[r[0]]&3;if(o==0){var l=e[r[0]++]>>2;if(l<60)++l;else{var u=l-59;l=e[r[0]],u>1&&(l|=e[r[0]+1]<<8),u>2&&(l|=e[r[0]+2]<<16),u>3&&(l|=e[r[0]+3]<<24),l>>>=0,l++,r[0]+=u}a.push(e.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var h=0,d=0;if(o==1?(d=(e[r[0]]>>2&7)+4,h=(e[r[0]++]&224)<<3,h|=e[r[0]++]):(d=(e[r[0]++]>>2)+1,o==2?(h=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(h=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Ys(a)],h==0)throw new Error("Invalid offset 0");if(h>a[0].length)throw new Error("Invalid offset beyond length");if(d>=h)for(a.push(a[0].slice(-h)),d-=h;d>=a[a.length-1].length;)a.push(a[a.length-1]),d-=a[a.length-1].length;a.push(a[0].slice(-h,-h+d))}}var p=Ys(a);if(p.length!=n)throw new Error("Unexpected length: ".concat(p.length," != ").concat(n));return p}function Ra(t){for(var e=[],r=0;r<t.length;){var n=t[r++],a=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(SF(n,t.slice(r,r+a))),r+=a}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Ys(e)}function Yl(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),a=new Uint8Array(4);e.push(a);var o=ar(n),l=o.length;e.push(o),n<=60?(l++,e.push(new Uint8Array([n-1<<2]))):n<=256?(l+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(l+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(l+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(l+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),l+=n,a[0]=0,a[1]=l&255,a[2]=l>>8&255,a[3]=l>>16&255,r+=n}return Ys(e)}function AF(t,e,r,n){var a=Xo(t),o=a.getUint32(4,!0),l=(n>1?12:8)+vy(o&(n>1?3470:398))*4,u=-1,h=-1,d=NaN,p=new Date(2001,0,1);o&512&&(u=a.getUint32(l,!0),l+=4),l+=vy(o&(n>1?12288:4096))*4,o&16&&(h=a.getUint32(l,!0),l+=4),o&32&&(d=a.getFloat64(l,!0),l+=8),o&64&&(p.setTime(p.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var v;switch(t[2]){case 0:break;case 2:v={t:"n",v:d};break;case 3:v={t:"s",v:e[h]};break;case 5:v={t:"d",v:p};break;case 6:v={t:"b",v:d>0};break;case 7:v={t:"n",v:d/86400};break;case 8:v={t:"e",v:0};break;case 9:if(u>-1)v={t:"s",v:r[u]};else if(h>-1)v={t:"s",v:e[h]};else if(!isNaN(d))v={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return v}function kF(t,e,r){var n=Xo(t),a=n.getUint32(8,!0),o=12,l=-1,u=-1,h=NaN,d=NaN,p=new Date(2001,0,1);a&1&&(h=EF(t,o),o+=16),a&2&&(d=n.getFloat64(o,!0),o+=8),a&4&&(p.setTime(p.getTime()+n.getFloat64(o,!0)*1e3),o+=8),a&8&&(u=n.getUint32(o,!0),o+=4),a&16&&(l=n.getUint32(o,!0),o+=4);var v;switch(t[1]){case 0:break;case 2:v={t:"n",v:h};break;case 3:v={t:"s",v:e[u]};break;case 5:v={t:"d",v:p};break;case 6:v={t:"b",v:d>0};break;case 7:v={t:"n",v:d/86400};break;case 8:v={t:"e",v:0};break;case 9:if(l>-1)v={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)));break;case 10:v={t:"n",v:h};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(a&31," : ").concat(t.slice(0,4)))}return v}function Im(t,e){var r=new Uint8Array(32),n=Xo(r),a=12,o=0;switch(r[0]=5,t.t){case"n":r[1]=2,wF(r,a,t.v),o|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,t.v?1:0,!0),o|=2,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(a,e.indexOf(t.v),!0),o|=8,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,o,!0),r.slice(0,a)}function Om(t,e){var r=new Uint8Array(32),n=Xo(r),a=12,o=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(a,t.v,!0),o|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,t.v?1:0,!0),o|=32,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(a,e.indexOf(t.v),!0),o|=16,a+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,o,!0),r.slice(0,a)}function bF(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return AF(t,e,r,t[0]);case 5:return kF(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function bn(t){var e=Yt(t);return of(e[1][0].data)}function _y(t,e){var r=Yt(e.data),n=Dr(r[1][0].data),a=r[3],o=[];return(a||[]).forEach(function(l){var u=Yt(l.data),h=Dr(u[1][0].data)>>>0;switch(n){case 1:o[h]=tp(u[3][0].data);break;case 8:{var d=t[bn(u[9][0].data)][0],p=Yt(d.data),v=t[bn(p[1][0].data)][0],_=Dr(v.meta[1][0].data);if(_!=2001)throw new Error("2000 unexpected reference to ".concat(_));var y=Yt(v.data);o[h]=y[3].map(function(w){return tp(w.data)}).join("")}break}}),o}function CF(t,e){var r,n,a,o,l,u,h,d,p,v,_,y,w,E,S=Yt(t),L=Dr(S[1][0].data)>>>0,z=Dr(S[2][0].data)>>>0,O=((n=(r=S[8])==null?void 0:r[0])==null?void 0:n.data)&&Dr(S[8][0].data)>0||!1,ee,te;if((o=(a=S[7])==null?void 0:a[0])!=null&&o.data&&e!=0)ee=(u=(l=S[7])==null?void 0:l[0])==null?void 0:u.data,te=(d=(h=S[6])==null?void 0:h[0])==null?void 0:d.data;else if((v=(p=S[4])==null?void 0:p[0])!=null&&v.data&&e!=1)ee=(y=(_=S[4])==null?void 0:_[0])==null?void 0:y.data,te=(E=(w=S[3])==null?void 0:w[0])==null?void 0:E.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var Z=O?4:1,C=Xo(ee),I=[],R=0;R<ee.length/2;++R){var B=C.getUint16(R*2,!0);B<65535&&I.push([R,B])}if(I.length!=z)throw"Expected ".concat(z," cells, found ").concat(I.length);var D=[];for(R=0;R<I.length-1;++R)D[I[R][0]]=te.subarray(I[R][1]*Z,I[R+1][1]*Z);return I.length>=1&&(D[I[I.length-1][0]]=te.subarray(I[I.length-1][1]*Z)),{R:L,cells:D}}function RF(t,e){var r,n=Yt(e.data),a=(r=n?.[7])!=null&&r[0]?Dr(n[7][0].data)>>>0>0?1:0:-1,o=ig(n[5],function(l){return CF(l,a)});return{nrows:Dr(n[4][0].data)>>>0,data:o.reduce(function(l,u){return l[u.R]||(l[u.R]=[]),u.cells.forEach(function(h,d){if(l[u.R][d])throw new Error("Duplicate cell r=".concat(u.R," c=").concat(d));l[u.R][d]=h}),l},[])}}function DF(t,e,r){var n,a=Yt(e.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(Dr(a[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(o.e.c=(Dr(a[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=St(o);var l=Yt(a[4][0].data),u=_y(t,t[bn(l[4][0].data)][0]),h=(n=l[17])!=null&&n[0]?_y(t,t[bn(l[17][0].data)][0]):[],d=Yt(l[3][0].data),p=0;d[1].forEach(function(v){var _=Yt(v.data),y=t[bn(_[2][0].data)][0],w=Dr(y.meta[1][0].data);if(w!=6002)throw new Error("6001 unexpected reference to ".concat(w));var E=RF(t,y);E.data.forEach(function(S,L){S.forEach(function(z,O){var ee=gt({r:p+L,c:O}),te=bF(z,u,h);te&&(r[ee]=te)})}),p+=E.nrows})}function IF(t,e){var r=Yt(e.data),n={"!ref":"A1"},a=t[bn(r[2][0].data)],o=Dr(a[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return DF(t,a[0],n),n}function OF(t,e){var r,n=Yt(e.data),a={name:(r=n[1])!=null&&r[0]?tp(n[1][0].data):"",sheets:[]},o=ig(n[2],bn);return o.forEach(function(l){t[l].forEach(function(u){var h=Dr(u.meta[1][0].data);h==6e3&&a.sheets.push(IF(t,u))})}),a}function FF(t,e){var r=ug(),n=Yt(e.data),a=ig(n[1],bn);if(a.forEach(function(o){t[o].forEach(function(l){var u=Dr(l.meta[1][0].data);if(u==2){var h=OF(t,l);h.sheets.forEach(function(d,p){fg(r,d,p==0?h.name:h.name+"_"+p,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Fm(t){var e,r,n,a,o={},l=[];if(t.FullPaths.forEach(function(h){if(h.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(h){if(h.name.match(/\.iwa$/)){var d;try{d=Ra(h.content)}catch(v){return console.log("?? "+h.content.length+" "+(v.message||v))}var p;try{p=Ca(d)}catch(v){return console.log("## "+(v.message||v))}p.forEach(function(v){o[v.id]=v.messages,l.push(v.id)})}}),!l.length)throw new Error("File has no messages");var u=((a=(n=(r=(e=o?.[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Dr(o[1][0].meta[1][0].data)==1&&o[1][0];if(u||l.forEach(function(h){o[h].forEach(function(d){var p=Dr(d.meta[1][0].data)>>>0;if(p==1)if(!u)u=d;else throw new Error("Document has multiple roots")})}),!u)throw new Error("Cannot find Document root");return FF(o,u)}function NF(t,e,r){var n,a,o,l;if(!((n=t[6])!=null&&n[0])||!((a=t[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var u=((l=(o=t[8])==null?void 0:o[0])==null?void 0:l.data)&&Dr(t[8][0].data)>0||!1;if(u)throw"Math only works with normal offsets";for(var h=0,d=Xo(t[7][0].data),p=0,v=[],_=Xo(t[4][0].data),y=0,w=[],E=0;E<e.length;++E){if(e[E]==null){d.setUint16(E*2,65535,!0),_.setUint16(E*2,65535);continue}d.setUint16(E*2,p,!0),_.setUint16(E*2,y,!0);var S,L;switch(typeof e[E]){case"string":S=Im({t:"s",v:e[E]},r),L=Om({t:"s",v:e[E]},r);break;case"number":S=Im({t:"n",v:e[E]},r),L=Om({t:"n",v:e[E]},r);break;case"boolean":S=Im({t:"b",v:e[E]},r),L=Om({t:"b",v:e[E]},r);break;default:throw new Error("Unsupported value "+e[E])}v.push(S),p+=S.length,w.push(L),y+=L.length,++h}for(t[2][0].data=ar(h);E<t[7][0].data.length/2;++E)d.setUint16(E*2,65535,!0),_.setUint16(E*2,65535,!0);return t[6][0].data=Ys(v),t[3][0].data=Ys(w),h}function MF(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Jn(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(St(n)));var o=Oh(r,{range:n,header:1}),l=["~Sh33tJ5~"];o.forEach(function(Y){return Y.forEach(function(Q){typeof Q=="string"&&l.push(Q)})});var u={},h=[],d=ot.read(e.numbers,{type:"base64"});d.FileIndex.map(function(Y,Q){return[Y,d.FullPaths[Q]]}).forEach(function(Y){var Q=Y[0],J=Y[1];if(Q.type==2&&Q.name.match(/\.iwa/)){var ue=Q.content,Ie=Ra(ue),ke=Ca(Ie);ke.forEach(function(Oe){h.push(Oe.id),u[Oe.id]={deps:[],location:J,type:Dr(Oe.messages[0].meta[1][0].data)}})}}),h.sort(function(Y,Q){return Y-Q});var p=h.filter(function(Y){return Y>1}).map(function(Y){return[Y,ar(Y)]});d.FileIndex.map(function(Y,Q){return[Y,d.FullPaths[Q]]}).forEach(function(Y){var Q=Y[0];if(Y[1],!!Q.name.match(/\.iwa/)){var J=Ca(Ra(Q.content));J.forEach(function(ue){ue.messages.forEach(function(Ie){p.forEach(function(ke){ue.messages.some(function(Oe){return Dr(Oe.meta[1][0].data)!=11006&&TF(Oe.data,ke[1])})&&u[ke[0]].deps.push(ue.id)})})})}});for(var v=ot.find(d,u[1].location),_=Ca(Ra(v.content)),y,w=0;w<_.length;++w){var E=_[w];E.id==1&&(y=E)}var S=bn(Yt(y.messages[0].data)[1][0].data);for(v=ot.find(d,u[S].location),_=Ca(Ra(v.content)),w=0;w<_.length;++w)E=_[w],E.id==S&&(y=E);for(S=bn(Yt(y.messages[0].data)[2][0].data),v=ot.find(d,u[S].location),_=Ca(Ra(v.content)),w=0;w<_.length;++w)E=_[w],E.id==S&&(y=E);for(S=bn(Yt(y.messages[0].data)[2][0].data),v=ot.find(d,u[S].location),_=Ca(Ra(v.content)),w=0;w<_.length;++w)E=_[w],E.id==S&&(y=E);var L=Yt(y.messages[0].data);{L[6][0].data=ar(n.e.r+1),L[7][0].data=ar(n.e.c+1);var z=bn(L[46][0].data),O=ot.find(d,u[z].location),ee=Ca(Ra(O.content));{for(var te=0;te<ee.length&&ee[te].id!=z;++te);if(ee[te].id!=z)throw"Bad ColumnRowUIDMapArchive";var Z=Yt(ee[te].messages[0].data);Z[1]=[],Z[2]=[],Z[3]=[];for(var C=0;C<=n.e.c;++C){var I=[];I[1]=I[2]=[{type:0,data:ar(C+420690)}],Z[1].push({type:2,data:gn(I)}),Z[2].push({type:0,data:ar(C)}),Z[3].push({type:0,data:ar(C)})}Z[4]=[],Z[5]=[],Z[6]=[];for(var R=0;R<=n.e.r;++R)I=[],I[1]=I[2]=[{type:0,data:ar(R+726270)}],Z[4].push({type:2,data:gn(I)}),Z[5].push({type:0,data:ar(R)}),Z[6].push({type:0,data:ar(R)});ee[te].messages[0].data=gn(Z)}O.content=Yl(Xl(ee)),O.size=O.content.length,delete L[46];var B=Yt(L[4][0].data);{B[7][0].data=ar(n.e.r+1);var D=Yt(B[1][0].data),F=bn(D[2][0].data);O=ot.find(d,u[F].location),ee=Ca(Ra(O.content));{if(ee[0].id!=F)throw"Bad HeaderStorageBucket";var M=Yt(ee[0].messages[0].data);for(R=0;R<o.length;++R){var Fe=Yt(M[2][0].data);Fe[1][0].data=ar(R),Fe[4][0].data=ar(o[R].length),M[2][R]={type:M[2][0].type,data:gn(Fe)}}ee[0].messages[0].data=gn(M)}O.content=Yl(Xl(ee)),O.size=O.content.length;var Se=bn(B[2][0].data);O=ot.find(d,u[Se].location),ee=Ca(Ra(O.content));{if(ee[0].id!=Se)throw"Bad HeaderStorageBucket";for(M=Yt(ee[0].messages[0].data),C=0;C<=n.e.c;++C)Fe=Yt(M[2][0].data),Fe[1][0].data=ar(C),Fe[4][0].data=ar(n.e.r+1),M[2][C]={type:M[2][0].type,data:gn(Fe)};ee[0].messages[0].data=gn(M)}O.content=Yl(Xl(ee)),O.size=O.content.length;var ne=bn(B[4][0].data);(function(){for(var Y=ot.find(d,u[ne].location),Q=Ca(Ra(Y.content)),J,ue=0;ue<Q.length;++ue){var Ie=Q[ue];Ie.id==ne&&(J=Ie)}var ke=Yt(J.messages[0].data);{ke[3]=[];var Oe=[];l.forEach(function(G,et){Oe[1]=[{type:0,data:ar(et)}],Oe[2]=[{type:0,data:ar(1)}],Oe[3]=[{type:2,data:yF(G)}],ke[3].push({type:2,data:gn(Oe)})})}J.messages[0].data=gn(ke);var le=Xl(Q),Qe=Yl(le);Y.content=Qe,Y.size=Y.content.length})();var se=Yt(B[3][0].data);{var Le=se[1][0];delete se[2];var ae=Yt(Le.data);{var W=bn(ae[2][0].data);(function(){for(var Y=ot.find(d,u[W].location),Q=Ca(Ra(Y.content)),J,ue=0;ue<Q.length;++ue){var Ie=Q[ue];Ie.id==W&&(J=Ie)}var ke=Yt(J.messages[0].data);{delete ke[6],delete se[7];var Oe=new Uint8Array(ke[5][0].data);ke[5]=[];for(var le=0,Qe=0;Qe<=n.e.r;++Qe){var G=Yt(Oe);le+=NF(G,o[Qe],l),G[1][0].data=ar(Qe),ke[5].push({data:gn(G),type:2})}ke[1]=[{type:0,data:ar(n.e.c+1)}],ke[2]=[{type:0,data:ar(n.e.r+1)}],ke[3]=[{type:0,data:ar(le)}],ke[4]=[{type:0,data:ar(n.e.r+1)}]}J.messages[0].data=gn(ke);var et=Xl(Q),Ve=Yl(et);Y.content=Ve,Y.size=Y.content.length})()}Le.data=gn(ae)}B[3][0].data=gn(se)}L[4][0].data=gn(B)}y.messages[0].data=gn(L);var pe=Xl(_),V=Yl(pe);return v.content=V,v.size=v.content.length,d}function Mw(t){return function(r){for(var n=0;n!=t.length;++n){var a=t[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function sg(t){Mw([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function og(t){Mw([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function PF(t){return It.WS.indexOf(t)>-1?"sheet":t==It.CS?"chart":t==It.DS?"dialog":t==It.MS?"macro":t&&t.length?t:"sheet"}function LF(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,PF(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function BF(t,e,r,n,a,o,l,u,h,d,p,v){try{o[n]=Lu(ha(t,r,!0),e);var _=Wr(t,e),y;switch(u){case"sheet":y=sO(_,e,a,h,o[n],d,p,v);break;case"chart":if(y=oO(_,e,a,h,o[n],d,p,v),!y||!y["!drawel"])break;var w=Ru(y["!drawel"].Target,e),E=ef(w),S=XR(ha(t,w,!0),Lu(ha(t,E,!0),w)),L=Ru(S,w),z=ef(L);y=NI(ha(t,L,!0),L,h,Lu(ha(t,z,!0),L),d,y);break;case"macro":y=lO(_,e,a,h,o[n],d,p,v);break;case"dialog":y=cO(_,e,a,h,o[n],d,p,v);break;default:throw new Error("Unrecognized sheet type "+u)}l[n]=y;var O=[];o&&o[n]&&Ir(o[n]).forEach(function(ee){var te="";if(o[n][ee].Type==It.CMNT){te=Ru(o[n][ee].Target,e);var Z=dO(Wr(t,te,!0),te,h);if(!Z||!Z.length)return;ay(y,Z,!1)}o[n][ee].Type==It.TCMNT&&(te=Ru(o[n][ee].Target,e),O=O.concat(KR(Wr(t,te,!0),h)))}),O&&O.length&&ay(y,O,!0,h.people||[])}catch(ee){if(h.WTF)throw ee}}function ka(t){return t.charAt(0)=="/"?t.slice(1):t}function VF(t,e){if(vc(),e=e||{},sg(e),Da(t,"META-INF/manifest.xml")||Da(t,"objectdata.xml"))return py(t,e);if(Da(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Fm<"u"){if(t.FileIndex)return Fm(t);var r=ot.utils.cfb_new();return A_(t).forEach(function(Fe){kt(r,Fe,$3(t,Fe))}),Fm(r)}throw new Error("Unsupported NUMBERS file")}if(!Da(t,"[Content_Types].xml"))throw Da(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Da(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=A_(t),a=Hk(ha(t,"[Content_Types].xml")),o=!1,l,u;if(a.workbooks.length===0&&(u="xl/workbook.xml",Wr(t,u,!0)&&a.workbooks.push(u)),a.workbooks.length===0){if(u="xl/workbook.bin",!Wr(t,u,!0))throw new Error("Could not find workbook");a.workbooks.push(u),o=!0}a.workbooks[0].slice(-3)=="bin"&&(o=!0);var h={},d={};if(!e.bookSheets&&!e.bookProps){if(Bu=[],a.sst)try{Bu=hO(Wr(t,ka(a.sst)),a.sst,e)}catch(Fe){if(e.WTF)throw Fe}e.cellStyles&&a.themes.length&&(h=fO(ha(t,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],e)),a.style&&(d=uO(Wr(t,ka(a.style)),a.style,h,e))}a.links.map(function(Fe){try{var Se=Lu(ha(t,ef(ka(Fe))),Fe);return pO(Wr(t,ka(Fe)),Se,Fe,e)}catch{}});var p=iO(Wr(t,ka(a.workbooks[0])),a.workbooks[0],e),v={},_="";a.coreprops.length&&(_=Wr(t,ka(a.coreprops[0]),!0),_&&(v=wE(_)),a.extprops.length!==0&&(_=Wr(t,ka(a.extprops[0]),!0),_&&$k(_,v,e)));var y={};(!e.bookSheets||e.bookProps)&&a.custprops.length!==0&&(_=ha(t,ka(a.custprops[0]),!0),_&&(y=Zk(_,e)));var w={};if((e.bookSheets||e.bookProps)&&(p.Sheets?l=p.Sheets.map(function(Se){return Se.name}):v.Worksheets&&v.SheetNames.length>0&&(l=v.SheetNames),e.bookProps&&(w.Props=v,w.Custprops=y),e.bookSheets&&typeof l<"u"&&(w.SheetNames=l),e.bookSheets?w.SheetNames:e.bookProps))return w;l={};var E={};e.bookDeps&&a.calcchain&&(E=mO(Wr(t,ka(a.calcchain)),a.calcchain));var S=0,L={},z,O;{var ee=p.Sheets;v.Worksheets=ee.length,v.SheetNames=[];for(var te=0;te!=ee.length;++te)v.SheetNames[te]=ee[te].name}var Z=o?"bin":"xml",C=a.workbooks[0].lastIndexOf("/"),I=(a.workbooks[0].slice(0,C+1)+"_rels/"+a.workbooks[0].slice(C+1)+".rels").replace(/^\//,"");Da(t,I)||(I="xl/_rels/workbook."+Z+".rels");var R=Lu(ha(t,I,!0),I.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(e.xlmeta=gO(Wr(t,ka(a.metadata[0])),a.metadata[0],e)),(a.people||[]).length>=1&&(e.people=QR(Wr(t,ka(a.people[0])),e)),R&&(R=LF(R,p.Sheets));var B=Wr(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(S=0;S!=v.Worksheets;++S){var D="sheet";if(R&&R[S]?(z="xl/"+R[S][1].replace(/[\/]?xl\//,""),Da(t,z)||(z=R[S][1]),Da(t,z)||(z=I.replace(/_rels\/.*$/,"")+R[S][1]),D=R[S][2]):(z="xl/worksheets/sheet"+(S+1-B)+"."+Z,z=z.replace(/sheet0\./,"sheet.")),O=z.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(S!=e.sheets)continue e;break;case"string":if(v.SheetNames[S].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var F=!1,M=0;M!=e.sheets.length;++M)typeof e.sheets[M]=="number"&&e.sheets[M]==S&&(F=1),typeof e.sheets[M]=="string"&&e.sheets[M].toLowerCase()==v.SheetNames[S].toLowerCase()&&(F=1);if(!F)continue e}}BF(t,z,O,v.SheetNames[S],S,L,l,D,e,p,h,d)}return w={Directory:a,Workbook:p,Props:v,Custprops:y,Deps:E,Sheets:l,SheetNames:v.SheetNames,Strings:Bu,Styles:d,Themes:h,SSF:_r(pt)},e&&e.bookFiles&&(t.files?(w.keys=n,w.files=t.files):(w.keys=[],w.files={},t.FullPaths.forEach(function(Fe,Se){Fe=Fe.replace(/^Root Entry[\/]/,""),w.keys.push(Fe),w.files[Fe]=t.FileIndex[Se]}))),e&&e.bookVBA&&(a.vba.length>0?w.vbaraw=Wr(t,ka(a.vba[0]),!0):a.defaults&&a.defaults.bin===i5&&(w.vbaraw=Wr(t,"xl/vbaProject.bin",!0))),w}function UF(t,e){var r=e||{},n="Workbook",a=ot.find(t,n);try{if(n="/!DataSpaces/Version",a=ot.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(g6(a.content),n="/!DataSpaces/DataSpaceMap",a=ot.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=v6(a.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=ot.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=_6(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=ot.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);T6(a.content)}catch{}if(n="/EncryptionInfo",a=ot.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var u=E6(a.content);if(n="/EncryptedPackage",a=ot.find(t,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(u[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(u[1],a.content,r.password||"",r);if(u[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(u[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function jF(t,e){return e.bookType=="ods"?Nw(t,e):e.bookType=="numbers"?MF(t,e):e.bookType=="xlsb"?zF(t,e):HF(t,e)}function zF(t,e){tc=1024,t&&!t.SSF&&(t.SSF=_r(pt)),t&&t.SSF&&(vc(),Qh(t.SSF),e.revssf=Jh(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Vu?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=lw.indexOf(e.bookType)>-1,a=qp();og(e=e||{});var o=Op(),l="",u=0;if(e.cellXfs=[],no(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),l="docProps/core.xml",kt(o,l,SE(t.Props,e)),a.coreprops.push(l),ir(e.rels,2,l,It.CORE_PROPS),l="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var h=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&h.push(t.SheetNames[d]);t.Props.SheetNames=h}for(t.Props.Worksheets=t.Props.SheetNames.length,kt(o,l,bE(t.Props)),a.extprops.push(l),ir(e.rels,3,l,It.EXT_PROPS),t.Custprops!==t.Props&&Ir(t.Custprops||{}).length>0&&(l="docProps/custom.xml",kt(o,l,CE(t.Custprops)),a.custprops.push(l),ir(e.rels,4,l,It.CUST_PROPS)),u=1;u<=t.SheetNames.length;++u){var p={"!id":{}},v=t.Sheets[t.SheetNames[u-1]],_=(v||{})["!type"]||"sheet";switch(_){case"chart":default:l="xl/worksheets/sheet"+u+"."+r,kt(o,l,vO(u-1,l,e,t,p)),a.sheets.push(l),ir(e.wbrels,-1,"worksheets/sheet"+u+"."+r,It.WS[0])}if(v){var y=v["!comments"],w=!1,E="";y&&y.length>0&&(E="xl/comments"+u+"."+r,kt(o,E,TO(y,E)),a.comments.push(E),ir(p,-1,"../comments"+u+"."+r,It.CMNT),w=!0),v["!legacy"]&&w&&kt(o,"xl/drawings/vmlDrawing"+u+".vml",sw(u,v["!comments"])),delete v["!comments"],delete v["!legacy"]}p["!id"].rId1&&kt(o,ef(l),nc(p))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+r,kt(o,l,yO(e.Strings,l,e)),a.strs.push(l),ir(e.wbrels,-1,"sharedStrings."+r,It.SST)),l="xl/workbook."+r,kt(o,l,xO(t,l)),a.workbooks.push(l),ir(e.rels,1,l,It.WB),l="xl/theme/theme1.xml",kt(o,l,Zp(t.Themes,e)),a.themes.push(l),ir(e.wbrels,-1,"theme/theme1.xml",It.THEME),l="xl/styles."+r,kt(o,l,_O(t,l,e)),a.styles.push(l),ir(e.wbrels,-1,"styles."+r,It.STY),t.vbaraw&&n&&(l="xl/vbaProject.bin",kt(o,l,t.vbaraw),a.vba.push(l),ir(e.wbrels,-1,"vbaProject.bin",It.VBA)),l="xl/metadata."+r,kt(o,l,EO(l)),a.metadata.push(l),ir(e.wbrels,-1,"metadata."+r,It.XLMETA),kt(o,"[Content_Types].xml",TE(a,e)),kt(o,"_rels/.rels",nc(e.rels)),kt(o,"xl/_rels/workbook."+r+".rels",nc(e.wbrels)),delete e.revssf,delete e.ssf,o}function HF(t,e){tc=1024,t&&!t.SSF&&(t.SSF=_r(pt)),t&&t.SSF&&(vc(),Qh(t.SSF),e.revssf=Jh(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Vu?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=lw.indexOf(e.bookType)>-1,a=qp();og(e=e||{});var o=Op(),l="",u=0;if(e.cellXfs=[],no(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),l="docProps/core.xml",kt(o,l,SE(t.Props,e)),a.coreprops.push(l),ir(e.rels,2,l,It.CORE_PROPS),l="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var h=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&h.push(t.SheetNames[d]);t.Props.SheetNames=h}t.Props.Worksheets=t.Props.SheetNames.length,kt(o,l,bE(t.Props)),a.extprops.push(l),ir(e.rels,3,l,It.EXT_PROPS),t.Custprops!==t.Props&&Ir(t.Custprops||{}).length>0&&(l="docProps/custom.xml",kt(o,l,CE(t.Custprops)),a.custprops.push(l),ir(e.rels,4,l,It.CUST_PROPS));var p=["SheetJ5"];for(e.tcid=0,u=1;u<=t.SheetNames.length;++u){var v={"!id":{}},_=t.Sheets[t.SheetNames[u-1]],y=(_||{})["!type"]||"sheet";switch(y){case"chart":default:l="xl/worksheets/sheet"+u+"."+r,kt(o,l,_w(u-1,e,t,v)),a.sheets.push(l),ir(e.wbrels,-1,"worksheets/sheet"+u+"."+r,It.WS[0])}if(_){var w=_["!comments"],E=!1,S="";if(w&&w.length>0){var L=!1;w.forEach(function(z){z[1].forEach(function(O){O.T==!0&&(L=!0)})}),L&&(S="xl/threadedComments/threadedComment"+u+"."+r,kt(o,S,$R(w,p,e)),a.threadedcomments.push(S),ir(v,-1,"../threadedComments/threadedComment"+u+"."+r,It.TCMNT)),S="xl/comments"+u+"."+r,kt(o,S,ow(w)),a.comments.push(S),ir(v,-1,"../comments"+u+"."+r,It.CMNT),E=!0}_["!legacy"]&&E&&kt(o,"xl/drawings/vmlDrawing"+u+".vml",sw(u,_["!comments"])),delete _["!comments"],delete _["!legacy"]}v["!id"].rId1&&kt(o,ef(l),nc(v))}return e.Strings!=null&&e.Strings.length>0&&(l="xl/sharedStrings."+r,kt(o,l,YE(e.Strings,e)),a.strs.push(l),ir(e.wbrels,-1,"sharedStrings."+r,It.SST)),l="xl/workbook."+r,kt(o,l,Sw(t)),a.workbooks.push(l),ir(e.rels,1,l,It.WB),l="xl/theme/theme1.xml",kt(o,l,Zp(t.Themes,e)),a.themes.push(l),ir(e.wbrels,-1,"theme/theme1.xml",It.THEME),l="xl/styles."+r,kt(o,l,rw(t,e)),a.styles.push(l),ir(e.wbrels,-1,"styles."+r,It.STY),t.vbaraw&&n&&(l="xl/vbaProject.bin",kt(o,l,t.vbaraw),a.vba.push(l),ir(e.wbrels,-1,"vbaProject.bin",It.VBA)),l="xl/metadata."+r,kt(o,l,iw()),a.metadata.push(l),ir(e.wbrels,-1,"metadata."+r,It.XLMETA),p.length>1&&(l="xl/persons/person.xml",kt(o,l,ZR(p)),a.people.push(l),ir(e.wbrels,-1,"persons/person.xml",It.PEOPLE)),kt(o,"[Content_Types].xml",TE(a,e)),kt(o,"_rels/.rels",nc(e.rels)),kt(o,"xl/_rels/workbook."+r+".rels",nc(e.wbrels)),delete e.revssf,delete e.ssf,o}function lg(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=da(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function WF(t,e){return ot.find(t,"EncryptedPackage")?UF(t,e):Cw(t,e)}function GF(t,e){var r,n=t,a=e||{};return a.type||(a.type=Rt&&Buffer.isBuffer(t)?"buffer":"base64"),r=$T(n,a),VF(r,a)}function Pw(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Jm(t.slice(r),e);default:break e}return cc.to_workbook(t,e)}function qF(t,e){var r="",n=lg(t,e);switch(e.type){case"base64":r=da(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Ho(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=fr(r)),e.type="binary",Pw(r,e)}function XF(t,e){var r=t;return e.type=="base64"&&(r=da(r)),r=Yu.utils.decode(1200,r.slice(2),"str"),e.type="binary",Pw(r,e)}function YF(t){return t.match(/[^\x00-\x7F]/)?vi(t):t}function Nm(t,e,r,n){return n?(r.type="string",cc.to_workbook(t,r)):cc.to_workbook(e,r)}function rp(t,e){bp();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return rp(new Uint8Array(t),(r=_r(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,a=[0,0,0,0],o=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),ic={},r.dateNF&&(ic.dateNF=r.dateNF),r.type||(r.type=Rt&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Rt?"buffer":"binary",n=z3(t),typeof Uint8Array<"u"&&!Rt&&(r.type="array")),r.type=="string"&&(o=!0,r.type="binary",r.codepage=65001,n=YF(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),u=new Uint8Array(l);if(u.foo="bar",!u.foo)return r=_r(r),r.type="array",rp(Cp(n),r)}switch((a=lg(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return WF(ot.read(n,r),r);break;case 9:if(a[1]<=8)return Cw(n,r);break;case 60:return Jm(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return JC(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return qE.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?GF(n,r):Nm(t,n,r,o);case 239:return a[3]===60?Jm(n,r):Nm(t,n,r,o);case 255:if(a[1]===254)return XF(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return Vo.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return Vo.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Zm.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return JE.to_workbook(n,r);break;case 10:case 13:case 32:return qF(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return ZC.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Zm.to_workbook(n,r):Nm(t,n,r,o)}function Lw(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return _f(e.file,ot.write(t,{type:Rt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return ot.write(t,e)}function KF(t,e){var r=_r(e||{}),n=jF(t,r);return $F(n,r)}function $F(t,e){var r={},n=Rt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var a=t.FullPaths?ot.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(e.type=="binary"||e.type=="base64")return a;a=new Uint8Array($h(a))}return e.password&&typeof encrypt_agile<"u"?Lw(encrypt_agile(a,e.password),e):e.type==="file"?_f(e.file,a):e.type=="string"?fr(a):a}function QF(t,e){var r=e||{},n=YO(t,r);return Lw(n,r)}function pi(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return Ku(vi(n));case"binary":return vi(n);case"string":return t;case"file":return _f(e.file,n,"utf8");case"buffer":return Rt?ns(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):pi(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function ZF(t,e){switch(e.type){case"base64":return Ku(t);case"binary":return t;case"string":return t;case"file":return _f(e.file,t,"binary");case"buffer":return Rt?ns(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function ah(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?Ku(r):e.type=="string"?fr(r):r;case"file":return _f(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function Bw(t,e){bp(),WI(t);var r=_r(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=Bw(t,r);return r.type="array",$h(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=t.SheetNames.indexOf(r.sheet),!t.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return pi(jO(t,r),r);case"slk":case"sylk":return pi(GE.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"htm":case"html":return pi(Dw(t.Sheets[t.SheetNames[a]],r),r);case"txt":return ZF(Vw(t.Sheets[t.SheetNames[a]],r),r);case"csv":return pi(cg(t.Sheets[t.SheetNames[a]],r),r,"\uFEFF");case"dif":return pi(qE.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"dbf":return ah(Zm.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"prn":return pi(cc.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"rtf":return pi(JE.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"eth":return pi(XE.from_sheet(t.Sheets[t.SheetNames[a]],r),r);case"fods":return pi(Nw(t,r),r);case"wk1":return ah(Vo.sheet_to_wk1(t.Sheets[t.SheetNames[a]],r),r);case"wk3":return ah(Vo.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),ah(Rw(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),QF(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return KF(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function JF(t,e,r,n,a,o,l,u){var h=Lr(r),d=u.defval,p=u.raw||!Object.prototype.hasOwnProperty.call(u,"raw"),v=!0,_=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:r,enumerable:!1})}catch{_.__rowNum__=r}else _.__rowNum__=r;if(!l||t[r])for(var y=e.s.c;y<=e.e.c;++y){var w=l?t[r][y]:t[n[y]+h];if(w===void 0||w.t===void 0){if(d===void 0)continue;o[y]!=null&&(_[o[y]]=d);continue}var E=w.v;switch(w.t){case"z":if(E==null)break;continue;case"e":E=E==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(o[y]!=null){if(E==null)if(w.t=="e"&&E===null)_[o[y]]=null;else if(d!==void 0)_[o[y]]=d;else if(p&&E===null)_[o[y]]=null;else continue;else _[o[y]]=p&&(w.t!=="n"||w.t==="n"&&u.rawNumbers!==!1)?E:Ji(w,E,u);E!=null&&(v=!1)}}return{row:_,isempty:v}}function Oh(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,o=[],l=0,u="",h={s:{r:0,c:0},e:{r:0,c:0}},d=e||{},p=d.range!=null?d.range:t["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof p){case"string":h=Gt(p);break;case"number":h=Gt(t["!ref"]),h.s.r=p;break;default:h=p}n>0&&(a=0);var v=Lr(h.s.r),_=[],y=[],w=0,E=0,S=Array.isArray(t),L=h.s.r,z=0,O={};S&&!t[L]&&(t[L]=[]);var ee=d.skipHidden&&t["!cols"]||[],te=d.skipHidden&&t["!rows"]||[];for(z=h.s.c;z<=h.e.c;++z)if(!(ee[z]||{}).hidden)switch(_[z]=Sr(z),r=S?t[L][z]:t[_[z]+v],n){case 1:o[z]=z-h.s.c;break;case 2:o[z]=_[z];break;case 3:o[z]=d.header[z-h.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),u=l=Ji(r,null,d),E=O[l]||0,!E)O[l]=1;else{do u=l+"_"+E++;while(O[u]);O[l]=E,O[u]=1}o[z]=u}for(L=h.s.r+a;L<=h.e.r;++L)if(!(te[L]||{}).hidden){var Z=JF(t,h,L,_,n,o,S,d);(Z.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(y[w++]=Z.row)}return y.length=w,y}var yy=/"/g;function eN(t,e,r,n,a,o,l,u){for(var h=!0,d=[],p="",v=Lr(r),_=e.s.c;_<=e.e.c;++_)if(n[_]){var y=u.dense?(t[r]||[])[_]:t[n[_]+v];if(y==null)p="";else if(y.v!=null){h=!1,p=""+(u.rawNumbers&&y.t=="n"?y.v:Ji(y,null,u));for(var w=0,E=0;w!==p.length;++w)if((E=p.charCodeAt(w))===a||E===o||E===34||u.forceQuotes){p='"'+p.replace(yy,'""')+'"';break}p=="ID"&&(p='"ID"')}else y.f!=null&&!y.F?(h=!1,p="="+y.f,p.indexOf(",")>=0&&(p='"'+p.replace(yy,'""')+'"')):p="";d.push(p)}return u.blankrows===!1&&h?null:d.join(l)}function cg(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var a=Gt(t["!ref"]),o=n.FS!==void 0?n.FS:",",l=o.charCodeAt(0),u=n.RS!==void 0?n.RS:`
`,h=u.charCodeAt(0),d=new RegExp((o=="|"?"\\|":o)+"+$"),p="",v=[];n.dense=Array.isArray(t);for(var _=n.skipHidden&&t["!cols"]||[],y=n.skipHidden&&t["!rows"]||[],w=a.s.c;w<=a.e.c;++w)(_[w]||{}).hidden||(v[w]=Sr(w));for(var E=0,S=a.s.r;S<=a.e.r;++S)(y[S]||{}).hidden||(p=eN(t,a,S,v,l,h,o,n),p!=null&&(n.strip&&(p=p.replace(d,"")),(p||n.blankrows!==!1)&&r.push((E++?u:"")+p)));return delete n.dense,r.join("")}function Vw(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=cg(t,e);return r}function tN(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var a=Gt(t["!ref"]),o="",l=[],u,h=[],d=Array.isArray(t);for(u=a.s.c;u<=a.e.c;++u)l[u]=Sr(u);for(var p=a.s.r;p<=a.e.r;++p)for(o=Lr(p),u=a.s.c;u<=a.e.c;++u)if(e=l[u]+o,r=d?(t[p]||[])[u]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}h[h.length]=e+"="+n}return h}function Uw(t,e,r){var n=r||{},a=+!n.skipHeader,o=t||{},l=0,u=0;if(o&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var h=typeof n.origin=="string"?Ar(n.origin):n.origin;l=h.r,u=h.c}var d,p={s:{c:0,r:0},e:{c:u,r:l+e.length-1+a}};if(o["!ref"]){var v=Gt(o["!ref"]);p.e.c=Math.max(p.e.c,v.e.c),p.e.r=Math.max(p.e.r,v.e.r),l==-1&&(l=v.e.r+1,p.e.r=l+e.length-1+a)}else l==-1&&(l=0,p.e.r=e.length-1+a);var _=n.header||[],y=0;e.forEach(function(E,S){Ir(E).forEach(function(L){(y=_.indexOf(L))==-1&&(_[y=_.length]=L);var z=E[L],O="z",ee="",te=gt({c:u+y,r:l+S+a});d=lf(o,te),z&&typeof z=="object"&&!(z instanceof Date)?o[te]=z:(typeof z=="number"?O="n":typeof z=="boolean"?O="b":typeof z=="string"?O="s":z instanceof Date?(O="d",n.cellDates||(O="n",z=en(z)),ee=n.dateNF||pt[14]):z===null&&n.nullError&&(O="e",z=0),d?(d.t=O,d.v=z,delete d.w,delete d.R,ee&&(d.z=ee)):o[te]=d={t:O,v:z},ee&&(d.z=ee))})}),p.e.c=Math.max(p.e.c,u+_.length-1);var w=Lr(l);if(a)for(y=0;y<_.length;++y)o[Sr(y+u)+w]={t:"s",v:_[y]};return o["!ref"]=St(p),o}function rN(t,e){return Uw(null,t,e)}function lf(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Ar(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?lf(t,gt(e)):lf(t,gt({r:e,c:r||0}))}function nN(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function ug(){return{SheetNames:[],Sheets:{}}}function fg(t,e,r,n){var a=1;if(!r)for(;a<=65535&&t.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var o=r.match(/(^.*?)(\d+)$/);a=o&&+o[2]||0;var l=o&&o[1]||r;for(++a;a<=65535&&t.SheetNames.indexOf(r=l+a)!=-1;++a);}if(ww(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function aN(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=nN(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function iN(t,e){return t.z=e,t}function jw(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function sN(t,e,r){return jw(t,"#"+e,r)}function oN(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function lN(t,e,r,n){for(var a=typeof e!="string"?e:Gt(e),o=typeof e=="string"?e:St(e),l=a.s.r;l<=a.e.r;++l)for(var u=a.s.c;u<=a.e.c;++u){var h=lf(t,l,u);h.t="n",h.F=o,delete h.v,l==a.s.r&&u==a.s.c&&(h.f=r,n&&(h.D=!0))}return t}var hh={encode_col:Sr,encode_row:Lr,encode_cell:gt,encode_range:St,decode_col:Up,decode_row:Vp,split_cell:yk,decode_cell:Ar,decode_range:Jn,format_cell:Ji,sheet_add_aoa:mE,sheet_add_json:Uw,sheet_add_dom:Iw,aoa_to_sheet:_c,json_to_sheet:rN,table_to_sheet:Ow,table_to_book:gF,sheet_to_csv:cg,sheet_to_txt:Vw,sheet_to_json:Oh,sheet_to_html:Dw,sheet_to_formulae:tN,sheet_to_row_object_array:Oh,sheet_get_cell:lf,book_new:ug,book_append_sheet:fg,book_set_sheet_visibility:aN,cell_set_number_format:iN,cell_set_hyperlink:jw,cell_set_internal_link:sN,cell_add_comment:oN,sheet_set_array_formula:lN,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}},dh={exports:{}},cN=dh.exports,Ty;function uN(){return Ty||(Ty=1,(function(t,e){(function(r,n){n()})(cN,function(){function r(d,p){return typeof p>"u"?p={autoBom:!1}:typeof p!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),p={autoBom:!p}),p.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(d.type)?new Blob(["\uFEFF",d],{type:d.type}):d}function n(d,p,v){var _=new XMLHttpRequest;_.open("GET",d),_.responseType="blob",_.onload=function(){h(_.response,p,v)},_.onerror=function(){console.error("could not download file")},_.send()}function a(d){var p=new XMLHttpRequest;p.open("HEAD",d,!1);try{p.send()}catch{}return 200<=p.status&&299>=p.status}function o(d){try{d.dispatchEvent(new MouseEvent("click"))}catch{var p=document.createEvent("MouseEvents");p.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),d.dispatchEvent(p)}}var l=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof X0=="object"&&X0.global===X0?X0:void 0,u=l.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),h=l.saveAs||(typeof window!="object"||window!==l?function(){}:"download"in HTMLAnchorElement.prototype&&!u?function(d,p,v){var _=l.URL||l.webkitURL,y=document.createElement("a");p=p||d.name||"download",y.download=p,y.rel="noopener",typeof d=="string"?(y.href=d,y.origin===location.origin?o(y):a(y.href)?n(d,p,v):o(y,y.target="_blank")):(y.href=_.createObjectURL(d),setTimeout(function(){_.revokeObjectURL(y.href)},4e4),setTimeout(function(){o(y)},0))}:"msSaveOrOpenBlob"in navigator?function(d,p,v){if(p=p||d.name||"download",typeof d!="string")navigator.msSaveOrOpenBlob(r(d,v),p);else if(a(d))n(d,p,v);else{var _=document.createElement("a");_.href=d,_.target="_blank",setTimeout(function(){o(_)})}}:function(d,p,v,_){if(_=_||open("","_blank"),_&&(_.document.title=_.document.body.innerText="downloading..."),typeof d=="string")return n(d,p,v);var y=d.type==="application/octet-stream",w=/constructor/i.test(l.HTMLElement)||l.safari,E=/CriOS\/[\d]+/.test(navigator.userAgent);if((E||y&&w||u)&&typeof FileReader<"u"){var S=new FileReader;S.onloadend=function(){var O=S.result;O=E?O:O.replace(/^data:[^;]*;/,"data:attachment/file;"),_?_.location.href=O:location=O,_=null},S.readAsDataURL(d)}else{var L=l.URL||l.webkitURL,z=L.createObjectURL(d);_?_.location=z:location.href=z,_=null,setTimeout(function(){L.revokeObjectURL(z)},4e4)}});l.saveAs=h.saveAs=h,t.exports=h})})(dh)),dh.exports}var Ey=uN();const Us=["Saturday","Monday","Tuesday","Wednesday","Thursday","Friday"],fN=["Raqib","Rahman"],hN=[{id:"1",name:"Tricia",villa:"P3 110",phone:"559932715",numCars:"1",carType:"1 SUV",days:"Sat-Wed",time:"6:00 AM",worker:"Rahman",fee:"100",startDate:"02-Sep-2025",payment:"yes"},{id:"2",name:"Yousef",villa:"P1 018",phone:"552496396",numCars:"3",carType:"1 SUV 2 Sedan",days:"Tues-Fri",time:"6:00 AM",worker:"Rahman",fee:"300",startDate:"02-Sep-2025",payment:""},{id:"3",name:"Abu Huthaifa",villa:"P2 076",phone:"523301945",numCars:"2",carType:"1 SUV 1 Sedan",days:"Sat-Tue",time:"3:00 PM",worker:"Rahman & Raqib",fee:"200",startDate:"03-Sep-2025",payment:""},{id:"4",name:"Abu Gaith",villa:"P1 096",phone:"505503126",numCars:"3",carType:"1 SUV 2 Sedan",days:"Mon-Thurs",time:"4:00 PM",worker:"Rahman & Raqib",fee:"300",startDate:"15-Sep-2025",payment:""},{id:"5",name:"Muhab",villa:"P1 004",phone:"522537716",numCars:"2",carType:"2 sedan",days:"Mon-Wed - Fri",time:"7:00 AM",worker:"Rahman",fee:"200",startDate:"08-Sep-2025",payment:""},{id:"6",name:"Hassan",villa:"P1 019",phone:"555600744",numCars:"1",carType:"1 SUV",days:"Sat-Mon-Wed",time:"8:00 AM",worker:"Raqib",fee:"130",startDate:"01-Oct-2025",payment:""},{id:"7",name:"Karl",villa:"P1 133",phone:"554871726",numCars:"2",carType:"2 Small SUV",days:"Sat-Wed",time:"9:00 Am & 5:00 PM",worker:"Rahman",fee:"200",startDate:"06-Sep-2025",payment:""},{id:"8",name:"Muhannad",villa:"P 1 002",phone:"508856664",numCars:"1",carType:"1 SUV",days:"Tues-Fri",time:"8:00 AM",worker:"Raqib",fee:"200",startDate:"06-Sep-2025",payment:""},{id:"9",name:"Anas",villa:"P3 116",phone:"543176562",numCars:"2",carType:"1 Sedan 1 SUV",days:"Sat-Wed",time:"7:00 AM",worker:"Raqib",fee:"200",startDate:"09-Sep-2025",payment:""},{id:"10",name:"Ali Khan",villa:"P2 029",phone:"554957901",numCars:"1",carType:"1 SUV",days:"",time:"",worker:"",fee:"100",startDate:"01-Oct-2025",payment:""},{id:"11",name:"Rabih",villa:"P1 100",phone:"502888808",numCars:"1",carType:"1 Suv",days:"Sat-Mon-Wed",time:"4:30 PM",worker:"Raqib",fee:"200",startDate:"08-Sep-2025",payment:""},{id:"12",name:"Abu Qais",villa:"P2 73",phone:"555446524",numCars:"1",carType:"1 SUV",days:"Mon-Thurs",time:"10:00 AM",worker:"Rahman",fee:"100",startDate:"08-Sep-2025",payment:""},{id:"13",name:"Imad futsal",villa:"P1 63",phone:"",numCars:"1",carType:"1 Tahoe",days:"Mon-Wed - Fri",time:"6:00 AM",worker:"Raqib",fee:"100",startDate:"12-Sep-2025",payment:""},{id:"14",name:"Karol",villa:"P3 133",phone:"554756619",numCars:"2",carType:"2 SUV",days:"Tues - Fri",time:"9:00 Am & 5:00 PM",worker:"Raqib",fee:"200",startDate:"16-Sep-2025",payment:""},{id:"15",name:"Simon",villa:"P2 10",phone:"526511303",numCars:"2",carType:"2 SUV",days:"Sat - Tues",time:"6:00 AM",worker:"Raqib 2 Ext 1 INT bi week",fee:"220",startDate:"13-Sep-2025",payment:""},{id:"16",name:"Garry",villa:"P3 003",phone:"553102890",numCars:"2",carType:"1 Sedan 1 SUV",days:"",time:"",worker:"",fee:"",startDate:"",payment:""},{id:"17",name:"Murray",villa:"P1 092",phone:"503046580",numCars:"1",carType:"1",days:"",time:"",worker:"",fee:"",startDate:"",payment:""},{id:"18",name:"Mostafa",villa:"P1 012",phone:"564069936",numCars:"2",carType:"1 Sedan 1 SUV",days:"Mon-Thurs",time:"6:00 AM",worker:"Rahman",fee:"",startDate:"",payment:""},{id:"19",name:"Noelle",villa:"P3 076",phone:"551440917",numCars:"2",carType:"",days:"Mon-Thurs",time:"7:00 AM",worker:"Raqib",fee:"",startDate:"",payment:""},{id:"20",name:"",villa:"P2 014",phone:"507186480",numCars:"1",carType:"",days:"Mon-Thurs",time:"5:00 PM",worker:"Rahman & Raqib",fee:"",startDate:"",payment:""},{id:"21",name:"Moussab",villa:"P1 059",phone:"566466606",numCars:"3",carType:"",days:"Fri",time:"",worker:"",fee:"",startDate:"19-Sep-2025",payment:""},{id:"22",name:"Anton",villa:"P3 085",phone:"558510462",numCars:"",carType:"",days:"Tues - Fri",time:"7:00 AM",worker:"Raqib",fee:"",startDate:"",payment:""}];function dN({workerName:t,appointments:e,onClose:r,onEditAppointment:n,onDeleteAppointment:a,showAlert:o}){const l=v=>{if(!v)return"";const[_,y]=v.split(":"),w=parseInt(_,10),E=w>=12?"PM":"AM";return`${w%12||12}:${y} ${E}`},u=v=>{if(!v)return 0;let _;if(v.includes("-")){const[S,L,z]=v.split("-"),O={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11};_=new Date(parseInt(z),O[L],parseInt(S))}else _=new Date(v);const w=new Date-_,E=Math.floor(w/(1e3*60*60*24*7));return Math.max(0,E)},h=(v,_,y)=>{if(!v||!y)return"";const w=v.toLowerCase().replace(/[^a-z0-9\s]/g," "),E=w.match(/\d+/g)||[],S=/ext/i.test(w),L=/int/i.test(w),z=/bi/i.test(w);let O=0,ee=0;if(E.length>=2&&S&&L)O=parseInt(E[0]),ee=parseInt(E[1]);else if(E.length>=1&&S&&!L)O=parseInt(E[0]),ee=0;else if(E.length>=1&&L&&!S)O=0,ee=parseInt(E[0]);else return"";const te=O+ee;if(te===0)return"";let Z=0;if(y.toLowerCase()==="daily"?Z=7:y.toLowerCase()==="weekends"?Z=2:Z=y.split("-").filter(R=>R.trim()).length,Z===0)return"";const C=z?Math.floor(_/2):_;if(Z>=te){const I=C%Z,R=Math.round(O/te*Z);return I<R?" EXT":" INT"}else return C%te<O?" EXT":" INT"},d=v=>{const y=JSON.parse(localStorage.getItem("clientsData")||"[]").find(S=>S.villa&&v&&S.villa.replace(/\s+/g," ").trim().toLowerCase()===v.replace(/\s+/g," ").trim().toLowerCase());if(!y||!y.startDate||!y.days)return"";let w=y.washmanPackage;if(!w&&y.worker){const S=y.worker.toLowerCase();(S.includes("ext")||S.includes("int"))&&(w=y.worker)}if(!w)return"";const E=u(y.startDate);return h(w,E,y.days)},p=e.filter(v=>v.worker===t||v.secondaryWorker===t).sort((v,_)=>{const y=Us.indexOf(v.day),w=Us.indexOf(_.day);return y!==w?y-w:v.time.localeCompare(_.time)});return k.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(5px)"},onClick:r,children:k.jsxs("div",{style:{backgroundColor:"white",borderRadius:"20px",padding:"2rem",boxShadow:"0 20px 60px rgba(0,0,0,0.3)",border:"2px solid #548235",minWidth:"600px",maxWidth:"700px",width:"90%",maxHeight:"80vh",display:"flex",flexDirection:"column"},onClick:v=>v.stopPropagation(),children:[k.jsxs("div",{style:{textAlign:"center",marginBottom:"1.5rem",paddingBottom:"1rem",borderBottom:"2px solid #548235"},children:[k.jsxs("h2",{style:{color:"#548235",fontSize:"1.8rem",fontWeight:"700",margin:"0",display:"flex",alignItems:"center",justifyContent:"center",gap:"10px"},children:[" Appointments for ",t]}),k.jsxs("p",{style:{color:"#6c757d",fontSize:"0.9rem",margin:"0.5rem 0 0 0"},children:["Total: ",p.length," appointments"]})]}),p.length===0?k.jsx("div",{style:{textAlign:"center",padding:"3rem",color:"#6c757d"},children:k.jsxs("p",{style:{fontSize:"1.2rem",margin:"0"},children:[" No appointments found for ",t]})}):k.jsx("div",{style:{flexGrow:1,overflowY:"auto",paddingRight:"10px",marginBottom:"1rem"},children:p.map(v=>{const _=d(v.villa);return k.jsxs("div",{style:{background:"linear-gradient(135deg, #DAF2D0 0%, #c8e6c9 100%)",border:"2px solid #e2e8f0",borderRadius:"15px",padding:"1.5rem",marginBottom:"1rem",transition:"all 0.3s ease",position:"relative"},children:[k.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem"},children:[k.jsxs("h3",{style:{color:"#548235",fontSize:"1.3rem",fontWeight:"700",margin:"0",display:"flex",alignItems:"center",gap:"8px"},children:[" ",v.villa]}),_&&k.jsx("span",{style:{backgroundColor:_.includes("EXT")?"#007bff":"#28a745",color:"white",padding:"6px 12px",borderRadius:"20px",fontSize:"0.8rem",fontWeight:"600",boxShadow:"0 2px 8px rgba(0,0,0,0.2)"},children:_})]}),k.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem",marginBottom:"1rem"},children:[k.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[k.jsx("span",{style:{fontSize:"1.1rem"},children:""}),k.jsxs("div",{children:[k.jsx("div",{style:{fontSize:"0.8rem",color:"#6c757d",fontWeight:"500"},children:"Day"}),k.jsx("div",{style:{fontSize:"1rem",fontWeight:"600",color:"#374151"},children:v.day})]})]}),k.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[k.jsx("span",{style:{fontSize:"1.1rem"},children:""}),k.jsxs("div",{children:[k.jsx("div",{style:{fontSize:"0.8rem",color:"#6c757d",fontWeight:"500"},children:"Time"}),k.jsx("div",{style:{fontSize:"1rem",fontWeight:"600",color:"#374151"},children:l(v.time)})]})]}),k.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[k.jsx("span",{style:{fontSize:"1.1rem"},children:""}),k.jsxs("div",{children:[k.jsx("div",{style:{fontSize:"0.8rem",color:"#6c757d",fontWeight:"500"},children:"Role"}),k.jsx("div",{style:{fontSize:"1rem",fontWeight:"600",color:v.worker===t?"#548235":"#6f42c1"},children:v.worker===t?"Primary":"Secondary"})]})]})]}),k.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"flex-end"},children:[k.jsx("button",{onClick:()=>n(v),style:{backgroundColor:"#548235",color:"white",border:"none",padding:"8px 16px",borderRadius:"8px",fontSize:"0.85rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"4px"},children:" Edit"}),k.jsx("button",{onClick:()=>a(v.id),style:{backgroundColor:"#dc3545",color:"white",border:"none",padding:"8px 16px",borderRadius:"8px",fontSize:"0.85rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",display:"flex",alignItems:"center",gap:"4px"},children:" Delete"})]})]},v.id)})}),k.jsx("div",{style:{paddingTop:"1rem",borderTop:"2px solid #e2e8f0",textAlign:"center"},children:k.jsx("button",{onClick:r,style:{backgroundColor:"#6c757d",color:"white",border:"none",padding:"12px 24px",borderRadius:"10px",fontSize:"1rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease"},children:"Close"})})]})})}function mN({uniqueVillas:t,onClose:e,navigateToClientsWithSearch:r}){const[n,a]=bt.useState(""),o=u=>{r(u),e()},l=t.filter(u=>u.toLowerCase().includes(n.toLowerCase()));return k.jsx("div",{style:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.75)",display:"flex",justifyContent:"center",alignItems:"center",zIndex:1e3,backdropFilter:"blur(10px)"},onClick:e,children:k.jsxs("div",{style:{backgroundColor:"white",borderRadius:"30px",padding:"0",maxWidth:"900px",width:"95%",maxHeight:"90vh",display:"flex",flexDirection:"column",boxShadow:"0 30px 100px rgba(0,0,0,0.5), 0 0 0 1px rgba(255,255,255,0.1)",border:"4px solid #548235",overflow:"hidden"},onClick:u=>u.stopPropagation(),children:[k.jsxs("div",{style:{background:"linear-gradient(135deg, #548235 0%, #6a9c3d 50%, #7db46c 100%)",padding:"1.5rem 1rem",textAlign:"center",position:"relative",overflow:"hidden"},children:[k.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"radial-gradient(circle at 20% 20%, rgba(255,255,255,0.2) 0%, transparent 50%)",opacity:.8}}),k.jsx("h2",{style:{color:"white",fontSize:"1.8rem",fontWeight:"800",margin:"0 0 0.8rem 0",textShadow:"2px 2px 4px rgba(0,0,0,0.5)",letterSpacing:"1px",position:"relative",zIndex:1},children:" Villa Directory"}),k.jsxs("div",{style:{background:"rgba(255,255,255,0.3)",color:"white",padding:"6px 16px",borderRadius:"20px",fontSize:"1rem",fontWeight:"700",display:"inline-block",boxShadow:"0 4px 15px rgba(0,0,0,0.3)",position:"relative",zIndex:1,textShadow:"1px 1px 2px rgba(0,0,0,0.4)",border:"2px solid rgba(255,255,255,0.2)"},children:[l.length," Properties"]})]}),k.jsxs("div",{style:{padding:"1.5rem",backgroundColor:"#DAF2D0"},children:[k.jsxs("div",{style:{position:"relative",marginBottom:"2rem"},children:[k.jsx("input",{type:"text",placeholder:" Search properties by name or number...",value:n,onChange:u=>a(u.target.value),style:{fontSize:"1rem",padding:"12px 50px 12px 20px",borderRadius:"25px",border:"3px solid #548235",width:"100%",transition:"all 0.4s ease",boxShadow:"0 10px 30px rgba(84, 130, 53, 0.2)",outline:"none",boxSizing:"border-box",backgroundColor:"white",fontWeight:"500"}}),k.jsx("div",{style:{position:"absolute",right:"20px",top:"50%",transform:"translateY(-50%)",color:"#548235",fontSize:"1.5rem",pointerEvents:"none"},children:""})]}),l.length===0?k.jsx("div",{style:{textAlign:"center",padding:"3rem",color:"#548235",fontSize:"1.3rem",fontWeight:"600"},children:n?" No properties found matching your search.":" No properties found."}):k.jsx("div",{style:{flexGrow:1,overflowY:"auto",paddingRight:"15px",marginBottom:"1rem"},children:k.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(160px, 1fr))",gap:"12px"},children:l.map((u,h)=>{const d=["linear-gradient(135deg, #548235 0%, #6a9c3d 100%)","linear-gradient(135deg, #6a9c3d 0%, #7db46c 100%)","linear-gradient(135deg, #548235 0%, #7db46c 100%)"];return k.jsxs("div",{onClick:()=>o(u),style:{padding:"12px 16px",background:d[h%3],color:"white",borderRadius:"18px",cursor:"pointer",transition:"all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275)",boxShadow:"0 8px 25px rgba(84, 130, 53, 0.3)",fontWeight:"700",textAlign:"center",fontSize:"0.9rem",border:"3px solid transparent",position:"relative",overflow:"hidden",minHeight:"60px",display:"flex",alignItems:"center",justifyContent:"center"},onMouseOver:p=>{p.currentTarget.style.transform="translateY(-6px) scale(1.03)",p.currentTarget.style.boxShadow="0 15px 40px rgba(84, 130, 53, 0.4)",p.currentTarget.style.borderColor="rgba(255,255,255,0.8)"},onMouseOut:p=>{p.currentTarget.style.transform="translateY(0) scale(1)",p.currentTarget.style.boxShadow="0 8px 25px rgba(84, 130, 53, 0.3)",p.currentTarget.style.borderColor="transparent"},children:[k.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"radial-gradient(circle at 30% 30%, rgba(255,255,255,0.25) 0%, transparent 70%)",opacity:.8}}),k.jsxs("span",{style:{position:"relative",zIndex:2,textShadow:"2px 2px 4px rgba(0,0,0,0.4)",letterSpacing:"0.5px"},children:[" ",u]})]},u)})})})]}),k.jsx("div",{style:{textAlign:"center",padding:"1.5rem",borderTop:"3px solid #548235",background:"linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%)"},children:k.jsx("button",{type:"button",onClick:e,style:{padding:"12px 24px",borderRadius:"25px",cursor:"pointer",border:"none",fontSize:"0.95rem",fontWeight:"600",transition:"all 0.3s ease",boxShadow:"0 6px 20px rgba(84, 130, 53, 0.3)",background:"linear-gradient(135deg, #548235 0%, #6a9c3d 100%)",color:"white"},onMouseOver:u=>u.target.style.transform="translateY(-2px)",onMouseOut:u=>u.target.style.transform="translateY(0)",children:" Close"})})]})})}const Mm=(t,e)=>{const n=JSON.parse(localStorage.getItem("clientsData")||"[]").find(u=>u.villa&&t&&u.villa.replace(/\s+/g," ").trim().toLowerCase()===t.replace(/\s+/g," ").trim().toLowerCase());if(!n||!n.days)return"";let a=n.washmanPackage;if(!a&&n.worker){const u=n.worker.toLowerCase();(u.includes("ext")||u.includes("int"))&&(a=n.worker)}if(!a)return"";let o=0;if(n.days.toLowerCase()==="daily")o={Monday:0,Tuesday:1,Wednesday:2,Thursday:3,Friday:4,Saturday:5,Sunday:6}[e]||0;else if(n.days.toLowerCase()==="weekends")o=e==="Friday"?0:1;else{const u={mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",thurs:"Thursday",fri:"Friday",sat:"Saturday",sun:"Sunday"};o=n.days.toLowerCase().split("-").map(d=>u[d.trim()]).filter(Boolean).indexOf(e),o===-1&&(o=0)}const l=a.toLowerCase();if(l.includes("2 ext 1 int week")||l.includes("3 ext 1 int week"))return o===1?" INT":" EXT";if(l.includes("bi week")){if(!n.startDate)return" EXT";let u;if(n.startDate.includes("-")){const[p,v,_]=n.startDate.split("-"),y={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11};u=new Date(parseInt(_),y[v],parseInt(p))}else u=new Date(n.startDate);const d=Math.floor((new Date-u)/(1e3*60*60*24*7));if(l.includes("2 ext 1 int bi week"))return(d*2+o)%4===3?" INT":" EXT";if(l.includes("3 ext 1 int bi week"))return(d*3+o)%6===4?" INT":" EXT"}return" EXT"},pN=t=>{if(!t||!t.days)return"";let e=t.washmanPackage;if(!e&&t.worker){const n=t.worker.toLowerCase();(n.includes("ext")||n.includes("int"))&&(e=t.worker)}if(!e)return"";const r=e.toLowerCase();return r.includes("2 ext 1 int week")?"EXTINT":r.includes("3 ext 1 int week")?"EXTINTEXT":r.includes("2 ext 1 int bi week")?"EXTEXTEXTINT":r.includes("3 ext 1 int bi week")?"EXTEXTEXTEXTINTEXT":""},gN=()=>{};var wy={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zw=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let a=t.charCodeAt(n);a<128?e[r++]=a:a<2048?(e[r++]=a>>6|192,e[r++]=a&63|128):(a&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=a>>18|240,e[r++]=a>>12&63|128,e[r++]=a>>6&63|128,e[r++]=a&63|128):(e[r++]=a>>12|224,e[r++]=a>>6&63|128,e[r++]=a&63|128)}return e},xN=function(t){const e=[];let r=0,n=0;for(;r<t.length;){const a=t[r++];if(a<128)e[n++]=String.fromCharCode(a);else if(a>191&&a<224){const o=t[r++];e[n++]=String.fromCharCode((a&31)<<6|o&63)}else if(a>239&&a<365){const o=t[r++],l=t[r++],u=t[r++],h=((a&7)<<18|(o&63)<<12|(l&63)<<6|u&63)-65536;e[n++]=String.fromCharCode(55296+(h>>10)),e[n++]=String.fromCharCode(56320+(h&1023))}else{const o=t[r++],l=t[r++];e[n++]=String.fromCharCode((a&15)<<12|(o&63)<<6|l&63)}}return e.join("")},Hw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let a=0;a<t.length;a+=3){const o=t[a],l=a+1<t.length,u=l?t[a+1]:0,h=a+2<t.length,d=h?t[a+2]:0,p=o>>2,v=(o&3)<<4|u>>4;let _=(u&15)<<2|d>>6,y=d&63;h||(y=64,l||(_=64)),n.push(r[p],r[v],r[_],r[y])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(zw(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):xN(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let a=0;a<t.length;){const o=r[t.charAt(a++)],u=a<t.length?r[t.charAt(a)]:0;++a;const d=a<t.length?r[t.charAt(a)]:64;++a;const v=a<t.length?r[t.charAt(a)]:64;if(++a,o==null||u==null||d==null||v==null)throw new vN;const _=o<<2|u>>4;if(n.push(_),d!==64){const y=u<<4&240|d>>2;if(n.push(y),v!==64){const w=d<<6&192|v;n.push(w)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class vN extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const _N=function(t){const e=zw(t);return Hw.encodeByteArray(e,!0)},Fh=function(t){return _N(t).replace(/\./g,"")},yN=function(t){try{return Hw.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TN(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EN=()=>TN().__FIREBASE_DEFAULTS__,wN=()=>{if(typeof process>"u"||typeof wy>"u")return;const t=wy.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},SN=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&yN(t[1]);return e&&JSON.parse(e)},hg=()=>{try{return gN()||EN()||wN()||SN()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},AN=t=>hg()?.emulatorHosts?.[t],kN=t=>{const e=AN(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},Ww=()=>hg()?.config;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bN{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dg(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function CN(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RN(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r={alg:"none",type:"JWT"},n=e||"demo-project",a=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l={iss:`https://securetoken.google.com/${n}`,aud:n,iat:a,exp:a+3600,auth_time:a,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}},...t};return[Fh(JSON.stringify(r)),Fh(JSON.stringify(l)),""].join(".")}const zu={};function DN(){const t={prod:[],emulator:[]};for(const e of Object.keys(zu))zu[e]?t.emulator.push(e):t.prod.push(e);return t}function IN(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let Sy=!1;function ON(t,e){if(typeof window>"u"||typeof document>"u"||!dg(window.location.host)||zu[t]===e||zu[t]||Sy)return;zu[t]=e;function r(_){return`__firebase__banner__${_}`}const n="__firebase__banner",o=DN().prod.length>0;function l(){const _=document.getElementById(n);_&&_.remove()}function u(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function h(_,y){_.setAttribute("width","24"),_.setAttribute("id",y),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function d(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{Sy=!0,l()},_}function p(_,y){_.setAttribute("id",y),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function v(){const _=IN(n),y=r("text"),w=document.getElementById(y)||document.createElement("span"),E=r("learnmore"),S=document.getElementById(E)||document.createElement("a"),L=r("preprendIcon"),z=document.getElementById(L)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const O=_.element;u(O),p(S,E);const ee=d();h(z,L),O.append(z,w,S,ee),document.body.appendChild(O)}o?(w.innerText="Preview backend disconnected.",z.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(z.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",y)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",v):v()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FN(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function NN(){const t=hg()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function MN(){return!NN()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function PN(){try{return typeof indexedDB=="object"}catch{return!1}}function LN(){return new Promise((t,e)=>{try{let r=!0;const n="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(n);a.onsuccess=()=>{a.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},a.onupgradeneeded=()=>{r=!1},a.onerror=()=>{e(a.error?.message||"")}}catch(r){e(r)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BN="FirebaseError";class Tc extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=BN,Object.setPrototypeOf(this,Tc.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Gw.prototype.create)}}class Gw{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){const n=r[0]||{},a=`${this.service}/${e}`,o=this.errors[e],l=o?VN(o,n):"Error",u=`${this.serviceName}: ${l} (${a}).`;return new Tc(a,u,n)}}function VN(t,e){return t.replace(UN,(r,n)=>{const a=e[n];return a!=null?String(a):`<${n}?>`})}const UN=/\{\$([^}]+)}/g;function Nh(t,e){if(t===e)return!0;const r=Object.keys(t),n=Object.keys(e);for(const a of r){if(!n.includes(a))return!1;const o=t[a],l=e[a];if(Ay(o)&&Ay(l)){if(!Nh(o,l))return!1}else if(o!==l)return!1}for(const a of n)if(!r.includes(a))return!1;return!0}function Ay(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mh(t){return t&&t._delegate?t._delegate:t}class cf{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jN{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const n=new bN;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:r});a&&n.resolve(a)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(a){if(n)return null;throw a}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(HN(e))try{this.getOrInitializeService({instanceIdentifier:Fo})}catch{}for(const[r,n]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);try{const o=this.getOrInitializeService({instanceIdentifier:a});n.resolve(o)}catch{}}}}clearInstance(e=Fo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Fo){return this.instances.has(e)}getOptions(e=Fo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:n,options:r});for(const[o,l]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(o);n===u&&l.resolve(a)}return a}onInit(e,r){const n=this.normalizeInstanceIdentifier(r),a=this.onInitCallbacks.get(n)??new Set;a.add(e),this.onInitCallbacks.set(n,a);const o=this.instances.get(n);return o&&e(o,n),()=>{a.delete(e)}}invokeOnInitCallbacks(e,r){const n=this.onInitCallbacks.get(r);if(n)for(const a of n)try{a(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:zN(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Fo){return this.component?this.component.multipleInstances?e:Fo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function zN(t){return t===Fo?void 0:t}function HN(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WN{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new jN(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(zt||(zt={}));const GN={debug:zt.DEBUG,verbose:zt.VERBOSE,info:zt.INFO,warn:zt.WARN,error:zt.ERROR,silent:zt.SILENT},qN=zt.INFO,XN={[zt.DEBUG]:"log",[zt.VERBOSE]:"log",[zt.INFO]:"info",[zt.WARN]:"warn",[zt.ERROR]:"error"},YN=(t,e,...r)=>{if(e<t.logLevel)return;const n=new Date().toISOString(),a=XN[e];if(a)console[a](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class qw{constructor(e){this.name=e,this._logLevel=qN,this._logHandler=YN,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in zt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?GN[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,zt.DEBUG,...e),this._logHandler(this,zt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,zt.VERBOSE,...e),this._logHandler(this,zt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,zt.INFO,...e),this._logHandler(this,zt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,zt.WARN,...e),this._logHandler(this,zt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,zt.ERROR,...e),this._logHandler(this,zt.ERROR,...e)}}const KN=(t,e)=>e.some(r=>t instanceof r);let ky,by;function $N(){return ky||(ky=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function QN(){return by||(by=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Xw=new WeakMap,np=new WeakMap,Yw=new WeakMap,Pm=new WeakMap,mg=new WeakMap;function ZN(t){const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("success",o),t.removeEventListener("error",l)},o=()=>{r(js(t.result)),a()},l=()=>{n(t.error),a()};t.addEventListener("success",o),t.addEventListener("error",l)});return e.then(r=>{r instanceof IDBCursor&&Xw.set(r,t)}).catch(()=>{}),mg.set(e,t),e}function JN(t){if(np.has(t))return;const e=new Promise((r,n)=>{const a=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",l),t.removeEventListener("abort",l)},o=()=>{r(),a()},l=()=>{n(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",o),t.addEventListener("error",l),t.addEventListener("abort",l)});np.set(t,e)}let ap={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return np.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Yw.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return js(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function e9(t){ap=t(ap)}function t9(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(Lm(this),e,...r);return Yw.set(n,e.sort?e.sort():[e]),js(n)}:QN().includes(t)?function(...e){return t.apply(Lm(this),e),js(Xw.get(this))}:function(...e){return js(t.apply(Lm(this),e))}}function r9(t){return typeof t=="function"?t9(t):(t instanceof IDBTransaction&&JN(t),KN(t,$N())?new Proxy(t,ap):t)}function js(t){if(t instanceof IDBRequest)return ZN(t);if(Pm.has(t))return Pm.get(t);const e=r9(t);return e!==t&&(Pm.set(t,e),mg.set(e,t)),e}const Lm=t=>mg.get(t);function n9(t,e,{blocked:r,upgrade:n,blocking:a,terminated:o}={}){const l=indexedDB.open(t,e),u=js(l);return n&&l.addEventListener("upgradeneeded",h=>{n(js(l.result),h.oldVersion,h.newVersion,js(l.transaction),h)}),r&&l.addEventListener("blocked",h=>r(h.oldVersion,h.newVersion,h)),u.then(h=>{o&&h.addEventListener("close",()=>o()),a&&h.addEventListener("versionchange",d=>a(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}const a9=["get","getKey","getAll","getAllKeys","count"],i9=["put","add","delete","clear"],Bm=new Map;function Cy(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Bm.get(e))return Bm.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,a=i9.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(a||a9.includes(r)))return;const o=async function(l,...u){const h=this.transaction(l,a?"readwrite":"readonly");let d=h.store;return n&&(d=d.index(u.shift())),(await Promise.all([d[r](...u),a&&h.done]))[0]};return Bm.set(e,o),o}e9(t=>({...t,get:(e,r,n)=>Cy(e,r)||t.get(e,r,n),has:(e,r)=>!!Cy(e,r)||t.has(e,r)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s9{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(o9(r)){const n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}}function o9(t){return t.getComponent()?.type==="VERSION"}const ip="@firebase/app",Ry="0.14.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const es=new qw("@firebase/app"),l9="@firebase/app-compat",c9="@firebase/analytics-compat",u9="@firebase/analytics",f9="@firebase/app-check-compat",h9="@firebase/app-check",d9="@firebase/auth",m9="@firebase/auth-compat",p9="@firebase/database",g9="@firebase/data-connect",x9="@firebase/database-compat",v9="@firebase/functions",_9="@firebase/functions-compat",y9="@firebase/installations",T9="@firebase/installations-compat",E9="@firebase/messaging",w9="@firebase/messaging-compat",S9="@firebase/performance",A9="@firebase/performance-compat",k9="@firebase/remote-config",b9="@firebase/remote-config-compat",C9="@firebase/storage",R9="@firebase/storage-compat",D9="@firebase/firestore",I9="@firebase/ai",O9="@firebase/firestore-compat",F9="firebase",N9="12.2.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sp="[DEFAULT]",M9={[ip]:"fire-core",[l9]:"fire-core-compat",[u9]:"fire-analytics",[c9]:"fire-analytics-compat",[h9]:"fire-app-check",[f9]:"fire-app-check-compat",[d9]:"fire-auth",[m9]:"fire-auth-compat",[p9]:"fire-rtdb",[g9]:"fire-data-connect",[x9]:"fire-rtdb-compat",[v9]:"fire-fn",[_9]:"fire-fn-compat",[y9]:"fire-iid",[T9]:"fire-iid-compat",[E9]:"fire-fcm",[w9]:"fire-fcm-compat",[S9]:"fire-perf",[A9]:"fire-perf-compat",[k9]:"fire-rc",[b9]:"fire-rc-compat",[C9]:"fire-gcs",[R9]:"fire-gcs-compat",[D9]:"fire-fst",[O9]:"fire-fst-compat",[I9]:"fire-vertex","fire-js":"fire-js",[F9]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ph=new Map,P9=new Map,op=new Map;function Dy(t,e){try{t.container.addComponent(e)}catch(r){es.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Lh(t){const e=t.name;if(op.has(e))return es.debug(`There were multiple attempts to register component ${e}.`),!1;op.set(e,t);for(const r of Ph.values())Dy(r,t);for(const r of P9.values())Dy(r,t);return!0}function L9(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function B9(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const V9={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},zs=new Gw("app","Firebase",V9);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U9{constructor(e,r,n){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new cf("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw zs.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j9=N9;function Kw(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const n={name:sp,automaticDataCollectionEnabled:!0,...e},a=n.name;if(typeof a!="string"||!a)throw zs.create("bad-app-name",{appName:String(a)});if(r||(r=Ww()),!r)throw zs.create("no-options");const o=Ph.get(a);if(o){if(Nh(r,o.options)&&Nh(n,o.config))return o;throw zs.create("duplicate-app",{appName:a})}const l=new WN(a);for(const h of op.values())l.addComponent(h);const u=new U9(r,n,l);return Ph.set(a,u),u}function z9(t=sp){const e=Ph.get(t);if(!e&&t===sp&&Ww())return Kw();if(!e)throw zs.create("no-app",{appName:t});return e}function sc(t,e,r){let n=M9[t]??t;r&&(n+=`-${r}`);const a=n.match(/\s|\//),o=e.match(/\s|\//);if(a||o){const l=[`Unable to register library "${n}" with version "${e}":`];a&&l.push(`library name "${n}" contains illegal characters (whitespace or "/")`),a&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),es.warn(l.join(" "));return}Lh(new cf(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H9="firebase-heartbeat-database",W9=1,uf="firebase-heartbeat-store";let Vm=null;function $w(){return Vm||(Vm=n9(H9,W9,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(uf)}catch(r){console.warn(r)}}}}).catch(t=>{throw zs.create("idb-open",{originalErrorMessage:t.message})})),Vm}async function G9(t){try{const r=(await $w()).transaction(uf),n=await r.objectStore(uf).get(Qw(t));return await r.done,n}catch(e){if(e instanceof Tc)es.warn(e.message);else{const r=zs.create("idb-get",{originalErrorMessage:e?.message});es.warn(r.message)}}}async function Iy(t,e){try{const n=(await $w()).transaction(uf,"readwrite");await n.objectStore(uf).put(e,Qw(t)),await n.done}catch(r){if(r instanceof Tc)es.warn(r.message);else{const n=zs.create("idb-set",{originalErrorMessage:r?.message});es.warn(n.message)}}}function Qw(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q9=1024,X9=30;class Y9{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new $9(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=Oy();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(a=>a.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:r}),this._heartbeatsCache.heartbeats.length>X9){const a=Q9(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(a,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){es.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=Oy(),{heartbeatsToSend:r,unsentEntries:n}=K9(this._heartbeatsCache.heartbeats),a=Fh(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(e){return es.warn(e),""}}}function Oy(){return new Date().toISOString().substring(0,10)}function K9(t,e=q9){const r=[];let n=t.slice();for(const a of t){const o=r.find(l=>l.agent===a.agent);if(o){if(o.dates.push(a.date),Fy(r)>e){o.dates.pop();break}}else if(r.push({agent:a.agent,dates:[a.date]}),Fy(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}class $9{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return PN()?LN().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await G9(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Iy(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return Iy(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function Fy(t){return Fh(JSON.stringify({version:2,heartbeats:t})).length}function Q9(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let n=1;n<t.length;n++)t[n].date<r&&(r=t[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z9(t){Lh(new cf("platform-logger",e=>new s9(e),"PRIVATE")),Lh(new cf("heartbeat",e=>new Y9(e),"PRIVATE")),sc(ip,Ry,t),sc(ip,Ry,"esm2020"),sc("fire-js","")}Z9("");var J9="firebase",eM="12.2.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */sc(J9,eM,"app");var Ny=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Hs,Zw;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,I){function R(){}R.prototype=I.prototype,C.D=I.prototype,C.prototype=new R,C.prototype.constructor=C,C.C=function(B,D,F){for(var M=Array(arguments.length-2),Fe=2;Fe<arguments.length;Fe++)M[Fe-2]=arguments[Fe];return I.prototype[D].apply(B,M)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(C,I,R){R||(R=0);var B=Array(16);if(typeof I=="string")for(var D=0;16>D;++D)B[D]=I.charCodeAt(R++)|I.charCodeAt(R++)<<8|I.charCodeAt(R++)<<16|I.charCodeAt(R++)<<24;else for(D=0;16>D;++D)B[D]=I[R++]|I[R++]<<8|I[R++]<<16|I[R++]<<24;I=C.g[0],R=C.g[1],D=C.g[2];var F=C.g[3],M=I+(F^R&(D^F))+B[0]+3614090360&4294967295;I=R+(M<<7&4294967295|M>>>25),M=F+(D^I&(R^D))+B[1]+3905402710&4294967295,F=I+(M<<12&4294967295|M>>>20),M=D+(R^F&(I^R))+B[2]+606105819&4294967295,D=F+(M<<17&4294967295|M>>>15),M=R+(I^D&(F^I))+B[3]+3250441966&4294967295,R=D+(M<<22&4294967295|M>>>10),M=I+(F^R&(D^F))+B[4]+4118548399&4294967295,I=R+(M<<7&4294967295|M>>>25),M=F+(D^I&(R^D))+B[5]+1200080426&4294967295,F=I+(M<<12&4294967295|M>>>20),M=D+(R^F&(I^R))+B[6]+2821735955&4294967295,D=F+(M<<17&4294967295|M>>>15),M=R+(I^D&(F^I))+B[7]+4249261313&4294967295,R=D+(M<<22&4294967295|M>>>10),M=I+(F^R&(D^F))+B[8]+1770035416&4294967295,I=R+(M<<7&4294967295|M>>>25),M=F+(D^I&(R^D))+B[9]+2336552879&4294967295,F=I+(M<<12&4294967295|M>>>20),M=D+(R^F&(I^R))+B[10]+4294925233&4294967295,D=F+(M<<17&4294967295|M>>>15),M=R+(I^D&(F^I))+B[11]+2304563134&4294967295,R=D+(M<<22&4294967295|M>>>10),M=I+(F^R&(D^F))+B[12]+1804603682&4294967295,I=R+(M<<7&4294967295|M>>>25),M=F+(D^I&(R^D))+B[13]+4254626195&4294967295,F=I+(M<<12&4294967295|M>>>20),M=D+(R^F&(I^R))+B[14]+2792965006&4294967295,D=F+(M<<17&4294967295|M>>>15),M=R+(I^D&(F^I))+B[15]+1236535329&4294967295,R=D+(M<<22&4294967295|M>>>10),M=I+(D^F&(R^D))+B[1]+4129170786&4294967295,I=R+(M<<5&4294967295|M>>>27),M=F+(R^D&(I^R))+B[6]+3225465664&4294967295,F=I+(M<<9&4294967295|M>>>23),M=D+(I^R&(F^I))+B[11]+643717713&4294967295,D=F+(M<<14&4294967295|M>>>18),M=R+(F^I&(D^F))+B[0]+3921069994&4294967295,R=D+(M<<20&4294967295|M>>>12),M=I+(D^F&(R^D))+B[5]+3593408605&4294967295,I=R+(M<<5&4294967295|M>>>27),M=F+(R^D&(I^R))+B[10]+38016083&4294967295,F=I+(M<<9&4294967295|M>>>23),M=D+(I^R&(F^I))+B[15]+3634488961&4294967295,D=F+(M<<14&4294967295|M>>>18),M=R+(F^I&(D^F))+B[4]+3889429448&4294967295,R=D+(M<<20&4294967295|M>>>12),M=I+(D^F&(R^D))+B[9]+568446438&4294967295,I=R+(M<<5&4294967295|M>>>27),M=F+(R^D&(I^R))+B[14]+3275163606&4294967295,F=I+(M<<9&4294967295|M>>>23),M=D+(I^R&(F^I))+B[3]+4107603335&4294967295,D=F+(M<<14&4294967295|M>>>18),M=R+(F^I&(D^F))+B[8]+1163531501&4294967295,R=D+(M<<20&4294967295|M>>>12),M=I+(D^F&(R^D))+B[13]+2850285829&4294967295,I=R+(M<<5&4294967295|M>>>27),M=F+(R^D&(I^R))+B[2]+4243563512&4294967295,F=I+(M<<9&4294967295|M>>>23),M=D+(I^R&(F^I))+B[7]+1735328473&4294967295,D=F+(M<<14&4294967295|M>>>18),M=R+(F^I&(D^F))+B[12]+2368359562&4294967295,R=D+(M<<20&4294967295|M>>>12),M=I+(R^D^F)+B[5]+4294588738&4294967295,I=R+(M<<4&4294967295|M>>>28),M=F+(I^R^D)+B[8]+2272392833&4294967295,F=I+(M<<11&4294967295|M>>>21),M=D+(F^I^R)+B[11]+1839030562&4294967295,D=F+(M<<16&4294967295|M>>>16),M=R+(D^F^I)+B[14]+4259657740&4294967295,R=D+(M<<23&4294967295|M>>>9),M=I+(R^D^F)+B[1]+2763975236&4294967295,I=R+(M<<4&4294967295|M>>>28),M=F+(I^R^D)+B[4]+1272893353&4294967295,F=I+(M<<11&4294967295|M>>>21),M=D+(F^I^R)+B[7]+4139469664&4294967295,D=F+(M<<16&4294967295|M>>>16),M=R+(D^F^I)+B[10]+3200236656&4294967295,R=D+(M<<23&4294967295|M>>>9),M=I+(R^D^F)+B[13]+681279174&4294967295,I=R+(M<<4&4294967295|M>>>28),M=F+(I^R^D)+B[0]+3936430074&4294967295,F=I+(M<<11&4294967295|M>>>21),M=D+(F^I^R)+B[3]+3572445317&4294967295,D=F+(M<<16&4294967295|M>>>16),M=R+(D^F^I)+B[6]+76029189&4294967295,R=D+(M<<23&4294967295|M>>>9),M=I+(R^D^F)+B[9]+3654602809&4294967295,I=R+(M<<4&4294967295|M>>>28),M=F+(I^R^D)+B[12]+3873151461&4294967295,F=I+(M<<11&4294967295|M>>>21),M=D+(F^I^R)+B[15]+530742520&4294967295,D=F+(M<<16&4294967295|M>>>16),M=R+(D^F^I)+B[2]+3299628645&4294967295,R=D+(M<<23&4294967295|M>>>9),M=I+(D^(R|~F))+B[0]+4096336452&4294967295,I=R+(M<<6&4294967295|M>>>26),M=F+(R^(I|~D))+B[7]+1126891415&4294967295,F=I+(M<<10&4294967295|M>>>22),M=D+(I^(F|~R))+B[14]+2878612391&4294967295,D=F+(M<<15&4294967295|M>>>17),M=R+(F^(D|~I))+B[5]+4237533241&4294967295,R=D+(M<<21&4294967295|M>>>11),M=I+(D^(R|~F))+B[12]+1700485571&4294967295,I=R+(M<<6&4294967295|M>>>26),M=F+(R^(I|~D))+B[3]+2399980690&4294967295,F=I+(M<<10&4294967295|M>>>22),M=D+(I^(F|~R))+B[10]+4293915773&4294967295,D=F+(M<<15&4294967295|M>>>17),M=R+(F^(D|~I))+B[1]+2240044497&4294967295,R=D+(M<<21&4294967295|M>>>11),M=I+(D^(R|~F))+B[8]+1873313359&4294967295,I=R+(M<<6&4294967295|M>>>26),M=F+(R^(I|~D))+B[15]+4264355552&4294967295,F=I+(M<<10&4294967295|M>>>22),M=D+(I^(F|~R))+B[6]+2734768916&4294967295,D=F+(M<<15&4294967295|M>>>17),M=R+(F^(D|~I))+B[13]+1309151649&4294967295,R=D+(M<<21&4294967295|M>>>11),M=I+(D^(R|~F))+B[4]+4149444226&4294967295,I=R+(M<<6&4294967295|M>>>26),M=F+(R^(I|~D))+B[11]+3174756917&4294967295,F=I+(M<<10&4294967295|M>>>22),M=D+(I^(F|~R))+B[2]+718787259&4294967295,D=F+(M<<15&4294967295|M>>>17),M=R+(F^(D|~I))+B[9]+3951481745&4294967295,C.g[0]=C.g[0]+I&4294967295,C.g[1]=C.g[1]+(D+(M<<21&4294967295|M>>>11))&4294967295,C.g[2]=C.g[2]+D&4294967295,C.g[3]=C.g[3]+F&4294967295}n.prototype.u=function(C,I){I===void 0&&(I=C.length);for(var R=I-this.blockSize,B=this.B,D=this.h,F=0;F<I;){if(D==0)for(;F<=R;)a(this,C,F),F+=this.blockSize;if(typeof C=="string"){for(;F<I;)if(B[D++]=C.charCodeAt(F++),D==this.blockSize){a(this,B),D=0;break}}else for(;F<I;)if(B[D++]=C[F++],D==this.blockSize){a(this,B),D=0;break}}this.h=D,this.o+=I},n.prototype.v=function(){var C=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);C[0]=128;for(var I=1;I<C.length-8;++I)C[I]=0;var R=8*this.o;for(I=C.length-8;I<C.length;++I)C[I]=R&255,R/=256;for(this.u(C),C=Array(16),I=R=0;4>I;++I)for(var B=0;32>B;B+=8)C[R++]=this.g[I]>>>B&255;return C};function o(C,I){var R=u;return Object.prototype.hasOwnProperty.call(R,C)?R[C]:R[C]=I(C)}function l(C,I){this.h=I;for(var R=[],B=!0,D=C.length-1;0<=D;D--){var F=C[D]|0;B&&F==I||(R[D]=F,B=!1)}this.g=R}var u={};function h(C){return-128<=C&&128>C?o(C,function(I){return new l([I|0],0>I?-1:0)}):new l([C|0],0>C?-1:0)}function d(C){if(isNaN(C)||!isFinite(C))return v;if(0>C)return S(d(-C));for(var I=[],R=1,B=0;C>=R;B++)I[B]=C/R|0,R*=4294967296;return new l(I,0)}function p(C,I){if(C.length==0)throw Error("number format error: empty string");if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(C.charAt(0)=="-")return S(p(C.substring(1),I));if(0<=C.indexOf("-"))throw Error('number format error: interior "-" character');for(var R=d(Math.pow(I,8)),B=v,D=0;D<C.length;D+=8){var F=Math.min(8,C.length-D),M=parseInt(C.substring(D,D+F),I);8>F?(F=d(Math.pow(I,F)),B=B.j(F).add(d(M))):(B=B.j(R),B=B.add(d(M)))}return B}var v=h(0),_=h(1),y=h(16777216);t=l.prototype,t.m=function(){if(E(this))return-S(this).m();for(var C=0,I=1,R=0;R<this.g.length;R++){var B=this.i(R);C+=(0<=B?B:4294967296+B)*I,I*=4294967296}return C},t.toString=function(C){if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(w(this))return"0";if(E(this))return"-"+S(this).toString(C);for(var I=d(Math.pow(C,6)),R=this,B="";;){var D=ee(R,I).g;R=L(R,D.j(I));var F=((0<R.g.length?R.g[0]:R.h)>>>0).toString(C);if(R=D,w(R))return F+B;for(;6>F.length;)F="0"+F;B=F+B}},t.i=function(C){return 0>C?0:C<this.g.length?this.g[C]:this.h};function w(C){if(C.h!=0)return!1;for(var I=0;I<C.g.length;I++)if(C.g[I]!=0)return!1;return!0}function E(C){return C.h==-1}t.l=function(C){return C=L(this,C),E(C)?-1:w(C)?0:1};function S(C){for(var I=C.g.length,R=[],B=0;B<I;B++)R[B]=~C.g[B];return new l(R,~C.h).add(_)}t.abs=function(){return E(this)?S(this):this},t.add=function(C){for(var I=Math.max(this.g.length,C.g.length),R=[],B=0,D=0;D<=I;D++){var F=B+(this.i(D)&65535)+(C.i(D)&65535),M=(F>>>16)+(this.i(D)>>>16)+(C.i(D)>>>16);B=M>>>16,F&=65535,M&=65535,R[D]=M<<16|F}return new l(R,R[R.length-1]&-2147483648?-1:0)};function L(C,I){return C.add(S(I))}t.j=function(C){if(w(this)||w(C))return v;if(E(this))return E(C)?S(this).j(S(C)):S(S(this).j(C));if(E(C))return S(this.j(S(C)));if(0>this.l(y)&&0>C.l(y))return d(this.m()*C.m());for(var I=this.g.length+C.g.length,R=[],B=0;B<2*I;B++)R[B]=0;for(B=0;B<this.g.length;B++)for(var D=0;D<C.g.length;D++){var F=this.i(B)>>>16,M=this.i(B)&65535,Fe=C.i(D)>>>16,Se=C.i(D)&65535;R[2*B+2*D]+=M*Se,z(R,2*B+2*D),R[2*B+2*D+1]+=F*Se,z(R,2*B+2*D+1),R[2*B+2*D+1]+=M*Fe,z(R,2*B+2*D+1),R[2*B+2*D+2]+=F*Fe,z(R,2*B+2*D+2)}for(B=0;B<I;B++)R[B]=R[2*B+1]<<16|R[2*B];for(B=I;B<2*I;B++)R[B]=0;return new l(R,0)};function z(C,I){for(;(C[I]&65535)!=C[I];)C[I+1]+=C[I]>>>16,C[I]&=65535,I++}function O(C,I){this.g=C,this.h=I}function ee(C,I){if(w(I))throw Error("division by zero");if(w(C))return new O(v,v);if(E(C))return I=ee(S(C),I),new O(S(I.g),S(I.h));if(E(I))return I=ee(C,S(I)),new O(S(I.g),I.h);if(30<C.g.length){if(E(C)||E(I))throw Error("slowDivide_ only works with positive integers.");for(var R=_,B=I;0>=B.l(C);)R=te(R),B=te(B);var D=Z(R,1),F=Z(B,1);for(B=Z(B,2),R=Z(R,2);!w(B);){var M=F.add(B);0>=M.l(C)&&(D=D.add(R),F=M),B=Z(B,1),R=Z(R,1)}return I=L(C,D.j(I)),new O(D,I)}for(D=v;0<=C.l(I);){for(R=Math.max(1,Math.floor(C.m()/I.m())),B=Math.ceil(Math.log(R)/Math.LN2),B=48>=B?1:Math.pow(2,B-48),F=d(R),M=F.j(I);E(M)||0<M.l(C);)R-=B,F=d(R),M=F.j(I);w(F)&&(F=_),D=D.add(F),C=L(C,M)}return new O(D,C)}t.A=function(C){return ee(this,C).h},t.and=function(C){for(var I=Math.max(this.g.length,C.g.length),R=[],B=0;B<I;B++)R[B]=this.i(B)&C.i(B);return new l(R,this.h&C.h)},t.or=function(C){for(var I=Math.max(this.g.length,C.g.length),R=[],B=0;B<I;B++)R[B]=this.i(B)|C.i(B);return new l(R,this.h|C.h)},t.xor=function(C){for(var I=Math.max(this.g.length,C.g.length),R=[],B=0;B<I;B++)R[B]=this.i(B)^C.i(B);return new l(R,this.h^C.h)};function te(C){for(var I=C.g.length+1,R=[],B=0;B<I;B++)R[B]=C.i(B)<<1|C.i(B-1)>>>31;return new l(R,C.h)}function Z(C,I){var R=I>>5;I%=32;for(var B=C.g.length-R,D=[],F=0;F<B;F++)D[F]=0<I?C.i(F+R)>>>I|C.i(F+R+1)<<32-I:C.i(F+R);return new l(D,C.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Zw=n,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.A,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=d,l.fromString=p,Hs=l}).apply(typeof Ny<"u"?Ny:typeof self<"u"?self:typeof window<"u"?window:{});var ih=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Jw,Du,eS,mh,lp,tS,rS,nS;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(m,T,A){return m==Array.prototype||m==Object.prototype||(m[T]=A.value),m};function r(m){m=[typeof globalThis=="object"&&globalThis,m,typeof window=="object"&&window,typeof self=="object"&&self,typeof ih=="object"&&ih];for(var T=0;T<m.length;++T){var A=m[T];if(A&&A.Math==Math)return A}throw Error("Cannot find global object")}var n=r(this);function a(m,T){if(T)e:{var A=n;m=m.split(".");for(var U=0;U<m.length-1;U++){var fe=m[U];if(!(fe in A))break e;A=A[fe]}m=m[m.length-1],U=A[m],T=T(U),T!=U&&T!=null&&e(A,m,{configurable:!0,writable:!0,value:T})}}function o(m,T){m instanceof String&&(m+="");var A=0,U=!1,fe={next:function(){if(!U&&A<m.length){var Te=A++;return{value:T(Te,m[Te]),done:!1}}return U=!0,{done:!0,value:void 0}}};return fe[Symbol.iterator]=function(){return fe},fe}a("Array.prototype.values",function(m){return m||function(){return o(this,function(T,A){return A})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},u=this||self;function h(m){var T=typeof m;return T=T!="object"?T:m?Array.isArray(m)?"array":T:"null",T=="array"||T=="object"&&typeof m.length=="number"}function d(m){var T=typeof m;return T=="object"&&m!=null||T=="function"}function p(m,T,A){return m.call.apply(m.bind,arguments)}function v(m,T,A){if(!m)throw Error();if(2<arguments.length){var U=Array.prototype.slice.call(arguments,2);return function(){var fe=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(fe,U),m.apply(T,fe)}}return function(){return m.apply(T,arguments)}}function _(m,T,A){return _=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:v,_.apply(null,arguments)}function y(m,T){var A=Array.prototype.slice.call(arguments,1);return function(){var U=A.slice();return U.push.apply(U,arguments),m.apply(this,U)}}function w(m,T){function A(){}A.prototype=T.prototype,m.aa=T.prototype,m.prototype=new A,m.prototype.constructor=m,m.Qb=function(U,fe,Te){for(var qe=Array(arguments.length-2),Bt=2;Bt<arguments.length;Bt++)qe[Bt-2]=arguments[Bt];return T.prototype[fe].apply(U,qe)}}function E(m){const T=m.length;if(0<T){const A=Array(T);for(let U=0;U<T;U++)A[U]=m[U];return A}return[]}function S(m,T){for(let A=1;A<arguments.length;A++){const U=arguments[A];if(h(U)){const fe=m.length||0,Te=U.length||0;m.length=fe+Te;for(let qe=0;qe<Te;qe++)m[fe+qe]=U[qe]}else m.push(U)}}class L{constructor(T,A){this.i=T,this.j=A,this.h=0,this.g=null}get(){let T;return 0<this.h?(this.h--,T=this.g,this.g=T.next,T.next=null):T=this.i(),T}}function z(m){return/^[\s\xa0]*$/.test(m)}function O(){var m=u.navigator;return m&&(m=m.userAgent)?m:""}function ee(m){return ee[" "](m),m}ee[" "]=function(){};var te=O().indexOf("Gecko")!=-1&&!(O().toLowerCase().indexOf("webkit")!=-1&&O().indexOf("Edge")==-1)&&!(O().indexOf("Trident")!=-1||O().indexOf("MSIE")!=-1)&&O().indexOf("Edge")==-1;function Z(m,T,A){for(const U in m)T.call(A,m[U],U,m)}function C(m,T){for(const A in m)T.call(void 0,m[A],A,m)}function I(m){const T={};for(const A in m)T[A]=m[A];return T}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function B(m,T){let A,U;for(let fe=1;fe<arguments.length;fe++){U=arguments[fe];for(A in U)m[A]=U[A];for(let Te=0;Te<R.length;Te++)A=R[Te],Object.prototype.hasOwnProperty.call(U,A)&&(m[A]=U[A])}}function D(m){var T=1;m=m.split(":");const A=[];for(;0<T&&m.length;)A.push(m.shift()),T--;return m.length&&A.push(m.join(":")),A}function F(m){u.setTimeout(()=>{throw m},0)}function M(){var m=ae;let T=null;return m.g&&(T=m.g,m.g=m.g.next,m.g||(m.h=null),T.next=null),T}class Fe{constructor(){this.h=this.g=null}add(T,A){const U=Se.get();U.set(T,A),this.h?this.h.next=U:this.g=U,this.h=U}}var Se=new L(()=>new ne,m=>m.reset());class ne{constructor(){this.next=this.g=this.h=null}set(T,A){this.h=T,this.g=A,this.next=null}reset(){this.next=this.g=this.h=null}}let se,Le=!1,ae=new Fe,W=()=>{const m=u.Promise.resolve(void 0);se=()=>{m.then(pe)}};var pe=()=>{for(var m;m=M();){try{m.h.call(m.g)}catch(A){F(A)}var T=Se;T.j(m),100>T.h&&(T.h++,m.next=T.g,T.g=m)}Le=!1};function V(){this.s=this.s,this.C=this.C}V.prototype.s=!1,V.prototype.ma=function(){this.s||(this.s=!0,this.N())},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Y(m,T){this.type=m,this.g=this.target=T,this.defaultPrevented=!1}Y.prototype.h=function(){this.defaultPrevented=!0};var Q=(function(){if(!u.addEventListener||!Object.defineProperty)return!1;var m=!1,T=Object.defineProperty({},"passive",{get:function(){m=!0}});try{const A=()=>{};u.addEventListener("test",A,T),u.removeEventListener("test",A,T)}catch{}return m})();function J(m,T){if(Y.call(this,m?m.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,m){var A=this.type=m.type,U=m.changedTouches&&m.changedTouches.length?m.changedTouches[0]:null;if(this.target=m.target||m.srcElement,this.g=T,T=m.relatedTarget){if(te){e:{try{ee(T.nodeName);var fe=!0;break e}catch{}fe=!1}fe||(T=null)}}else A=="mouseover"?T=m.fromElement:A=="mouseout"&&(T=m.toElement);this.relatedTarget=T,U?(this.clientX=U.clientX!==void 0?U.clientX:U.pageX,this.clientY=U.clientY!==void 0?U.clientY:U.pageY,this.screenX=U.screenX||0,this.screenY=U.screenY||0):(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0),this.button=m.button,this.key=m.key||"",this.ctrlKey=m.ctrlKey,this.altKey=m.altKey,this.shiftKey=m.shiftKey,this.metaKey=m.metaKey,this.pointerId=m.pointerId||0,this.pointerType=typeof m.pointerType=="string"?m.pointerType:ue[m.pointerType]||"",this.state=m.state,this.i=m,m.defaultPrevented&&J.aa.h.call(this)}}w(J,Y);var ue={2:"touch",3:"pen",4:"mouse"};J.prototype.h=function(){J.aa.h.call(this);var m=this.i;m.preventDefault?m.preventDefault():m.returnValue=!1};var Ie="closure_listenable_"+(1e6*Math.random()|0),ke=0;function Oe(m,T,A,U,fe){this.listener=m,this.proxy=null,this.src=T,this.type=A,this.capture=!!U,this.ha=fe,this.key=++ke,this.da=this.fa=!1}function le(m){m.da=!0,m.listener=null,m.proxy=null,m.src=null,m.ha=null}function Qe(m){this.src=m,this.g={},this.h=0}Qe.prototype.add=function(m,T,A,U,fe){var Te=m.toString();m=this.g[Te],m||(m=this.g[Te]=[],this.h++);var qe=et(m,T,U,fe);return-1<qe?(T=m[qe],A||(T.fa=!1)):(T=new Oe(T,this.src,Te,!!U,fe),T.fa=A,m.push(T)),T};function G(m,T){var A=T.type;if(A in m.g){var U=m.g[A],fe=Array.prototype.indexOf.call(U,T,void 0),Te;(Te=0<=fe)&&Array.prototype.splice.call(U,fe,1),Te&&(le(T),m.g[A].length==0&&(delete m.g[A],m.h--))}}function et(m,T,A,U){for(var fe=0;fe<m.length;++fe){var Te=m[fe];if(!Te.da&&Te.listener==T&&Te.capture==!!A&&Te.ha==U)return fe}return-1}var Ve="closure_lm_"+(1e6*Math.random()|0),at={};function Ze(m,T,A,U,fe){if(Array.isArray(T)){for(var Te=0;Te<T.length;Te++)Ze(m,T[Te],A,U,fe);return null}return A=dt(A),m&&m[Ie]?m.K(T,A,d(U)?!!U.capture:!1,fe):be(m,T,A,!1,U,fe)}function be(m,T,A,U,fe,Te){if(!T)throw Error("Invalid event type");var qe=d(fe)?!!fe.capture:!!fe,Bt=Ye(m);if(Bt||(m[Ve]=Bt=new Qe(m)),A=Bt.add(T,A,U,qe,Te),A.proxy)return A;if(U=Ee(),A.proxy=U,U.src=m,U.listener=A,m.addEventListener)Q||(fe=qe),fe===void 0&&(fe=!1),m.addEventListener(T.toString(),U,fe);else if(m.attachEvent)m.attachEvent(We(T.toString()),U);else if(m.addListener&&m.removeListener)m.addListener(U);else throw Error("addEventListener and attachEvent are unavailable.");return A}function Ee(){function m(A){return T.call(m.src,m.listener,A)}const T=Be;return m}function ze(m,T,A,U,fe){if(Array.isArray(T))for(var Te=0;Te<T.length;Te++)ze(m,T[Te],A,U,fe);else U=d(U)?!!U.capture:!!U,A=dt(A),m&&m[Ie]?(m=m.i,T=String(T).toString(),T in m.g&&(Te=m.g[T],A=et(Te,A,U,fe),-1<A&&(le(Te[A]),Array.prototype.splice.call(Te,A,1),Te.length==0&&(delete m.g[T],m.h--)))):m&&(m=Ye(m))&&(T=m.g[T.toString()],m=-1,T&&(m=et(T,A,U,fe)),(A=-1<m?T[m]:null)&&Ke(A))}function Ke(m){if(typeof m!="number"&&m&&!m.da){var T=m.src;if(T&&T[Ie])G(T.i,m);else{var A=m.type,U=m.proxy;T.removeEventListener?T.removeEventListener(A,U,m.capture):T.detachEvent?T.detachEvent(We(A),U):T.addListener&&T.removeListener&&T.removeListener(U),(A=Ye(T))?(G(A,m),A.h==0&&(A.src=null,T[Ve]=null)):le(m)}}}function We(m){return m in at?at[m]:at[m]="on"+m}function Be(m,T){if(m.da)m=!0;else{T=new J(T,this);var A=m.listener,U=m.ha||m.src;m.fa&&Ke(m),m=A.call(U,T)}return m}function Ye(m){return m=m[Ve],m instanceof Qe?m:null}var je="__closure_events_fn_"+(1e9*Math.random()>>>0);function dt(m){return typeof m=="function"?m:(m[je]||(m[je]=function(T){return m.handleEvent(T)}),m[je])}function rt(){V.call(this),this.i=new Qe(this),this.M=this,this.F=null}w(rt,V),rt.prototype[Ie]=!0,rt.prototype.removeEventListener=function(m,T,A,U){ze(this,m,T,A,U)};function lt(m,T){var A,U=m.F;if(U)for(A=[];U;U=U.F)A.push(U);if(m=m.M,U=T.type||T,typeof T=="string")T=new Y(T,m);else if(T instanceof Y)T.target=T.target||m;else{var fe=T;T=new Y(U,m),B(T,fe)}if(fe=!0,A)for(var Te=A.length-1;0<=Te;Te--){var qe=T.g=A[Te];fe=ut(qe,U,!0,T)&&fe}if(qe=T.g=m,fe=ut(qe,U,!0,T)&&fe,fe=ut(qe,U,!1,T)&&fe,A)for(Te=0;Te<A.length;Te++)qe=T.g=A[Te],fe=ut(qe,U,!1,T)&&fe}rt.prototype.N=function(){if(rt.aa.N.call(this),this.i){var m=this.i,T;for(T in m.g){for(var A=m.g[T],U=0;U<A.length;U++)le(A[U]);delete m.g[T],m.h--}}this.F=null},rt.prototype.K=function(m,T,A,U){return this.i.add(String(m),T,!1,A,U)},rt.prototype.L=function(m,T,A,U){return this.i.add(String(m),T,!0,A,U)};function ut(m,T,A,U){if(T=m.i.g[String(T)],!T)return!0;T=T.concat();for(var fe=!0,Te=0;Te<T.length;++Te){var qe=T[Te];if(qe&&!qe.da&&qe.capture==A){var Bt=qe.listener,Xr=qe.ha||qe.src;qe.fa&&G(m.i,qe),fe=Bt.call(Xr,U)!==!1&&fe}}return fe&&!U.defaultPrevented}function Tt(m,T,A){if(typeof m=="function")A&&(m=_(m,A));else if(m&&typeof m.handleEvent=="function")m=_(m.handleEvent,m);else throw Error("Invalid listener argument");return 2147483647<Number(T)?-1:u.setTimeout(m,T||0)}function ft(m){m.g=Tt(()=>{m.g=null,m.i&&(m.i=!1,ft(m))},m.l);const T=m.h;m.h=null,m.m.apply(null,T)}class er extends V{constructor(T,A){super(),this.m=T,this.l=A,this.h=null,this.i=!1,this.g=null}j(T){this.h=arguments,this.g?this.i=!0:ft(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function pr(m){V.call(this),this.h=m,this.g={}}w(pr,V);var tr=[];function En(m){Z(m.g,function(T,A){this.g.hasOwnProperty(A)&&Ke(T)},m),m.g={}}pr.prototype.N=function(){pr.aa.N.call(this),En(this)},pr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Wn=u.JSON.stringify,ss=u.JSON.parse,bi=class{stringify(m){return u.JSON.stringify(m,void 0)}parse(m){return u.JSON.parse(m,void 0)}};function os(){}os.prototype.h=null;function ls(m){return m.h||(m.h=m.i())}function cs(){}var La={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ba(){Y.call(this,"d")}w(Ba,Y);function $a(){Y.call(this,"c")}w($a,Y);var ma={},ao=null;function Qa(){return ao=ao||new rt}ma.La="serverreachability";function us(m){Y.call(this,ma.La,m)}w(us,Y);function Za(m){const T=Qa();lt(T,new us(T))}ma.STAT_EVENT="statevent";function sl(m,T){Y.call(this,ma.STAT_EVENT,m),this.stat=T}w(sl,Y);function dr(m){const T=Qa();lt(T,new sl(T,m))}ma.Ma="timingevent";function Or(m,T){Y.call(this,ma.Ma,m),this.size=T}w(Or,Y);function yr(m,T){if(typeof m!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){m()},T)}function Gn(){this.g=!0}Gn.prototype.xa=function(){this.g=!1};function io(m,T,A,U,fe,Te){m.info(function(){if(m.g)if(Te)for(var qe="",Bt=Te.split("&"),Xr=0;Xr<Bt.length;Xr++){var Vt=Bt[Xr].split("=");if(1<Vt.length){var rn=Vt[0];Vt=Vt[1];var Yr=rn.split("_");qe=2<=Yr.length&&Yr[1]=="type"?qe+(rn+"="+Vt+"&"):qe+(rn+"=redacted&")}}else qe=null;else qe=Te;return"XMLHTTP REQ ("+U+") [attempt "+fe+"]: "+T+`
`+A+`
`+qe})}function kc(m,T,A,U,fe,Te,qe){m.info(function(){return"XMLHTTP RESP ("+U+") [ attempt "+fe+"]: "+T+`
`+A+`
`+Te+" "+qe})}function N(m,T,A,U){m.info(function(){return"XMLHTTP TEXT ("+T+"): "+j(m,A)+(U?" "+U:"")})}function X(m,T){m.info(function(){return"TIMEOUT: "+T})}Gn.prototype.info=function(){};function j(m,T){if(!m.g)return T;if(!T)return null;try{var A=JSON.parse(T);if(A){for(m=0;m<A.length;m++)if(Array.isArray(A[m])){var U=A[m];if(!(2>U.length)){var fe=U[1];if(Array.isArray(fe)&&!(1>fe.length)){var Te=fe[0];if(Te!="noop"&&Te!="stop"&&Te!="close")for(var qe=1;qe<fe.length;qe++)fe[qe]=""}}}}return Wn(A)}catch{return T}}var H={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},q={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},K;function de(){}w(de,os),de.prototype.g=function(){return new XMLHttpRequest},de.prototype.i=function(){return{}},K=new de;function ye(m,T,A,U){this.j=m,this.i=T,this.l=A,this.R=U||1,this.U=new pr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ce}function ce(){this.i=null,this.g="",this.h=!1}var ge={},xe={};function Me(m,T,A){m.L=1,m.v=lo(ta(T)),m.m=A,m.P=!0,He(m,null)}function He(m,T){m.F=Date.now(),$e(m),m.A=ta(m.v);var A=m.A,U=m.R;Array.isArray(U)||(U=[String(U)]),Ic(A.i,"t",U),m.C=0,A=m.j.J,m.h=new ce,m.g=Hf(m.j,A?T:null,!m.m),0<m.O&&(m.M=new er(_(m.Y,m,m.g),m.O)),T=m.U,A=m.g,U=m.ca;var fe="readystatechange";Array.isArray(fe)||(fe&&(tr[0]=fe.toString()),fe=tr);for(var Te=0;Te<fe.length;Te++){var qe=Ze(A,fe[Te],U||T.handleEvent,!1,T.h||T);if(!qe)break;T.g[qe.key]=qe}T=m.H?I(m.H):{},m.m?(m.u||(m.u="POST"),T["Content-Type"]="application/x-www-form-urlencoded",m.g.ea(m.A,m.u,m.m,T)):(m.u="GET",m.g.ea(m.A,m.u,null,T)),Za(),io(m.i,m.u,m.A,m.l,m.R,m.m)}ye.prototype.ca=function(m){m=m.target;const T=this.M;T&&va(m)==3?T.j():this.Y(m)},ye.prototype.Y=function(m){try{if(m==this.g)e:{const Yr=va(this.g);var T=this.g.Ba();const Ni=this.g.Z();if(!(3>Yr)&&(Yr!=3||this.g&&(this.h.h||this.g.oa()||Mf(this.g)))){this.J||Yr!=4||T==7||(T==8||0>=Ni?Za(3):Za(2)),qt(this);var A=this.g.Z();this.X=A;t:if(Je(this)){var U=Mf(this.g);m="";var fe=U.length,Te=va(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Lt(this),Pt(this);var qe="";break t}this.h.i=new u.TextDecoder}for(T=0;T<fe;T++)this.h.h=!0,m+=this.h.i.decode(U[T],{stream:!(Te&&T==fe-1)});U.length=0,this.h.g+=m,this.C=0,qe=this.h.g}else qe=this.g.oa();if(this.o=A==200,kc(this.i,this.u,this.A,this.l,this.R,Yr,A),this.o){if(this.T&&!this.K){t:{if(this.g){var Bt,Xr=this.g;if((Bt=Xr.g?Xr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(Bt)){var Vt=Bt;break t}}Vt=null}if(A=Vt)N(this.i,this.l,A,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,ea(this,A);else{this.o=!1,this.s=3,dr(12),Lt(this),Pt(this);break e}}if(this.P){A=!0;let hn;for(;!this.J&&this.C<qe.length;)if(hn=Ue(this,qe),hn==xe){Yr==4&&(this.s=4,dr(14),A=!1),N(this.i,this.l,null,"[Incomplete Response]");break}else if(hn==ge){this.s=4,dr(15),N(this.i,this.l,qe,"[Invalid Chunk]"),A=!1;break}else N(this.i,this.l,hn,null),ea(this,hn);if(Je(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Yr!=4||qe.length!=0||this.h.h||(this.s=1,dr(16),A=!1),this.o=this.o&&A,!A)N(this.i,this.l,qe,"[Invalid Chunked Response]"),Lt(this),Pt(this);else if(0<qe.length&&!this.W){this.W=!0;var rn=this.j;rn.g==this&&rn.ba&&!rn.M&&(rn.j.info("Great, no buffering proxy detected. Bytes received: "+qe.length),xo(rn),rn.M=!0,dr(11))}}else N(this.i,this.l,qe,null),ea(this,qe);Yr==4&&Lt(this),this.o&&!this.J&&(Yr==4?Uf(this.j,this):(this.o=!1,$e(this)))}else wd(this.g),A==400&&0<qe.indexOf("Unknown SID")?(this.s=3,dr(12)):(this.s=0,dr(13)),Lt(this),Pt(this)}}}catch{}finally{}};function Je(m){return m.g?m.u=="GET"&&m.L!=2&&m.j.Ca:!1}function Ue(m,T){var A=m.C,U=T.indexOf(`
`,A);return U==-1?xe:(A=Number(T.substring(A,U)),isNaN(A)?ge:(U+=1,U+A>T.length?xe:(T=T.slice(U,U+A),m.C=U+A,T)))}ye.prototype.cancel=function(){this.J=!0,Lt(this)};function $e(m){m.S=Date.now()+m.I,vt(m,m.I)}function vt(m,T){if(m.B!=null)throw Error("WatchDog timer not null");m.B=yr(_(m.ba,m),T)}function qt(m){m.B&&(u.clearTimeout(m.B),m.B=null)}ye.prototype.ba=function(){this.B=null;const m=Date.now();0<=m-this.S?(X(this.i,this.A),this.L!=2&&(Za(),dr(17)),Lt(this),this.s=2,Pt(this)):vt(this,this.S-m)};function Pt(m){m.j.G==0||m.J||Uf(m.j,m)}function Lt(m){qt(m);var T=m.M;T&&typeof T.ma=="function"&&T.ma(),m.M=null,En(m.U),m.g&&(T=m.g,m.g=null,T.abort(),T.ma())}function ea(m,T){try{var A=m.j;if(A.G!=0&&(A.g==m||Ln(A.h,m))){if(!m.K&&Ln(A.h,m)&&A.G==3){try{var U=A.Da.g.parse(T)}catch{U=null}if(Array.isArray(U)&&U.length==3){var fe=U;if(fe[0]==0){e:if(!A.u){if(A.g)if(A.g.F+3e3<m.F)gl(A),ml(A);else break e;Pc(A),dr(18)}}else A.za=fe[1],0<A.za-A.T&&37500>fe[2]&&A.F&&A.v==0&&!A.C&&(A.C=yr(_(A.Za,A),6e3));if(1>=ei(A.h)&&A.ca){try{A.ca()}catch{}A.ca=void 0}}else Fi(A,11)}else if((m.K||A.g==m)&&gl(A),!z(T))for(fe=A.Da.g.parse(T),T=0;T<fe.length;T++){let Vt=fe[T];if(A.T=Vt[0],Vt=Vt[1],A.G==2)if(Vt[0]=="c"){A.K=Vt[1],A.ia=Vt[2];const rn=Vt[3];rn!=null&&(A.la=rn,A.j.info("VER="+A.la));const Yr=Vt[4];Yr!=null&&(A.Aa=Yr,A.j.info("SVER="+A.Aa));const Ni=Vt[5];Ni!=null&&typeof Ni=="number"&&0<Ni&&(U=1.5*Ni,A.L=U,A.j.info("backChannelRequestTimeoutMs_="+U)),U=A;const hn=m.g;if(hn){const oi=hn.g?hn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(oi){var Te=U.h;Te.g||oi.indexOf("spdy")==-1&&oi.indexOf("quic")==-1&&oi.indexOf("h2")==-1||(Te.j=Te.l,Te.g=new Set,Te.h&&(ol(Te,Te.h),Te.h=null))}if(U.D){const Bc=hn.g?hn.g.getResponseHeader("X-HTTP-Session-Id"):null;Bc&&(U.ya=Bc,or(U.I,U.D,Bc))}}A.G=3,A.l&&A.l.ua(),A.ba&&(A.R=Date.now()-m.F,A.j.info("Handshake RTT: "+A.R+"ms")),U=A;var qe=m;if(U.qa=zf(U,U.J?U.ia:null,U.W),qe.K){Bn(U.h,qe);var Bt=qe,Xr=U.L;Xr&&(Bt.I=Xr),Bt.B&&(qt(Bt),$e(Bt)),U.g=qe}else Bf(U);0<A.i.length&&pl(A)}else Vt[0]!="stop"&&Vt[0]!="close"||Fi(A,7);else A.G==3&&(Vt[0]=="stop"||Vt[0]=="close"?Vt[0]=="stop"?Fi(A,7):Nc(A):Vt[0]!="noop"&&A.l&&A.l.ta(Vt),A.v=0)}}Za(4)}catch{}}var Ja=class{constructor(m,T){this.g=m,this.map=T}};function Pn(m){this.l=m||10,u.PerformanceNavigationTiming?(m=u.performance.getEntriesByType("navigation"),m=0<m.length&&(m[0].nextHopProtocol=="hq"||m[0].nextHopProtocol=="h2")):m=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=m?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function qn(m){return m.h?!0:m.g?m.g.size>=m.j:!1}function ei(m){return m.h?1:m.g?m.g.size:0}function Ln(m,T){return m.h?m.h==T:m.g?m.g.has(T):!1}function ol(m,T){m.g?m.g.add(T):m.h=T}function Bn(m,T){m.h&&m.h==T?m.h=null:m.g&&m.g.has(T)&&m.g.delete(T)}Pn.prototype.cancel=function(){if(this.i=bc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const m of this.g.values())m.cancel();this.g.clear()}};function bc(m){if(m.h!=null)return m.i.concat(m.h.D);if(m.g!=null&&m.g.size!==0){let T=m.i;for(const A of m.g.values())T=T.concat(A.D);return T}return E(m.i)}function _d(m){if(m.V&&typeof m.V=="function")return m.V();if(typeof Map<"u"&&m instanceof Map||typeof Set<"u"&&m instanceof Set)return Array.from(m.values());if(typeof m=="string")return m.split("");if(h(m)){for(var T=[],A=m.length,U=0;U<A;U++)T.push(m[U]);return T}T=[],A=0;for(U in m)T[A++]=m[U];return T}function ll(m){if(m.na&&typeof m.na=="function")return m.na();if(!m.V||typeof m.V!="function"){if(typeof Map<"u"&&m instanceof Map)return Array.from(m.keys());if(!(typeof Set<"u"&&m instanceof Set)){if(h(m)||typeof m=="string"){var T=[];m=m.length;for(var A=0;A<m;A++)T.push(A);return T}T=[],A=0;for(const U in m)T[A++]=U;return T}}}function Cc(m,T){if(m.forEach&&typeof m.forEach=="function")m.forEach(T,void 0);else if(h(m)||typeof m=="string")Array.prototype.forEach.call(m,T,void 0);else for(var A=ll(m),U=_d(m),fe=U.length,Te=0;Te<fe;Te++)T.call(void 0,U[Te],A&&A[Te],m)}var so=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function yd(m,T){if(m){m=m.split("&");for(var A=0;A<m.length;A++){var U=m[A].indexOf("="),fe=null;if(0<=U){var Te=m[A].substring(0,U);fe=m[A].substring(U+1)}else Te=m[A];T(Te,fe?decodeURIComponent(fe.replace(/\+/g," ")):"")}}}function Vr(m){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,m instanceof Vr){this.h=m.h,oo(this,m.j),this.o=m.o,this.g=m.g,fs(this,m.s),this.l=m.l;var T=m.i,A=new Ri;A.i=T.i,T.g&&(A.g=new Map(T.g),A.h=T.h),Ci(this,A),this.m=m.m}else m&&(T=String(m).match(so))?(this.h=!1,oo(this,T[1]||"",!0),this.o=pa(T[2]||""),this.g=pa(T[3]||"",!0),fs(this,T[4]),this.l=pa(T[5]||"",!0),Ci(this,T[6]||"",!0),this.m=pa(T[7]||"")):(this.h=!1,this.i=new Ri(null,this.h))}Vr.prototype.toString=function(){var m=[],T=this.j;T&&m.push(co(T,Rc,!0),":");var A=this.g;return(A||T=="file")&&(m.push("//"),(T=this.o)&&m.push(co(T,Rc,!0),"@"),m.push(encodeURIComponent(String(A)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),A=this.s,A!=null&&m.push(":",String(A))),(A=this.l)&&(this.g&&A.charAt(0)!="/"&&m.push("/"),m.push(co(A,A.charAt(0)=="/"?Td:Dc,!0))),(A=this.i.toString())&&m.push("?",A),(A=this.m)&&m.push("#",co(A,cl)),m.join("")};function ta(m){return new Vr(m)}function oo(m,T,A){m.j=A?pa(T,!0):T,m.j&&(m.j=m.j.replace(/:$/,""))}function fs(m,T){if(T){if(T=Number(T),isNaN(T)||0>T)throw Error("Bad port number "+T);m.s=T}else m.s=null}function Ci(m,T,A){T instanceof Ri?(m.i=T,Ff(m.i,m.h)):(A||(T=co(T,Ed)),m.i=new Ri(T,m.h))}function or(m,T,A){m.i.set(T,A)}function lo(m){return or(m,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),m}function pa(m,T){return m?T?decodeURI(m.replace(/%25/g,"%2525")):decodeURIComponent(m):""}function co(m,T,A){return typeof m=="string"?(m=encodeURI(m).replace(T,Of),A&&(m=m.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m):null}function Of(m){return m=m.charCodeAt(0),"%"+(m>>4&15).toString(16)+(m&15).toString(16)}var Rc=/[#\/\?@]/g,Dc=/[#\?:]/g,Td=/[#\?]/g,Ed=/[#\?@]/g,cl=/#/g;function Ri(m,T){this.h=this.g=null,this.i=m||null,this.j=!!T}function ga(m){m.g||(m.g=new Map,m.h=0,m.i&&yd(m.i,function(T,A){m.add(decodeURIComponent(T.replace(/\+/g," ")),A)}))}t=Ri.prototype,t.add=function(m,T){ga(this),this.i=null,m=ti(this,m);var A=this.g.get(m);return A||this.g.set(m,A=[]),A.push(T),this.h+=1,this};function Di(m,T){ga(m),T=ti(m,T),m.g.has(T)&&(m.i=null,m.h-=m.g.get(T).length,m.g.delete(T))}function Ii(m,T){return ga(m),T=ti(m,T),m.g.has(T)}t.forEach=function(m,T){ga(this),this.g.forEach(function(A,U){A.forEach(function(fe){m.call(T,fe,U,this)},this)},this)},t.na=function(){ga(this);const m=Array.from(this.g.values()),T=Array.from(this.g.keys()),A=[];for(let U=0;U<T.length;U++){const fe=m[U];for(let Te=0;Te<fe.length;Te++)A.push(T[U])}return A},t.V=function(m){ga(this);let T=[];if(typeof m=="string")Ii(this,m)&&(T=T.concat(this.g.get(ti(this,m))));else{m=Array.from(this.g.values());for(let A=0;A<m.length;A++)T=T.concat(m[A])}return T},t.set=function(m,T){return ga(this),this.i=null,m=ti(this,m),Ii(this,m)&&(this.h-=this.g.get(m).length),this.g.set(m,[T]),this.h+=1,this},t.get=function(m,T){return m?(m=this.V(m),0<m.length?String(m[0]):T):T};function Ic(m,T,A){Di(m,T),0<A.length&&(m.i=null,m.g.set(ti(m,T),E(A)),m.h+=A.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const m=[],T=Array.from(this.g.keys());for(var A=0;A<T.length;A++){var U=T[A];const Te=encodeURIComponent(String(U)),qe=this.V(U);for(U=0;U<qe.length;U++){var fe=Te;qe[U]!==""&&(fe+="="+encodeURIComponent(String(qe[U]))),m.push(fe)}}return this.i=m.join("&")};function ti(m,T){return T=String(T),m.j&&(T=T.toLowerCase()),T}function Ff(m,T){T&&!m.j&&(ga(m),m.i=null,m.g.forEach(function(A,U){var fe=U.toLowerCase();U!=fe&&(Di(this,U),Ic(this,fe,A))},m)),m.j=T}function uo(m,T){const A=new Gn;if(u.Image){const U=new Image;U.onload=y(xa,A,"TestLoadImage: loaded",!0,T,U),U.onerror=y(xa,A,"TestLoadImage: error",!1,T,U),U.onabort=y(xa,A,"TestLoadImage: abort",!1,T,U),U.ontimeout=y(xa,A,"TestLoadImage: timeout",!1,T,U),u.setTimeout(function(){U.ontimeout&&U.ontimeout()},1e4),U.src=m}else T(!1)}function Va(m,T){const A=new Gn,U=new AbortController,fe=setTimeout(()=>{U.abort(),xa(A,"TestPingServer: timeout",!1,T)},1e4);fetch(m,{signal:U.signal}).then(Te=>{clearTimeout(fe),Te.ok?xa(A,"TestPingServer: ok",!0,T):xa(A,"TestPingServer: server error",!1,T)}).catch(()=>{clearTimeout(fe),xa(A,"TestPingServer: error",!1,T)})}function xa(m,T,A,U,fe){try{fe&&(fe.onload=null,fe.onerror=null,fe.onabort=null,fe.ontimeout=null),U(A)}catch{}}function fo(){this.g=new bi}function ri(m,T,A){const U=A||"";try{Cc(m,function(fe,Te){let qe=fe;d(fe)&&(qe=Wn(fe)),T.push(U+Te+"="+encodeURIComponent(qe))})}catch(fe){throw T.push(U+"type="+encodeURIComponent("_badmap")),fe}}function hs(m){this.l=m.Ub||null,this.j=m.eb||!1}w(hs,os),hs.prototype.g=function(){return new Oi(this.l,this.j)},hs.prototype.i=(function(m){return function(){return m}})({});function Oi(m,T){rt.call(this),this.D=m,this.o=T,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(Oi,rt),t=Oi.prototype,t.open=function(m,T){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=m,this.A=T,this.readyState=1,ai(this)},t.send=function(m){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const T={headers:this.u,method:this.B,credentials:this.m,cache:void 0};m&&(T.body=m),(this.D||u).fetch(new Request(this.A,T)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ni(this)),this.readyState=0},t.Sa=function(m){if(this.g&&(this.l=m,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=m.headers,this.readyState=2,ai(this)),this.g&&(this.readyState=3,ai(this),this.g)))if(this.responseType==="arraybuffer")m.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in m){if(this.j=m.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Oc(this)}else m.text().then(this.Ra.bind(this),this.ga.bind(this))};function Oc(m){m.j.read().then(m.Pa.bind(m)).catch(m.ga.bind(m))}t.Pa=function(m){if(this.g){if(this.o&&m.value)this.response.push(m.value);else if(!this.o){var T=m.value?m.value:new Uint8Array(0);(T=this.v.decode(T,{stream:!m.done}))&&(this.response=this.responseText+=T)}m.done?ni(this):ai(this),this.readyState==3&&Oc(this)}},t.Ra=function(m){this.g&&(this.response=this.responseText=m,ni(this))},t.Qa=function(m){this.g&&(this.response=m,ni(this))},t.ga=function(){this.g&&ni(this)};function ni(m){m.readyState=4,m.l=null,m.j=null,m.v=null,ai(m)}t.setRequestHeader=function(m,T){this.u.append(m,T)},t.getResponseHeader=function(m){return this.h&&this.h.get(m.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const m=[],T=this.h.entries();for(var A=T.next();!A.done;)A=A.value,m.push(A[0]+": "+A[1]),A=T.next();return m.join(`\r
`)};function ai(m){m.onreadystatechange&&m.onreadystatechange.call(m)}Object.defineProperty(Oi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(m){this.m=m?"include":"same-origin"}});function Fc(m){let T="";return Z(m,function(A,U){T+=U,T+=":",T+=A,T+=`\r
`}),T}function tn(m,T,A){e:{for(U in A){var U=!1;break e}U=!0}U||(A=Fc(A),typeof m=="string"?A!=null&&encodeURIComponent(String(A)):or(m,T,A))}function $t(m){rt.call(this),this.headers=new Map,this.o=m||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w($t,rt);var ul=/^https?$/i,ho=["POST","PUT"];t=$t.prototype,t.Ha=function(m){this.J=m},t.ea=function(m,T,A,U){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+m);T=T?T.toUpperCase():"GET",this.D=m,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():K.g(),this.v=this.o?ls(this.o):ls(K),this.g.onreadystatechange=_(this.Ea,this);try{this.B=!0,this.g.open(T,String(m),!0),this.B=!1}catch(Te){Nf(this,Te);return}if(m=A||"",A=new Map(this.headers),U)if(Object.getPrototypeOf(U)===Object.prototype)for(var fe in U)A.set(fe,U[fe]);else if(typeof U.keys=="function"&&typeof U.get=="function")for(const Te of U.keys())A.set(Te,U.get(Te));else throw Error("Unknown input type for opt_headers: "+String(U));U=Array.from(A.keys()).find(Te=>Te.toLowerCase()=="content-type"),fe=u.FormData&&m instanceof u.FormData,!(0<=Array.prototype.indexOf.call(ho,T,void 0))||U||fe||A.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Te,qe]of A)this.g.setRequestHeader(Te,qe);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{mo(this),this.u=!0,this.g.send(m),this.u=!1}catch(Te){Nf(this,Te)}};function Nf(m,T){m.h=!1,m.g&&(m.j=!0,m.g.abort(),m.j=!1),m.l=T,m.m=5,fl(m),ii(m)}function fl(m){m.A||(m.A=!0,lt(m,"complete"),lt(m,"error"))}t.abort=function(m){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=m||7,lt(this,"complete"),lt(this,"abort"),ii(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ii(this,!0)),$t.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?hl(this):this.bb())},t.bb=function(){hl(this)};function hl(m){if(m.h&&typeof l<"u"&&(!m.v[1]||va(m)!=4||m.Z()!=2)){if(m.u&&va(m)==4)Tt(m.Ea,0,m);else if(lt(m,"readystatechange"),va(m)==4){m.h=!1;try{const qe=m.Z();e:switch(qe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var T=!0;break e;default:T=!1}var A;if(!(A=T)){var U;if(U=qe===0){var fe=String(m.D).match(so)[1]||null;!fe&&u.self&&u.self.location&&(fe=u.self.location.protocol.slice(0,-1)),U=!ul.test(fe?fe.toLowerCase():"")}A=U}if(A)lt(m,"complete"),lt(m,"success");else{m.m=6;try{var Te=2<va(m)?m.g.statusText:""}catch{Te=""}m.l=Te+" ["+m.Z()+"]",fl(m)}}finally{ii(m)}}}}function ii(m,T){if(m.g){mo(m);const A=m.g,U=m.v[0]?()=>{}:null;m.g=null,m.v=null,T||lt(m,"ready");try{A.onreadystatechange=U}catch{}}}function mo(m){m.I&&(u.clearTimeout(m.I),m.I=null)}t.isActive=function(){return!!this.g};function va(m){return m.g?m.g.readyState:0}t.Z=function(){try{return 2<va(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(m){if(this.g){var T=this.g.responseText;return m&&T.indexOf(m)==0&&(T=T.substring(m.length)),ss(T)}};function Mf(m){try{if(!m.g)return null;if("response"in m.g)return m.g.response;switch(m.H){case"":case"text":return m.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in m.g)return m.g.mozResponseArrayBuffer}return null}catch{return null}}function wd(m){const T={};m=(m.g&&2<=va(m)&&m.g.getAllResponseHeaders()||"").split(`\r
`);for(let U=0;U<m.length;U++){if(z(m[U]))continue;var A=D(m[U]);const fe=A[0];if(A=A[1],typeof A!="string")continue;A=A.trim();const Te=T[fe]||[];T[fe]=Te,Te.push(A)}C(T,function(U){return U.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function po(m,T,A){return A&&A.internalChannelParams&&A.internalChannelParams[m]||T}function dl(m){this.Aa=0,this.i=[],this.j=new Gn,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=po("failFast",!1,m),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=po("baseRetryDelayMs",5e3,m),this.cb=po("retryDelaySeedMs",1e4,m),this.Wa=po("forwardChannelMaxRetries",2,m),this.wa=po("forwardChannelRequestTimeoutMs",2e4,m),this.pa=m&&m.xmlHttpFactory||void 0,this.Xa=m&&m.Tb||void 0,this.Ca=m&&m.useFetchStreams||!1,this.L=void 0,this.J=m&&m.supportsCrossDomainXhr||!1,this.K="",this.h=new Pn(m&&m.concurrentRequestLimit),this.Da=new fo,this.P=m&&m.fastHandshake||!1,this.O=m&&m.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=m&&m.Rb||!1,m&&m.xa&&this.j.xa(),m&&m.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&m&&m.detectBufferingProxy||!1,this.ja=void 0,m&&m.longPollingTimeout&&0<m.longPollingTimeout&&(this.ja=m.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=dl.prototype,t.la=8,t.G=1,t.connect=function(m,T,A,U){dr(0),this.W=m,this.H=T||{},A&&U!==void 0&&(this.H.OSID=A,this.H.OAID=U),this.F=this.X,this.I=zf(this,null,this.W),pl(this)};function Nc(m){if(Pf(m),m.G==3){var T=m.U++,A=ta(m.I);if(or(A,"SID",m.K),or(A,"RID",T),or(A,"TYPE","terminate"),go(m,A),T=new ye(m,m.j,T),T.L=2,T.v=lo(ta(A)),A=!1,u.navigator&&u.navigator.sendBeacon)try{A=u.navigator.sendBeacon(T.v.toString(),"")}catch{}!A&&u.Image&&(new Image().src=T.v,A=!0),A||(T.g=Hf(T.j,null),T.g.ea(T.v)),T.F=Date.now(),$e(T)}jf(m)}function ml(m){m.g&&(xo(m),m.g.cancel(),m.g=null)}function Pf(m){ml(m),m.u&&(u.clearTimeout(m.u),m.u=null),gl(m),m.h.cancel(),m.s&&(typeof m.s=="number"&&u.clearTimeout(m.s),m.s=null)}function pl(m){if(!qn(m.h)&&!m.s){m.s=!0;var T=m.Ga;se||W(),Le||(se(),Le=!0),ae.add(T,m),m.B=0}}function Sd(m,T){return ei(m.h)>=m.h.j-(m.s?1:0)?!1:m.s?(m.i=T.D.concat(m.i),!0):m.G==1||m.G==2||m.B>=(m.Va?0:m.Wa)?!1:(m.s=yr(_(m.Ga,m,T),Lc(m,m.B)),m.B++,!0)}t.Ga=function(m){if(this.s)if(this.s=null,this.G==1){if(!m){this.U=Math.floor(1e5*Math.random()),m=this.U++;const fe=new ye(this,this.j,m);let Te=this.o;if(this.S&&(Te?(Te=I(Te),B(Te,this.S)):Te=this.S),this.m!==null||this.O||(fe.H=Te,Te=null),this.P)e:{for(var T=0,A=0;A<this.i.length;A++){t:{var U=this.i[A];if("__data__"in U.map&&(U=U.map.__data__,typeof U=="string")){U=U.length;break t}U=void 0}if(U===void 0)break;if(T+=U,4096<T){T=A;break e}if(T===4096||A===this.i.length-1){T=A+1;break e}}T=1e3}else T=1e3;T=Lf(this,fe,T),A=ta(this.I),or(A,"RID",m),or(A,"CVER",22),this.D&&or(A,"X-HTTP-Session-Id",this.D),go(this,A),Te&&(this.O?T="headers="+encodeURIComponent(String(Fc(Te)))+"&"+T:this.m&&tn(A,this.m,Te)),ol(this.h,fe),this.Ua&&or(A,"TYPE","init"),this.P?(or(A,"$req",T),or(A,"SID","null"),fe.T=!0,Me(fe,A,null)):Me(fe,A,T),this.G=2}}else this.G==3&&(m?Mc(this,m):this.i.length==0||qn(this.h)||Mc(this))};function Mc(m,T){var A;T?A=T.l:A=m.U++;const U=ta(m.I);or(U,"SID",m.K),or(U,"RID",A),or(U,"AID",m.T),go(m,U),m.m&&m.o&&tn(U,m.m,m.o),A=new ye(m,m.j,A,m.B+1),m.m===null&&(A.H=m.o),T&&(m.i=T.D.concat(m.i)),T=Lf(m,A,1e3),A.I=Math.round(.5*m.wa)+Math.round(.5*m.wa*Math.random()),ol(m.h,A),Me(A,U,T)}function go(m,T){m.H&&Z(m.H,function(A,U){or(T,U,A)}),m.l&&Cc({},function(A,U){or(T,U,A)})}function Lf(m,T,A){A=Math.min(m.i.length,A);var U=m.l?_(m.l.Na,m.l,m):null;e:{var fe=m.i;let Te=-1;for(;;){const qe=["count="+A];Te==-1?0<A?(Te=fe[0].g,qe.push("ofs="+Te)):Te=0:qe.push("ofs="+Te);let Bt=!0;for(let Xr=0;Xr<A;Xr++){let Vt=fe[Xr].g;const rn=fe[Xr].map;if(Vt-=Te,0>Vt)Te=Math.max(0,fe[Xr].g-100),Bt=!1;else try{ri(rn,qe,"req"+Vt+"_")}catch{U&&U(rn)}}if(Bt){U=qe.join("&");break e}}}return m=m.i.splice(0,A),T.D=m,U}function Bf(m){if(!m.g&&!m.u){m.Y=1;var T=m.Fa;se||W(),Le||(se(),Le=!0),ae.add(T,m),m.v=0}}function Pc(m){return m.g||m.u||3<=m.v?!1:(m.Y++,m.u=yr(_(m.Fa,m),Lc(m,m.v)),m.v++,!0)}t.Fa=function(){if(this.u=null,Vf(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var m=2*this.R;this.j.info("BP detection timer enabled: "+m),this.A=yr(_(this.ab,this),m)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,dr(10),ml(this),Vf(this))};function xo(m){m.A!=null&&(u.clearTimeout(m.A),m.A=null)}function Vf(m){m.g=new ye(m,m.j,"rpc",m.Y),m.m===null&&(m.g.H=m.o),m.g.O=0;var T=ta(m.qa);or(T,"RID","rpc"),or(T,"SID",m.K),or(T,"AID",m.T),or(T,"CI",m.F?"0":"1"),!m.F&&m.ja&&or(T,"TO",m.ja),or(T,"TYPE","xmlhttp"),go(m,T),m.m&&m.o&&tn(T,m.m,m.o),m.L&&(m.g.I=m.L);var A=m.g;m=m.ia,A.L=1,A.v=lo(ta(T)),A.m=null,A.P=!0,He(A,m)}t.Za=function(){this.C!=null&&(this.C=null,ml(this),Pc(this),dr(19))};function gl(m){m.C!=null&&(u.clearTimeout(m.C),m.C=null)}function Uf(m,T){var A=null;if(m.g==T){gl(m),xo(m),m.g=null;var U=2}else if(Ln(m.h,T))A=T.D,Bn(m.h,T),U=1;else return;if(m.G!=0){if(T.o)if(U==1){A=T.m?T.m.length:0,T=Date.now()-T.F;var fe=m.B;U=Qa(),lt(U,new Or(U,A)),pl(m)}else Bf(m);else if(fe=T.s,fe==3||fe==0&&0<T.X||!(U==1&&Sd(m,T)||U==2&&Pc(m)))switch(A&&0<A.length&&(T=m.h,T.i=T.i.concat(A)),fe){case 1:Fi(m,5);break;case 4:Fi(m,10);break;case 3:Fi(m,6);break;default:Fi(m,2)}}}function Lc(m,T){let A=m.Ta+Math.floor(Math.random()*m.cb);return m.isActive()||(A*=2),A*T}function Fi(m,T){if(m.j.info("Error code "+T),T==2){var A=_(m.fb,m),U=m.Xa;const fe=!U;U=new Vr(U||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||oo(U,"https"),lo(U),fe?uo(U.toString(),A):Va(U.toString(),A)}else dr(2);m.G=0,m.l&&m.l.sa(T),jf(m),Pf(m)}t.fb=function(m){m?(this.j.info("Successfully pinged google.com"),dr(2)):(this.j.info("Failed to ping google.com"),dr(1))};function jf(m){if(m.G=0,m.ka=[],m.l){const T=bc(m.h);(T.length!=0||m.i.length!=0)&&(S(m.ka,T),S(m.ka,m.i),m.h.i.length=0,E(m.i),m.i.length=0),m.l.ra()}}function zf(m,T,A){var U=A instanceof Vr?ta(A):new Vr(A);if(U.g!="")T&&(U.g=T+"."+U.g),fs(U,U.s);else{var fe=u.location;U=fe.protocol,T=T?T+"."+fe.hostname:fe.hostname,fe=+fe.port;var Te=new Vr(null);U&&oo(Te,U),T&&(Te.g=T),fe&&fs(Te,fe),A&&(Te.l=A),U=Te}return A=m.D,T=m.ya,A&&T&&or(U,A,T),or(U,"VER",m.la),go(m,U),U}function Hf(m,T,A){if(T&&!m.J)throw Error("Can't create secondary domain capable XhrIo object.");return T=m.Ca&&!m.pa?new $t(new hs({eb:A})):new $t(m.pa),T.Ha(m.J),T}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Wf(){}t=Wf.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function xl(){}xl.prototype.g=function(m,T){return new Vn(m,T)};function Vn(m,T){rt.call(this),this.g=new dl(T),this.l=m,this.h=T&&T.messageUrlParams||null,m=T&&T.messageHeaders||null,T&&T.clientProtocolHeaderRequired&&(m?m["X-Client-Protocol"]="webchannel":m={"X-Client-Protocol":"webchannel"}),this.g.o=m,m=T&&T.initMessageHeaders||null,T&&T.messageContentType&&(m?m["X-WebChannel-Content-Type"]=T.messageContentType:m={"X-WebChannel-Content-Type":T.messageContentType}),T&&T.va&&(m?m["X-WebChannel-Client-Profile"]=T.va:m={"X-WebChannel-Client-Profile":T.va}),this.g.S=m,(m=T&&T.Sb)&&!z(m)&&(this.g.m=m),this.v=T&&T.supportsCrossDomainXhr||!1,this.u=T&&T.sendRawJson||!1,(T=T&&T.httpSessionIdParam)&&!z(T)&&(this.g.D=T,m=this.h,m!==null&&T in m&&(m=this.h,T in m&&delete m[T])),this.j=new si(this)}w(Vn,rt),Vn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Vn.prototype.close=function(){Nc(this.g)},Vn.prototype.o=function(m){var T=this.g;if(typeof m=="string"){var A={};A.__data__=m,m=A}else this.u&&(A={},A.__data__=Wn(m),m=A);T.i.push(new Ja(T.Ya++,m)),T.G==3&&pl(T)},Vn.prototype.N=function(){this.g.l=null,delete this.j,Nc(this.g),delete this.g,Vn.aa.N.call(this)};function Gf(m){Ba.call(this),m.__headers__&&(this.headers=m.__headers__,this.statusCode=m.__status__,delete m.__headers__,delete m.__status__);var T=m.__sm__;if(T){e:{for(const A in T){m=A;break e}m=void 0}(this.i=m)&&(m=this.i,T=T!==null&&m in T?T[m]:void 0),this.data=T}else this.data=m}w(Gf,Ba);function qf(){$a.call(this),this.status=1}w(qf,$a);function si(m){this.g=m}w(si,Wf),si.prototype.ua=function(){lt(this.g,"a")},si.prototype.ta=function(m){lt(this.g,new Gf(m))},si.prototype.sa=function(m){lt(this.g,new qf)},si.prototype.ra=function(){lt(this.g,"b")},xl.prototype.createWebChannel=xl.prototype.g,Vn.prototype.send=Vn.prototype.o,Vn.prototype.open=Vn.prototype.m,Vn.prototype.close=Vn.prototype.close,nS=function(){return new xl},rS=function(){return Qa()},tS=ma,lp={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},H.NO_ERROR=0,H.TIMEOUT=8,H.HTTP_ERROR=6,mh=H,q.COMPLETE="complete",eS=q,cs.EventType=La,La.OPEN="a",La.CLOSE="b",La.ERROR="c",La.MESSAGE="d",rt.prototype.listen=rt.prototype.K,Du=cs,$t.prototype.listenOnce=$t.prototype.L,$t.prototype.getLastError=$t.prototype.Ka,$t.prototype.getLastErrorCode=$t.prototype.Ba,$t.prototype.getStatus=$t.prototype.Z,$t.prototype.getResponseJson=$t.prototype.Oa,$t.prototype.getResponseText=$t.prototype.oa,$t.prototype.send=$t.prototype.ea,$t.prototype.setWithCredentials=$t.prototype.Ha,Jw=$t}).apply(typeof ih<"u"?ih:typeof self<"u"?self:typeof window<"u"?window:{});const My="@firebase/firestore",Py="4.9.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Cn.UNAUTHENTICATED=new Cn(null),Cn.GOOGLE_CREDENTIALS=new Cn("google-credentials-uid"),Cn.FIRST_PARTY=new Cn("first-party-uid"),Cn.MOCK_USER=new Cn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ec="12.2.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yo=new qw("@firebase/firestore");function Ql(){return Yo.logLevel}function tt(t,...e){if(Yo.logLevel<=zt.DEBUG){const r=e.map(pg);Yo.debug(`Firestore (${Ec}): ${t}`,...r)}}function ts(t,...e){if(Yo.logLevel<=zt.ERROR){const r=e.map(pg);Yo.error(`Firestore (${Ec}): ${t}`,...r)}}function fc(t,...e){if(Yo.logLevel<=zt.WARN){const r=e.map(pg);Yo.warn(`Firestore (${Ec}): ${t}`,...r)}}function pg(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(r){return JSON.stringify(r)})(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xt(t,e,r){let n="Unexpected state";typeof e=="string"?n=e:r=e,aS(t,n,r)}function aS(t,e,r){let n=`FIRESTORE (${Ec}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(r!==void 0)try{n+=" CONTEXT: "+JSON.stringify(r)}catch{n+=" CONTEXT: "+r}throw ts(n),new Error(n)}function Jt(t,e,r,n){let a="Unexpected state";typeof r=="string"?a=r:n=r,t||aS(e,a,n)}function wt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class st extends Tc{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws{constructor(){this.promise=new Promise(((e,r)=>{this.resolve=e,this.reject=r}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iS{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class tM{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable((()=>r(Cn.UNAUTHENTICATED)))}shutdown(){}}class rM{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable((()=>r(this.token.user)))}shutdown(){this.changeListener=null}}class nM{constructor(e){this.t=e,this.currentUser=Cn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){Jt(this.o===void 0,42304);let n=this.i;const a=h=>this.i!==n?(n=this.i,r(h)):Promise.resolve();let o=new Ws;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Ws,e.enqueueRetryable((()=>a(this.currentUser)))};const l=()=>{const h=o;e.enqueueRetryable((async()=>{await h.promise,await a(this.currentUser)}))},u=h=>{tt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((h=>u(h))),setTimeout((()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?u(h):(tt("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Ws)}}),0),l()}getToken(){const e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then((n=>this.i!==e?(tt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(Jt(typeof n.accessToken=="string",31837,{l:n}),new iS(n.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Jt(e===null||typeof e=="string",2055,{h:e}),new Cn(e)}}class aM{constructor(e,r,n){this.P=e,this.T=r,this.I=n,this.type="FirstParty",this.user=Cn.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class iM{constructor(e,r,n){this.P=e,this.T=r,this.I=n}getToken(){return Promise.resolve(new aM(this.P,this.T,this.I))}start(e,r){e.enqueueRetryable((()=>r(Cn.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Ly{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class sM{constructor(e,r){this.V=r,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,B9(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,r){Jt(this.o===void 0,3512);const n=o=>{o.error!=null&&tt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const l=o.token!==this.m;return this.m=o.token,tt("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?r(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable((()=>n(o)))};const a=o=>{tt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((o=>a(o))),setTimeout((()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?a(o):tt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Ly(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((r=>r?(Jt(typeof r.token=="string",44558,{tokenResult:r}),this.m=r.token,new Ly(r.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oM(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const a=oM(40);for(let o=0;o<a.length;++o)n.length<20&&a[o]<r&&(n+=e.charAt(a[o]%62))}return n}}function Nt(t,e){return t<e?-1:t>e?1:0}function cp(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++){const a=t.charAt(n),o=e.charAt(n);if(a!==o)return Um(a)===Um(o)?Nt(a,o):Um(a)?1:-1}return Nt(t.length,e.length)}const lM=55296,cM=57343;function Um(t){const e=t.charCodeAt(0);return e>=lM&&e<=cM}function hc(t,e,r){return t.length===e.length&&t.every(((n,a)=>r(n,e[a])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const By="__name__";class gi{constructor(e,r,n){r===void 0?r=0:r>e.length&&xt(637,{offset:r,range:e.length}),n===void 0?n=e.length-r:n>e.length-r&&xt(1746,{length:n,range:e.length-r}),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return gi.comparator(this,e)===0}child(e){const r=this.segments.slice(this.offset,this.limit());return e instanceof gi?e.forEach((n=>{r.push(n)})):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){const n=Math.min(e.length,r.length);for(let a=0;a<n;a++){const o=gi.compareSegments(e.get(a),r.get(a));if(o!==0)return o}return Nt(e.length,r.length)}static compareSegments(e,r){const n=gi.isNumericId(e),a=gi.isNumericId(r);return n&&!a?-1:!n&&a?1:n&&a?gi.extractNumericId(e).compare(gi.extractNumericId(r)):cp(e,r)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Hs.fromString(e.substring(4,e.length-2))}}class wr extends gi{construct(e,r,n){return new wr(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const r=[];for(const n of e){if(n.indexOf("//")>=0)throw new st(Pe.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter((a=>a.length>0)))}return new wr(r)}static emptyPath(){return new wr([])}}const uM=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class yn extends gi{construct(e,r,n){return new yn(e,r,n)}static isValidIdentifier(e){return uM.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),yn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===By}static keyField(){return new yn([By])}static fromServerFormat(e){const r=[];let n="",a=0;const o=()=>{if(n.length===0)throw new st(Pe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""};let l=!1;for(;a<e.length;){const u=e[a];if(u==="\\"){if(a+1===e.length)throw new st(Pe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[a+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new st(Pe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=h,a+=2}else u==="`"?(l=!l,a++):u!=="."||l?(n+=u,a++):(o(),a++)}if(o(),l)throw new st(Pe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new yn(r)}static emptyPath(){return new yn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ct{constructor(e){this.path=e}static fromPath(e){return new ct(wr.fromString(e))}static fromName(e){return new ct(wr.fromString(e).popFirst(5))}static empty(){return new ct(wr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&wr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return wr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ct(new wr(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fM(t,e,r){if(!r)throw new st(Pe.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function hM(t,e,r,n){if(e===!0&&n===!0)throw new st(Pe.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function Vy(t){if(!ct.isDocumentKey(t))throw new st(Pe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function sS(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function xg(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(n){return n.constructor?n.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":xt(12329,{type:typeof t})}function ff(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new st(Pe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=xg(t);throw new st(Pe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qr(t,e){const r={typeString:t};return e&&(r.value=e),r}function bf(t,e){if(!sS(t))throw new st(Pe.INVALID_ARGUMENT,"JSON must be an object");let r;for(const n in e)if(e[n]){const a=e[n].typeString,o="value"in e[n]?{value:e[n].value}:void 0;if(!(n in t)){r=`JSON missing required field: '${n}'`;break}const l=t[n];if(a&&typeof l!==a){r=`JSON field '${n}' must be a ${a}.`;break}if(o!==void 0&&l!==o.value){r=`Expected '${n}' field to equal '${o.value}'`;break}}if(r)throw new st(Pe.INVALID_ARGUMENT,r);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uy=-62135596800,jy=1e6;class xr{static now(){return xr.fromMillis(Date.now())}static fromDate(e){return xr.fromMillis(e.getTime())}static fromMillis(e){const r=Math.floor(e/1e3),n=Math.floor((e-1e3*r)*jy);return new xr(r,n)}constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new st(Pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new st(Pe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<Uy)throw new st(Pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new st(Pe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/jy}_compareTo(e){return this.seconds===e.seconds?Nt(this.nanoseconds,e.nanoseconds):Nt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:xr._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(bf(e,xr._jsonSchema))return new xr(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Uy;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}xr._jsonSchemaVersion="firestore/timestamp/1.0",xr._jsonSchema={type:qr("string",xr._jsonSchemaVersion),seconds:qr("number"),nanoseconds:qr("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{static fromTimestamp(e){return new Et(e)}static min(){return new Et(new xr(0,0))}static max(){return new Et(new xr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hf=-1;function dM(t,e){const r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,a=Et.fromTimestamp(n===1e9?new xr(r+1,0):new xr(r,n));return new Ks(a,ct.empty(),e)}function mM(t){return new Ks(t.readTime,t.key,hf)}class Ks{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new Ks(Et.min(),ct.empty(),hf)}static max(){return new Ks(Et.max(),ct.empty(),hf)}}function pM(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=ct.comparator(t.documentKey,e.documentKey),r!==0?r:Nt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gM="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class xM{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wc(t){if(t.code!==Pe.FAILED_PRECONDITION||t.message!==gM)throw t;tt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)}),(r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)}))}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&xt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new De(((n,a)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(n,a)},this.catchCallback=o=>{this.wrapFailure(r,o).next(n,a)}}))}toPromise(){return new Promise(((e,r)=>{this.next(e,r)}))}wrapUserFunction(e){try{const r=e();return r instanceof De?r:De.resolve(r)}catch(r){return De.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction((()=>e(r))):De.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction((()=>e(r))):De.reject(r)}static resolve(e){return new De(((r,n)=>{r(e)}))}static reject(e){return new De(((r,n)=>{n(e)}))}static waitFor(e){return new De(((r,n)=>{let a=0,o=0,l=!1;e.forEach((u=>{++a,u.next((()=>{++o,l&&o===a&&r()}),(h=>n(h)))})),l=!0,o===a&&r()}))}static or(e){let r=De.resolve(!1);for(const n of e)r=r.next((a=>a?De.resolve(a):n()));return r}static forEach(e,r){const n=[];return e.forEach(((a,o)=>{n.push(r.call(this,a,o))})),this.waitFor(n)}static mapArray(e,r){return new De(((n,a)=>{const o=e.length,l=new Array(o);let u=0;for(let h=0;h<o;h++){const d=h;r(e[d]).next((p=>{l[d]=p,++u,u===o&&n(l)}),(p=>a(p)))}}))}static doWhile(e,r){return new De(((n,a)=>{const o=()=>{e()===!0?r().next((()=>{o()}),a):n()};o()}))}}function vM(t){const e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Sc(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class id{constructor(e,r){this.previousValue=e,r&&(r.sequenceNumberHandler=n=>this.ae(n),this.ue=n=>r.writeSequenceNumber(n))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}id.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vg=-1;function sd(t){return t==null}function Bh(t){return t===0&&1/t==-1/0}function _M(t){return typeof t=="number"&&Number.isInteger(t)&&!Bh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oS="";function yM(t){let e="";for(let r=0;r<t.length;r++)e.length>0&&(e=zy(e)),e=TM(t.get(r),e);return zy(e)}function TM(t,e){let r=e;const n=t.length;for(let a=0;a<n;a++){const o=t.charAt(a);switch(o){case"\0":r+="";break;case oS:r+="";break;default:r+=o}}return r}function zy(t){return t+oS+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hy(t){let e=0;for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function rl(t,e){for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function lS(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr{constructor(e,r){this.comparator=e,this.root=r||xn.EMPTY}insert(e,r){return new kr(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,xn.BLACK,null,null))}remove(e){return new kr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,xn.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){const n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){const a=this.comparator(e,n.key);if(a===0)return r+n.left.size;a<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((r,n)=>(e(r,n),!1)))}toString(){const e=[];return this.inorderTraversal(((r,n)=>(e.push(`${r}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new sh(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new sh(this.root,e,this.comparator,!1)}getReverseIterator(){return new sh(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new sh(this.root,e,this.comparator,!0)}}class sh{constructor(e,r,n,a){this.isReverse=a,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=r?n(e.key,r):1,r&&a&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class xn{constructor(e,r,n,a,o){this.key=e,this.value=r,this.color=n??xn.RED,this.left=a??xn.EMPTY,this.right=o??xn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,a,o){return new xn(e??this.key,r??this.value,n??this.color,a??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let a=this;const o=n(e,a.key);return a=o<0?a.copy(null,null,null,a.left.insert(e,r,n),null):o===0?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(e,r,n)),a.fixUp()}removeMin(){if(this.left.isEmpty())return xn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,a=this;if(r(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,r),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),r(e,a.key)===0){if(a.right.isEmpty())return xn.EMPTY;n=a.right.min(),a=a.copy(n.key,n.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,r))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,xn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,xn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw xt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw xt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw xt(27949);return e+(this.isRed()?0:1)}}xn.EMPTY=null,xn.RED=!0,xn.BLACK=!1;xn.EMPTY=new class{constructor(){this.size=0}get key(){throw xt(57766)}get value(){throw xt(16141)}get color(){throw xt(16727)}get left(){throw xt(29726)}get right(){throw xt(36894)}copy(e,r,n,a,o){return this}insert(e,r,n){return new xn(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jr{constructor(e){this.comparator=e,this.data=new kr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((r,n)=>(e(r),!1)))}forEachInRange(e,r){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const a=n.getNext();if(this.comparator(a.key,e[1])>=0)return;r(a.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new Wy(this.data.getIterator())}getIteratorFrom(e){return new Wy(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach((n=>{r=r.add(n)})),r}isEqual(e){if(!(e instanceof Jr)||this.size!==e.size)return!1;const r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){const a=r.getNext().key,o=n.getNext().key;if(this.comparator(a,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((r=>{e.push(r)})),e}toString(){const e=[];return this.forEach((r=>e.push(r))),"SortedSet("+e.toString()+")"}copy(e){const r=new Jr(this.comparator);return r.data=e,r}}class Wy{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xa{constructor(e){this.fields=e,e.sort(yn.comparator)}static empty(){return new Xa([])}unionWith(e){let r=new Jr(yn.comparator);for(const n of this.fields)r=r.add(n);for(const n of e)r=r.add(n);return new Xa(r.toArray())}covers(e){for(const r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return hc(this.fields,e.fields,((r,n)=>r.isEqual(n)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cS extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tn{constructor(e){this.binaryString=e}static fromBase64String(e){const r=(function(a){try{return atob(a)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new cS("Invalid base64 string: "+o):o}})(e);return new Tn(r)}static fromUint8Array(e){const r=(function(a){let o="";for(let l=0;l<a.length;++l)o+=String.fromCharCode(a[l]);return o})(e);return new Tn(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(r){return btoa(r)})(this.binaryString)}toUint8Array(){return(function(r){const n=new Uint8Array(r.length);for(let a=0;a<r.length;a++)n[a]=r.charCodeAt(a);return n})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Nt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Tn.EMPTY_BYTE_STRING=new Tn("");const EM=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function $s(t){if(Jt(!!t,39018),typeof t=="string"){let e=0;const r=EM.exec(t);if(Jt(!!r,46558,{timestamp:t}),r[1]){let a=r[1];a=(a+"000000000").substr(0,9),e=Number(a)}const n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Pr(t.seconds),nanos:Pr(t.nanos)}}function Pr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Qs(t){return typeof t=="string"?Tn.fromBase64String(t):Tn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uS="server_timestamp",fS="__type__",hS="__previous_value__",dS="__local_write_time__";function _g(t){return(t?.mapValue?.fields||{})[fS]?.stringValue===uS}function od(t){const e=t.mapValue.fields[hS];return _g(e)?od(e):e}function df(t){const e=$s(t.mapValue.fields[dS].timestampValue);return new xr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wM{constructor(e,r,n,a,o,l,u,h,d,p){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=a,this.ssl=o,this.forceLongPolling=l,this.autoDetectLongPolling=u,this.longPollingOptions=h,this.useFetchStreams=d,this.isUsingEmulator=p}}const Vh="(default)";class mf{constructor(e,r){this.projectId=e,this.database=r||Vh}static empty(){return new mf("","")}get isDefaultDatabase(){return this.database===Vh}isEqual(e){return e instanceof mf&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mS="__type__",SM="__max__",oh={mapValue:{}},pS="__vector__",Uh="value";function Zs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?_g(t)?4:kM(t)?9007199254740991:AM(t)?10:11:xt(28295,{value:t})}function wi(t,e){if(t===e)return!0;const r=Zs(t);if(r!==Zs(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return df(t).isEqual(df(e));case 3:return(function(a,o){if(typeof a.timestampValue=="string"&&typeof o.timestampValue=="string"&&a.timestampValue.length===o.timestampValue.length)return a.timestampValue===o.timestampValue;const l=$s(a.timestampValue),u=$s(o.timestampValue);return l.seconds===u.seconds&&l.nanos===u.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(a,o){return Qs(a.bytesValue).isEqual(Qs(o.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(a,o){return Pr(a.geoPointValue.latitude)===Pr(o.geoPointValue.latitude)&&Pr(a.geoPointValue.longitude)===Pr(o.geoPointValue.longitude)})(t,e);case 2:return(function(a,o){if("integerValue"in a&&"integerValue"in o)return Pr(a.integerValue)===Pr(o.integerValue);if("doubleValue"in a&&"doubleValue"in o){const l=Pr(a.doubleValue),u=Pr(o.doubleValue);return l===u?Bh(l)===Bh(u):isNaN(l)&&isNaN(u)}return!1})(t,e);case 9:return hc(t.arrayValue.values||[],e.arrayValue.values||[],wi);case 10:case 11:return(function(a,o){const l=a.mapValue.fields||{},u=o.mapValue.fields||{};if(Hy(l)!==Hy(u))return!1;for(const h in l)if(l.hasOwnProperty(h)&&(u[h]===void 0||!wi(l[h],u[h])))return!1;return!0})(t,e);default:return xt(52216,{left:t})}}function pf(t,e){return(t.values||[]).find((r=>wi(r,e)))!==void 0}function dc(t,e){if(t===e)return 0;const r=Zs(t),n=Zs(e);if(r!==n)return Nt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Nt(t.booleanValue,e.booleanValue);case 2:return(function(o,l){const u=Pr(o.integerValue||o.doubleValue),h=Pr(l.integerValue||l.doubleValue);return u<h?-1:u>h?1:u===h?0:isNaN(u)?isNaN(h)?0:-1:1})(t,e);case 3:return Gy(t.timestampValue,e.timestampValue);case 4:return Gy(df(t),df(e));case 5:return cp(t.stringValue,e.stringValue);case 6:return(function(o,l){const u=Qs(o),h=Qs(l);return u.compareTo(h)})(t.bytesValue,e.bytesValue);case 7:return(function(o,l){const u=o.split("/"),h=l.split("/");for(let d=0;d<u.length&&d<h.length;d++){const p=Nt(u[d],h[d]);if(p!==0)return p}return Nt(u.length,h.length)})(t.referenceValue,e.referenceValue);case 8:return(function(o,l){const u=Nt(Pr(o.latitude),Pr(l.latitude));return u!==0?u:Nt(Pr(o.longitude),Pr(l.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return qy(t.arrayValue,e.arrayValue);case 10:return(function(o,l){const u=o.fields||{},h=l.fields||{},d=u[Uh]?.arrayValue,p=h[Uh]?.arrayValue,v=Nt(d?.values?.length||0,p?.values?.length||0);return v!==0?v:qy(d,p)})(t.mapValue,e.mapValue);case 11:return(function(o,l){if(o===oh.mapValue&&l===oh.mapValue)return 0;if(o===oh.mapValue)return 1;if(l===oh.mapValue)return-1;const u=o.fields||{},h=Object.keys(u),d=l.fields||{},p=Object.keys(d);h.sort(),p.sort();for(let v=0;v<h.length&&v<p.length;++v){const _=cp(h[v],p[v]);if(_!==0)return _;const y=dc(u[h[v]],d[p[v]]);if(y!==0)return y}return Nt(h.length,p.length)})(t.mapValue,e.mapValue);default:throw xt(23264,{he:r})}}function Gy(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Nt(t,e);const r=$s(t),n=$s(e),a=Nt(r.seconds,n.seconds);return a!==0?a:Nt(r.nanos,n.nanos)}function qy(t,e){const r=t.values||[],n=e.values||[];for(let a=0;a<r.length&&a<n.length;++a){const o=dc(r[a],n[a]);if(o)return o}return Nt(r.length,n.length)}function mc(t){return up(t)}function up(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(r){const n=$s(r);return`time(${n.seconds},${n.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(r){return Qs(r).toBase64()})(t.bytesValue):"referenceValue"in t?(function(r){return ct.fromName(r).toString()})(t.referenceValue):"geoPointValue"in t?(function(r){return`geo(${r.latitude},${r.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(r){let n="[",a=!0;for(const o of r.values||[])a?a=!1:n+=",",n+=up(o);return n+"]"})(t.arrayValue):"mapValue"in t?(function(r){const n=Object.keys(r.fields||{}).sort();let a="{",o=!0;for(const l of n)o?o=!1:a+=",",a+=`${l}:${up(r.fields[l])}`;return a+"}"})(t.mapValue):xt(61005,{value:t})}function ph(t){switch(Zs(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=od(t);return e?16+ph(e):16;case 5:return 2*t.stringValue.length;case 6:return Qs(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(n){return(n.values||[]).reduce(((a,o)=>a+ph(o)),0)})(t.arrayValue);case 10:case 11:return(function(n){let a=0;return rl(n.fields,((o,l)=>{a+=o.length+ph(l)})),a})(t.mapValue);default:throw xt(13486,{value:t})}}function fp(t){return!!t&&"integerValue"in t}function yg(t){return!!t&&"arrayValue"in t}function Xy(t){return!!t&&"nullValue"in t}function Yy(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function gh(t){return!!t&&"mapValue"in t}function AM(t){return(t?.mapValue?.fields||{})[mS]?.stringValue===pS}function Hu(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return rl(t.mapValue.fields,((r,n)=>e.mapValue.fields[r]=Hu(n))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Hu(t.arrayValue.values[r]);return e}return{...t}}function kM(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===SM}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa{constructor(e){this.value=e}static empty(){return new Oa({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!gh(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Hu(r)}setAll(e){let r=yn.emptyPath(),n={},a=[];e.forEach(((l,u)=>{if(!r.isImmediateParentOf(u)){const h=this.getFieldsMap(r);this.applyChanges(h,n,a),n={},a=[],r=u.popLast()}l?n[u.lastSegment()]=Hu(l):a.push(u.lastSegment())}));const o=this.getFieldsMap(r);this.applyChanges(o,n,a)}delete(e){const r=this.field(e.popLast());gh(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return wi(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let a=r.mapValue.fields[e.get(n)];gh(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=a),r=a}return r.mapValue.fields}applyChanges(e,r,n){rl(r,((a,o)=>e[a]=o));for(const a of n)delete e[a]}clone(){return new Oa(Hu(this.value))}}function gS(t){const e=[];return rl(t.fields,((r,n)=>{const a=new yn([r]);if(gh(n)){const o=gS(n.mapValue).fields;if(o.length===0)e.push(a);else for(const l of o)e.push(a.child(l))}else e.push(a)})),new Xa(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class In{constructor(e,r,n,a,o,l,u){this.key=e,this.documentType=r,this.version=n,this.readTime=a,this.createTime=o,this.data=l,this.documentState=u}static newInvalidDocument(e){return new In(e,0,Et.min(),Et.min(),Et.min(),Oa.empty(),0)}static newFoundDocument(e,r,n,a){return new In(e,1,r,Et.min(),n,a,0)}static newNoDocument(e,r){return new In(e,2,r,Et.min(),Et.min(),Oa.empty(),0)}static newUnknownDocument(e,r){return new In(e,3,r,Et.min(),Et.min(),Oa.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(Et.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Oa.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Oa.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Et.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof In&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new In(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jh{constructor(e,r){this.position=e,this.inclusive=r}}function Ky(t,e,r){let n=0;for(let a=0;a<t.position.length;a++){const o=e[a],l=t.position[a];if(o.field.isKeyField()?n=ct.comparator(ct.fromName(l.referenceValue),r.key):n=dc(l,r.data.field(o.field)),o.dir==="desc"&&(n*=-1),n!==0)break}return n}function $y(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!wi(t.position[r],e.position[r]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zh{constructor(e,r="asc"){this.field=e,this.dir=r}}function bM(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xS{}class Zr extends xS{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new RM(e,r,n):r==="array-contains"?new OM(e,n):r==="in"?new FM(e,n):r==="not-in"?new NM(e,n):r==="array-contains-any"?new MM(e,n):new Zr(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new DM(e,n):new IM(e,n)}matches(e){const r=e.data.field(this.field);return this.op==="!="?r!==null&&r.nullValue===void 0&&this.matchesComparison(dc(r,this.value)):r!==null&&Zs(this.value)===Zs(r)&&this.matchesComparison(dc(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return xt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Si extends xS{constructor(e,r){super(),this.filters=e,this.op=r,this.Pe=null}static create(e,r){return new Si(e,r)}matches(e){return vS(this)?this.filters.find((r=>!r.matches(e)))===void 0:this.filters.find((r=>r.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,r)=>e.concat(r.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function vS(t){return t.op==="and"}function _S(t){return CM(t)&&vS(t)}function CM(t){for(const e of t.filters)if(e instanceof Si)return!1;return!0}function hp(t){if(t instanceof Zr)return t.field.canonicalString()+t.op.toString()+mc(t.value);if(_S(t))return t.filters.map((e=>hp(e))).join(",");{const e=t.filters.map((r=>hp(r))).join(",");return`${t.op}(${e})`}}function yS(t,e){return t instanceof Zr?(function(n,a){return a instanceof Zr&&n.op===a.op&&n.field.isEqual(a.field)&&wi(n.value,a.value)})(t,e):t instanceof Si?(function(n,a){return a instanceof Si&&n.op===a.op&&n.filters.length===a.filters.length?n.filters.reduce(((o,l,u)=>o&&yS(l,a.filters[u])),!0):!1})(t,e):void xt(19439)}function TS(t){return t instanceof Zr?(function(r){return`${r.field.canonicalString()} ${r.op} ${mc(r.value)}`})(t):t instanceof Si?(function(r){return r.op.toString()+" {"+r.getFilters().map(TS).join(" ,")+"}"})(t):"Filter"}class RM extends Zr{constructor(e,r,n){super(e,r,n),this.key=ct.fromName(n.referenceValue)}matches(e){const r=ct.comparator(e.key,this.key);return this.matchesComparison(r)}}class DM extends Zr{constructor(e,r){super(e,"in",r),this.keys=ES("in",r)}matches(e){return this.keys.some((r=>r.isEqual(e.key)))}}class IM extends Zr{constructor(e,r){super(e,"not-in",r),this.keys=ES("not-in",r)}matches(e){return!this.keys.some((r=>r.isEqual(e.key)))}}function ES(t,e){return(e.arrayValue?.values||[]).map((r=>ct.fromName(r.referenceValue)))}class OM extends Zr{constructor(e,r){super(e,"array-contains",r)}matches(e){const r=e.data.field(this.field);return yg(r)&&pf(r.arrayValue,this.value)}}class FM extends Zr{constructor(e,r){super(e,"in",r)}matches(e){const r=e.data.field(this.field);return r!==null&&pf(this.value.arrayValue,r)}}class NM extends Zr{constructor(e,r){super(e,"not-in",r)}matches(e){if(pf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=e.data.field(this.field);return r!==null&&r.nullValue===void 0&&!pf(this.value.arrayValue,r)}}class MM extends Zr{constructor(e,r){super(e,"array-contains-any",r)}matches(e){const r=e.data.field(this.field);return!(!yg(r)||!r.arrayValue.values)&&r.arrayValue.values.some((n=>pf(this.value.arrayValue,n)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PM{constructor(e,r=null,n=[],a=[],o=null,l=null,u=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=a,this.limit=o,this.startAt=l,this.endAt=u,this.Te=null}}function Qy(t,e=null,r=[],n=[],a=null,o=null,l=null){return new PM(t,e,r,n,a,o,l)}function Tg(t){const e=wt(t);if(e.Te===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map((n=>hp(n))).join(","),r+="|ob:",r+=e.orderBy.map((n=>(function(o){return o.field.canonicalString()+o.dir})(n))).join(","),sd(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map((n=>mc(n))).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map((n=>mc(n))).join(",")),e.Te=r}return e.Te}function Eg(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!bM(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!yS(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!$y(t.startAt,e.startAt)&&$y(t.endAt,e.endAt)}function dp(t){return ct.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld{constructor(e,r=null,n=[],a=[],o=null,l="F",u=null,h=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=a,this.limit=o,this.limitType=l,this.startAt=u,this.endAt=h,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function LM(t,e,r,n,a,o,l,u){return new ld(t,e,r,n,a,o,l,u)}function wg(t){return new ld(t)}function Zy(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function BM(t){return t.collectionGroup!==null}function Wu(t){const e=wt(t);if(e.Ie===null){e.Ie=[];const r=new Set;for(const o of e.explicitOrderBy)e.Ie.push(o),r.add(o.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let u=new Jr(yn.comparator);return l.filters.forEach((h=>{h.getFlattenedFilters().forEach((d=>{d.isInequality()&&(u=u.add(d.field))}))})),u})(e).forEach((o=>{r.has(o.canonicalString())||o.isKeyField()||e.Ie.push(new zh(o,n))})),r.has(yn.keyField().canonicalString())||e.Ie.push(new zh(yn.keyField(),n))}return e.Ie}function _i(t){const e=wt(t);return e.Ee||(e.Ee=VM(e,Wu(t))),e.Ee}function VM(t,e){if(t.limitType==="F")return Qy(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((a=>{const o=a.dir==="desc"?"asc":"desc";return new zh(a.field,o)}));const r=t.endAt?new jh(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new jh(t.startAt.position,t.startAt.inclusive):null;return Qy(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function mp(t,e,r){return new ld(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function cd(t,e){return Eg(_i(t),_i(e))&&t.limitType===e.limitType}function wS(t){return`${Tg(_i(t))}|lt:${t.limitType}`}function Zl(t){return`Query(target=${(function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map((a=>TS(a))).join(", ")}]`),sd(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map((a=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(a))).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map((a=>mc(a))).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map((a=>mc(a))).join(",")),`Target(${n})`})(_i(t))}; limitType=${t.limitType})`}function ud(t,e){return e.isFoundDocument()&&(function(n,a){const o=a.key.path;return n.collectionGroup!==null?a.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):ct.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)})(t,e)&&(function(n,a){for(const o of Wu(n))if(!o.field.isKeyField()&&a.data.field(o.field)===null)return!1;return!0})(t,e)&&(function(n,a){for(const o of n.filters)if(!o.matches(a))return!1;return!0})(t,e)&&(function(n,a){return!(n.startAt&&!(function(l,u,h){const d=Ky(l,u,h);return l.inclusive?d<=0:d<0})(n.startAt,Wu(n),a)||n.endAt&&!(function(l,u,h){const d=Ky(l,u,h);return l.inclusive?d>=0:d>0})(n.endAt,Wu(n),a))})(t,e)}function UM(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function SS(t){return(e,r)=>{let n=!1;for(const a of Wu(t)){const o=jM(a,e,r);if(o!==0)return o;n=n||a.field.isKeyField()}return 0}}function jM(t,e,r){const n=t.field.isKeyField()?ct.comparator(e.key,r.key):(function(o,l,u){const h=l.data.field(o),d=u.data.field(o);return h!==null&&d!==null?dc(h,d):xt(42886)})(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return xt(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(const[a,o]of n)if(this.equalsFn(a,e))return o}}has(e){return this.get(e)!==void 0}set(e,r){const n=this.mapKeyFn(e),a=this.inner[n];if(a===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let o=0;o<a.length;o++)if(this.equalsFn(a[o][0],e))return void(a[o]=[e,r]);a.push([e,r]),this.innerSize++}delete(e){const r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let a=0;a<n.length;a++)if(this.equalsFn(n[a][0],e))return n.length===1?delete this.inner[r]:n.splice(a,1),this.innerSize--,!0;return!1}forEach(e){rl(this.inner,((r,n)=>{for(const[a,o]of n)e(a,o)}))}isEmpty(){return lS(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zM=new kr(ct.comparator);function rs(){return zM}const AS=new kr(ct.comparator);function Iu(...t){let e=AS;for(const r of t)e=e.insert(r.key,r);return e}function kS(t){let e=AS;return t.forEach(((r,n)=>e=e.insert(r,n.overlayedDocument))),e}function Po(){return Gu()}function bS(){return Gu()}function Gu(){return new nl((t=>t.toString()),((t,e)=>t.isEqual(e)))}const HM=new kr(ct.comparator),WM=new Jr(ct.comparator);function Mt(...t){let e=WM;for(const r of t)e=e.add(r);return e}const GM=new Jr(Nt);function qM(){return GM}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sg(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Bh(e)?"-0":e}}function CS(t){return{integerValue:""+t}}function XM(t,e){return _M(e)?CS(e):Sg(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fd{constructor(){this._=void 0}}function YM(t,e,r){return t instanceof Hh?(function(a,o){const l={fields:{[fS]:{stringValue:uS},[dS]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return o&&_g(o)&&(o=od(o)),o&&(l.fields[hS]=o),{mapValue:l}})(r,e):t instanceof gf?DS(t,e):t instanceof xf?IS(t,e):(function(a,o){const l=RS(a,o),u=Jy(l)+Jy(a.Ae);return fp(l)&&fp(a.Ae)?CS(u):Sg(a.serializer,u)})(t,e)}function KM(t,e,r){return t instanceof gf?DS(t,e):t instanceof xf?IS(t,e):r}function RS(t,e){return t instanceof Wh?(function(n){return fp(n)||(function(o){return!!o&&"doubleValue"in o})(n)})(e)?e:{integerValue:0}:null}class Hh extends fd{}class gf extends fd{constructor(e){super(),this.elements=e}}function DS(t,e){const r=OS(e);for(const n of t.elements)r.some((a=>wi(a,n)))||r.push(n);return{arrayValue:{values:r}}}class xf extends fd{constructor(e){super(),this.elements=e}}function IS(t,e){let r=OS(e);for(const n of t.elements)r=r.filter((a=>!wi(a,n)));return{arrayValue:{values:r}}}class Wh extends fd{constructor(e,r){super(),this.serializer=e,this.Ae=r}}function Jy(t){return Pr(t.integerValue||t.doubleValue)}function OS(t){return yg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function $M(t,e){return t.field.isEqual(e.field)&&(function(n,a){return n instanceof gf&&a instanceof gf||n instanceof xf&&a instanceof xf?hc(n.elements,a.elements,wi):n instanceof Wh&&a instanceof Wh?wi(n.Ae,a.Ae):n instanceof Hh&&a instanceof Hh})(t.transform,e.transform)}class QM{constructor(e,r){this.version=e,this.transformResults=r}}class Zi{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new Zi}static exists(e){return new Zi(void 0,e)}static updateTime(e){return new Zi(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function xh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class hd{}function FS(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new MS(t.key,Zi.none()):new Cf(t.key,t.data,Zi.none());{const r=t.data,n=Oa.empty();let a=new Jr(yn.comparator);for(let o of e.fields)if(!a.has(o)){let l=r.field(o);l===null&&o.length>1&&(o=o.popLast(),l=r.field(o)),l===null?n.delete(o):n.set(o,l),a=a.add(o)}return new al(t.key,n,new Xa(a.toArray()),Zi.none())}}function ZM(t,e,r){t instanceof Cf?(function(a,o,l){const u=a.value.clone(),h=tT(a.fieldTransforms,o,l.transformResults);u.setAll(h),o.convertToFoundDocument(l.version,u).setHasCommittedMutations()})(t,e,r):t instanceof al?(function(a,o,l){if(!xh(a.precondition,o))return void o.convertToUnknownDocument(l.version);const u=tT(a.fieldTransforms,o,l.transformResults),h=o.data;h.setAll(NS(a)),h.setAll(u),o.convertToFoundDocument(l.version,h).setHasCommittedMutations()})(t,e,r):(function(a,o,l){o.convertToNoDocument(l.version).setHasCommittedMutations()})(0,e,r)}function qu(t,e,r,n){return t instanceof Cf?(function(o,l,u,h){if(!xh(o.precondition,l))return u;const d=o.value.clone(),p=rT(o.fieldTransforms,h,l);return d.setAll(p),l.convertToFoundDocument(l.version,d).setHasLocalMutations(),null})(t,e,r,n):t instanceof al?(function(o,l,u,h){if(!xh(o.precondition,l))return u;const d=rT(o.fieldTransforms,h,l),p=l.data;return p.setAll(NS(o)),p.setAll(d),l.convertToFoundDocument(l.version,p).setHasLocalMutations(),u===null?null:u.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map((v=>v.field)))})(t,e,r,n):(function(o,l,u){return xh(o.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):u})(t,e,r)}function JM(t,e){let r=null;for(const n of t.fieldTransforms){const a=e.data.field(n.field),o=RS(n.transform,a||null);o!=null&&(r===null&&(r=Oa.empty()),r.set(n.field,o))}return r||null}function eT(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(n,a){return n===void 0&&a===void 0||!(!n||!a)&&hc(n,a,((o,l)=>$M(o,l)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Cf extends hd{constructor(e,r,n,a=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class al extends hd{constructor(e,r,n,a,o=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=a,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function NS(t){const e=new Map;return t.fieldMask.fields.forEach((r=>{if(!r.isEmpty()){const n=t.data.field(r);e.set(r,n)}})),e}function tT(t,e,r){const n=new Map;Jt(t.length===r.length,32656,{Re:r.length,Ve:t.length});for(let a=0;a<r.length;a++){const o=t[a],l=o.transform,u=e.data.field(o.field);n.set(o.field,KM(l,u,r[a]))}return n}function rT(t,e,r){const n=new Map;for(const a of t){const o=a.transform,l=r.data.field(a.field);n.set(a.field,YM(o,l,e))}return n}class MS extends hd{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class e7 extends hd{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t7{constructor(e,r,n,a){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=a}applyToRemoteDocument(e,r){const n=r.mutationResults;for(let a=0;a<this.mutations.length;a++){const o=this.mutations[a];o.key.isEqual(e.key)&&ZM(o,e,n[a])}}applyToLocalView(e,r){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(r=qu(n,e,r,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(r=qu(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){const n=bS();return this.mutations.forEach((a=>{const o=e.get(a.key),l=o.overlayedDocument;let u=this.applyToLocalView(l,o.mutatedFields);u=r.has(a.key)?null:u;const h=FS(l,u);h!==null&&n.set(a.key,h),l.isValidDocument()||l.convertToNoDocument(Et.min())})),n}keys(){return this.mutations.reduce(((e,r)=>e.add(r.key)),Mt())}isEqual(e){return this.batchId===e.batchId&&hc(this.mutations,e.mutations,((r,n)=>eT(r,n)))&&hc(this.baseMutations,e.baseMutations,((r,n)=>eT(r,n)))}}class Ag{constructor(e,r,n,a){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=a}static from(e,r,n){Jt(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let a=(function(){return HM})();const o=e.mutations;for(let l=0;l<o.length;l++)a=a.insert(o[l].key,n[l].version);return new Ag(e,r,n,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r7{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n7{constructor(e,r){this.count=e,this.unchangedNames=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Hr,jt;function a7(t){switch(t){case Pe.OK:return xt(64938);case Pe.CANCELLED:case Pe.UNKNOWN:case Pe.DEADLINE_EXCEEDED:case Pe.RESOURCE_EXHAUSTED:case Pe.INTERNAL:case Pe.UNAVAILABLE:case Pe.UNAUTHENTICATED:return!1;case Pe.INVALID_ARGUMENT:case Pe.NOT_FOUND:case Pe.ALREADY_EXISTS:case Pe.PERMISSION_DENIED:case Pe.FAILED_PRECONDITION:case Pe.ABORTED:case Pe.OUT_OF_RANGE:case Pe.UNIMPLEMENTED:case Pe.DATA_LOSS:return!0;default:return xt(15467,{code:t})}}function PS(t){if(t===void 0)return ts("GRPC error has no .code"),Pe.UNKNOWN;switch(t){case Hr.OK:return Pe.OK;case Hr.CANCELLED:return Pe.CANCELLED;case Hr.UNKNOWN:return Pe.UNKNOWN;case Hr.DEADLINE_EXCEEDED:return Pe.DEADLINE_EXCEEDED;case Hr.RESOURCE_EXHAUSTED:return Pe.RESOURCE_EXHAUSTED;case Hr.INTERNAL:return Pe.INTERNAL;case Hr.UNAVAILABLE:return Pe.UNAVAILABLE;case Hr.UNAUTHENTICATED:return Pe.UNAUTHENTICATED;case Hr.INVALID_ARGUMENT:return Pe.INVALID_ARGUMENT;case Hr.NOT_FOUND:return Pe.NOT_FOUND;case Hr.ALREADY_EXISTS:return Pe.ALREADY_EXISTS;case Hr.PERMISSION_DENIED:return Pe.PERMISSION_DENIED;case Hr.FAILED_PRECONDITION:return Pe.FAILED_PRECONDITION;case Hr.ABORTED:return Pe.ABORTED;case Hr.OUT_OF_RANGE:return Pe.OUT_OF_RANGE;case Hr.UNIMPLEMENTED:return Pe.UNIMPLEMENTED;case Hr.DATA_LOSS:return Pe.DATA_LOSS;default:return xt(39323,{code:t})}}(jt=Hr||(Hr={}))[jt.OK=0]="OK",jt[jt.CANCELLED=1]="CANCELLED",jt[jt.UNKNOWN=2]="UNKNOWN",jt[jt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",jt[jt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",jt[jt.NOT_FOUND=5]="NOT_FOUND",jt[jt.ALREADY_EXISTS=6]="ALREADY_EXISTS",jt[jt.PERMISSION_DENIED=7]="PERMISSION_DENIED",jt[jt.UNAUTHENTICATED=16]="UNAUTHENTICATED",jt[jt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",jt[jt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",jt[jt.ABORTED=10]="ABORTED",jt[jt.OUT_OF_RANGE=11]="OUT_OF_RANGE",jt[jt.UNIMPLEMENTED=12]="UNIMPLEMENTED",jt[jt.INTERNAL=13]="INTERNAL",jt[jt.UNAVAILABLE=14]="UNAVAILABLE",jt[jt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i7(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s7=new Hs([4294967295,4294967295],0);function nT(t){const e=i7().encode(t),r=new Zw;return r.update(e),new Uint8Array(r.digest())}function aT(t){const e=new DataView(t.buffer),r=e.getUint32(0,!0),n=e.getUint32(4,!0),a=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new Hs([r,n],0),new Hs([a,o],0)]}class kg{constructor(e,r,n){if(this.bitmap=e,this.padding=r,this.hashCount=n,r<0||r>=8)throw new Ou(`Invalid padding: ${r}`);if(n<0)throw new Ou(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Ou(`Invalid hash count: ${n}`);if(e.length===0&&r!==0)throw new Ou(`Invalid padding when bitmap length is 0: ${r}`);this.ge=8*e.length-r,this.pe=Hs.fromNumber(this.ge)}ye(e,r,n){let a=e.add(r.multiply(Hs.fromNumber(n)));return a.compare(s7)===1&&(a=new Hs([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const r=nT(e),[n,a]=aT(r);for(let o=0;o<this.hashCount;o++){const l=this.ye(n,a,o);if(!this.we(l))return!1}return!0}static create(e,r,n){const a=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),l=new kg(o,a,r);return n.forEach((u=>l.insert(u))),l}insert(e){if(this.ge===0)return;const r=nT(e),[n,a]=aT(r);for(let o=0;o<this.hashCount;o++){const l=this.ye(n,a,o);this.Se(l)}}Se(e){const r=Math.floor(e/8),n=e%8;this.bitmap[r]|=1<<n}}class Ou extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd{constructor(e,r,n,a,o){this.snapshotVersion=e,this.targetChanges=r,this.targetMismatches=n,this.documentUpdates=a,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,r,n){const a=new Map;return a.set(e,Rf.createSynthesizedTargetChangeForCurrentChange(e,r,n)),new dd(Et.min(),a,new kr(Nt),rs(),Mt())}}class Rf{constructor(e,r,n,a,o){this.resumeToken=e,this.current=r,this.addedDocuments=n,this.modifiedDocuments=a,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,r,n){return new Rf(n,r,Mt(),Mt(),Mt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vh{constructor(e,r,n,a){this.be=e,this.removedTargetIds=r,this.key=n,this.De=a}}class LS{constructor(e,r){this.targetId=e,this.Ce=r}}class BS{constructor(e,r,n=Tn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=r,this.resumeToken=n,this.cause=a}}class iT{constructor(){this.ve=0,this.Fe=sT(),this.Me=Tn.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Mt(),r=Mt(),n=Mt();return this.Fe.forEach(((a,o)=>{switch(o){case 0:e=e.add(a);break;case 2:r=r.add(a);break;case 1:n=n.add(a);break;default:xt(38017,{changeType:o})}})),new Rf(this.Me,this.xe,e,r,n)}qe(){this.Oe=!1,this.Fe=sT()}Qe(e,r){this.Oe=!0,this.Fe=this.Fe.insert(e,r)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,Jt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class o7{constructor(e){this.Ge=e,this.ze=new Map,this.je=rs(),this.Je=lh(),this.He=lh(),this.Ye=new kr(Nt)}Ze(e){for(const r of e.be)e.De&&e.De.isFoundDocument()?this.Xe(r,e.De):this.et(r,e.key,e.De);for(const r of e.removedTargetIds)this.et(r,e.key,e.De)}tt(e){this.forEachTarget(e,(r=>{const n=this.nt(r);switch(e.state){case 0:this.rt(r)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(r);break;case 3:this.rt(r)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(r)&&(this.it(r),n.Le(e.resumeToken));break;default:xt(56790,{state:e.state})}}))}forEachTarget(e,r){e.targetIds.length>0?e.targetIds.forEach(r):this.ze.forEach(((n,a)=>{this.rt(a)&&r(a)}))}st(e){const r=e.targetId,n=e.Ce.count,a=this.ot(r);if(a){const o=a.target;if(dp(o))if(n===0){const l=new ct(o.path);this.et(r,l,In.newNoDocument(l,Et.min()))}else Jt(n===1,20013,{expectedCount:n});else{const l=this._t(r);if(l!==n){const u=this.ut(e),h=u?this.ct(u,e,l):1;if(h!==0){this.it(r);const d=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(r,d)}}}}}ut(e){const r=e.Ce.unchangedNames;if(!r||!r.bits)return null;const{bits:{bitmap:n="",padding:a=0},hashCount:o=0}=r;let l,u;try{l=Qs(n).toUint8Array()}catch(h){if(h instanceof cS)return fc("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{u=new kg(l,a,o)}catch(h){return fc(h instanceof Ou?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return u.ge===0?null:u}ct(e,r,n){return r.Ce.count===n-this.Pt(e,r.targetId)?0:2}Pt(e,r){const n=this.Ge.getRemoteKeysForTarget(r);let a=0;return n.forEach((o=>{const l=this.Ge.ht(),u=`projects/${l.projectId}/databases/${l.database}/documents/${o.path.canonicalString()}`;e.mightContain(u)||(this.et(r,o,null),a++)})),a}Tt(e){const r=new Map;this.ze.forEach(((o,l)=>{const u=this.ot(l);if(u){if(o.current&&dp(u.target)){const h=new ct(u.target.path);this.It(h).has(l)||this.Et(l,h)||this.et(l,h,In.newNoDocument(h,e))}o.Be&&(r.set(l,o.ke()),o.qe())}}));let n=Mt();this.He.forEach(((o,l)=>{let u=!0;l.forEachWhile((h=>{const d=this.ot(h);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)})),u&&(n=n.add(o))})),this.je.forEach(((o,l)=>l.setReadTime(e)));const a=new dd(e,r,this.Ye,this.je,n);return this.je=rs(),this.Je=lh(),this.He=lh(),this.Ye=new kr(Nt),a}Xe(e,r){if(!this.rt(e))return;const n=this.Et(e,r.key)?2:0;this.nt(e).Qe(r.key,n),this.je=this.je.insert(r.key,r),this.Je=this.Je.insert(r.key,this.It(r.key).add(e)),this.He=this.He.insert(r.key,this.dt(r.key).add(e))}et(e,r,n){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,r)?a.Qe(r,1):a.$e(r),this.He=this.He.insert(r,this.dt(r).delete(e)),this.He=this.He.insert(r,this.dt(r).add(e)),n&&(this.je=this.je.insert(r,n))}removeTarget(e){this.ze.delete(e)}_t(e){const r=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+r.addedDocuments.size-r.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let r=this.ze.get(e);return r||(r=new iT,this.ze.set(e,r)),r}dt(e){let r=this.He.get(e);return r||(r=new Jr(Nt),this.He=this.He.insert(e,r)),r}It(e){let r=this.Je.get(e);return r||(r=new Jr(Nt),this.Je=this.Je.insert(e,r)),r}rt(e){const r=this.ot(e)!==null;return r||tt("WatchChangeAggregator","Detected inactive target",e),r}ot(e){const r=this.ze.get(e);return r&&r.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new iT),this.Ge.getRemoteKeysForTarget(e).forEach((r=>{this.et(e,r,null)}))}Et(e,r){return this.Ge.getRemoteKeysForTarget(e).has(r)}}function lh(){return new kr(ct.comparator)}function sT(){return new kr(ct.comparator)}const l7={asc:"ASCENDING",desc:"DESCENDING"},c7={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},u7={and:"AND",or:"OR"};class f7{constructor(e,r){this.databaseId=e,this.useProto3Json=r}}function pp(t,e){return t.useProto3Json||sd(e)?e:{value:e}}function Gh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function VS(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function h7(t,e){return Gh(t,e.toTimestamp())}function yi(t){return Jt(!!t,49232),Et.fromTimestamp((function(r){const n=$s(r);return new xr(n.seconds,n.nanos)})(t))}function bg(t,e){return gp(t,e).canonicalString()}function gp(t,e){const r=(function(a){return new wr(["projects",a.projectId,"databases",a.database])})(t).child("documents");return e===void 0?r:r.child(e)}function US(t){const e=wr.fromString(t);return Jt(GS(e),10190,{key:e.toString()}),e}function xp(t,e){return bg(t.databaseId,e.path)}function jm(t,e){const r=US(e);if(r.get(1)!==t.databaseId.projectId)throw new st(Pe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+t.databaseId.projectId);if(r.get(3)!==t.databaseId.database)throw new st(Pe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+t.databaseId.database);return new ct(zS(r))}function jS(t,e){return bg(t.databaseId,e)}function d7(t){const e=US(t);return e.length===4?wr.emptyPath():zS(e)}function vp(t){return new wr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function zS(t){return Jt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function oT(t,e,r){return{name:xp(t,e),fields:r.value.mapValue.fields}}function m7(t,e){let r;if("targetChange"in e){e.targetChange;const n=(function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:xt(39313,{state:d})})(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],o=(function(d,p){return d.useProto3Json?(Jt(p===void 0||typeof p=="string",58123),Tn.fromBase64String(p||"")):(Jt(p===void 0||p instanceof Buffer||p instanceof Uint8Array,16193),Tn.fromUint8Array(p||new Uint8Array))})(t,e.targetChange.resumeToken),l=e.targetChange.cause,u=l&&(function(d){const p=d.code===void 0?Pe.UNKNOWN:PS(d.code);return new st(p,d.message||"")})(l);r=new BS(n,a,o,u||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const a=jm(t,n.document.name),o=yi(n.document.updateTime),l=n.document.createTime?yi(n.document.createTime):Et.min(),u=new Oa({mapValue:{fields:n.document.fields}}),h=In.newFoundDocument(a,o,l,u),d=n.targetIds||[],p=n.removedTargetIds||[];r=new vh(d,p,h.key,h)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const a=jm(t,n.document),o=n.readTime?yi(n.readTime):Et.min(),l=In.newNoDocument(a,o),u=n.removedTargetIds||[];r=new vh([],u,l.key,l)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const a=jm(t,n.document),o=n.removedTargetIds||[];r=new vh([],o,a,null)}else{if(!("filter"in e))return xt(11601,{Rt:e});{e.filter;const n=e.filter;n.targetId;const{count:a=0,unchangedNames:o}=n,l=new n7(a,o),u=n.targetId;r=new LS(u,l)}}return r}function p7(t,e){let r;if(e instanceof Cf)r={update:oT(t,e.key,e.value)};else if(e instanceof MS)r={delete:xp(t,e.key)};else if(e instanceof al)r={update:oT(t,e.key,e.data),updateMask:S7(e.fieldMask)};else{if(!(e instanceof e7))return xt(16599,{Vt:e.type});r={verify:xp(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map((n=>(function(o,l){const u=l.transform;if(u instanceof Hh)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof gf)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof xf)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Wh)return{fieldPath:l.field.canonicalString(),increment:u.Ae};throw xt(20930,{transform:l.transform})})(0,n)))),e.precondition.isNone||(r.currentDocument=(function(a,o){return o.updateTime!==void 0?{updateTime:h7(a,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:xt(27497)})(t,e.precondition)),r}function g7(t,e){return t&&t.length>0?(Jt(e!==void 0,14353),t.map((r=>(function(a,o){let l=a.updateTime?yi(a.updateTime):yi(o);return l.isEqual(Et.min())&&(l=yi(o)),new QM(l,a.transformResults||[])})(r,e)))):[]}function x7(t,e){return{documents:[jS(t,e.path)]}}function v7(t,e){const r={structuredQuery:{}},n=e.path;let a;e.collectionGroup!==null?(a=n,r.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=n.popLast(),r.structuredQuery.from=[{collectionId:n.lastSegment()}]),r.parent=jS(t,a);const o=(function(d){if(d.length!==0)return WS(Si.create(d,"and"))})(e.filters);o&&(r.structuredQuery.where=o);const l=(function(d){if(d.length!==0)return d.map((p=>(function(_){return{field:Jl(_.field),direction:T7(_.dir)}})(p)))})(e.orderBy);l&&(r.structuredQuery.orderBy=l);const u=pp(t,e.limit);return u!==null&&(r.structuredQuery.limit=u),e.startAt&&(r.structuredQuery.startAt=(function(d){return{before:d.inclusive,values:d.position}})(e.startAt)),e.endAt&&(r.structuredQuery.endAt=(function(d){return{before:!d.inclusive,values:d.position}})(e.endAt)),{ft:r,parent:a}}function _7(t){let e=d7(t.parent);const r=t.structuredQuery,n=r.from?r.from.length:0;let a=null;if(n>0){Jt(n===1,65062);const p=r.from[0];p.allDescendants?a=p.collectionId:e=e.child(p.collectionId)}let o=[];r.where&&(o=(function(v){const _=HS(v);return _ instanceof Si&&_S(_)?_.getFilters():[_]})(r.where));let l=[];r.orderBy&&(l=(function(v){return v.map((_=>(function(w){return new zh(ec(w.field),(function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(w.direction))})(_)))})(r.orderBy));let u=null;r.limit&&(u=(function(v){let _;return _=typeof v=="object"?v.value:v,sd(_)?null:_})(r.limit));let h=null;r.startAt&&(h=(function(v){const _=!!v.before,y=v.values||[];return new jh(y,_)})(r.startAt));let d=null;return r.endAt&&(d=(function(v){const _=!v.before,y=v.values||[];return new jh(y,_)})(r.endAt)),LM(e,a,l,o,u,"F",h,d)}function y7(t,e){const r=(function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return xt(28987,{purpose:a})}})(e.purpose);return r==null?null:{"goog-listen-tags":r}}function HS(t){return t.unaryFilter!==void 0?(function(r){switch(r.unaryFilter.op){case"IS_NAN":const n=ec(r.unaryFilter.field);return Zr.create(n,"==",{doubleValue:NaN});case"IS_NULL":const a=ec(r.unaryFilter.field);return Zr.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=ec(r.unaryFilter.field);return Zr.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=ec(r.unaryFilter.field);return Zr.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return xt(61313);default:return xt(60726)}})(t):t.fieldFilter!==void 0?(function(r){return Zr.create(ec(r.fieldFilter.field),(function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return xt(58110);default:return xt(50506)}})(r.fieldFilter.op),r.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(r){return Si.create(r.compositeFilter.filters.map((n=>HS(n))),(function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return xt(1026)}})(r.compositeFilter.op))})(t):xt(30097,{filter:t})}function T7(t){return l7[t]}function E7(t){return c7[t]}function w7(t){return u7[t]}function Jl(t){return{fieldPath:t.canonicalString()}}function ec(t){return yn.fromServerFormat(t.fieldPath)}function WS(t){return t instanceof Zr?(function(r){if(r.op==="=="){if(Yy(r.value))return{unaryFilter:{field:Jl(r.field),op:"IS_NAN"}};if(Xy(r.value))return{unaryFilter:{field:Jl(r.field),op:"IS_NULL"}}}else if(r.op==="!="){if(Yy(r.value))return{unaryFilter:{field:Jl(r.field),op:"IS_NOT_NAN"}};if(Xy(r.value))return{unaryFilter:{field:Jl(r.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Jl(r.field),op:E7(r.op),value:r.value}}})(t):t instanceof Si?(function(r){const n=r.getFilters().map((a=>WS(a)));return n.length===1?n[0]:{compositeFilter:{op:w7(r.op),filters:n}}})(t):xt(54877,{filter:t})}function S7(t){const e=[];return t.fields.forEach((r=>e.push(r.canonicalString()))),{fieldPaths:e}}function GS(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vs{constructor(e,r,n,a,o=Et.min(),l=Et.min(),u=Tn.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=r,this.purpose=n,this.sequenceNumber=a,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=u,this.expectedCount=h}withSequenceNumber(e){return new Vs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,r){return new Vs(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Vs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Vs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A7{constructor(e){this.yt=e}}function k7(t){const e=_7({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?mp(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b7{constructor(){this.Cn=new C7}addToCollectionParentIndex(e,r){return this.Cn.add(r),De.resolve()}getCollectionParents(e,r){return De.resolve(this.Cn.getEntries(r))}addFieldIndex(e,r){return De.resolve()}deleteFieldIndex(e,r){return De.resolve()}deleteAllFieldIndexes(e){return De.resolve()}createTargetIndexes(e,r){return De.resolve()}getDocumentsMatchingTarget(e,r){return De.resolve(null)}getIndexType(e,r){return De.resolve(0)}getFieldIndexes(e,r){return De.resolve([])}getNextCollectionGroupToUpdate(e){return De.resolve(null)}getMinOffset(e,r){return De.resolve(Ks.min())}getMinOffsetFromCollectionGroup(e,r){return De.resolve(Ks.min())}updateCollectionGroup(e,r,n){return De.resolve()}updateIndexEntries(e,r){return De.resolve()}}class C7{constructor(){this.index={}}add(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r]||new Jr(wr.comparator),o=!a.has(n);return this.index[r]=a.add(n),o}has(e){const r=e.lastSegment(),n=e.popLast(),a=this.index[r];return a&&a.has(n)}getEntries(e){return(this.index[e]||new Jr(wr.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},qS=41943040;class Qn{static withCacheSize(e){return new Qn(e,Qn.DEFAULT_COLLECTION_PERCENTILE,Qn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Qn.DEFAULT_COLLECTION_PERCENTILE=10,Qn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Qn.DEFAULT=new Qn(qS,Qn.DEFAULT_COLLECTION_PERCENTILE,Qn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Qn.DISABLED=new Qn(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pc{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new pc(0)}static cr(){return new pc(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cT="LruGarbageCollector",R7=1048576;function uT([t,e],[r,n]){const a=Nt(t,r);return a===0?Nt(e,n):a}class D7{constructor(e){this.Ir=e,this.buffer=new Jr(uT),this.Er=0}dr(){return++this.Er}Ar(e){const r=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(r);else{const n=this.buffer.last();uT(r,n)<0&&(this.buffer=this.buffer.delete(n).add(r))}}get maxValue(){return this.buffer.last()[0]}}class I7{constructor(e,r,n){this.garbageCollector=e,this.asyncQueue=r,this.localStore=n,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){tt(cT,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(r){Sc(r)?tt(cT,"Ignoring IndexedDB error during garbage collection: ",r):await wc(r)}await this.Vr(3e5)}))}}class O7{constructor(e,r){this.mr=e,this.params=r}calculateTargetCount(e,r){return this.mr.gr(e).next((n=>Math.floor(r/100*n)))}nthSequenceNumber(e,r){if(r===0)return De.resolve(id.ce);const n=new D7(r);return this.mr.forEachTarget(e,(a=>n.Ar(a.sequenceNumber))).next((()=>this.mr.pr(e,(a=>n.Ar(a))))).next((()=>n.maxValue))}removeTargets(e,r,n){return this.mr.removeTargets(e,r,n)}removeOrphanedDocuments(e,r){return this.mr.removeOrphanedDocuments(e,r)}collect(e,r){return this.params.cacheSizeCollectionThreshold===-1?(tt("LruGarbageCollector","Garbage collection skipped; disabled"),De.resolve(lT)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(tt("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),lT):this.yr(e,r)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,r){let n,a,o,l,u,h,d;const p=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((v=>(v>this.params.maximumSequenceNumbersToCollect?(tt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${v}`),a=this.params.maximumSequenceNumbersToCollect):a=v,l=Date.now(),this.nthSequenceNumber(e,a)))).next((v=>(n=v,u=Date.now(),this.removeTargets(e,n,r)))).next((v=>(o=v,h=Date.now(),this.removeOrphanedDocuments(e,n)))).next((v=>(d=Date.now(),Ql()<=zt.DEBUG&&tt("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-p}ms
	Determined least recently used ${a} in `+(u-l)+`ms
	Removed ${o} targets in `+(h-u)+`ms
	Removed ${v} documents in `+(d-h)+`ms
Total Duration: ${d-p}ms`),De.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:o,documentsRemoved:v}))))}}function F7(t,e){return new O7(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N7{constructor(){this.changes=new nl((e=>e.toString()),((e,r)=>e.isEqual(r))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,In.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();const n=this.changes.get(r);return n!==void 0?De.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M7{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P7{constructor(e,r,n,a){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=a}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next((a=>(n=a,this.remoteDocumentCache.getEntry(e,r)))).next((a=>(n!==null&&qu(n.mutation,a,Xa.empty(),xr.now()),a)))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.getLocalViewOfDocuments(e,n,Mt()).next((()=>n))))}getLocalViewOfDocuments(e,r,n=Mt()){const a=Po();return this.populateOverlays(e,a,r).next((()=>this.computeViews(e,r,a,n).next((o=>{let l=Iu();return o.forEach(((u,h)=>{l=l.insert(u,h.overlayedDocument)})),l}))))}getOverlayedDocuments(e,r){const n=Po();return this.populateOverlays(e,n,r).next((()=>this.computeViews(e,r,n,Mt())))}populateOverlays(e,r,n){const a=[];return n.forEach((o=>{r.has(o)||a.push(o)})),this.documentOverlayCache.getOverlays(e,a).next((o=>{o.forEach(((l,u)=>{r.set(l,u)}))}))}computeViews(e,r,n,a){let o=rs();const l=Gu(),u=(function(){return Gu()})();return r.forEach(((h,d)=>{const p=n.get(d.key);a.has(d.key)&&(p===void 0||p.mutation instanceof al)?o=o.insert(d.key,d):p!==void 0?(l.set(d.key,p.mutation.getFieldMask()),qu(p.mutation,d,p.mutation.getFieldMask(),xr.now())):l.set(d.key,Xa.empty())})),this.recalculateAndSaveOverlays(e,o).next((h=>(h.forEach(((d,p)=>l.set(d,p))),r.forEach(((d,p)=>u.set(d,new M7(p,l.get(d)??null)))),u)))}recalculateAndSaveOverlays(e,r){const n=Gu();let a=new kr(((l,u)=>l-u)),o=Mt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next((l=>{for(const u of l)u.keys().forEach((h=>{const d=r.get(h);if(d===null)return;let p=n.get(h)||Xa.empty();p=u.applyToLocalView(d,p),n.set(h,p);const v=(a.get(u.batchId)||Mt()).add(h);a=a.insert(u.batchId,v)}))})).next((()=>{const l=[],u=a.getReverseIterator();for(;u.hasNext();){const h=u.getNext(),d=h.key,p=h.value,v=bS();p.forEach((_=>{if(!o.has(_)){const y=FS(r.get(_),n.get(_));y!==null&&v.set(_,y),o=o.add(_)}})),l.push(this.documentOverlayCache.saveOverlays(e,d,v))}return De.waitFor(l)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next((n=>this.recalculateAndSaveOverlays(e,n)))}getDocumentsMatchingQuery(e,r,n,a){return(function(l){return ct.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0})(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):BM(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,a):this.getDocumentsMatchingCollectionQuery(e,r,n,a)}getNextDocuments(e,r,n,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,a).next((o=>{const l=a-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,a-o.size):De.resolve(Po());let u=hf,h=o;return l.next((d=>De.forEach(d,((p,v)=>(u<v.largestBatchId&&(u=v.largestBatchId),o.get(p)?De.resolve():this.remoteDocumentCache.getEntry(e,p).next((_=>{h=h.insert(p,_)}))))).next((()=>this.populateOverlays(e,d,o))).next((()=>this.computeViews(e,h,d,Mt()))).next((p=>({batchId:u,changes:kS(p)})))))}))}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new ct(r)).next((n=>{let a=Iu();return n.isFoundDocument()&&(a=a.insert(n.key,n)),a}))}getDocumentsMatchingCollectionGroupQuery(e,r,n,a){const o=r.collectionGroup;let l=Iu();return this.indexManager.getCollectionParents(e,o).next((u=>De.forEach(u,(h=>{const d=(function(v,_){return new ld(_,null,v.explicitOrderBy.slice(),v.filters.slice(),v.limit,v.limitType,v.startAt,v.endAt)})(r,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,d,n,a).next((p=>{p.forEach(((v,_)=>{l=l.insert(v,_)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(e,r,n,a){let o;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next((l=>(o=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,o,a)))).next((l=>{o.forEach(((h,d)=>{const p=d.getKey();l.get(p)===null&&(l=l.insert(p,In.newInvalidDocument(p)))}));let u=Iu();return l.forEach(((h,d)=>{const p=o.get(h);p!==void 0&&qu(p.mutation,d,Xa.empty(),xr.now()),ud(r,d)&&(u=u.insert(h,d))})),u}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L7{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,r){return De.resolve(this.Lr.get(r))}saveBundleMetadata(e,r){return this.Lr.set(r.id,(function(a){return{id:a.id,version:a.version,createTime:yi(a.createTime)}})(r)),De.resolve()}getNamedQuery(e,r){return De.resolve(this.kr.get(r))}saveNamedQuery(e,r){return this.kr.set(r.name,(function(a){return{name:a.name,query:k7(a.bundledQuery),readTime:yi(a.readTime)}})(r)),De.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B7{constructor(){this.overlays=new kr(ct.comparator),this.qr=new Map}getOverlay(e,r){return De.resolve(this.overlays.get(r))}getOverlays(e,r){const n=Po();return De.forEach(r,(a=>this.getOverlay(e,a).next((o=>{o!==null&&n.set(a,o)})))).next((()=>n))}saveOverlays(e,r,n){return n.forEach(((a,o)=>{this.St(e,r,o)})),De.resolve()}removeOverlaysForBatchId(e,r,n){const a=this.qr.get(n);return a!==void 0&&(a.forEach((o=>this.overlays=this.overlays.remove(o))),this.qr.delete(n)),De.resolve()}getOverlaysForCollection(e,r,n){const a=Po(),o=r.length+1,l=new ct(r.child("")),u=this.overlays.getIteratorFrom(l);for(;u.hasNext();){const h=u.getNext().value,d=h.getKey();if(!r.isPrefixOf(d.path))break;d.path.length===o&&h.largestBatchId>n&&a.set(h.getKey(),h)}return De.resolve(a)}getOverlaysForCollectionGroup(e,r,n,a){let o=new kr(((d,p)=>d-p));const l=this.overlays.getIterator();for(;l.hasNext();){const d=l.getNext().value;if(d.getKey().getCollectionGroup()===r&&d.largestBatchId>n){let p=o.get(d.largestBatchId);p===null&&(p=Po(),o=o.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}const u=Po(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach(((d,p)=>u.set(d,p))),!(u.size()>=a)););return De.resolve(u)}St(e,r,n){const a=this.overlays.get(n.key);if(a!==null){const l=this.qr.get(a.largestBatchId).delete(n.key);this.qr.set(a.largestBatchId,l)}this.overlays=this.overlays.insert(n.key,new r7(r,n));let o=this.qr.get(r);o===void 0&&(o=Mt(),this.qr.set(r,o)),this.qr.set(r,o.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V7{constructor(){this.sessionToken=Tn.EMPTY_BYTE_STRING}getSessionToken(e){return De.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,De.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cg{constructor(){this.Qr=new Jr(ln.$r),this.Ur=new Jr(ln.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,r){const n=new ln(e,r);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,r){e.forEach((n=>this.addReference(n,r)))}removeReference(e,r){this.Gr(new ln(e,r))}zr(e,r){e.forEach((n=>this.removeReference(n,r)))}jr(e){const r=new ct(new wr([])),n=new ln(r,e),a=new ln(r,e+1),o=[];return this.Ur.forEachInRange([n,a],(l=>{this.Gr(l),o.push(l.key)})),o}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const r=new ct(new wr([])),n=new ln(r,e),a=new ln(r,e+1);let o=Mt();return this.Ur.forEachInRange([n,a],(l=>{o=o.add(l.key)})),o}containsKey(e){const r=new ln(e,0),n=this.Qr.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}}class ln{constructor(e,r){this.key=e,this.Yr=r}static $r(e,r){return ct.comparator(e.key,r.key)||Nt(e.Yr,r.Yr)}static Kr(e,r){return Nt(e.Yr,r.Yr)||ct.comparator(e.key,r.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U7{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.tr=1,this.Zr=new Jr(ln.$r)}checkEmpty(e){return De.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,a){const o=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new t7(o,r,n,a);this.mutationQueue.push(l);for(const u of a)this.Zr=this.Zr.add(new ln(u.key,o)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return De.resolve(l)}lookupMutationBatch(e,r){return De.resolve(this.Xr(r))}getNextMutationBatchAfterBatchId(e,r){const n=r+1,a=this.ei(n),o=a<0?0:a;return De.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return De.resolve(this.mutationQueue.length===0?vg:this.tr-1)}getAllMutationBatches(e){return De.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){const n=new ln(r,0),a=new ln(r,Number.POSITIVE_INFINITY),o=[];return this.Zr.forEachInRange([n,a],(l=>{const u=this.Xr(l.Yr);o.push(u)})),De.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Jr(Nt);return r.forEach((a=>{const o=new ln(a,0),l=new ln(a,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([o,l],(u=>{n=n.add(u.Yr)}))})),De.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,r){const n=r.path,a=n.length+1;let o=n;ct.isDocumentKey(o)||(o=o.child(""));const l=new ln(new ct(o),0);let u=new Jr(Nt);return this.Zr.forEachWhile((h=>{const d=h.key.path;return!!n.isPrefixOf(d)&&(d.length===a&&(u=u.add(h.Yr)),!0)}),l),De.resolve(this.ti(u))}ti(e){const r=[];return e.forEach((n=>{const a=this.Xr(n);a!==null&&r.push(a)})),r}removeMutationBatch(e,r){Jt(this.ni(r.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Zr;return De.forEach(r.mutations,(a=>{const o=new ln(a.key,r.batchId);return n=n.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((()=>{this.Zr=n}))}ir(e){}containsKey(e,r){const n=new ln(r,0),a=this.Zr.firstAfterOrEqual(n);return De.resolve(r.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,De.resolve()}ni(e,r){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const r=this.ei(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j7{constructor(e){this.ri=e,this.docs=(function(){return new kr(ct.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){const n=r.key,a=this.docs.get(n),o=a?a.size:0,l=this.ri(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:l}),this.size+=l-o,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){const n=this.docs.get(r);return De.resolve(n?n.document.mutableCopy():In.newInvalidDocument(r))}getEntries(e,r){let n=rs();return r.forEach((a=>{const o=this.docs.get(a);n=n.insert(a,o?o.document.mutableCopy():In.newInvalidDocument(a))})),De.resolve(n)}getDocumentsMatchingQuery(e,r,n,a){let o=rs();const l=r.path,u=new ct(l.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(u);for(;h.hasNext();){const{key:d,value:{document:p}}=h.getNext();if(!l.isPrefixOf(d.path))break;d.path.length>l.length+1||pM(mM(p),n)<=0||(a.has(p.key)||ud(r,p))&&(o=o.insert(p.key,p.mutableCopy()))}return De.resolve(o)}getAllFromCollectionGroup(e,r,n,a){xt(9500)}ii(e,r){return De.forEach(this.docs,(n=>r(n)))}newChangeBuffer(e){return new z7(this)}getSize(e){return De.resolve(this.size)}}class z7 extends N7{constructor(e){super(),this.Nr=e}applyChanges(e){const r=[];return this.changes.forEach(((n,a)=>{a.isValidDocument()?r.push(this.Nr.addEntry(e,a)):this.Nr.removeEntry(n)})),De.waitFor(r)}getFromCache(e,r){return this.Nr.getEntry(e,r)}getAllFromCache(e,r){return this.Nr.getEntries(e,r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H7{constructor(e){this.persistence=e,this.si=new nl((r=>Tg(r)),Eg),this.lastRemoteSnapshotVersion=Et.min(),this.highestTargetId=0,this.oi=0,this._i=new Cg,this.targetCount=0,this.ai=pc.ur()}forEachTarget(e,r){return this.si.forEach(((n,a)=>r(a))),De.resolve()}getLastRemoteSnapshotVersion(e){return De.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return De.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),De.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.oi&&(this.oi=r),De.resolve()}Pr(e){this.si.set(e.target,e);const r=e.targetId;r>this.highestTargetId&&(this.ai=new pc(r),this.highestTargetId=r),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,r){return this.Pr(r),this.targetCount+=1,De.resolve()}updateTargetData(e,r){return this.Pr(r),De.resolve()}removeTargetData(e,r){return this.si.delete(r.target),this._i.jr(r.targetId),this.targetCount-=1,De.resolve()}removeTargets(e,r,n){let a=0;const o=[];return this.si.forEach(((l,u)=>{u.sequenceNumber<=r&&n.get(u.targetId)===null&&(this.si.delete(l),o.push(this.removeMatchingKeysForTargetId(e,u.targetId)),a++)})),De.waitFor(o).next((()=>a))}getTargetCount(e){return De.resolve(this.targetCount)}getTargetData(e,r){const n=this.si.get(r)||null;return De.resolve(n)}addMatchingKeys(e,r,n){return this._i.Wr(r,n),De.resolve()}removeMatchingKeys(e,r,n){this._i.zr(r,n);const a=this.persistence.referenceDelegate,o=[];return a&&r.forEach((l=>{o.push(a.markPotentiallyOrphaned(e,l))})),De.waitFor(o)}removeMatchingKeysForTargetId(e,r){return this._i.jr(r),De.resolve()}getMatchingKeysForTargetId(e,r){const n=this._i.Hr(r);return De.resolve(n)}containsKey(e,r){return De.resolve(this._i.containsKey(r))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XS{constructor(e,r){this.ui={},this.overlays={},this.ci=new id(0),this.li=!1,this.li=!0,this.hi=new V7,this.referenceDelegate=e(this),this.Pi=new H7(this),this.indexManager=new b7,this.remoteDocumentCache=(function(a){return new j7(a)})((n=>this.referenceDelegate.Ti(n))),this.serializer=new A7(r),this.Ii=new L7(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new B7,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.ui[e.toKey()];return n||(n=new U7(r,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,r,n){tt("MemoryPersistence","Starting transaction:",e);const a=new W7(this.ci.next());return this.referenceDelegate.Ei(),n(a).next((o=>this.referenceDelegate.di(a).next((()=>o)))).toPromise().then((o=>(a.raiseOnCommittedEvent(),o)))}Ai(e,r){return De.or(Object.values(this.ui).map((n=>()=>n.containsKey(e,r))))}}class W7 extends xM{constructor(e){super(),this.currentSequenceNumber=e}}class Rg{constructor(e){this.persistence=e,this.Ri=new Cg,this.Vi=null}static mi(e){return new Rg(e)}get fi(){if(this.Vi)return this.Vi;throw xt(60996)}addReference(e,r,n){return this.Ri.addReference(n,r),this.fi.delete(n.toString()),De.resolve()}removeReference(e,r,n){return this.Ri.removeReference(n,r),this.fi.add(n.toString()),De.resolve()}markPotentiallyOrphaned(e,r){return this.fi.add(r.toString()),De.resolve()}removeTarget(e,r){this.Ri.jr(r.targetId).forEach((a=>this.fi.add(a.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next((a=>{a.forEach((o=>this.fi.add(o.toString())))})).next((()=>n.removeTargetData(e,r)))}Ei(){this.Vi=new Set}di(e){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return De.forEach(this.fi,(n=>{const a=ct.fromPath(n);return this.gi(e,a).next((o=>{o||r.removeEntry(a,Et.min())}))})).next((()=>(this.Vi=null,r.apply(e))))}updateLimboDocument(e,r){return this.gi(e,r).next((n=>{n?this.fi.delete(r.toString()):this.fi.add(r.toString())}))}Ti(e){return 0}gi(e,r){return De.or([()=>De.resolve(this.Ri.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.Ai(e,r)])}}class qh{constructor(e,r){this.persistence=e,this.pi=new nl((n=>yM(n.path)),((n,a)=>n.isEqual(a))),this.garbageCollector=F7(this,r)}static mi(e,r){return new qh(e,r)}Ei(){}di(e){return De.resolve()}forEachTarget(e,r){return this.persistence.getTargetCache().forEachTarget(e,r)}gr(e){const r=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((n=>r.next((a=>n+a))))}wr(e){let r=0;return this.pr(e,(n=>{r++})).next((()=>r))}pr(e,r){return De.forEach(this.pi,((n,a)=>this.br(e,n,a).next((o=>o?De.resolve():r(a)))))}removeTargets(e,r,n){return this.persistence.getTargetCache().removeTargets(e,r,n)}removeOrphanedDocuments(e,r){let n=0;const a=this.persistence.getRemoteDocumentCache(),o=a.newChangeBuffer();return a.ii(e,(l=>this.br(e,l,r).next((u=>{u||(n++,o.removeEntry(l,Et.min()))})))).next((()=>o.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,r){return this.pi.set(r,e.currentSequenceNumber),De.resolve()}removeTarget(e,r){const n=r.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),De.resolve()}removeReference(e,r,n){return this.pi.set(n,e.currentSequenceNumber),De.resolve()}updateLimboDocument(e,r){return this.pi.set(r,e.currentSequenceNumber),De.resolve()}Ti(e){let r=e.key.toString().length;return e.isFoundDocument()&&(r+=ph(e.data.value)),r}br(e,r,n){return De.or([()=>this.persistence.Ai(e,r),()=>this.persistence.getTargetCache().containsKey(e,r),()=>{const a=this.pi.get(r);return De.resolve(a!==void 0&&a>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dg{constructor(e,r,n,a){this.targetId=e,this.fromCache=r,this.Es=n,this.ds=a}static As(e,r){let n=Mt(),a=Mt();for(const o of r.docChanges)switch(o.type){case 0:n=n.add(o.doc.key);break;case 1:a=a.add(o.doc.key)}return new Dg(e,r.fromCache,n,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G7{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q7{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return MN()?8:vM(FN())>0?6:4})()}initialize(e,r){this.ps=e,this.indexManager=r,this.Rs=!0}getDocumentsMatchingQuery(e,r,n,a){const o={result:null};return this.ys(e,r).next((l=>{o.result=l})).next((()=>{if(!o.result)return this.ws(e,r,a,n).next((l=>{o.result=l}))})).next((()=>{if(o.result)return;const l=new G7;return this.Ss(e,r,l).next((u=>{if(o.result=u,this.Vs)return this.bs(e,r,l,u.size)}))})).next((()=>o.result))}bs(e,r,n,a){return n.documentReadCount<this.fs?(Ql()<=zt.DEBUG&&tt("QueryEngine","SDK will not create cache indexes for query:",Zl(r),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),De.resolve()):(Ql()<=zt.DEBUG&&tt("QueryEngine","Query:",Zl(r),"scans",n.documentReadCount,"local documents and returns",a,"documents as results."),n.documentReadCount>this.gs*a?(Ql()<=zt.DEBUG&&tt("QueryEngine","The SDK decides to create cache indexes for query:",Zl(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,_i(r))):De.resolve())}ys(e,r){if(Zy(r))return De.resolve(null);let n=_i(r);return this.indexManager.getIndexType(e,n).next((a=>a===0?null:(r.limit!==null&&a===1&&(r=mp(r,null,"F"),n=_i(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next((o=>{const l=Mt(...o);return this.ps.getDocuments(e,l).next((u=>this.indexManager.getMinOffset(e,n).next((h=>{const d=this.Ds(r,u);return this.Cs(r,d,l,h.readTime)?this.ys(e,mp(r,null,"F")):this.vs(e,d,r,h)}))))})))))}ws(e,r,n,a){return Zy(r)||a.isEqual(Et.min())?De.resolve(null):this.ps.getDocuments(e,n).next((o=>{const l=this.Ds(r,o);return this.Cs(r,l,n,a)?De.resolve(null):(Ql()<=zt.DEBUG&&tt("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Zl(r)),this.vs(e,l,r,dM(a,hf)).next((u=>u)))}))}Ds(e,r){let n=new Jr(SS(e));return r.forEach(((a,o)=>{ud(e,o)&&(n=n.add(o))})),n}Cs(e,r,n,a){if(e.limit===null)return!1;if(n.size!==r.size)return!0;const o=e.limitType==="F"?r.last():r.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(a)>0)}Ss(e,r,n){return Ql()<=zt.DEBUG&&tt("QueryEngine","Using full collection scan to execute query:",Zl(r)),this.ps.getDocumentsMatchingQuery(e,r,Ks.min(),n)}vs(e,r,n,a){return this.ps.getDocumentsMatchingQuery(e,n,a).next((o=>(r.forEach((l=>{o=o.insert(l.key,l)})),o)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ig="LocalStore",X7=3e8;class Y7{constructor(e,r,n,a){this.persistence=e,this.Fs=r,this.serializer=a,this.Ms=new kr(Nt),this.xs=new nl((o=>Tg(o)),Eg),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new P7(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(r=>e.collect(r,this.Ms)))}}function K7(t,e,r,n){return new Y7(t,e,r,n)}async function YS(t,e){const r=wt(t);return await r.persistence.runTransaction("Handle user change","readonly",(n=>{let a;return r.mutationQueue.getAllMutationBatches(n).next((o=>(a=o,r.Bs(e),r.mutationQueue.getAllMutationBatches(n)))).next((o=>{const l=[],u=[];let h=Mt();for(const d of a){l.push(d.batchId);for(const p of d.mutations)h=h.add(p.key)}for(const d of o){u.push(d.batchId);for(const p of d.mutations)h=h.add(p.key)}return r.localDocuments.getDocuments(n,h).next((d=>({Ls:d,removedBatchIds:l,addedBatchIds:u})))}))}))}function $7(t,e){const r=wt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",(n=>{const a=e.batch.keys(),o=r.Ns.newChangeBuffer({trackRemovals:!0});return(function(u,h,d,p){const v=d.batch,_=v.keys();let y=De.resolve();return _.forEach((w=>{y=y.next((()=>p.getEntry(h,w))).next((E=>{const S=d.docVersions.get(w);Jt(S!==null,48541),E.version.compareTo(S)<0&&(v.applyToRemoteDocument(E,d),E.isValidDocument()&&(E.setReadTime(d.commitVersion),p.addEntry(E)))}))})),y.next((()=>u.mutationQueue.removeMutationBatch(h,v)))})(r,n,e,o).next((()=>o.apply(n))).next((()=>r.mutationQueue.performConsistencyCheck(n))).next((()=>r.documentOverlayCache.removeOverlaysForBatchId(n,a,e.batch.batchId))).next((()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,(function(u){let h=Mt();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(h=h.add(u.batch.mutations[d].key));return h})(e)))).next((()=>r.localDocuments.getDocuments(n,a)))}))}function KS(t){const e=wt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(r=>e.Pi.getLastRemoteSnapshotVersion(r)))}function Q7(t,e){const r=wt(t),n=e.snapshotVersion;let a=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",(o=>{const l=r.Ns.newChangeBuffer({trackRemovals:!0});a=r.Ms;const u=[];e.targetChanges.forEach(((p,v)=>{const _=a.get(v);if(!_)return;u.push(r.Pi.removeMatchingKeys(o,p.removedDocuments,v).next((()=>r.Pi.addMatchingKeys(o,p.addedDocuments,v))));let y=_.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(v)!==null?y=y.withResumeToken(Tn.EMPTY_BYTE_STRING,Et.min()).withLastLimboFreeSnapshotVersion(Et.min()):p.resumeToken.approximateByteSize()>0&&(y=y.withResumeToken(p.resumeToken,n)),a=a.insert(v,y),(function(E,S,L){return E.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=X7?!0:L.addedDocuments.size+L.modifiedDocuments.size+L.removedDocuments.size>0})(_,y,p)&&u.push(r.Pi.updateTargetData(o,y))}));let h=rs(),d=Mt();if(e.documentUpdates.forEach((p=>{e.resolvedLimboDocuments.has(p)&&u.push(r.persistence.referenceDelegate.updateLimboDocument(o,p))})),u.push(Z7(o,l,e.documentUpdates).next((p=>{h=p.ks,d=p.qs}))),!n.isEqual(Et.min())){const p=r.Pi.getLastRemoteSnapshotVersion(o).next((v=>r.Pi.setTargetsMetadata(o,o.currentSequenceNumber,n)));u.push(p)}return De.waitFor(u).next((()=>l.apply(o))).next((()=>r.localDocuments.getLocalViewOfDocuments(o,h,d))).next((()=>h))})).then((o=>(r.Ms=a,o)))}function Z7(t,e,r){let n=Mt(),a=Mt();return r.forEach((o=>n=n.add(o))),e.getEntries(t,n).next((o=>{let l=rs();return r.forEach(((u,h)=>{const d=o.get(u);h.isFoundDocument()!==d.isFoundDocument()&&(a=a.add(u)),h.isNoDocument()&&h.version.isEqual(Et.min())?(e.removeEntry(u,h.readTime),l=l.insert(u,h)):!d.isValidDocument()||h.version.compareTo(d.version)>0||h.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(h),l=l.insert(u,h)):tt(Ig,"Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",h.version)})),{ks:l,qs:a}}))}function J7(t,e){const r=wt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",(n=>(e===void 0&&(e=vg),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e))))}function eP(t,e){const r=wt(t);return r.persistence.runTransaction("Allocate target","readwrite",(n=>{let a;return r.Pi.getTargetData(n,e).next((o=>o?(a=o,De.resolve(a)):r.Pi.allocateTargetId(n).next((l=>(a=new Vs(e,l,"TargetPurposeListen",n.currentSequenceNumber),r.Pi.addTargetData(n,a).next((()=>a)))))))})).then((n=>{const a=r.Ms.get(n.targetId);return(a===null||n.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(n.targetId,n),r.xs.set(e,n.targetId)),n}))}async function _p(t,e,r){const n=wt(t),a=n.Ms.get(e),o=r?"readwrite":"readwrite-primary";try{r||await n.persistence.runTransaction("Release target",o,(l=>n.persistence.referenceDelegate.removeTarget(l,a)))}catch(l){if(!Sc(l))throw l;tt(Ig,`Failed to update sequence numbers for target ${e}: ${l}`)}n.Ms=n.Ms.remove(e),n.xs.delete(a.target)}function fT(t,e,r){const n=wt(t);let a=Et.min(),o=Mt();return n.persistence.runTransaction("Execute query","readwrite",(l=>(function(h,d,p){const v=wt(h),_=v.xs.get(p);return _!==void 0?De.resolve(v.Ms.get(_)):v.Pi.getTargetData(d,p)})(n,l,_i(e)).next((u=>{if(u)return a=u.lastLimboFreeSnapshotVersion,n.Pi.getMatchingKeysForTargetId(l,u.targetId).next((h=>{o=h}))})).next((()=>n.Fs.getDocumentsMatchingQuery(l,e,r?a:Et.min(),r?o:Mt()))).next((u=>(tP(n,UM(e),u),{documents:u,Qs:o})))))}function tP(t,e,r){let n=t.Os.get(e)||Et.min();r.forEach(((a,o)=>{o.readTime.compareTo(n)>0&&(n=o.readTime)})),t.Os.set(e,n)}class hT{constructor(){this.activeTargetIds=qM()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class rP{constructor(){this.Mo=new hT,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e,r=!0){return r&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,r,n){this.xo[e]=r}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new hT,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nP{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dT="ConnectivityMonitor";class mT{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){tt(dT,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){tt(dT,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ch=null;function yp(){return ch===null?ch=(function(){return 268435456+Math.round(2147483648*Math.random())})():ch++,"0x"+ch.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zm="RestConnection",aP={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class iP{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const r=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Uo=r+"://"+e.host,this.Ko=`projects/${n}/databases/${a}`,this.Wo=this.databaseId.database===Vh?`project_id=${n}`:`project_id=${n}&database_id=${a}`}Go(e,r,n,a,o){const l=yp(),u=this.zo(e,r.toUriEncodedString());tt(zm,`Sending RPC '${e}' ${l}:`,u,n);const h={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(h,a,o);const{host:d}=new URL(u),p=dg(d);return this.Jo(e,u,h,n,p).then((v=>(tt(zm,`Received RPC '${e}' ${l}: `,v),v)),(v=>{throw fc(zm,`RPC '${e}' ${l} failed with error: `,v,"url: ",u,"request:",n),v}))}Ho(e,r,n,a,o,l){return this.Go(e,r,n,a,o)}jo(e,r,n){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Ec})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach(((a,o)=>e[o]=a)),n&&n.headers.forEach(((a,o)=>e[o]=a))}zo(e,r){const n=aP[e];return`${this.Uo}/v1/${r}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sP{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kn="WebChannelConnection";class oP extends iP{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,r,n,a,o){const l=yp();return new Promise(((u,h)=>{const d=new Jw;d.setWithCredentials(!0),d.listenOnce(eS.COMPLETE,(()=>{try{switch(d.getLastErrorCode()){case mh.NO_ERROR:const v=d.getResponseJson();tt(kn,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(v)),u(v);break;case mh.TIMEOUT:tt(kn,`RPC '${e}' ${l} timed out`),h(new st(Pe.DEADLINE_EXCEEDED,"Request time out"));break;case mh.HTTP_ERROR:const _=d.getStatus();if(tt(kn,`RPC '${e}' ${l} failed with status:`,_,"response text:",d.getResponseText()),_>0){let y=d.getResponseJson();Array.isArray(y)&&(y=y[0]);const w=y?.error;if(w&&w.status&&w.message){const E=(function(L){const z=L.toLowerCase().replace(/_/g,"-");return Object.values(Pe).indexOf(z)>=0?z:Pe.UNKNOWN})(w.status);h(new st(E,w.message))}else h(new st(Pe.UNKNOWN,"Server responded with status "+d.getStatus()))}else h(new st(Pe.UNAVAILABLE,"Connection failed."));break;default:xt(9055,{l_:e,streamId:l,h_:d.getLastErrorCode(),P_:d.getLastError()})}}finally{tt(kn,`RPC '${e}' ${l} completed.`)}}));const p=JSON.stringify(a);tt(kn,`RPC '${e}' ${l} sending request:`,a),d.send(r,"POST",p,n,15)}))}T_(e,r,n){const a=yp(),o=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=nS(),u=rS(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(h.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(h.useFetchStreams=!0),this.jo(h.initMessageHeaders,r,n),h.encodeInitMessageHeaders=!0;const p=o.join("");tt(kn,`Creating RPC '${e}' stream ${a}: ${p}`,h);const v=l.createWebChannel(p,h);this.I_(v);let _=!1,y=!1;const w=new sP({Yo:S=>{y?tt(kn,`Not sending because RPC '${e}' stream ${a} is closed:`,S):(_||(tt(kn,`Opening RPC '${e}' stream ${a} transport.`),v.open(),_=!0),tt(kn,`RPC '${e}' stream ${a} sending:`,S),v.send(S))},Zo:()=>v.close()}),E=(S,L,z)=>{S.listen(L,(O=>{try{z(O)}catch(ee){setTimeout((()=>{throw ee}),0)}}))};return E(v,Du.EventType.OPEN,(()=>{y||(tt(kn,`RPC '${e}' stream ${a} transport opened.`),w.o_())})),E(v,Du.EventType.CLOSE,(()=>{y||(y=!0,tt(kn,`RPC '${e}' stream ${a} transport closed`),w.a_(),this.E_(v))})),E(v,Du.EventType.ERROR,(S=>{y||(y=!0,fc(kn,`RPC '${e}' stream ${a} transport errored. Name:`,S.name,"Message:",S.message),w.a_(new st(Pe.UNAVAILABLE,"The operation could not be completed")))})),E(v,Du.EventType.MESSAGE,(S=>{if(!y){const L=S.data[0];Jt(!!L,16349);const z=L,O=z?.error||z[0]?.error;if(O){tt(kn,`RPC '${e}' stream ${a} received error:`,O);const ee=O.status;let te=(function(I){const R=Hr[I];if(R!==void 0)return PS(R)})(ee),Z=O.message;te===void 0&&(te=Pe.INTERNAL,Z="Unknown error status: "+ee+" with message "+O.message),y=!0,w.a_(new st(te,Z)),v.close()}else tt(kn,`RPC '${e}' stream ${a} received:`,L),w.u_(L)}})),E(u,tS.STAT_EVENT,(S=>{S.stat===lp.PROXY?tt(kn,`RPC '${e}' stream ${a} detected buffering proxy`):S.stat===lp.NOPROXY&&tt(kn,`RPC '${e}' stream ${a} detected no buffering proxy`)})),setTimeout((()=>{w.__()}),0),w}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((r=>r===e))}}function Hm(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function md(t){return new f7(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $S{constructor(e,r,n=1e3,a=1.5,o=6e4){this.Mi=e,this.timerId=r,this.d_=n,this.A_=a,this.R_=o,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const r=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),a=Math.max(0,r-n);a>0&&tt("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.V_} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,a,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pT="PersistentStream";class QS{constructor(e,r,n,a,o,l,u,h){this.Mi=e,this.S_=n,this.b_=a,this.connection=o,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=u,this.listener=h,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new $S(e,r)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,r){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():r&&r.code===Pe.RESOURCE_EXHAUSTED?(ts(r.toString()),ts("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):r&&r.code===Pe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(r)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),r=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([n,a])=>{this.D_===r&&this.G_(n,a)}),(n=>{e((()=>{const a=new st(Pe.UNKNOWN,"Fetching auth token failed: "+n.message);return this.z_(a)}))}))}G_(e,r){const n=this.W_(this.D_);this.stream=this.j_(e,r),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((a=>{n((()=>this.z_(a)))})),this.stream.onMessage((a=>{n((()=>++this.F_==1?this.J_(a):this.onNext(a)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return tt(pT,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return r=>{this.Mi.enqueueAndForget((()=>this.D_===e?r():(tt(pT,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class lP extends QS{constructor(e,r,n,a,o,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,n,a,l),this.serializer=o}j_(e,r){return this.connection.T_("Listen",e,r)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const r=m7(this.serializer,e),n=(function(o){if(!("targetChange"in o))return Et.min();const l=o.targetChange;return l.targetIds&&l.targetIds.length?Et.min():l.readTime?yi(l.readTime):Et.min()})(e);return this.listener.H_(r,n)}Y_(e){const r={};r.database=vp(this.serializer),r.addTarget=(function(o,l){let u;const h=l.target;if(u=dp(h)?{documents:x7(o,h)}:{query:v7(o,h).ft},u.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){u.resumeToken=VS(o,l.resumeToken);const d=pp(o,l.expectedCount);d!==null&&(u.expectedCount=d)}else if(l.snapshotVersion.compareTo(Et.min())>0){u.readTime=Gh(o,l.snapshotVersion.toTimestamp());const d=pp(o,l.expectedCount);d!==null&&(u.expectedCount=d)}return u})(this.serializer,e);const n=y7(this.serializer,e);n&&(r.labels=n),this.q_(r)}Z_(e){const r={};r.database=vp(this.serializer),r.removeTarget=e,this.q_(r)}}class cP extends QS{constructor(e,r,n,a,o,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,a,l),this.serializer=o}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,r){return this.connection.T_("Write",e,r)}J_(e){return Jt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Jt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){Jt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const r=g7(e.writeResults,e.commitTime),n=yi(e.commitTime);return this.listener.na(n,r)}ra(){const e={};e.database=vp(this.serializer),this.q_(e)}ea(e){const r={streamToken:this.lastStreamToken,writes:e.map((n=>p7(this.serializer,n)))};this.q_(r)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uP{}class fP extends uP{constructor(e,r,n,a){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new st(Pe.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,r,n,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,l])=>this.connection.Go(e,gp(r,n),a,o,l))).catch((o=>{throw o.name==="FirebaseError"?(o.code===Pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new st(Pe.UNKNOWN,o.toString())}))}Ho(e,r,n,a,o){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,u])=>this.connection.Ho(e,gp(r,n),a,l,u,o))).catch((l=>{throw l.name==="FirebaseError"?(l.code===Pe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new st(Pe.UNKNOWN,l.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class hP{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(ts(r),this.aa=!1):tt("OnlineStateTracker",r)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ko="RemoteStore";class dP{constructor(e,r,n,a,o){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=o,this.Aa.Oo((l=>{n.enqueueAndForget((async()=>{il(this)&&(tt(Ko,"Restarting streams for network reachability change."),await(async function(h){const d=wt(h);d.Ea.add(4),await Df(d),d.Ra.set("Unknown"),d.Ea.delete(4),await pd(d)})(this))}))})),this.Ra=new hP(n,a)}}async function pd(t){if(il(t))for(const e of t.da)await e(!0)}async function Df(t){for(const e of t.da)await e(!1)}function ZS(t,e){const r=wt(t);r.Ia.has(e.targetId)||(r.Ia.set(e.targetId,e),Mg(r)?Ng(r):Ac(r).O_()&&Fg(r,e))}function Og(t,e){const r=wt(t),n=Ac(r);r.Ia.delete(e),n.O_()&&JS(r,e),r.Ia.size===0&&(n.O_()?n.L_():il(r)&&r.Ra.set("Unknown"))}function Fg(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Et.min())>0){const r=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(r)}Ac(t).Y_(e)}function JS(t,e){t.Va.Ue(e),Ac(t).Z_(e)}function Ng(t){t.Va=new o7({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),Ac(t).start(),t.Ra.ua()}function Mg(t){return il(t)&&!Ac(t).x_()&&t.Ia.size>0}function il(t){return wt(t).Ea.size===0}function e4(t){t.Va=void 0}async function mP(t){t.Ra.set("Online")}async function pP(t){t.Ia.forEach(((e,r)=>{Fg(t,e)}))}async function gP(t,e){e4(t),Mg(t)?(t.Ra.ha(e),Ng(t)):t.Ra.set("Unknown")}async function xP(t,e,r){if(t.Ra.set("Online"),e instanceof BS&&e.state===2&&e.cause)try{await(async function(a,o){const l=o.cause;for(const u of o.targetIds)a.Ia.has(u)&&(await a.remoteSyncer.rejectListen(u,l),a.Ia.delete(u),a.Va.removeTarget(u))})(t,e)}catch(n){tt(Ko,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Xh(t,n)}else if(e instanceof vh?t.Va.Ze(e):e instanceof LS?t.Va.st(e):t.Va.tt(e),!r.isEqual(Et.min()))try{const n=await KS(t.localStore);r.compareTo(n)>=0&&await(function(o,l){const u=o.Va.Tt(l);return u.targetChanges.forEach(((h,d)=>{if(h.resumeToken.approximateByteSize()>0){const p=o.Ia.get(d);p&&o.Ia.set(d,p.withResumeToken(h.resumeToken,l))}})),u.targetMismatches.forEach(((h,d)=>{const p=o.Ia.get(h);if(!p)return;o.Ia.set(h,p.withResumeToken(Tn.EMPTY_BYTE_STRING,p.snapshotVersion)),JS(o,h);const v=new Vs(p.target,h,d,p.sequenceNumber);Fg(o,v)})),o.remoteSyncer.applyRemoteEvent(u)})(t,r)}catch(n){tt(Ko,"Failed to raise snapshot:",n),await Xh(t,n)}}async function Xh(t,e,r){if(!Sc(e))throw e;t.Ea.add(1),await Df(t),t.Ra.set("Offline"),r||(r=()=>KS(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{tt(Ko,"Retrying IndexedDB access"),await r(),t.Ea.delete(1),await pd(t)}))}function t4(t,e){return e().catch((r=>Xh(t,r,e)))}async function gd(t){const e=wt(t),r=Js(e);let n=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:vg;for(;vP(e);)try{const a=await J7(e.localStore,n);if(a===null){e.Ta.length===0&&r.L_();break}n=a.batchId,_P(e,a)}catch(a){await Xh(e,a)}r4(e)&&n4(e)}function vP(t){return il(t)&&t.Ta.length<10}function _P(t,e){t.Ta.push(e);const r=Js(t);r.O_()&&r.X_&&r.ea(e.mutations)}function r4(t){return il(t)&&!Js(t).x_()&&t.Ta.length>0}function n4(t){Js(t).start()}async function yP(t){Js(t).ra()}async function TP(t){const e=Js(t);for(const r of t.Ta)e.ea(r.mutations)}async function EP(t,e,r){const n=t.Ta.shift(),a=Ag.from(n,e,r);await t4(t,(()=>t.remoteSyncer.applySuccessfulWrite(a))),await gd(t)}async function wP(t,e){e&&Js(t).X_&&await(async function(n,a){if((function(l){return a7(l)&&l!==Pe.ABORTED})(a.code)){const o=n.Ta.shift();Js(n).B_(),await t4(n,(()=>n.remoteSyncer.rejectFailedWrite(o.batchId,a))),await gd(n)}})(t,e),r4(t)&&n4(t)}async function gT(t,e){const r=wt(t);r.asyncQueue.verifyOperationInProgress(),tt(Ko,"RemoteStore received new credentials");const n=il(r);r.Ea.add(3),await Df(r),n&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(e),r.Ea.delete(3),await pd(r)}async function SP(t,e){const r=wt(t);e?(r.Ea.delete(2),await pd(r)):e||(r.Ea.add(2),await Df(r),r.Ra.set("Unknown"))}function Ac(t){return t.ma||(t.ma=(function(r,n,a){const o=wt(r);return o.sa(),new lP(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,a)})(t.datastore,t.asyncQueue,{Xo:mP.bind(null,t),t_:pP.bind(null,t),r_:gP.bind(null,t),H_:xP.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),Mg(t)?Ng(t):t.Ra.set("Unknown")):(await t.ma.stop(),e4(t))}))),t.ma}function Js(t){return t.fa||(t.fa=(function(r,n,a){const o=wt(r);return o.sa(),new cP(n,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,a)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:yP.bind(null,t),r_:wP.bind(null,t),ta:TP.bind(null,t),na:EP.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await gd(t)):(await t.fa.stop(),t.Ta.length>0&&(tt(Ko,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pg{constructor(e,r,n,a,o){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=a,this.removalCallback=o,this.deferred=new Ws,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,a,o){const l=Date.now()+n,u=new Pg(e,r,l,a,o);return u.start(n),u}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new st(Pe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Lg(t,e){if(ts("AsyncQueue",`${e}: ${t}`),Sc(t))return new st(Pe.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oc{static emptySet(e){return new oc(e.comparator)}constructor(e){this.comparator=e?(r,n)=>e(r,n)||ct.comparator(r.key,n.key):(r,n)=>ct.comparator(r.key,n.key),this.keyedMap=Iu(),this.sortedSet=new kr(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const r=this.keyedMap.get(e);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((r,n)=>(e(r),!1)))}add(e){const r=this.delete(e.key);return r.copy(r.keyedMap.insert(e.key,e),r.sortedSet.insert(e,null))}delete(e){const r=this.get(e);return r?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(r)):this}isEqual(e){if(!(e instanceof oc)||this.size!==e.size)return!1;const r=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;r.hasNext();){const a=r.getNext().key,o=n.getNext().key;if(!a.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach((r=>{e.push(r.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,r){const n=new oc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=r,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xT{constructor(){this.ga=new kr(ct.comparator)}track(e){const r=e.doc.key,n=this.ga.get(r);n?e.type!==0&&n.type===3?this.ga=this.ga.insert(r,e):e.type===3&&n.type!==1?this.ga=this.ga.insert(r,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.ga=this.ga.insert(r,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.ga=this.ga.remove(r):e.type===1&&n.type===2?this.ga=this.ga.insert(r,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.ga=this.ga.insert(r,{type:2,doc:e.doc}):xt(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(r,e)}ya(){const e=[];return this.ga.inorderTraversal(((r,n)=>{e.push(n)})),e}}class gc{constructor(e,r,n,a,o,l,u,h,d){this.query=e,this.docs=r,this.oldDocs=n,this.docChanges=a,this.mutatedKeys=o,this.fromCache=l,this.syncStateChanged=u,this.excludesMetadataChanges=h,this.hasCachedResults=d}static fromInitialDocuments(e,r,n,a,o){const l=[];return r.forEach((u=>{l.push({type:0,doc:u})})),new gc(e,r,oc.emptySet(r),l,n,a,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&cd(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const r=this.docChanges,n=e.docChanges;if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(r[a].type!==n[a].type||!r[a].doc.isEqual(n[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AP{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class kP{constructor(){this.queries=vT(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(r,n){const a=wt(r),o=a.queries;a.queries=vT(),o.forEach(((l,u)=>{for(const h of u.Sa)h.onError(n)}))})(this,new st(Pe.ABORTED,"Firestore shutting down"))}}function vT(){return new nl((t=>wS(t)),cd)}async function bP(t,e){const r=wt(t);let n=3;const a=e.query;let o=r.queries.get(a);o?!o.ba()&&e.Da()&&(n=2):(o=new AP,n=e.Da()?0:1);try{switch(n){case 0:o.wa=await r.onListen(a,!0);break;case 1:o.wa=await r.onListen(a,!1);break;case 2:await r.onFirstRemoteStoreListen(a)}}catch(l){const u=Lg(l,`Initialization of query '${Zl(e.query)}' failed`);return void e.onError(u)}r.queries.set(a,o),o.Sa.push(e),e.va(r.onlineState),o.wa&&e.Fa(o.wa)&&Bg(r)}async function CP(t,e){const r=wt(t),n=e.query;let a=3;const o=r.queries.get(n);if(o){const l=o.Sa.indexOf(e);l>=0&&(o.Sa.splice(l,1),o.Sa.length===0?a=e.Da()?0:1:!o.ba()&&e.Da()&&(a=2))}switch(a){case 0:return r.queries.delete(n),r.onUnlisten(n,!0);case 1:return r.queries.delete(n),r.onUnlisten(n,!1);case 2:return r.onLastRemoteStoreUnlisten(n);default:return}}function RP(t,e){const r=wt(t);let n=!1;for(const a of e){const o=a.query,l=r.queries.get(o);if(l){for(const u of l.Sa)u.Fa(a)&&(n=!0);l.wa=a}}n&&Bg(r)}function DP(t,e,r){const n=wt(t),a=n.queries.get(e);if(a)for(const o of a.Sa)o.onError(r);n.queries.delete(e)}function Bg(t){t.Ca.forEach((e=>{e.next()}))}var Tp,_T;(_T=Tp||(Tp={})).Ma="default",_T.Cache="cache";class IP{constructor(e,r,n){this.query=e,this.xa=r,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const n=[];for(const a of e.docChanges)a.type!==3&&n.push(a);e=new gc(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let r=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),r=!0):this.La(e,this.onlineState)&&(this.ka(e),r=!0),this.Na=e,r}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let r=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),r=!0),r}La(e,r){if(!e.fromCache||!this.Da())return!0;const n=r!=="Offline";return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||r==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const r=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!r)&&this.options.includeMetadataChanges===!0}ka(e){e=gc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Tp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a4{constructor(e){this.key=e}}class i4{constructor(e){this.key=e}}class OP{constructor(e,r){this.query=e,this.Ya=r,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Mt(),this.mutatedKeys=Mt(),this.eu=SS(e),this.tu=new oc(this.eu)}get nu(){return this.Ya}ru(e,r){const n=r?r.iu:new xT,a=r?r.tu:this.tu;let o=r?r.mutatedKeys:this.mutatedKeys,l=a,u=!1;const h=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,d=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal(((p,v)=>{const _=a.get(p),y=ud(this.query,v)?v:null,w=!!_&&this.mutatedKeys.has(_.key),E=!!y&&(y.hasLocalMutations||this.mutatedKeys.has(y.key)&&y.hasCommittedMutations);let S=!1;_&&y?_.data.isEqual(y.data)?w!==E&&(n.track({type:3,doc:y}),S=!0):this.su(_,y)||(n.track({type:2,doc:y}),S=!0,(h&&this.eu(y,h)>0||d&&this.eu(y,d)<0)&&(u=!0)):!_&&y?(n.track({type:0,doc:y}),S=!0):_&&!y&&(n.track({type:1,doc:_}),S=!0,(h||d)&&(u=!0)),S&&(y?(l=l.add(y),o=E?o.add(p):o.delete(p)):(l=l.delete(p),o=o.delete(p)))})),this.query.limit!==null)for(;l.size>this.query.limit;){const p=this.query.limitType==="F"?l.last():l.first();l=l.delete(p.key),o=o.delete(p.key),n.track({type:1,doc:p})}return{tu:l,iu:n,Cs:u,mutatedKeys:o}}su(e,r){return e.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(e,r,n,a){const o=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const l=e.iu.ya();l.sort(((p,v)=>(function(y,w){const E=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return xt(20277,{Rt:S})}};return E(y)-E(w)})(p.type,v.type)||this.eu(p.doc,v.doc))),this.ou(n),a=a??!1;const u=r&&!a?this._u():[],h=this.Xa.size===0&&this.current&&!a?1:0,d=h!==this.Za;return this.Za=h,l.length!==0||d?{snapshot:new gc(this.query,e.tu,o,l,e.mutatedKeys,h===0,d,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:u}:{au:u}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new xT,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((r=>this.Ya=this.Ya.add(r))),e.modifiedDocuments.forEach((r=>{})),e.removedDocuments.forEach((r=>this.Ya=this.Ya.delete(r))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Mt(),this.tu.forEach((n=>{this.uu(n.key)&&(this.Xa=this.Xa.add(n.key))}));const r=[];return e.forEach((n=>{this.Xa.has(n)||r.push(new i4(n))})),this.Xa.forEach((n=>{e.has(n)||r.push(new a4(n))})),r}cu(e){this.Ya=e.Qs,this.Xa=Mt();const r=this.ru(e.documents);return this.applyChanges(r,!0)}lu(){return gc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const Vg="SyncEngine";class FP{constructor(e,r,n){this.query=e,this.targetId=r,this.view=n}}class NP{constructor(e){this.key=e,this.hu=!1}}class MP{constructor(e,r,n,a,o,l){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=a,this.currentUser=o,this.maxConcurrentLimboResolutions=l,this.Pu={},this.Tu=new nl((u=>wS(u)),cd),this.Iu=new Map,this.Eu=new Set,this.du=new kr(ct.comparator),this.Au=new Map,this.Ru=new Cg,this.Vu={},this.mu=new Map,this.fu=pc.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function PP(t,e,r=!0){const n=f4(t);let a;const o=n.Tu.get(e);return o?(n.sharedClientState.addLocalQueryTarget(o.targetId),a=o.view.lu()):a=await s4(n,e,r,!0),a}async function LP(t,e){const r=f4(t);await s4(r,e,!0,!1)}async function s4(t,e,r,n){const a=await eP(t.localStore,_i(e)),o=a.targetId,l=t.sharedClientState.addLocalQueryTarget(o,r);let u;return n&&(u=await BP(t,e,o,l==="current",a.resumeToken)),t.isPrimaryClient&&r&&ZS(t.remoteStore,a),u}async function BP(t,e,r,n,a){t.pu=(v,_,y)=>(async function(E,S,L,z){let O=S.view.ru(L);O.Cs&&(O=await fT(E.localStore,S.query,!1).then((({documents:C})=>S.view.ru(C,O))));const ee=z&&z.targetChanges.get(S.targetId),te=z&&z.targetMismatches.get(S.targetId)!=null,Z=S.view.applyChanges(O,E.isPrimaryClient,ee,te);return TT(E,S.targetId,Z.au),Z.snapshot})(t,v,_,y);const o=await fT(t.localStore,e,!0),l=new OP(e,o.Qs),u=l.ru(o.documents),h=Rf.createSynthesizedTargetChangeForCurrentChange(r,n&&t.onlineState!=="Offline",a),d=l.applyChanges(u,t.isPrimaryClient,h);TT(t,r,d.au);const p=new FP(e,r,l);return t.Tu.set(e,p),t.Iu.has(r)?t.Iu.get(r).push(e):t.Iu.set(r,[e]),d.snapshot}async function VP(t,e,r){const n=wt(t),a=n.Tu.get(e),o=n.Iu.get(a.targetId);if(o.length>1)return n.Iu.set(a.targetId,o.filter((l=>!cd(l,e)))),void n.Tu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(a.targetId),n.sharedClientState.isActiveQueryTarget(a.targetId)||await _p(n.localStore,a.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(a.targetId),r&&Og(n.remoteStore,a.targetId),Ep(n,a.targetId)})).catch(wc)):(Ep(n,a.targetId),await _p(n.localStore,a.targetId,!0))}async function UP(t,e){const r=wt(t),n=r.Tu.get(e),a=r.Iu.get(n.targetId);r.isPrimaryClient&&a.length===1&&(r.sharedClientState.removeLocalQueryTarget(n.targetId),Og(r.remoteStore,n.targetId))}async function jP(t,e,r){const n=YP(t);try{const a=await(function(l,u){const h=wt(l),d=xr.now(),p=u.reduce(((y,w)=>y.add(w.key)),Mt());let v,_;return h.persistence.runTransaction("Locally write mutations","readwrite",(y=>{let w=rs(),E=Mt();return h.Ns.getEntries(y,p).next((S=>{w=S,w.forEach(((L,z)=>{z.isValidDocument()||(E=E.add(L))}))})).next((()=>h.localDocuments.getOverlayedDocuments(y,w))).next((S=>{v=S;const L=[];for(const z of u){const O=JM(z,v.get(z.key).overlayedDocument);O!=null&&L.push(new al(z.key,O,gS(O.value.mapValue),Zi.exists(!0)))}return h.mutationQueue.addMutationBatch(y,d,L,u)})).next((S=>{_=S;const L=S.applyToLocalDocumentSet(v,E);return h.documentOverlayCache.saveOverlays(y,S.batchId,L)}))})).then((()=>({batchId:_.batchId,changes:kS(v)})))})(n.localStore,e);n.sharedClientState.addPendingMutation(a.batchId),(function(l,u,h){let d=l.Vu[l.currentUser.toKey()];d||(d=new kr(Nt)),d=d.insert(u,h),l.Vu[l.currentUser.toKey()]=d})(n,a.batchId,r),await If(n,a.changes),await gd(n.remoteStore)}catch(a){const o=Lg(a,"Failed to persist write");r.reject(o)}}async function o4(t,e){const r=wt(t);try{const n=await Q7(r.localStore,e);e.targetChanges.forEach(((a,o)=>{const l=r.Au.get(o);l&&(Jt(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?l.hu=!0:a.modifiedDocuments.size>0?Jt(l.hu,14607):a.removedDocuments.size>0&&(Jt(l.hu,42227),l.hu=!1))})),await If(r,n,e)}catch(n){await wc(n)}}function yT(t,e,r){const n=wt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){const a=[];n.Tu.forEach(((o,l)=>{const u=l.view.va(e);u.snapshot&&a.push(u.snapshot)})),(function(l,u){const h=wt(l);h.onlineState=u;let d=!1;h.queries.forEach(((p,v)=>{for(const _ of v.Sa)_.va(u)&&(d=!0)})),d&&Bg(h)})(n.eventManager,e),a.length&&n.Pu.H_(a),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function zP(t,e,r){const n=wt(t);n.sharedClientState.updateQueryState(e,"rejected",r);const a=n.Au.get(e),o=a&&a.key;if(o){let l=new kr(ct.comparator);l=l.insert(o,In.newNoDocument(o,Et.min()));const u=Mt().add(o),h=new dd(Et.min(),new Map,new kr(Nt),l,u);await o4(n,h),n.du=n.du.remove(o),n.Au.delete(e),Ug(n)}else await _p(n.localStore,e,!1).then((()=>Ep(n,e,r))).catch(wc)}async function HP(t,e){const r=wt(t),n=e.batch.batchId;try{const a=await $7(r.localStore,e);c4(r,n,null),l4(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),await If(r,a)}catch(a){await wc(a)}}async function WP(t,e,r){const n=wt(t);try{const a=await(function(l,u){const h=wt(l);return h.persistence.runTransaction("Reject batch","readwrite-primary",(d=>{let p;return h.mutationQueue.lookupMutationBatch(d,u).next((v=>(Jt(v!==null,37113),p=v.keys(),h.mutationQueue.removeMutationBatch(d,v)))).next((()=>h.mutationQueue.performConsistencyCheck(d))).next((()=>h.documentOverlayCache.removeOverlaysForBatchId(d,p,u))).next((()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p))).next((()=>h.localDocuments.getDocuments(d,p)))}))})(n.localStore,e);c4(n,e,r),l4(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),await If(n,a)}catch(a){await wc(a)}}function l4(t,e){(t.mu.get(e)||[]).forEach((r=>{r.resolve()})),t.mu.delete(e)}function c4(t,e,r){const n=wt(t);let a=n.Vu[n.currentUser.toKey()];if(a){const o=a.get(e);o&&(r?o.reject(r):o.resolve(),a=a.remove(e)),n.Vu[n.currentUser.toKey()]=a}}function Ep(t,e,r=null){t.sharedClientState.removeLocalQueryTarget(e);for(const n of t.Iu.get(e))t.Tu.delete(n),r&&t.Pu.yu(n,r);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((n=>{t.Ru.containsKey(n)||u4(t,n)}))}function u4(t,e){t.Eu.delete(e.path.canonicalString());const r=t.du.get(e);r!==null&&(Og(t.remoteStore,r),t.du=t.du.remove(e),t.Au.delete(r),Ug(t))}function TT(t,e,r){for(const n of r)n instanceof a4?(t.Ru.addReference(n.key,e),GP(t,n)):n instanceof i4?(tt(Vg,"Document no longer in limbo: "+n.key),t.Ru.removeReference(n.key,e),t.Ru.containsKey(n.key)||u4(t,n.key)):xt(19791,{wu:n})}function GP(t,e){const r=e.key,n=r.path.canonicalString();t.du.get(r)||t.Eu.has(n)||(tt(Vg,"New document in limbo: "+r),t.Eu.add(n),Ug(t))}function Ug(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const r=new ct(wr.fromString(e)),n=t.fu.next();t.Au.set(n,new NP(r)),t.du=t.du.insert(r,n),ZS(t.remoteStore,new Vs(_i(wg(r.path)),n,"TargetPurposeLimboResolution",id.ce))}}async function If(t,e,r){const n=wt(t),a=[],o=[],l=[];n.Tu.isEmpty()||(n.Tu.forEach(((u,h)=>{l.push(n.pu(h,e,r).then((d=>{if((d||r)&&n.isPrimaryClient){const p=d?!d.fromCache:r?.targetChanges.get(h.targetId)?.current;n.sharedClientState.updateQueryState(h.targetId,p?"current":"not-current")}if(d){a.push(d);const p=Dg.As(h.targetId,d);o.push(p)}})))})),await Promise.all(l),n.Pu.H_(a),await(async function(h,d){const p=wt(h);try{await p.persistence.runTransaction("notifyLocalViewChanges","readwrite",(v=>De.forEach(d,(_=>De.forEach(_.Es,(y=>p.persistence.referenceDelegate.addReference(v,_.targetId,y))).next((()=>De.forEach(_.ds,(y=>p.persistence.referenceDelegate.removeReference(v,_.targetId,y)))))))))}catch(v){if(!Sc(v))throw v;tt(Ig,"Failed to update sequence numbers: "+v)}for(const v of d){const _=v.targetId;if(!v.fromCache){const y=p.Ms.get(_),w=y.snapshotVersion,E=y.withLastLimboFreeSnapshotVersion(w);p.Ms=p.Ms.insert(_,E)}}})(n.localStore,o))}async function qP(t,e){const r=wt(t);if(!r.currentUser.isEqual(e)){tt(Vg,"User change. New user:",e.toKey());const n=await YS(r.localStore,e);r.currentUser=e,(function(o,l){o.mu.forEach((u=>{u.forEach((h=>{h.reject(new st(Pe.CANCELLED,l))}))})),o.mu.clear()})(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await If(r,n.Ls)}}function XP(t,e){const r=wt(t),n=r.Au.get(e);if(n&&n.hu)return Mt().add(n.key);{let a=Mt();const o=r.Iu.get(e);if(!o)return a;for(const l of o){const u=r.Tu.get(l);a=a.unionWith(u.view.nu)}return a}}function f4(t){const e=wt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=o4.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=XP.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=zP.bind(null,e),e.Pu.H_=RP.bind(null,e.eventManager),e.Pu.yu=DP.bind(null,e.eventManager),e}function YP(t){const e=wt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=HP.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=WP.bind(null,e),e}class Yh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=md(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,r){return null}Mu(e,r){return null}vu(e){return K7(this.persistence,new q7,e.initialUser,this.serializer)}Cu(e){return new XS(Rg.mi,this.serializer)}Du(e){return new rP}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Yh.provider={build:()=>new Yh};class KP extends Yh{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,r){Jt(this.persistence.referenceDelegate instanceof qh,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new I7(n,e.asyncQueue,r)}Cu(e){const r=this.cacheSizeBytes!==void 0?Qn.withCacheSize(this.cacheSizeBytes):Qn.DEFAULT;return new XS((n=>qh.mi(n,r)),this.serializer)}}class wp{async initialize(e,r){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>yT(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=qP.bind(null,this.syncEngine),await SP(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new kP})()}createDatastore(e){const r=md(e.databaseInfo.databaseId),n=(function(o){return new oP(o)})(e.databaseInfo);return(function(o,l,u,h){return new fP(o,l,u,h)})(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return(function(n,a,o,l,u){return new dP(n,a,o,l,u)})(this.localStore,this.datastore,e.asyncQueue,(r=>yT(this.syncEngine,r,0)),(function(){return mT.v()?new mT:new nP})())}createSyncEngine(e,r){return(function(a,o,l,u,h,d,p){const v=new MP(a,o,l,u,h,d);return p&&(v.gu=!0),v})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}async terminate(){await(async function(r){const n=wt(r);tt(Ko,"RemoteStore shutting down."),n.Ea.add(5),await Df(n),n.Aa.shutdown(),n.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}wp.provider={build:()=>new wp};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $P{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):ts("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,r){setTimeout((()=>{this.muted||e(r)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eo="FirestoreClient";class QP{constructor(e,r,n,a,o){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=a,this.user=Cn.UNAUTHENTICATED,this.clientId=gg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(n,(async l=>{tt(eo,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(n,(l=>(tt(eo,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ws;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){const n=Lg(r,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function Wm(t,e){t.asyncQueue.verifyOperationInProgress(),tt(eo,"Initializing OfflineComponentProvider");const r=t.configuration;await e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener((async a=>{n.isEqual(a)||(await YS(e.localStore,a),n=a)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function ET(t,e){t.asyncQueue.verifyOperationInProgress();const r=await ZP(t);tt(eo,"Initializing OnlineComponentProvider"),await e.initialize(r,t.configuration),t.setCredentialChangeListener((n=>gT(e.remoteStore,n))),t.setAppCheckTokenChangeListener(((n,a)=>gT(e.remoteStore,a))),t._onlineComponents=e}async function ZP(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){tt(eo,"Using user provided OfflineComponentProvider");try{await Wm(t,t._uninitializedComponentsProvider._offline)}catch(e){const r=e;if(!(function(a){return a.name==="FirebaseError"?a.code===Pe.FAILED_PRECONDITION||a.code===Pe.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11})(r))throw r;fc("Error using user provided cache. Falling back to memory cache: "+r),await Wm(t,new Yh)}}else tt(eo,"Using default OfflineComponentProvider"),await Wm(t,new KP(void 0));return t._offlineComponents}async function h4(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(tt(eo,"Using user provided OnlineComponentProvider"),await ET(t,t._uninitializedComponentsProvider._online)):(tt(eo,"Using default OnlineComponentProvider"),await ET(t,new wp))),t._onlineComponents}function JP(t){return h4(t).then((e=>e.syncEngine))}async function eL(t){const e=await h4(t),r=e.eventManager;return r.onListen=PP.bind(null,e.syncEngine),r.onUnlisten=VP.bind(null,e.syncEngine),r.onFirstRemoteStoreListen=LP.bind(null,e.syncEngine),r.onLastRemoteStoreUnlisten=UP.bind(null,e.syncEngine),r}function tL(t,e,r={}){const n=new Ws;return t.asyncQueue.enqueueAndForget((async()=>(function(o,l,u,h,d){const p=new $P({next:_=>{p.Nu(),l.enqueueAndForget((()=>CP(o,v)));const y=_.docs.has(u);!y&&_.fromCache?d.reject(new st(Pe.UNAVAILABLE,"Failed to get document because the client is offline.")):y&&_.fromCache&&h&&h.source==="server"?d.reject(new st(Pe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(_)},error:_=>d.reject(_)}),v=new IP(wg(u.path),p,{includeMetadataChanges:!0,qa:!0});return bP(o,v)})(await eL(t),t.asyncQueue,e,r,n))),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d4(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wT=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m4="firestore.googleapis.com",ST=!0;class AT{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new st(Pe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=m4,this.ssl=ST}else this.host=e.host,this.ssl=e.ssl??ST;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=qS;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<R7)throw new st(Pe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}hM("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=d4(e.experimentalLongPollingOptions??{}),(function(n){if(n.timeoutSeconds!==void 0){if(isNaN(n.timeoutSeconds))throw new st(Pe.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (must not be NaN)`);if(n.timeoutSeconds<5)throw new st(Pe.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (minimum allowed value is 5)`);if(n.timeoutSeconds>30)throw new st(Pe.INVALID_ARGUMENT,`invalid long polling timeout: ${n.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(n,a){return n.timeoutSeconds===a.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class jg{constructor(e,r,n,a){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new AT({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new st(Pe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new st(Pe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new AT(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(n){if(!n)return new tM;switch(n.type){case"firstParty":return new iM(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new st(Pe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(r){const n=wT.get(r);n&&(tt("ComponentProvider","Removing Datastore"),wT.delete(r),n.terminate())})(this),Promise.resolve()}}function rL(t,e,r,n={}){t=ff(t,jg);const a=dg(e),o=t._getSettings(),l={...o,emulatorOptions:t._getEmulatorOptions()},u=`${e}:${r}`;a&&(CN(`https://${u}`),ON("Firestore",!0)),o.host!==m4&&o.host!==u&&fc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const h={...o,host:u,ssl:a,emulatorOptions:n};if(!Nh(h,l)&&(t._setSettings(h),n.mockUserToken)){let d,p;if(typeof n.mockUserToken=="string")d=n.mockUserToken,p=Cn.MOCK_USER;else{d=RN(n.mockUserToken,t._app?.options.projectId);const v=n.mockUserToken.sub||n.mockUserToken.user_id;if(!v)throw new st(Pe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new Cn(v)}t._authCredentials=new rM(new iS(d,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zg{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new zg(this.firestore,e,this._query)}}class fn{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new vf(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new fn(this.firestore,e,this._key)}toJSON(){return{type:fn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,r,n){if(bf(r,fn._jsonSchema))return new fn(e,n||null,new ct(wr.fromString(r.referencePath)))}}fn._jsonSchemaVersion="firestore/documentReference/1.0",fn._jsonSchema={type:qr("string",fn._jsonSchemaVersion),referencePath:qr("string")};class vf extends zg{constructor(e,r,n){super(e,r,wg(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new fn(this.firestore,null,new ct(e))}withConverter(e){return new vf(this.firestore,e,this._path)}}function xd(t,e,...r){if(t=Mh(t),arguments.length===1&&(e=gg.newId()),fM("doc","path",e),t instanceof jg){const n=wr.fromString(e,...r);return Vy(n),new fn(t,null,new ct(n))}{if(!(t instanceof fn||t instanceof vf))throw new st(Pe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=t._path.child(wr.fromString(e,...r));return Vy(n),new fn(t.firestore,t instanceof vf?t.converter:null,new ct(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kT="AsyncQueue";class bT{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new $S(this,"async_queue_retry"),this._c=()=>{const n=Hm();n&&tt(kT,"Visibility state changed to "+n.visibilityState),this.M_.w_()},this.ac=e;const r=Hm();r&&typeof r.addEventListener=="function"&&r.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const r=Hm();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const r=new Ws;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(r.resolve,r.reject),r.promise))).then((()=>r.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Sc(e))throw e;tt(kT,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const r=this.ac.then((()=>(this.rc=!0,e().catch((n=>{throw this.nc=n,this.rc=!1,ts("INTERNAL UNHANDLED ERROR: ",CT(n)),n})).then((n=>(this.rc=!1,n))))));return this.ac=r,r}enqueueAfterDelay(e,r,n){this.uc(),this.oc.indexOf(e)>-1&&(r=0);const a=Pg.createAndSchedule(this,e,r,n,(o=>this.hc(o)));return this.tc.push(a),a}uc(){this.nc&&xt(47125,{Pc:CT(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const r of this.tc)if(r.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((r,n)=>r.targetTimeMs-n.targetTimeMs));for(const r of this.tc)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const r=this.tc.indexOf(e);this.tc.splice(r,1)}}function CT(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Hg extends jg{constructor(e,r,n,a){super(e,r,n,a),this.type="firestore",this._queue=new bT,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new bT(e),this._firestoreClient=void 0,await e}}}function nL(t,e){const r=typeof t=="object"?t:z9(),n=typeof t=="string"?t:Vh,a=L9(r,"firestore").getImmediate({identifier:n});if(!a._initialized){const o=kN("firestore");o&&rL(a,...o)}return a}function p4(t){if(t._terminated)throw new st(Pe.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||aL(t),t._firestoreClient}function aL(t){const e=t._freezeSettings(),r=(function(a,o,l,u){return new wM(a,o,l,u.host,u.ssl,u.experimentalForceLongPolling,u.experimentalAutoDetectLongPolling,d4(u.experimentalLongPollingOptions),u.useFetchStreams,u.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new QP(t._authCredentials,t._appCheckCredentials,t._queue,r,t._componentsProvider&&(function(a){const o=a?._online.build();return{_offline:a?._offline.build(o),_online:o}})(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fa{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Fa(Tn.fromBase64String(e))}catch(r){throw new st(Pe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new Fa(Tn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Fa._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(bf(e,Fa._jsonSchema))return Fa.fromBase64String(e.bytes)}}Fa._jsonSchemaVersion="firestore/bytes/1.0",Fa._jsonSchema={type:qr("string",Fa._jsonSchemaVersion),bytes:qr("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wg{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new st(Pe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new yn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g4{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new st(Pe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new st(Pe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Nt(this._lat,e._lat)||Nt(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Ti._jsonSchemaVersion}}static fromJSON(e){if(bf(e,Ti._jsonSchema))return new Ti(e.latitude,e.longitude)}}Ti._jsonSchemaVersion="firestore/geoPoint/1.0",Ti._jsonSchema={type:qr("string",Ti._jsonSchemaVersion),latitude:qr("number"),longitude:qr("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ei{constructor(e){this._values=(e||[]).map((r=>r))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(n,a){if(n.length!==a.length)return!1;for(let o=0;o<n.length;++o)if(n[o]!==a[o])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Ei._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(bf(e,Ei._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((r=>typeof r=="number")))return new Ei(e.vectorValues);throw new st(Pe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Ei._jsonSchemaVersion="firestore/vectorValue/1.0",Ei._jsonSchema={type:qr("string",Ei._jsonSchemaVersion),vectorValues:qr("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iL=/^__.*__$/;class sL{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new al(e,this.data,this.fieldMask,r,this.fieldTransforms):new Cf(e,this.data,r,this.fieldTransforms)}}function x4(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw xt(40011,{Ac:t})}}class Gg{constructor(e,r,n,a,o,l){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=a,o===void 0&&this.Rc(),this.fieldTransforms=o||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Gg({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.gc(e),n}yc(e){const r=this.path?.child(e),n=this.Vc({path:r,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Kh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((r=>e.isPrefixOf(r)))!==void 0||this.fieldTransforms.find((r=>e.isPrefixOf(r.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(x4(this.Ac)&&iL.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class oL{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||md(e)}Cc(e,r,n,a=!1){return new Gg({Ac:e,methodName:r,Dc:n,path:yn.emptyPath(),fc:!1,bc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function lL(t){const e=t._freezeSettings(),r=md(t._databaseId);return new oL(t._databaseId,!!e.ignoreUndefinedProperties,r)}function cL(t,e,r,n,a,o={}){const l=t.Cc(o.merge||o.mergeFields?2:0,e,r,a);T4("Data must be an object, but it was:",l,n);const u=_4(n,l);let h,d;if(o.merge)h=new Xa(l.fieldMask),d=l.fieldTransforms;else if(o.mergeFields){const p=[];for(const v of o.mergeFields){const _=uL(e,v,r);if(!l.contains(_))throw new st(Pe.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);hL(p,_)||p.push(_)}h=new Xa(p),d=l.fieldTransforms.filter((v=>h.covers(v.field)))}else h=null,d=l.fieldTransforms;return new sL(new Oa(u),h,d)}function v4(t,e){if(y4(t=Mh(t)))return T4("Unsupported field value:",e,t),_4(t,e);if(t instanceof g4)return(function(n,a){if(!x4(a.Ac))throw a.Sc(`${n._methodName}() can only be used with update() and set()`);if(!a.path)throw a.Sc(`${n._methodName}() is not currently supported inside arrays`);const o=n._toFieldTransform(a);o&&a.fieldTransforms.push(o)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(n,a){const o=[];let l=0;for(const u of n){let h=v4(u,a.wc(l));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),l++}return{arrayValue:{values:o}}})(t,e)}return(function(n,a){if((n=Mh(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return XM(a.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const o=xr.fromDate(n);return{timestampValue:Gh(a.serializer,o)}}if(n instanceof xr){const o=new xr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Gh(a.serializer,o)}}if(n instanceof Ti)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Fa)return{bytesValue:VS(a.serializer,n._byteString)};if(n instanceof fn){const o=a.databaseId,l=n.firestore._databaseId;if(!l.isEqual(o))throw a.Sc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:bg(n.firestore._databaseId||a.databaseId,n._key.path)}}if(n instanceof Ei)return(function(l,u){return{mapValue:{fields:{[mS]:{stringValue:pS},[Uh]:{arrayValue:{values:l.toArray().map((d=>{if(typeof d!="number")throw u.Sc("VectorValues must only contain numeric values.");return Sg(u.serializer,d)}))}}}}}})(n,a);throw a.Sc(`Unsupported field value: ${xg(n)}`)})(t,e)}function _4(t,e){const r={};return lS(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):rl(t,((n,a)=>{const o=v4(a,e.mc(n));o!=null&&(r[n]=o)})),{mapValue:{fields:r}}}function y4(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof xr||t instanceof Ti||t instanceof Fa||t instanceof fn||t instanceof g4||t instanceof Ei)}function T4(t,e,r){if(!y4(r)||!sS(r)){const n=xg(r);throw n==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+n)}}function uL(t,e,r){if((e=Mh(e))instanceof Wg)return e._internalPath;if(typeof e=="string")return E4(t,e);throw Kh("Field path arguments must be of type string or ",t,!1,void 0,r)}const fL=new RegExp("[~\\*/\\[\\]]");function E4(t,e,r){if(e.search(fL)>=0)throw Kh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Wg(...e.split("."))._internalPath}catch{throw Kh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Kh(t,e,r,n,a){const o=n&&!n.isEmpty(),l=a!==void 0;let u=`Function ${e}() called with invalid data`;r&&(u+=" (via `toFirestore()`)"),u+=". ";let h="";return(o||l)&&(h+=" (found",o&&(h+=` in field ${n}`),l&&(h+=` in document ${a}`),h+=")"),new st(Pe.INVALID_ARGUMENT,u+t+h)}function hL(t,e){return t.some((r=>r.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w4{constructor(e,r,n,a,o){this._firestore=e,this._userDataWriter=r,this._key=n,this._document=a,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new fn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new dL(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const r=this._document.data.field(S4("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r)}}}class dL extends w4{data(){return super.data()}}function S4(t,e){return typeof e=="string"?E4(t,e):e instanceof Wg?e._internalPath:e._delegate._internalPath}class mL{convertValue(e,r="none"){switch(Zs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Pr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,r);case 5:return e.stringValue;case 6:return this.convertBytes(Qs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,r);case 11:return this.convertObject(e.mapValue,r);case 10:return this.convertVectorValue(e.mapValue);default:throw xt(62114,{value:e})}}convertObject(e,r){return this.convertObjectMap(e.fields,r)}convertObjectMap(e,r="none"){const n={};return rl(e,((a,o)=>{n[a]=this.convertValue(o,r)})),n}convertVectorValue(e){const r=e.fields?.[Uh].arrayValue?.values?.map((n=>Pr(n.doubleValue)));return new Ei(r)}convertGeoPoint(e){return new Ti(Pr(e.latitude),Pr(e.longitude))}convertArray(e,r){return(e.values||[]).map((n=>this.convertValue(n,r)))}convertServerTimestamp(e,r){switch(r){case"previous":const n=od(e);return n==null?null:this.convertValue(n,r);case"estimate":return this.convertTimestamp(df(e));default:return null}}convertTimestamp(e){const r=$s(e);return new xr(r.seconds,r.nanos)}convertDocumentKey(e,r){const n=wr.fromString(e);Jt(GS(n),9688,{name:e});const a=new mf(n.get(1),n.get(3)),o=new ct(n.popFirst(5));return a.isEqual(r)||ts(`Document ${o} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pL(t,e,r){let n;return n=t?t.toFirestore(e):e,n}class Fu{constructor(e,r){this.hasPendingWrites=e,this.fromCache=r}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class jo extends w4{constructor(e,r,n,a,o,l){super(e,r,n,a,l),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const r=new _h(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,r={}){if(this._document){const n=this._document.data.field(S4("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,r.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new st(Pe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,r={};return r.type=jo._jsonSchemaVersion,r.bundle="",r.bundleSource="DocumentSnapshot",r.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?r:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),r.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),r)}}jo._jsonSchemaVersion="firestore/documentSnapshot/1.0",jo._jsonSchema={type:qr("string",jo._jsonSchemaVersion),bundleSource:qr("string","DocumentSnapshot"),bundleName:qr("string"),bundle:qr("string")};class _h extends jo{data(e={}){return super.data(e)}}class Xu{constructor(e,r,n,a){this._firestore=e,this._userDataWriter=r,this._snapshot=a,this.metadata=new Fu(a.hasPendingWrites,a.fromCache),this.query=n}get docs(){const e=[];return this.forEach((r=>e.push(r))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,r){this._snapshot.docs.forEach((n=>{e.call(r,new _h(this._firestore,this._userDataWriter,n.key,n,new Fu(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const r=!!e.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new st(Pe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=(function(a,o){if(a._snapshot.oldDocs.isEmpty()){let l=0;return a._snapshot.docChanges.map((u=>{const h=new _h(a._firestore,a._userDataWriter,u.doc.key,u.doc,new Fu(a._snapshot.mutatedKeys.has(u.doc.key),a._snapshot.fromCache),a.query.converter);return u.doc,{type:"added",doc:h,oldIndex:-1,newIndex:l++}}))}{let l=a._snapshot.oldDocs;return a._snapshot.docChanges.filter((u=>o||u.type!==3)).map((u=>{const h=new _h(a._firestore,a._userDataWriter,u.doc.key,u.doc,new Fu(a._snapshot.mutatedKeys.has(u.doc.key),a._snapshot.fromCache),a.query.converter);let d=-1,p=-1;return u.type!==0&&(d=l.indexOf(u.doc.key),l=l.delete(u.doc.key)),u.type!==1&&(l=l.add(u.doc),p=l.indexOf(u.doc.key)),{type:gL(u.type),doc:h,oldIndex:d,newIndex:p}}))}})(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new st(Pe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Xu._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=gg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const r=[],n=[],a=[];return this.docs.forEach((o=>{o._document!==null&&(r.push(o._document),n.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),a.push(o.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function gL(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return xt(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A4(t){t=ff(t,fn);const e=ff(t.firestore,Hg);return tL(p4(e),t._key).then((r=>_L(e,t,r)))}Xu._jsonSchemaVersion="firestore/querySnapshot/1.0",Xu._jsonSchema={type:qr("string",Xu._jsonSchemaVersion),bundleSource:qr("string","QuerySnapshot"),bundleName:qr("string"),bundle:qr("string")};class xL extends mL{constructor(e){super(),this.firestore=e}convertBytes(e){return new Fa(e)}convertReference(e){const r=this.convertDocumentKey(e,this.firestore._databaseId);return new fn(this.firestore,null,r)}}function k4(t,e,r){t=ff(t,fn);const n=ff(t.firestore,Hg),a=pL(t.converter,e);return vL(n,[cL(lL(n),"setDoc",t._key,a,t.converter!==null,r).toMutation(t._key,Zi.none())])}function vL(t,e){return(function(n,a){const o=new Ws;return n.asyncQueue.enqueueAndForget((async()=>jP(await JP(n),a,o))),o.promise})(p4(t),e)}function _L(t,e,r){const n=r.docs.get(e._key),a=new xL(t);return new jo(t,a,e._key,n,new Fu(r.hasPendingWrites,r.fromCache),e.converter)}(function(e,r=!0){(function(a){Ec=a})(j9),Lh(new cf("firestore",((n,{instanceIdentifier:a,options:o})=>{const l=n.getProvider("app").getImmediate(),u=new Hg(new nM(n.getProvider("auth-internal")),new sM(l,n.getProvider("app-check-internal")),(function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new st(Pe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new mf(d.options.projectId,p)})(l,a),l);return o={useFetchStreams:r,...o},u._setSettings(o),u}),"PUBLIC").setMultipleInstances(!0)),sc(My,Py,e),sc(My,Py,"esm2020")})();const yL={apiKey:"AIzaSyCx-Ee9kbneoAGzqvaKC9CZE-Im6Id1El4",authDomain:"schedule-3314f.firebaseapp.com",projectId:"schedule-3314f",storageBucket:"schedule-3314f.firebasestorage.app",messagingSenderId:"964408323673",appId:"1:964408323673:web:4e7e9c2af4bc4ebfad4b48",measurementId:"G-QCBPLPVL9H"},TL=Kw(yL),vd=nL(TL),EL=async t=>{try{return await k4(xd(vd,"schedule","appointments"),{appointments:t,lastUpdated:new Date().toISOString()}),!0}catch(e){return console.error("Error saving appointments:",e),!1}},wL=async()=>{try{const t=xd(vd,"schedule","appointments"),e=await A4(t);return e.exists()?e.data().appointments||[]:[]}catch(t){console.error("Error loading appointments:",t);const e=localStorage.getItem("appointments");return e?JSON.parse(e):[]}},SL=async t=>{try{return await k4(xd(vd,"schedule","clients"),{clients:t,lastUpdated:new Date().toISOString()}),!0}catch(e){return console.error("Error saving clients:",e),!1}},AL=async()=>{try{const t=xd(vd,"schedule","clients"),e=await A4(t);return e.exists()?e.data().clients||[]:[]}catch(t){console.error("Error loading clients:",t);const e=localStorage.getItem("clientsData");return e?JSON.parse(e):[]}},kL=()=>k.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:k.jsx("path",{d:"M10 20V14H14V20H19V12H22L12 3L2 12H5V20H10Z",fill:"currentColor"})}),bL=()=>k.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:k.jsx("path",{d:"M19 4H18V2H16V4H8V2H6V4H5C3.89 4 3.01 4.9 3.01 6L3 20C3 21.1 3.89 22 5 22H19C20.1 22 21 21.1 21 20V6C21 4.9 20.1 4 19 4ZM19 20H5V10H19V20ZM19 8H5V6H19V8Z",fill:"currentColor"})}),CL=()=>k.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:k.jsx("path",{d:"M11.99 2C6.47 2 2 6.48 2 12C2 17.52 6.47 22 11.99 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 11.99 2ZM12 20C7.58 20 4 16.42 4 12C4 7.58 7.58 4 12 4C16.42 4 20 7.58 20 12C20 16.42 16.42 20 12 20ZM12.5 7H11V13L16.25 16.15L17 14.92L12.5 12.25V7Z",fill:"currentColor"})}),RT=()=>k.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:k.jsx("path",{d:"M12 12C14.21 12 16 10.21 16 8C16 5.79 14.21 4 12 4C9.79 4 8 5.79 8 8C8 10.21 9.79 12 12 12ZM12 14C9.33 14 4 15.34 4 18V20H20V18C20 15.34 14.67 14 12 14Z",fill:"currentColor"})}),DT=[],Wa="none",xi=fN,b4=Array.from({length:14},(t,e)=>`${(6+e).toString().padStart(2,"0")}:00`).sort((t,e)=>{const[r]=t.split(":").map(Number),[n]=e.split(":").map(Number);return r-n}),C4=t=>b4.includes(t);function RL({appointment:t,onSave:e,onDelete:r,onClose:n,showAlert:a}){const[o,l]=bt.useState(t),u=v=>{const{name:_,value:y}=v.target;l(w=>({...w,[_]:y}))},h=v=>{if(v.preventDefault(),!C4(o.time)){a(`Time ${o.time} is outside the allowed schedule (6:00 to 19:00).`,"Invalid Time");return}e(o)},d=xi.filter(v=>v!==o.secondaryWorker&&o.secondaryWorker!==Wa),p=xi.filter(v=>v!==o.worker&&o.worker!==Wa);return k.jsx("div",{className:"modal-backdrop",onClick:n,children:k.jsxs("div",{className:"modal-content",onClick:v=>v.stopPropagation(),children:[k.jsx("h2",{children:"Edit Appointment"}),k.jsxs("form",{onSubmit:h,className:"modal-form",children:[k.jsx("label",{children:"Villa:"}),k.jsx("input",{type:"text",name:"villa",value:o.villa,onChange:u,required:!0}),k.jsx("label",{children:"Day:"}),k.jsx("select",{name:"day",value:o.day,onChange:u,children:Us.map(v=>k.jsx("option",{value:v,children:v},v))}),k.jsx("label",{children:"Time:"}),k.jsx("input",{type:"time",name:"time",value:o.time,onChange:u}),k.jsx("label",{children:"Worker:"}),k.jsxs("select",{name:"worker",value:o.worker,onChange:u,children:[o.worker&&k.jsx("option",{value:o.worker,children:o.worker},o.worker),d.map(v=>k.jsx("option",{value:v,children:v},v))]}),k.jsx("label",{children:"Secondary Worker:"}),k.jsxs("select",{name:"secondaryWorker",value:o.secondaryWorker,onChange:u,children:[k.jsx("option",{value:Wa,children:"None"}),o.secondaryWorker&&o.secondaryWorker!==Wa&&k.jsx("option",{value:o.secondaryWorker,children:o.secondaryWorker},o.secondaryWorker),p.map(v=>k.jsx("option",{value:v,children:v},v))]}),k.jsx("label",{children:"Wash Type:"}),k.jsxs("select",{name:"washType",value:o.washType||"EXT",onChange:u,children:[k.jsx("option",{value:"EXT",children:" EXT"}),k.jsx("option",{value:"INT",children:" INT"})]}),k.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:"center",marginTop:"1rem"},children:[k.jsx("button",{type:"submit",style:{background:"linear-gradient(135deg, #548235 0%, #6a9c3d 100%)",color:"white",padding:"12px 24px",borderRadius:"10px",border:"none",fontSize:"0.95rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 4px 15px rgba(84, 130, 53, 0.3)"},children:"Save Changes"}),k.jsx("button",{type:"button",onClick:n,style:{background:"linear-gradient(135deg, #6c757d 0%, #495057 100%)",color:"white",padding:"12px 24px",borderRadius:"10px",border:"none",fontSize:"0.95rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 4px 15px rgba(108, 117, 125, 0.3)"},children:"Cancel"}),k.jsx("button",{type:"button",onClick:()=>r(t.id),style:{background:"linear-gradient(135deg, #dc3545 0%, #c82333 100%)",color:"white",padding:"12px 24px",borderRadius:"10px",border:"none",fontSize:"0.95rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 4px 15px rgba(220, 53, 69, 0.3)"},children:"Delete"})]})]})]})})}function DL({onClose:t,onExport:e}){const[r,n]=bt.useState("daily"),[a,o]=bt.useState(Us[0]),[l,u]=bt.useState("all"),h=()=>{e(r,a,l),t()},d=()=>{t()},p=()=>{t()};return k.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(5px)"},onClick:p,children:k.jsxs("div",{style:{backgroundColor:"white",borderRadius:"20px",padding:"3rem",boxShadow:"0 20px 60px rgba(0,0,0,0.3)",border:"1px solid rgba(255,255,255,0.2)",minWidth:"500px",maxWidth:"600px",width:"90%",position:"relative"},onClick:v=>v.stopPropagation(),children:[k.jsxs("div",{style:{textAlign:"center",marginBottom:"2.5rem"},children:[k.jsx("div",{style:{background:"linear-gradient(135deg, #548235 0%, #6a9c3d 50%, #548235 100%)",padding:"1rem 2rem",borderRadius:"15px",marginBottom:"1rem",display:"inline-block"},children:k.jsx("h2",{style:{color:"white",fontSize:"1.8rem",fontWeight:"700",margin:"0",textShadow:"2px 2px 4px rgba(0,0,0,0.3)"},children:" Export Schedule"})}),k.jsx("p",{style:{color:"#6c757d",fontSize:"1rem",margin:"0"},children:"Generate Excel report with wash type information"})]}),k.jsxs("div",{style:{marginBottom:"2rem"},children:[k.jsxs("div",{style:{marginBottom:"1.5rem"},children:[k.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"600",color:"#374151",fontSize:"1rem"},children:" Export Type:"}),k.jsxs("select",{value:r,onChange:v=>n(v.target.value),style:{width:"100%",padding:"12px 16px",borderRadius:"10px",border:"2px solid #e5e7eb",fontSize:"1rem",backgroundColor:"#f9fafb",transition:"all 0.3s ease",outline:"none"},children:[k.jsx("option",{value:"daily",children:"Daily Schedule"}),k.jsx("option",{value:"weekly",children:"Weekly Schedule"})]})]}),r==="daily"&&k.jsxs("div",{style:{marginBottom:"1.5rem"},children:[k.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"600",color:"#374151",fontSize:"1rem"},children:" Select Day:"}),k.jsx("select",{value:a,onChange:v=>o(v.target.value),style:{width:"100%",padding:"12px 16px",borderRadius:"10px",border:"2px solid #e5e7eb",fontSize:"1rem",backgroundColor:"#f9fafb",transition:"all 0.3s ease",outline:"none"},children:Us.map(v=>k.jsx("option",{value:v,children:v},v))})]}),k.jsxs("div",{style:{marginBottom:"1.5rem"},children:[k.jsx("label",{style:{display:"block",marginBottom:"0.5rem",fontWeight:"600",color:"#374151",fontSize:"1rem"},children:" For Worker:"}),k.jsxs("select",{value:l,onChange:v=>u(v.target.value),style:{width:"100%",padding:"12px 16px",borderRadius:"10px",border:"2px solid #e5e7eb",fontSize:"1rem",backgroundColor:"#f9fafb",transition:"all 0.3s ease",outline:"none"},children:[k.jsx("option",{value:"all",children:"All Workers"}),xi.map(v=>k.jsx("option",{value:v,children:v},v))]})]})]}),k.jsxs("div",{style:{display:"flex",gap:"1rem",justifyContent:"center"},children:[k.jsx("button",{onClick:h,style:{background:"linear-gradient(135deg, #548235 0%, #6a9c3d 100%)",color:"white",padding:"14px 28px",borderRadius:"12px",border:"none",fontSize:"1rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 6px 20px rgba(84, 130, 53, 0.3)",display:"flex",alignItems:"center",gap:"8px"},children:" Generate Export"}),k.jsx("button",{onClick:d,style:{background:"linear-gradient(135deg, #6c757d 0%, #495057 100%)",color:"white",padding:"14px 28px",borderRadius:"12px",border:"none",fontSize:"1rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 6px 20px rgba(108, 117, 125, 0.3)"},children:"Cancel"})]})]})})}function IL({isOpen:t,title:e,message:r,options:n,onConfirm:a,onCancel:o}){return t?k.jsx("div",{className:"modal-backdrop",style:{zIndex:1001},onClick:o,children:k.jsxs("div",{className:"modal-content custom-alert-dialog",onClick:l=>l.stopPropagation(),children:[k.jsx("h2",{children:e}),k.jsx("p",{style:{whiteSpace:"pre-wrap"},children:r}),k.jsxs("div",{className:"modal-actions",children:[n.includes("cancel")&&k.jsx("button",{type:"button",onClick:o,style:{background:"linear-gradient(135deg, #6c757d 0%, #495057 100%)",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",fontSize:"0.9rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 4px 15px rgba(108, 117, 125, 0.3)",marginRight:"0.5rem"},children:"Cancel"}),n.includes("ok")&&k.jsx("button",{type:"button",onClick:a,style:{background:"linear-gradient(135deg, #548235 0%, #6a9c3d 100%)",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",fontSize:"0.9rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 4px 15px rgba(84, 130, 53, 0.3)",marginRight:"0.5rem"},children:"OK"}),n.includes("yes")&&k.jsx("button",{type:"button",onClick:a,style:{background:"linear-gradient(135deg, #548235 0%, #6a9c3d 100%)",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",fontSize:"0.9rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 4px 15px rgba(84, 130, 53, 0.3)",marginRight:"0.5rem"},children:"Yes"}),n.includes("no")&&k.jsx("button",{type:"button",onClick:o,style:{background:"linear-gradient(135deg, #dc3545 0%, #c82333 100%)",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",fontSize:"0.9rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 4px 15px rgba(220, 53, 69, 0.3)",marginRight:"0.5rem"},children:"No"})]})]})}):null}function OL({navigateToClientsWithSearch:t,initialSearchTerm:e=""}){const[r,n]=bt.useState(DT),[a,o]=bt.useState(!0),[l,u]=bt.useState({villa:"",day:["Saturday"],time:"06:00",worker:"Raqib",secondaryWorker:Wa}),[h,d]=bt.useState(!1),[p,v]=bt.useState(null),[_,y]=bt.useState(!1),[w,E]=bt.useState(e),[S,L]=bt.useState(null),[z,O]=bt.useState(!1),[ee,te]=bt.useState(!1),[Z,C]=bt.useState(null),[I,R]=bt.useState({isOpen:!1,title:"",message:"",options:[],onConfirm:()=>{},onCancel:()=>{}}),B=(Ee,ze="Alert",Ke=()=>{})=>{R({isOpen:!0,title:ze,message:Ee,options:["ok"],onConfirm:()=>{R(We=>({...We,isOpen:!1})),Ke()},onCancel:()=>R(We=>({...We,isOpen:!1}))})},D=(Ee,ze="Confirm",Ke=()=>{},We=()=>{})=>{R({isOpen:!0,title:ze,message:Ee,options:["yes","no"],onConfirm:()=>{R(Be=>({...Be,isOpen:!1})),Ke()},onCancel:()=>{R(Be=>({...Be,isOpen:!1})),We()}})};bt.useEffect(()=>{E(e)},[e]),bt.useEffect(()=>{(async()=>{o(!0);const ze=await wL();n(ze),o(!1)})()},[]),bt.useEffect(()=>{!a&&r.length>=0&&(EL(r),localStorage.setItem("appointments",JSON.stringify(r)))},[r,a]);const M=(()=>{const Ee={};return xi.forEach(ze=>{Ee[ze]=0}),r.forEach(ze=>{ze.worker&&Ee.hasOwnProperty(ze.worker)&&Ee[ze.worker]++,ze.secondaryWorker&&Ee.hasOwnProperty(ze.secondaryWorker)&&Ee[ze.secondaryWorker]++}),Ee})(),Fe=new Set(r.map(Ee=>Ee.villa)).size,Se=Array.from(new Set(r.map(Ee=>Ee.villa))).sort(),ne=()=>{d(!1),R(Ee=>({...Ee,isOpen:!1})),y(!0)},se=()=>{y(!1)},Le=Ee=>{L(Ee),O(!0)},ae=()=>{L(null),O(!1)},W=()=>{te(!0)},pe=()=>{te(!1)},V=Ee=>{const{name:ze,value:Ke,type:We,checked:Be}=Ee.target;if(ze==="day")if(We==="checkbox")u(Ye=>({...Ye,day:Be?[...Ye.day,Ke]:Ye.day.filter(je=>je!==Ke)}));else{const Ye=Array.from(Ee.target.options).filter(je=>je.selected).map(je=>je.value);u(je=>({...je,day:Ye}))}else u(Ye=>{const je={...Ye,[ze]:Ke};return ze==="worker"&&je.worker===je.secondaryWorker&&(je.secondaryWorker=Wa),je})},Y=(Ee,ze,Ke)=>{let We=r;Ke!=="all"&&(We=We.filter(Tt=>Tt.worker===Ke)),Ee==="daily"&&(We=We.filter(Tt=>Tt.day===ze));const Be=Tt=>{if(!Tt)return"";const[ft,er]=Tt.split(":"),pr=parseInt(ft,10),tr=pr>=12?"PM":"AM";return`${pr%12||12}:${er} ${tr}`},je=We.sort((Tt,ft)=>{const[er]=Tt.time.split(":").map(Number),[pr]=ft.time.split(":").map(Number);return er-pr}).map(Tt=>{let ft;return Tt.manualWashType?ft=Tt.manualWashType==="EXT"?" EXT":" INT":ft=Mm(Tt.villa,Tt.day)||"N/A",{Villa:Tt.villa,Day:Tt.day,Time:Be(Tt.time),Worker:Tt.worker,"Wash Type":ft}}),dt=hh.json_to_sheet(je),rt=hh.book_new();hh.book_append_sheet(rt,dt,"Schedule");const lt=Bw(rt,{bookType:"xlsx",type:"array"}),ut=new Blob([lt],{type:"application/octet-stream"});Ey.saveAs(ut,`Schedule_Export_${Ee}_${Ke}${Ee==="daily"?`_${ze}`:""}.xlsx`)},Q=()=>{const ze=JSON.stringify({appointments:r},null,2),Ke=new Blob([ze],{type:"application/json"});Ey.saveAs(Ke,"schedule_settings.json")},J=Ee=>{const ze=Ee.target.files[0];if(!ze)return;const Ke=new FileReader;Ke.onload=We=>{try{const Be=JSON.parse(We.target.result);Be.appointments?n(Be.appointments):B("Invalid settings file: missing appointments data.","Error")}catch(Be){B("Error parsing settings file: "+Be.message,"Error")}},Ke.readAsText(ze)},ue=()=>{D("Are you sure you want to clear the entire schedule? This action cannot be undone.","Confirm Reset",()=>{n([]),localStorage.removeItem("appointments")})},Ie=()=>{D("Are you sure you want to clear all saved data from your browser? This will reset the schedule completely.","Confirm Clear Data",()=>{localStorage.removeItem("appointments"),n(DT)})},ke=async Ee=>{if(Ee.preventDefault(),!l.villa){B("Please enter a villa name.","Validation Error");return}if(!C4(l.time)){B(`Time ${l.time} is outside the allowed schedule (6:00 to 19:00).`,"Invalid Time");return}const ze=(Ye,je="Confirm")=>new Promise(dt=>{R({isOpen:!0,title:je,message:Ye,options:["yes","no"],onConfirm:()=>{R(rt=>({...rt,isOpen:!1})),dt(!0)},onCancel:()=>{R(rt=>({...rt,isOpen:!1})),dt(!1)}})}),Ke=[],We=[];let Be=!1;for(const Ye of l.day){if(Be)break;if(r.some(dt=>!We.includes(dt.id)&&dt.day===Ye&&dt.time===l.time&&dt.worker===l.worker)){const dt=xi.find(rt=>rt!==l.worker&&!r.some(lt=>!We.includes(lt.id)&&lt.day===Ye&&lt.time===l.time&&lt.worker===rt));dt?await ze(`Worker "${l.worker}" is busy on ${Ye} at ${l.time}. Assign to "${dt}" instead?`,"Worker Conflict")?Ke.push({id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}-${Ye}-${dt}`,day:Ye,time:l.time,worker:dt,villa:l.villa}):Be=!0:(B(`No available workers on ${Ye} at ${l.time}. Aborting schedule creation.`,"No Worker Available"),Be=!0)}else{const dt=r.find(rt=>!We.includes(rt.id)&&rt.day===Ye&&rt.time===l.time&&rt.secondaryWorker===l.worker);if(dt)await ze(`Worker "${l.worker}" is currently a secondary worker for villa "${dt.villa}" on ${Ye} at ${l.time}. Do you want to assign them as primary for this new task and remove them from the secondary task?`,"Secondary Worker Conflict")?(We.push(dt.id),Ke.push({id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}-${Ye}-${l.worker}`,day:Ye,time:l.time,worker:l.worker,secondaryWorker:l.secondaryWorker!==Wa?l.secondaryWorker:void 0,villa:l.villa})):Be=!0;else{let rt=!1;if(l.secondaryWorker!==Wa){if(l.secondaryWorker===l.worker){B("Primary and secondary workers cannot be the same. Aborting schedule creation.","Conflict"),Be=!0;break}if(rt=r.some(lt=>!We.includes(lt.id)&&lt.day===Ye&&lt.time===l.time&&(lt.worker===l.secondaryWorker||lt.secondaryWorker===l.secondaryWorker)),rt){B(`Secondary worker "${l.secondaryWorker}" is busy on ${Ye} at ${l.time}. Aborting schedule creation.`,"Conflict"),Be=!0;break}}rt||Ke.push({id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}-${Ye}-${l.worker}`,day:Ye,time:l.time,worker:l.worker,secondaryWorker:l.secondaryWorker!==Wa?l.secondaryWorker:void 0,villa:l.villa})}}}!Be&&(Ke.length>0||We.length>0)?(n(Ye=>[...Ye.filter(rt=>!We.includes(rt.id)),...Ke].sort((rt,lt)=>{const[ut]=rt.time.split(":").map(Number),[Tt]=lt.time.split(":").map(Number);return ut-Tt})),u(Ye=>({...Ye,villa:""}))):Be&&B("Schedule creation aborted due to conflicts or user cancellation.","Aborted")},Oe=Ee=>{v(Ee),d(!0)},le=()=>{d(!1),v(null)},Qe=Ee=>{const ze={...Ee,secondaryWorker:Ee.secondaryWorker===Wa?void 0:Ee.secondaryWorker,manualWashType:Ee.washType};if(ze.secondaryWorker&&ze.worker===ze.secondaryWorker){B("Primary and secondary workers cannot be the same for an appointment.","Conflict");return}n(Ke=>Ke.map(We=>We.id===ze.id?ze:We).sort((We,Be)=>{const[Ye]=We.time.split(":").map(Number),[je]=Be.time.split(":").map(Number);return Ye-je})),le()},G=Ee=>{D("Are you sure you want to delete this appointment?","Confirm Delete",()=>{n(ze=>ze.filter(Ke=>Ke.id!==Ee)),le()})},et=Ee=>{E(""),t(Ee)},Ve=(Ee,ze)=>{C(ze),Ee.dataTransfer.effectAllowed="move"},at=Ee=>{Ee.preventDefault(),Ee.dataTransfer.dropEffect="move"},Ze=(Ee,ze,Ke,We)=>{if(Ee.preventDefault(),!Z||Z.worker===ze){C(null);return}const Be=r.find(Ye=>Ye.day===Ke&&Ye.time===We&&Ye.worker===ze);if(Be)if(Z.day===Ke&&Z.time===We){n(Ye=>Ye.map(je=>je.id===Z.id?{...je,worker:ze}:je.id===Be.id?{...je,worker:Z.worker}:je)),C(null);return}else{B(`${ze} is already busy at ${We} on ${Ke}`,"Slot Occupied"),C(null);return}n(Ye=>Ye.map(je=>je.id===Z.id?{...je,worker:ze,day:Ke,time:We}:je)),C(null)},be=()=>{C(null)};return a?k.jsx("div",{style:{backgroundColor:"#DAF2D0",borderRadius:"20px",padding:"2rem",textAlign:"center",minHeight:"200px",display:"flex",alignItems:"center",justifyContent:"center"},children:k.jsx("div",{style:{fontSize:"1.5rem",color:"#548235"},children:" Loading schedule..."})}):k.jsxs("div",{style:{backgroundColor:"#DAF2D0",borderRadius:"20px",padding:"2rem",boxShadow:"0 8px 32px rgba(0,0,0,0.1)",border:"1px solid rgba(255,255,255,0.2)"},children:[h&&k.jsx(RL,{appointment:p,onSave:Qe,onDelete:G,onClose:le,showAlert:B}),k.jsx(IL,{isOpen:I.isOpen,title:I.title,message:I.message,options:I.options,onConfirm:I.onConfirm,onCancel:I.onCancel}),k.jsx("div",{style:{display:"flex",justifyContent:"center",marginBottom:"2rem"},children:k.jsxs("div",{style:{background:"linear-gradient(135deg, #548235 0%, #6a9c3d 50%, #548235 100%)",padding:"1.5rem 3rem",borderRadius:"25px",boxShadow:"0 8px 32px rgba(84, 130, 53, 0.3)",border:"none",position:"relative",overflow:"hidden"},children:[k.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"linear-gradient(45deg, rgba(255,255,255,0.1) 25%, transparent 25%, transparent 75%, rgba(255,255,255,0.1) 75%)",backgroundSize:"20px 20px"}}),k.jsx("h1",{style:{color:"white",fontSize:"2.5rem",fontWeight:"700",margin:"0",textAlign:"center",textShadow:"2px 2px 4px rgba(0,0,0,0.3)",letterSpacing:"1px",position:"relative",zIndex:1},children:"GLOGO car wash Schedule"})]})}),k.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1.5rem",marginBottom:"2rem"},children:[k.jsxs("div",{style:{backgroundColor:"#DAF2D0",borderRadius:"15px",padding:"1.5rem",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",border:"1px solid rgba(255,255,255,0.2)"},children:[k.jsx("h3",{style:{color:"#548235",fontSize:"1.3rem",fontWeight:"600",marginBottom:"1rem",textAlign:"center"},children:" Worker Car Counts"}),xi.map(Ee=>k.jsxs("div",{onClick:()=>Le(Ee),style:{cursor:"pointer",padding:"12px 16px",margin:"8px 0",borderRadius:"10px",background:"linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)",border:"1px solid #e2e8f0",transition:"all 0.3s ease",display:"flex",justifyContent:"space-between",alignItems:"center"},onMouseOver:ze=>{ze.target.style.transform="translateY(-2px)",ze.target.style.boxShadow="0 4px 15px rgba(0,0,0,0.1)"},onMouseOut:ze=>{ze.target.style.transform="translateY(0)",ze.target.style.boxShadow="none"},children:[k.jsx("span",{style:{fontWeight:"600",color:"#374151"},children:Ee}),k.jsxs("span",{style:{backgroundColor:"#548235",color:"white",padding:"4px 12px",borderRadius:"20px",fontSize:"0.9rem",fontWeight:"600"},children:[M[Ee]||0," cars"]})]},Ee))]}),k.jsxs("div",{style:{backgroundColor:"#DAF2D0",borderRadius:"15px",padding:"1.5rem",boxShadow:"0 4px 20px rgba(0,0,0,0.1)",border:"1px solid rgba(255,255,255,0.2)"},children:[k.jsx("h3",{style:{color:"#548235",fontSize:"1.3rem",fontWeight:"600",marginBottom:"1rem",textAlign:"center"},children:" Client Stats"}),k.jsxs("div",{onClick:W,style:{cursor:"pointer",padding:"12px 16px",borderRadius:"10px",background:"linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)",border:"1px solid #e2e8f0",transition:"all 0.3s ease",display:"flex",justifyContent:"space-between",alignItems:"center"},onMouseOver:Ee=>{Ee.target.style.transform="translateY(-2px)",Ee.target.style.boxShadow="0 4px 15px rgba(0,0,0,0.1)"},onMouseOut:Ee=>{Ee.target.style.transform="translateY(0)",Ee.target.style.boxShadow="none"},children:[k.jsx("span",{style:{fontWeight:"600",color:"#374151"},children:"Total Unique Villas"}),k.jsx("span",{style:{backgroundColor:"#28a745",color:"white",padding:"4px 12px",borderRadius:"20px",fontSize:"0.9rem",fontWeight:"600"},children:Fe})]})]})]}),k.jsx("div",{className:"form-container",children:k.jsxs("form",{onSubmit:ke,children:[k.jsxs("div",{className:"form-field",children:[k.jsxs("label",{htmlFor:"villa-input",children:[k.jsx(kL,{})," Villa:"]}),k.jsx("input",{id:"villa-input",type:"text",name:"villa",placeholder:"Villa Name",value:l.villa,onChange:V,required:!0})]}),k.jsxs("div",{className:"form-field",children:[k.jsxs("label",{children:[k.jsx(bL,{})," Day:"]}),k.jsx("div",{className:"day-checkboxes",children:Us.map(Ee=>k.jsxs("label",{children:[k.jsx("input",{type:"checkbox",name:"day",value:Ee,checked:l.day.includes(Ee),onChange:V}),Ee]},Ee))})]}),k.jsxs("div",{className:"form-field",children:[k.jsxs("label",{htmlFor:"time-input",children:[k.jsx(CL,{})," Time:"]}),k.jsx("input",{id:"time-input",type:"time",name:"time",value:l.time,onChange:V})]}),k.jsxs("div",{className:"form-field",children:[k.jsxs("label",{htmlFor:"worker-select",children:[k.jsx(RT,{})," Worker:"]}),k.jsx("select",{id:"worker-select",name:"worker",value:l.worker,onChange:V,children:xi.map(Ee=>k.jsx("option",{value:Ee,children:Ee},Ee))})]}),k.jsxs("div",{className:"form-field",children:[k.jsxs("label",{htmlFor:"secondary-worker-select",children:[k.jsx(RT,{})," Secondary Worker:"]}),k.jsxs("select",{id:"secondary-worker-select",name:"secondaryWorker",value:l.secondaryWorker,onChange:V,children:[k.jsx("option",{value:Wa,children:"None"}),xi.filter(Ee=>Ee!==l.worker).map(Ee=>k.jsx("option",{value:Ee,children:Ee},Ee))]})]}),k.jsxs("div",{className:"form-field",children:[k.jsx("label",{htmlFor:"search-input",children:" Search:"}),k.jsxs("div",{style:{position:"relative"},children:[k.jsx("input",{id:"search-input",type:"text",name:"search",placeholder:"Search Villa, Worker, Day...",value:w,onChange:Ee=>E(Ee.target.value),style:{paddingRight:w?"40px":"0.8rem"}}),w&&k.jsx("button",{onClick:()=>E(""),style:{position:"absolute",right:"10px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",fontSize:"16px",color:"#6c757d",cursor:"pointer",padding:"0",width:"18px",height:"18px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",transition:"all 0.2s ease"},onMouseOver:Ee=>{Ee.target.style.backgroundColor="#e9ecef",Ee.target.style.color="#495057"},onMouseOut:Ee=>{Ee.target.style.backgroundColor="transparent",Ee.target.style.color="#6c757d"},children:""})]})]}),k.jsx("button",{type:"submit",style:{padding:"12px 24px",borderRadius:"12px",border:"none",fontSize:"0.95rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",background:"linear-gradient(135deg, #548235 0%, #6a9c3d 100%)",color:"white",boxShadow:"0 6px 20px rgba(84, 130, 53, 0.3)",display:"inline-flex",alignItems:"center",gap:"8px",marginRight:"0.5rem",marginBottom:"0.5rem"},children:" Add Appointment"}),k.jsx("button",{type:"button",onClick:ne,style:{padding:"12px 24px",borderRadius:"12px",border:"none",fontSize:"0.95rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",background:"linear-gradient(135deg, #548235 0%, #6a9c3d 100%)",color:"white",boxShadow:"0 6px 20px rgba(84, 130, 53, 0.3)",display:"inline-flex",alignItems:"center",gap:"8px",marginRight:"0.5rem",marginBottom:"0.5rem"},children:" Export to Excel"}),k.jsx("button",{type:"button",onClick:Q,style:{padding:"12px 24px",borderRadius:"12px",border:"none",fontSize:"0.95rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",background:"linear-gradient(135deg, #548235 0%, #6a9c3d 100%)",color:"white",boxShadow:"0 6px 20px rgba(84, 130, 53, 0.3)",display:"inline-flex",alignItems:"center",gap:"8px",marginRight:"0.5rem",marginBottom:"0.5rem"},children:" Save Settings"}),k.jsx("input",{type:"file",accept:".json",onChange:J,style:{display:"none"},id:"import-settings-file"}),k.jsx("button",{type:"button",onClick:()=>document.getElementById("import-settings-file").click(),style:{padding:"12px 24px",borderRadius:"12px",border:"none",fontSize:"0.95rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",background:"linear-gradient(135deg, #548235 0%, #6a9c3d 100%)",color:"white",boxShadow:"0 6px 20px rgba(84, 130, 53, 0.3)",display:"inline-flex",alignItems:"center",gap:"8px",marginRight:"0.5rem",marginBottom:"0.5rem"},children:" Import Settings"}),k.jsx("button",{type:"button",onClick:ue,style:{padding:"12px 24px",borderRadius:"12px",border:"none",fontSize:"0.95rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",background:"linear-gradient(135deg, #6c757d 0%, #495057 100%)",color:"white",boxShadow:"0 6px 20px rgba(108, 117, 125, 0.3)",display:"inline-flex",alignItems:"center",gap:"8px",marginRight:"0.5rem",marginBottom:"0.5rem"},children:" Reset Schedule"}),k.jsx("button",{type:"button",onClick:Ie,style:{padding:"12px 24px",borderRadius:"12px",border:"none",fontSize:"0.95rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",background:"linear-gradient(135deg, #dc3545 0%, #c82333 100%)",color:"white",boxShadow:"0 6px 20px rgba(220, 53, 69, 0.3)",display:"inline-flex",alignItems:"center",gap:"8px",marginRight:"0.5rem",marginBottom:"0.5rem"},children:" Clear Storage"}),k.jsx("button",{type:"button",onClick:()=>{const Ee=localStorage.getItem("appointments");if(Ee){const Ke=JSON.parse(Ee).map(We=>({...We,washType:void 0}));localStorage.setItem("appointments",JSON.stringify(Ke)),n(Ke),window.location.reload()}},style:{padding:"12px 24px",borderRadius:"12px",border:"none",fontSize:"0.95rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",background:"linear-gradient(135deg, #17a2b8 0%, #138496 100%)",color:"white",boxShadow:"0 6px 20px rgba(23, 162, 184, 0.3)",display:"inline-flex",alignItems:"center",gap:"8px",marginRight:"0.5rem",marginBottom:"0.5rem"},children:" Recalculate Wash Types"})]})}),_&&k.jsx(DL,{onClose:se,onExport:Y}),z&&k.jsx(dN,{workerName:S,appointments:r,onClose:ae,onEditAppointment:Oe,onDeleteAppointment:G,showAlert:B}),ee&&k.jsx(mN,{uniqueVillas:Se,onClose:pe,navigateToClientsWithSearch:t}),k.jsxs("div",{className:"schedule-grid",children:[k.jsx("div",{className:"header-cell",children:"Time"}),Us.map(Ee=>k.jsxs("div",{className:"header-cell day-header",children:[k.jsx("span",{children:Ee}),k.jsx("div",{className:"worker-headers",children:xi.map(ze=>k.jsx("span",{children:ze},ze))})]},Ee)),b4.map(Ee=>k.jsxs(bt.Fragment,{children:[k.jsx("div",{className:"time-slot-cell",children:Ee}),Us.map(ze=>k.jsx("div",{className:"grid-cell",children:xi.map(Ke=>{const We=r.find(ut=>ut.day===ze&&ut.time.split(":")[0]===Ee.split(":")[0]&&ut.worker===Ke),Be=r.find(ut=>ut.day===ze&&ut.time.split(":")[0]===Ee.split(":")[0]&&ut.secondaryWorker===Ke),Ye=w.toLowerCase();let je=!1;w&&(je=We&&(We.villa.toLowerCase().includes(Ye)||We.worker.toLowerCase().includes(Ye)||We.day.toLowerCase().includes(Ye)));let dt=!1;w&&(dt=Be&&(Be.villa.toLowerCase().includes(Ye)||Be.worker&&Be.worker.toLowerCase().includes(Ye)||Be.secondaryWorker&&Be.secondaryWorker.toLowerCase().includes(Ye)||Be.day.toLowerCase().includes(Ye)));const rt=!w||je,lt=!w||dt;return k.jsxs("div",{className:"worker-slot",onDragOver:at,onDrop:ut=>Ze(ut,Ke,ze,Ee),style:{minHeight:"40px",border:Z&&Z.worker!==Ke?"1px dashed #548235":"none",borderRadius:"4px",transition:"all 0.3s ease",padding:"2px"},children:[We&&rt&&k.jsxs("div",{className:`appointment-card worker-${We.worker.toLowerCase()} ${je?"highlight":""}`,onClick:()=>et(We.villa),draggable:!0,onDragStart:ut=>Ve(ut,We),onDragEnd:be,style:{cursor:"grab",opacity:Z&&Z.id===We.id?.5:1},children:[k.jsx("strong",{children:We.villa}),k.jsx("div",{style:{fontSize:"0.7rem",fontWeight:"600",marginTop:"2px",color:"white",textShadow:"1px 1px 2px rgba(0,0,0,0.5)"},children:We.manualWashType?We.manualWashType==="EXT"?" EXT":" INT":Mm(We.villa,We.day)||" EXT"}),k.jsx("button",{className:"edit-btn",onClick:ut=>{ut.stopPropagation(),Oe(We)},children:""})]}),Be&&lt&&k.jsxs("div",{className:`appointment-card secondary-worker-card worker-${Be.secondaryWorker.toLowerCase()} ${dt?"highlight":""}`,onClick:()=>et(Be.villa),draggable:!0,onDragStart:ut=>Ve(ut,Be),onDragEnd:be,style:{cursor:"grab",opacity:Z&&Z.id===Be.id?.5:1},children:[k.jsx("strong",{children:Be.villa}),k.jsx("div",{style:{fontSize:"0.7rem",fontWeight:"600",marginTop:"2px",color:"white",textShadow:"1px 1px 2px rgba(0,0,0,0.5)"},children:Be.manualWashType?Be.manualWashType==="EXT"?" EXT":" INT":Mm(Be.villa,Be.day)||" EXT"}),k.jsx("button",{className:"edit-btn",onClick:ut=>{ut.stopPropagation(),Oe(Be)},children:""})]}),!We&&!Be&&Z&&k.jsx("div",{style:{height:"30px",display:"flex",alignItems:"center",justifyContent:"center",color:"#548235",fontSize:"0.7rem",fontWeight:"500",opacity:.7},children:"Drop here"})]},Ke)})},ze))]},Ee))]})]})}const FL=({invoiceData:t})=>{const{ref:e,date:r,customer:n,service:a,basePrice:o}=t,l="    ",u=.05,h=o*u,d=o+h,p=new Date(r).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"});return k.jsxs("div",{style:Ht.invoiceContainer,children:[k.jsx("h1",{style:Ht.header,children:"Tax Invoice"}),k.jsx("div",{style:Ht.invoiceInfo,children:k.jsxs("p",{children:["Date: ",p]})}),k.jsxs("div",{style:Ht.refInfo,children:[k.jsxs("p",{children:["Ref: ",e]}),k.jsxs("p",{children:["TRN#: ",l]})]}),k.jsxs("div",{style:Ht.customerInfo,children:[k.jsx("p",{children:n.name}),k.jsx("p",{children:n.addressLine1}),k.jsx("p",{children:n.addressLine2})]}),k.jsxs("p",{style:Ht.subject,children:["SUB: ",a.subject]}),k.jsx("p",{children:"Dear Sir,"}),k.jsx("p",{children:"Thank you for subscribing to the monthly car wash service."}),k.jsxs("table",{style:Ht.table,children:[k.jsx("thead",{children:k.jsxs("tr",{children:[k.jsx("th",{style:Ht.th,children:"No."}),k.jsx("th",{style:Ht.th,children:"Description"}),k.jsx("th",{style:Ht.th,children:"Duration"}),k.jsx("th",{style:Ht.th,children:"Total Price"})]})}),k.jsxs("tbody",{children:[k.jsxs("tr",{children:[k.jsx("td",{style:{...Ht.td,textAlign:"center",verticalAlign:"middle"},children:"1"}),k.jsxs("td",{style:Ht.td,children:["Name: ",n.name,k.jsx("br",{}),"Package ID: ",a.packageId,k.jsx("br",{}),"Vehicle: ",a.vehicleType,k.jsx("br",{}),"Start: ",a.startDate,k.jsx("br",{}),"End: ",a.endDate]}),k.jsx("td",{style:{...Ht.td,textAlign:"center",verticalAlign:"middle"},children:a.duration}),k.jsxs("td",{style:{...Ht.td,textAlign:"center",verticalAlign:"middle"},children:[o," + ",u*100,"% VAT"]})]}),k.jsxs("tr",{children:[k.jsx("td",{style:Ht.emptyCell}),k.jsx("td",{style:Ht.emptyCell}),k.jsx("td",{style:Ht.totalLabelCell,children:"TOTAL:"}),k.jsxs("td",{style:Ht.totalValueCell,children:["AED ",d.toFixed(2)]})]})]})]}),k.jsxs("div",{style:Ht.footer,children:[k.jsx("h3",{children:"General Conditions:"}),k.jsx("p",{children:"Terms: Payments are to be made in advance at the beginning of each month"}),k.jsx("p",{style:{marginTop:"20px"},children:"Best Regards,"}),k.jsx("p",{children:"GLOGO car wash"})]})]})},NL=({clientData:t,onClose:e})=>{const[r,n]=bt.useState(!1),a=()=>{const h=new Date;t.startDate||h.toLocaleDateString("en-GB");let d;if(t.startDate&&t.startDate.includes("-")){const[v,_,y]=t.startDate.split("-"),w={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11};d=new Date(parseInt(y),w[_],parseInt(v))}else d=new Date(t.startDate||h);const p=new Date(d);return p.setDate(p.getDate()+30),{ref:`GLOGO-${String(Math.floor(Math.random()*1e3)).padStart(3,"0")}`,date:h.toISOString().split("T")[0],customer:{name:t.name||"Customer Name",addressLine1:t.villa||"Villa Address",addressLine2:"Dubai, U.A.E."},service:{subject:"Car Wash",packageId:t.washmanPackage||"Standard Package",vehicleType:t.carType||"Vehicle",startDate:d.toLocaleDateString("en-GB"),endDate:p.toLocaleDateString("en-GB"),duration:"30 days"},basePrice:parseInt(t.fee)||100}},o=()=>{window.print()};if(!r)return k.jsx("div",{style:Ht.modalBackdrop,onClick:e,children:k.jsxs("div",{style:Ht.modalContent,onClick:h=>h.stopPropagation(),children:[k.jsx("h2",{style:{color:"#548235",marginBottom:"1.5rem"},children:"Generate Invoice"}),k.jsxs("div",{style:Ht.clientPreview,children:[k.jsxs("p",{children:[k.jsx("strong",{children:"Client:"})," ",t.name]}),k.jsxs("p",{children:[k.jsx("strong",{children:"Villa:"})," ",t.villa]}),k.jsxs("p",{children:[k.jsx("strong",{children:"Package:"})," ",t.washmanPackage]}),k.jsxs("p",{children:[k.jsx("strong",{children:"Fee:"})," AED ",t.fee]})]}),k.jsxs("div",{style:Ht.buttonGroup,children:[k.jsx("button",{onClick:()=>n(!0),style:Ht.generateButton,children:" Generate Invoice"}),k.jsx("button",{onClick:e,style:Ht.cancelButton,children:"Cancel"})]})]})});const l=a(),u=()=>{const h=new Date(l.date).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}),d=l.basePrice*.05,p=l.basePrice+d,v=`
      <html>
        <head>
          <meta charset="utf-8">
          <title>Tax Invoice</title>
          <style>
            body { font-family: Arial, sans-serif; width: 800px; margin: auto; padding: 40px; }
            h1 { text-align: center; text-decoration: underline; }
            .invoice-info { text-align: left; margin-bottom: 10px; }
            .ref-info { text-align: right; margin-bottom: 30px; }
            .customer-info { text-align: left; margin-bottom: 30px; }
            .subject { font-weight: bold; text-decoration: underline; margin-bottom: 20px; }
            table { width: 100%; border-collapse: collapse; margin-top: 20px; }
            th, td { border: 1px solid #000; padding: 8px; }
            th { text-align: center; background-color: #f2f2f2; }
            td { text-align: left; vertical-align: top; }
            .empty-cell { border: none; }
            .total-label { border: 1px solid #000; text-align: center; background-color: #f2f2f2; font-weight: bold; }
            .total-value { border: 1px solid #000; text-align: center; font-weight: bold; font-size: 1.1em; }
            .footer { margin-top: 50px; }
          </style>
        </head>
        <body>
          <h1>Tax Invoice</h1>
          <div class="invoice-info">
            <p>Date: ${h}</p>
          </div>
          <div class="ref-info">
            <p>Ref: ${l.ref}</p>
            <p>TRN#:     </p>
          </div>
          <div class="customer-info">
            <p>${l.customer.name}</p>
            <p>${l.customer.addressLine1}</p>
            <p>${l.customer.addressLine2}</p>
          </div>
          <p class="subject">SUB: ${l.service.subject}</p>
          <p>Dear Sir,</p>
          <p>Thank you for subscribing to the monthly car wash service.</p>
          <table>
            <thead>
              <tr>
                <th>No.</th>
                <th>Description</th>
                <th>Duration</th>
                <th>Total Price</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td style="text-align: center; vertical-align: middle;">1</td>
                <td>
                  Name: ${l.customer.name}<br/>
                  Package ID: ${l.service.packageId}<br/>
                  Vehicle: ${l.service.vehicleType}<br/>
                  Start: ${l.service.startDate}<br/>
                  End: ${l.service.endDate}
                </td>
                <td style="text-align: center; vertical-align: middle;">${l.service.duration}</td>
                <td style="text-align: center; vertical-align: middle;">${l.basePrice} + 5% VAT</td>
              </tr>
              <tr>
                <td class="empty-cell"></td>
                <td class="empty-cell"></td>
                <td class="total-label">TOTAL:</td>
                <td class="total-value">AED ${p.toFixed(2)}</td>
              </tr>
            </tbody>
          </table>
          <div class="footer">
            <h3>General Conditions:</h3>
            <p>Terms: Payments are to be made in advance at the beginning of each month</p>
            <p style="margin-top: 20px;">Best Regards,</p>
            <p>GLOGO car wash</p>
          </div>
        </body>
      </html>
    `,_=new Blob([v],{type:"application/msword"}),y=URL.createObjectURL(_),w=document.createElement("a");w.href=y,w.download=`Invoice_${l.ref}.doc`,document.body.appendChild(w),w.click(),document.body.removeChild(w),URL.revokeObjectURL(y)};return k.jsx("div",{style:Ht.modalBackdrop,onClick:e,children:k.jsxs("div",{style:Ht.invoiceModal,onClick:h=>h.stopPropagation(),children:[k.jsxs("div",{style:Ht.invoiceActions,children:[k.jsx("button",{onClick:o,style:Ht.printButton,children:" Print Invoice"}),k.jsx("button",{onClick:u,style:Ht.wordButton,children:" Export Word"}),k.jsx("button",{onClick:()=>n(!1),style:Ht.backButton,children:" Back"}),k.jsx("button",{onClick:e,style:Ht.closeButton,children:" Close"})]}),k.jsx(FL,{invoiceData:l})]})})},Ht={modalBackdrop:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0,0,0,0.6)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,backdropFilter:"blur(5px)"},modalContent:{backgroundColor:"white",borderRadius:"15px",padding:"2rem",boxShadow:"0 20px 60px rgba(0,0,0,0.3)",minWidth:"400px",maxWidth:"500px"},invoiceModal:{backgroundColor:"white",borderRadius:"15px",padding:"1rem",boxShadow:"0 20px 60px rgba(0,0,0,0.3)",maxWidth:"90vw",maxHeight:"90vh",overflow:"auto"},clientPreview:{backgroundColor:"#f8f9fa",padding:"1rem",borderRadius:"8px",marginBottom:"1.5rem"},buttonGroup:{display:"flex",gap:"1rem",justifyContent:"center"},generateButton:{background:"linear-gradient(135deg, #548235 0%, #6a9c3d 100%)",color:"white",padding:"12px 24px",borderRadius:"8px",border:"none",fontSize:"0.95rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 4px 15px rgba(84, 130, 53, 0.3)"},cancelButton:{background:"linear-gradient(135deg, #6c757d 0%, #495057 100%)",color:"white",padding:"12px 24px",borderRadius:"8px",border:"none",fontSize:"0.95rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 4px 15px rgba(108, 117, 125, 0.3)"},invoiceActions:{display:"flex",gap:"1rem",justifyContent:"center",marginBottom:"1rem",padding:"1rem",borderBottom:"1px solid #eee"},printButton:{background:"linear-gradient(135deg, #28a745 0%, #20c997 100%)",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",fontSize:"0.9rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 4px 15px rgba(40, 167, 69, 0.3)"},wordButton:{background:"linear-gradient(135deg, #007bff 0%, #0056b3 100%)",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",fontSize:"0.9rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 4px 15px rgba(0, 123, 255, 0.3)"},backButton:{background:"linear-gradient(135deg, #17a2b8 0%, #138496 100%)",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",fontSize:"0.9rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 4px 15px rgba(23, 162, 184, 0.3)"},closeButton:{background:"linear-gradient(135deg, #dc3545 0%, #c82333 100%)",color:"white",padding:"10px 20px",borderRadius:"8px",border:"none",fontSize:"0.9rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 4px 15px rgba(220, 53, 69, 0.3)"},invoiceContainer:{fontFamily:"Arial, sans-serif",width:"800px",margin:"auto",padding:"40px",border:"1px solid #eee",boxShadow:"0 0 10px rgba(0, 0, 0, 0.15)",backgroundColor:"white"},header:{textAlign:"center",textDecoration:"underline"},invoiceInfo:{textAlign:"left",marginBottom:"10px"},refInfo:{textAlign:"right",marginBottom:"30px"},customerInfo:{textAlign:"left",marginBottom:"30px"},subject:{fontWeight:"bold",textDecoration:"underline",marginBottom:"20px"},table:{width:"100%",borderCollapse:"collapse",marginTop:"20px"},th:{border:"1px solid #000",padding:"8px",textAlign:"center",backgroundColor:"#f2f2f2"},td:{border:"1px solid #000",padding:"8px",textAlign:"left",verticalAlign:"top"},emptyCell:{border:"none",padding:"8px"},totalLabelCell:{border:"1px solid #000",padding:"8px",textAlign:"center",backgroundColor:"#f2f2f2",fontWeight:"bold"},totalValueCell:{border:"1px solid #000",padding:"8px",textAlign:"center",fontWeight:"bold",fontSize:"1.1em"},footer:{marginTop:"50px"}},uh={width:"100%",borderCollapse:"collapse",fontSize:"0.9rem",borderRadius:"12px",overflow:"hidden",boxShadow:"0 8px 32px rgba(0,0,0,0.1)",backgroundColor:"white",border:"2px solid #548235"},Qt={backgroundColor:"#548235",color:"white",padding:"16px 20px",textAlign:"center",fontWeight:"600",fontSize:"0.95rem",letterSpacing:"0.5px",border:"1px solid #3d6b28",borderBottom:"2px solid #3d6b28"},Zt={padding:"12px 20px",border:"1px solid #e5e7eb",fontSize:"0.9rem",textAlign:"center"},Ps={transition:"all 0.2s ease",cursor:"pointer"},fh={backgroundColor:"#DAF2D0"},ML={fontSize:"1rem",padding:"0.75rem 1rem",borderRadius:"8px",border:"1px solid #ced4da",width:"100%",maxWidth:"400px",marginBottom:"2rem",display:"block",transition:"all 0.3s ease",backgroundColor:"#DAF2D0",outline:"none"},Kl={padding:"12px 24px",borderRadius:"8px",cursor:"pointer",border:"none",fontSize:"0.95rem",fontWeight:"600",transition:"all 0.3s ease",boxShadow:"0 4px 15px rgba(0,0,0,0.1)",display:"inline-flex",alignItems:"center",gap:"8px",textDecoration:"none"},IT={padding:"0",backgroundColor:"#DAF2D0"},OT={backgroundColor:"#DAF2D0",borderRadius:"12px",padding:"2rem",boxShadow:"0 6px 15px rgba(0, 0, 0, 0.07)",border:"1px solid #e9ecef"},PL=t=>{if(typeof t=="number"){const e=new Date(Math.round((t-25569)*86400*1e3)),r={day:"2-digit",month:"short",year:"numeric"};return e.toLocaleDateString("en-GB",r).replace(/ /g,"-")}return String(t||"")},LL="https://docs.google.com/spreadsheets/d/1sG0itNKcxg10mOzbuiY_i-IsPBQ3fmXwXDvqCbT3kFU/export?format=csv&gid=0";function BL({initialSearchTerm:t="",navigateToScheduleWithSearch:e,navigateToReport:r}){const[n,a]=bt.useState(t),o=bt.useRef(null),[l,u]=bt.useState(hN),[h,d]=bt.useState(!0),[p,v]=bt.useState(!1),[_,y]=bt.useState(null),[w,E]=bt.useState(!1),[S,L]=bt.useState(null);bt.useEffect(()=>{(async()=>{d(!0);const F=await AL();F.length>0&&u(F),d(!1)})()},[]),bt.useEffect(()=>{h||(SL(l),localStorage.setItem("clientsData",JSON.stringify(l)))},[l,h]),bt.useEffect(()=>{t&&o.current&&o.current.focus()},[t]),bt.useEffect(()=>{R()},[]);const z=D=>{const F=D.target.files[0];if(!F)return;const M=new FileReader;M.onload=Fe=>{const Se=new Uint8Array(Fe.target.result),ne=rp(Se,{type:"array"}),se=ne.Sheets[ne.SheetNames[0]],ae=hh.sheet_to_json(se).map(W=>({id:W.id||Math.random().toString(36).substr(2,9),name:String(W.Name||""),villa:String(W.Villa||""),phone:String(W.Phone||""),numCars:String(W["Number of car"]||""),carType:String(W["Type of Car"]||""),days:String(W.Days||""),time:String(W.Time||""),worker:String(W.Worker||""),fee:String(W.Fee||""),startDate:PL(W["start date"]),payment:String(W.payment||""),washmanPackage:String(W["Washman Package"]||""),status:String(W.Status||""),notes:String(W.Notes||"")}));u(ae),alert("Clients data imported successfully!")},M.readAsArrayBuffer(F)},O=D=>{if(!D)return"";if(D.includes("&")||D.includes(",")){const ne=D.includes("&")?"&":",";return D.split(ne).map(se=>O(se.trim())).join(" & ")}const F=D.match(/(\d{1,2}):(\d{2})\s*(AM|PM|Am|Pm|am|pm)?/i);if(!F)return D;let[,M,Fe,Se]=F;return M=parseInt(M),Se&&Se.toLowerCase()==="pm"&&M!==12?M+=12:Se&&Se.toLowerCase()==="am"&&M===12&&(M=0),`${M.toString().padStart(2,"0")}:${Fe}`},ee=(D,F)=>{const M=O(D);return M.includes("&")?M.split(" & ").map(Se=>Se.trim()).includes(F):M===F},te=D=>D.replace(/\s+/g," ").trim(),Z=D=>{e&&e(D)},C=()=>{const D=JSON.parse(localStorage.getItem("appointments")||"[]"),F=l.filter(se=>se.status&&se.status.toLowerCase()==="active"),M=[],Fe=[],Se=[],ne=l.filter(se=>!se.status||se.status.toLowerCase()!=="active");F.forEach(se=>{const Le=D.find(ae=>te(ae.villa)===te(se.villa)&&ee(se.time,ae.time));Le?M.push({client:se,schedule:Le}):Fe.push(se)}),D.forEach(se=>{F.find(ae=>te(ae.villa)===te(se.villa)&&ee(ae.time,se.time))||Se.push(se)}),y({matches:M,clientsNotInSchedule:Fe,scheduleNotInClients:Se,inactiveClients:ne,totalClients:l.length,activeClientsCount:F.length}),E(!0)},I=()=>{const D=l.filter(le=>le.status&&le.status.toLowerCase()==="active"&&le.villa&&le.time&&le.days);if(D.length===0){alert("No active clients with complete data found!");return}const F=JSON.parse(localStorage.getItem("appointments")||"[]"),M=[...F],Fe=["Raqib","Rahman"],Se={Raqib:0,Rahman:0},ne={Raqib:0,Rahman:0},se={Monday:{Raqib:0,Rahman:0},Tuesday:{Raqib:0,Rahman:0},Wednesday:{Raqib:0,Rahman:0},Thursday:{Raqib:0,Rahman:0},Friday:{Raqib:0,Rahman:0},Saturday:{Raqib:0,Rahman:0},Sunday:{Raqib:0,Rahman:0}},Le=[],ae=[],W=(le,Qe)=>{let G=le.washmanPackage;if(!G&&le.worker){const Ve=le.worker.toLowerCase();(Ve.includes("ext")||Ve.includes("int"))&&(G=le.worker)}if(!G)return!1;const et=G.toLowerCase();return et.includes("int")?et.includes("2 ext 1 int")||et.includes("3 ext 1 int"):!1};D.forEach(le=>{let Qe=[];if(le.days.toLowerCase()==="daily")Qe=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];else if(le.days.toLowerCase()==="weekends")Qe=["Friday","Saturday"];else{const et={mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",thurs:"Thursday",fri:"Friday",sat:"Saturday",sun:"Sunday"};Qe=le.days.split("-").map(at=>at.trim().toLowerCase()).map(at=>et[at]).filter(Boolean)}const G=et=>{if(le.notes){const at={Monday:["mon","monday"],Tuesday:["tue","tuesday"],Wednesday:["wed","wednesday"],Thursday:["thu","thursday"],Friday:["fri","friday"],Saturday:["sat","saturday"],Sunday:["sun","sunday"]}[et]||[];for(const Ze of at){const be=new RegExp(`${Ze}\\s+at\\s+(\\d{1,2}:\\d{2}\\s*(?:AM|PM|am|pm)?)`,"i"),Ee=le.notes.match(be);if(Ee)return O(Ee[1])}}if(le.time.includes("&")){const Ve=le.time.split("&").map(at=>at.trim());return O(Ve[0])}return O(le.time)};Qe.forEach(et=>{const Ve=G(et);if(Ve&&!M.find(Ze=>te(Ze.villa)===te(le.villa)&&Ze.day===et&&Ze.time===Ve)){const Ze=M.filter(Be=>Be.day===et&&Be.time===Ve);let be;const Ee=Ze.map(Be=>Be.worker),ze=Fe.filter(Be=>!Ee.includes(Be)),Ke=W(le);if(ze.length>0)be=ze.reduce((Be,Ye)=>{if(Ke&&ne[Be]!==ne[Ye])return ne[Be]<ne[Ye]?Be:Ye;const je=se[et][Be],dt=se[et][Ye];return je!==dt?je<dt?Be:Ye:Se[Be]<=Se[Ye]?Be:Ye});else if(Ze.length<Fe.length)be=Fe.reduce((Be,Ye)=>{if(Ke&&ne[Be]!==ne[Ye])return ne[Be]<ne[Ye]?Be:Ye;const je=se[et][Be],dt=se[et][Ye];return je!==dt?je<dt?Be:Ye:Se[Be]<=Se[Ye]?Be:Ye}),Le.push({day:et,time:Ve,workers:Ze.map(Be=>Be.worker).concat([be])});else{ae.push({clientName:le.name,villa:le.villa,day:et,time:Ve,reason:"No workers available at this time"});return}Se[be]++,se[et][be]++,Ke&&ne[be]++;const We={id:`auto_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,villa:le.villa,day:et,time:Ve,worker:be};M.push(We)}})});const V=(le=>{const Qe=JSON.parse(localStorage.getItem("clientsData")||"[]"),G={};Fe.forEach(Ve=>{G[Ve]={int:[],ext:[],total:0}}),le.forEach(Ve=>{if(!Ve.worker||!G[Ve.worker])return;const at=Qe.find(Ze=>Ze.villa&&Ve.villa&&Ze.villa.replace(/\s+/g," ").trim().toLowerCase()===Ve.villa.replace(/\s+/g," ").trim().toLowerCase());if(at){let Ze=at.washmanPackage;if(!Ze&&at.worker){const be=at.worker.toLowerCase();(be.includes("ext")||be.includes("int"))&&(Ze=at.worker)}if(Ze&&Ze.toLowerCase().includes("int")){let be=0;if(at.days.toLowerCase()==="daily")be={Monday:0,Tuesday:1,Wednesday:2,Thursday:3,Friday:4,Saturday:5,Sunday:6}[Ve.day]||0;else{const Ke={mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",thurs:"Thursday",fri:"Friday",sat:"Saturday",sun:"Sunday"};be=at.days.toLowerCase().split("-").map(Be=>Ke[Be.trim()]).filter(Boolean).indexOf(Ve.day),be===-1&&(be=0)}const Ee=Ze.toLowerCase();let ze=!1;(Ee.includes("2 ext 1 int week")||Ee.includes("3 ext 1 int week"))&&(ze=be===1),ze?G[Ve.worker].int.push(Ve):G[Ve.worker].ext.push(Ve)}else G[Ve.worker].ext.push(Ve)}else G[Ve.worker].ext.push(Ve);G[Ve.worker].total++});const et=Object.keys(G);if(et.length===2){const[Ve,at]=et,Ze=G[Ve],be=G[at],Ee=Ze.int.length-be.int.length;if(Math.abs(Ee)>1){const ze=Math.floor(Math.abs(Ee)/2);if(Ee>0)for(let Ke=0;Ke<ze&&Ke<Ze.int.length&&Ke<be.ext.length;Ke++){const We=Ze.int[Ke],Be=be.ext[Ke];if(!(le.some(je=>je.id!==We.id&&je.id!==Be.id&&je.day===We.day&&je.time===We.time&&je.worker===at)||le.some(je=>je.id!==We.id&&je.id!==Be.id&&je.day===Be.day&&je.time===Be.time&&je.worker===Ve))){const je=le.findIndex(rt=>rt.id===We.id),dt=le.findIndex(rt=>rt.id===Be.id);je!==-1&&dt!==-1&&(le[je].worker=at,le[dt].worker=Ve)}}else for(let Ke=0;Ke<ze&&Ke<be.int.length&&Ke<Ze.ext.length;Ke++){const We=be.int[Ke],Be=Ze.ext[Ke];if(!(le.some(je=>je.id!==We.id&&je.id!==Be.id&&je.day===We.day&&je.time===We.time&&je.worker===Ve)||le.some(je=>je.id!==We.id&&je.id!==Be.id&&je.day===Be.day&&je.time===Be.time&&je.worker===at))){const je=le.findIndex(rt=>rt.id===We.id),dt=le.findIndex(rt=>rt.id===Be.id);je!==-1&&dt!==-1&&(le[je].worker=Ve,le[dt].worker=at)}}}}return le})(M);localStorage.setItem("appointments",JSON.stringify(V));const Y=V.length-F.length,Q={};Fe.forEach(le=>{Q[le]=V.filter(Qe=>Qe.worker===le).length});const J={};Fe.forEach(le=>{J[le]={int:0,ext:0,total:0}});const ue=JSON.parse(localStorage.getItem("clientsData")||"[]");V.forEach(le=>{if(!le.worker||!J[le.worker])return;const Qe=ue.find(et=>et.villa&&le.villa&&et.villa.replace(/\s+/g," ").trim().toLowerCase()===le.villa.replace(/\s+/g," ").trim().toLowerCase());let G=!1;if(Qe){let et=Qe.washmanPackage;if(!et&&Qe.worker){const Ve=Qe.worker.toLowerCase();(Ve.includes("ext")||Ve.includes("int"))&&(et=Qe.worker)}if(et&&et.toLowerCase().includes("int")){let Ve=0;if(Qe.days.toLowerCase()==="daily")Ve={Monday:0,Tuesday:1,Wednesday:2,Thursday:3,Friday:4,Saturday:5,Sunday:6}[le.day]||0;else{const Ze={mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",thurs:"Thursday",fri:"Friday",sat:"Saturday",sun:"Sunday"};Ve=Qe.days.toLowerCase().split("-").map(Ee=>Ze[Ee.trim()]).filter(Boolean).indexOf(le.day),Ve===-1&&(Ve=0)}const at=et.toLowerCase();(at.includes("2 ext 1 int week")||at.includes("3 ext 1 int week"))&&(G=Ve===1)}}G?J[le.worker].int++:J[le.worker].ext++,J[le.worker].total++});const Ie=Object.values(Q).reduce((le,Qe)=>le+Qe,0);Fe.map(le=>{const Qe=Ie>0?(Q[le]/Ie*100).toFixed(1):0,G=ne[le]||0;return`   ${le}: ${Q[le]} total (${Qe}%) - ${G} INT assignments`}).join(`
`),Object.keys(se).map(le=>se[le].Raqib+se[le].Rahman===0?null:`   ${le}: Raqib(${se[le].Raqib}) Rahman(${se[le].Rahman})`).filter(Boolean).join(`
`);let ke=` Auto-Fill Schedule Completed
${"=".repeat(30)}

 Added: ${Y} new appointments
 Total appointments: ${M.length}
`;ae.length>0&&(ke+=` Ignored appointments: ${ae.length}
`),Le.length>0&&(ke+=` Conflicts: ${Le.length}
`),ke+=`
 Data saved successfully!`;const Oe={totalScheduled:Y,ignoredAppointments:ae,conflicts:Le,workerStats:J};localStorage.setItem("lastReportData",JSON.stringify(Oe)),alert(ke)},R=bt.useCallback(async()=>{v(!0);try{const M=(await(await fetch(LL)).text()).split(`
`),Fe=M[0].split(",").map(ne=>ne.trim().replace(/"/g,"")),Se=M.slice(1).filter(ne=>ne.trim()).map((ne,se)=>{const Le=ne.split(",").map(W=>W.trim().replace(/"/g,"")),ae={};return Fe.forEach((W,pe)=>{ae[W]=Le[pe]||""}),{id:ae.id||`google_${se}`,name:String(ae.Name||""),villa:String(ae.Villa||""),phone:String(ae.Phone||""),numCars:String(ae["Number of car"]||""),carType:String(ae["Type of Car"]||""),days:String(ae.Days||""),time:String(ae.Time||""),worker:String(ae.Worker||""),fee:String(ae.Fee||""),startDate:String(ae["start date"]||""),payment:String(ae.payment||""),washmanPackage:String(ae["Washman Package"]||""),status:String(ae.Status||""),notes:String(ae.Notes||"")}});u(Se)}catch{alert("Error updating data from Google Sheets")}finally{v(!1)}},[]),B=l.filter(D=>D.name.toLowerCase().includes(n.toLowerCase())||D.villa.toLowerCase().includes(n.toLowerCase())||D.phone.toLowerCase().includes(n.toLowerCase()));return w&&_?k.jsx("div",{style:IT,children:k.jsxs("div",{style:OT,children:[k.jsx("div",{style:{marginBottom:"2rem"},children:k.jsx("button",{onClick:()=>E(!1),style:{...Kl,background:"linear-gradient(135deg, #548235 0%, #6a9c3d 100%)",color:"white",boxShadow:"0 6px 20px rgba(84, 130, 53, 0.3)",border:"2px solid transparent"},children:" Back to Clients"})}),k.jsx("h1",{style:{color:"#548235",fontSize:"2.5rem",fontWeight:"700",marginBottom:"2rem",textAlign:"center"},children:"Comparison Results"}),k.jsxs("div",{style:{textAlign:"center",marginBottom:"2rem",padding:"1rem",backgroundColor:"#DAF2D0",borderRadius:"8px",border:"1px solid #e9ecef"},children:[k.jsxs("p",{style:{margin:"0.5rem 0",fontSize:"1rem",color:"#495057"},children:[" ",k.jsx("strong",{children:"Total Clients:"})," ",_.totalClients," |  ",k.jsx("strong",{children:"Active Clients:"})," ",_.activeClientsCount," |  ",k.jsx("strong",{children:"Inactive Clients:"})," ",_.inactiveClients.length]}),k.jsx("p",{style:{margin:"0",fontSize:"0.9rem",color:"#6c757d"},children:k.jsx("em",{children:"Only Active clients are included in the comparison"})})]}),k.jsxs("div",{style:{marginBottom:"3rem"},children:[k.jsxs("h2",{style:{color:"#28a745"},children:[" Matched (",_.matches.length,")"]}),k.jsx("div",{style:{overflowX:"auto"},children:k.jsxs("table",{style:uh,children:[k.jsx("thead",{children:k.jsxs("tr",{children:[k.jsx("th",{style:Qt,children:"Client Name"}),k.jsx("th",{style:Qt,children:"Villa"}),k.jsx("th",{style:Qt,children:"Client Time"}),k.jsx("th",{style:Qt,children:"Client Days"}),k.jsx("th",{style:Qt,children:"Schedule Day"}),k.jsx("th",{style:Qt,children:"Schedule Time"})]})}),k.jsx("tbody",{children:_.matches.map((D,F)=>k.jsxs("tr",{style:F%2===0?{...Ps,...fh}:Ps,children:[k.jsx("td",{style:Zt,children:D.client.name}),k.jsx("td",{style:Zt,children:D.client.villa}),k.jsx("td",{style:Zt,children:D.client.time}),k.jsx("td",{style:Zt,children:D.client.days}),k.jsx("td",{style:Zt,children:D.schedule.day}),k.jsx("td",{style:Zt,children:D.schedule.time})]},F))})]})})]}),k.jsxs("div",{style:{marginBottom:"3rem"},children:[k.jsxs("h2",{style:{color:"#dc3545"},children:[" Clients Not in Schedule (",_.clientsNotInSchedule.length,")"]}),k.jsx("div",{style:{overflowX:"auto"},children:k.jsxs("table",{style:uh,children:[k.jsx("thead",{children:k.jsxs("tr",{children:[k.jsx("th",{style:Qt,children:"Name"}),k.jsx("th",{style:Qt,children:"Villa"}),k.jsx("th",{style:Qt,children:"Time"}),k.jsx("th",{style:Qt,children:"Days"}),k.jsx("th",{style:Qt,children:"Status"})]})}),k.jsx("tbody",{children:_.clientsNotInSchedule.map((D,F)=>k.jsxs("tr",{style:F%2===0?{...Ps,...fh}:Ps,children:[k.jsx("td",{style:Zt,children:D.name}),k.jsx("td",{style:Zt,children:D.villa}),k.jsx("td",{style:Zt,children:D.time}),k.jsx("td",{style:Zt,children:D.days}),k.jsx("td",{style:Zt,children:!D.time||!D.days?"Incomplete Data":"Not Scheduled"})]},F))})]})})]}),k.jsxs("div",{children:[k.jsxs("h2",{style:{color:"#ffc107"},children:[" Schedule Not in Clients (",_.scheduleNotInClients.length,")"]}),k.jsx("div",{style:{overflowX:"auto"},children:k.jsxs("table",{style:uh,children:[k.jsx("thead",{children:k.jsxs("tr",{children:[k.jsx("th",{style:Qt,children:"Villa"}),k.jsx("th",{style:Qt,children:"Day"}),k.jsx("th",{style:Qt,children:"Time"}),k.jsx("th",{style:Qt,children:"Status"})]})}),k.jsx("tbody",{children:_.scheduleNotInClients.map((D,F)=>k.jsxs("tr",{style:F%2===0?{...Ps,...fh}:Ps,children:[k.jsx("td",{style:Zt,children:D.villa}),k.jsx("td",{style:Zt,children:D.day}),k.jsx("td",{style:Zt,children:D.time}),k.jsx("td",{style:Zt,children:"No Client Found"})]},F))})]})})]})]})}):k.jsxs(k.Fragment,{children:[S&&k.jsx(NL,{clientData:S,onClose:()=>L(null)}),k.jsx("div",{style:IT,children:k.jsxs("div",{style:OT,children:[k.jsx("h1",{style:{color:"#548235",fontSize:"2.5rem",fontWeight:"700",marginBottom:"2rem",textAlign:"center"},children:"Clients Management"}),k.jsxs("div",{style:{marginBottom:"2rem",display:"flex",gap:"1rem",flexWrap:"wrap",justifyContent:"center"},children:[k.jsx("input",{type:"file",accept:".xlsx,.xls,.csv",onChange:z,style:{display:"none"},id:"import-clients"}),k.jsx("label",{htmlFor:"import-clients",style:{...Kl,background:"linear-gradient(135deg, #548235 0%, #6a9c3d 100%)",color:"white",boxShadow:"0 6px 20px rgba(84, 130, 53, 0.3)",border:"2px solid transparent"},children:" Import Excel/CSV"}),k.jsx("button",{onClick:R,disabled:p,style:{...Kl,background:p?"linear-gradient(135deg, #94a3b8 0%, #64748b 100%)":"linear-gradient(135deg, #548235 0%, #6a9c3d 100%)",color:"white",cursor:p?"not-allowed":"pointer",boxShadow:p?"0 4px 15px rgba(148, 163, 184, 0.3)":"0 6px 20px rgba(84, 130, 53, 0.3)",border:"2px solid transparent"},children:p?" Updating...":" Refresh from Google Sheets"}),k.jsx("button",{onClick:C,style:{...Kl,background:"linear-gradient(135deg, #548235 0%, #6a9c3d 100%)",color:"white",boxShadow:"0 6px 20px rgba(84, 130, 53, 0.3)",border:"2px solid transparent"},children:" Compare with Schedule"}),k.jsx("button",{onClick:I,style:{...Kl,background:"linear-gradient(135deg, #548235 0%, #6a9c3d 100%)",color:"white",boxShadow:"0 6px 20px rgba(84, 130, 53, 0.3)",border:"2px solid transparent"},children:" Auto Fill Schedule"}),k.jsx("button",{onClick:()=>{const D=localStorage.getItem("lastReportData");D&&r?r(JSON.parse(D)):alert("   .     .")},style:{...Kl,background:"linear-gradient(135deg, #17a2b8 0%, #138496 100%)",color:"white",boxShadow:"0 6px 20px rgba(23, 162, 184, 0.3)",border:"2px solid transparent"},children:" View Report"})]}),k.jsxs("div",{style:{position:"relative",maxWidth:"400px",marginBottom:"2rem"},children:[k.jsx("input",{ref:o,type:"text",placeholder:" Search clients by name, villa, or phone...",value:n,onChange:D=>a(D.target.value),style:{...ML,marginBottom:"0",paddingRight:n?"40px":"1rem"}}),n&&k.jsx("button",{onClick:()=>a(""),style:{position:"absolute",right:"10px",top:"50%",transform:"translateY(-50%)",background:"none",border:"none",fontSize:"18px",color:"#6c757d",cursor:"pointer",padding:"0",width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",transition:"all 0.2s ease"},onMouseOver:D=>{D.target.style.backgroundColor="#e9ecef",D.target.style.color="#495057"},onMouseOut:D=>{D.target.style.backgroundColor="transparent",D.target.style.color="#6c757d"},children:""})]}),k.jsx("div",{style:{overflowX:"auto",borderRadius:"12px"},children:k.jsxs("table",{style:uh,children:[k.jsx("thead",{children:k.jsxs("tr",{children:[k.jsx("th",{style:Qt,children:"Name"}),k.jsx("th",{style:Qt,children:"Villa"}),k.jsx("th",{style:Qt,children:"Phone"}),k.jsx("th",{style:Qt,children:"Number of Cars"}),k.jsx("th",{style:Qt,children:"Type of Car"}),k.jsx("th",{style:Qt,children:"Days"}),k.jsx("th",{style:Qt,children:"Time"}),k.jsx("th",{style:Qt,children:"Fee"}),k.jsx("th",{style:Qt,children:"Start Date"}),k.jsx("th",{style:Qt,children:"Payment"}),k.jsx("th",{style:Qt,children:"Washman Package"}),k.jsx("th",{style:Qt,children:"Notes"}),k.jsx("th",{style:Qt,children:"Current Wash"}),k.jsx("th",{style:Qt,children:"Status"}),k.jsx("th",{style:Qt,children:"Actions"})]})}),k.jsx("tbody",{children:B.map((D,F)=>k.jsxs("tr",{style:F%2===0?{...Ps,...fh}:Ps,children:[k.jsx("td",{style:Zt,children:D.name}),k.jsx("td",{style:{...Zt,cursor:"pointer",color:"#548235",fontWeight:"600",textDecoration:"underline"},onClick:()=>Z(D.villa),children:D.villa}),k.jsx("td",{style:Zt,children:D.phone}),k.jsx("td",{style:Zt,children:D.numCars}),k.jsx("td",{style:Zt,children:D.carType}),k.jsx("td",{style:Zt,children:D.days}),k.jsx("td",{style:Zt,children:D.time}),k.jsx("td",{style:Zt,children:D.fee}),k.jsx("td",{style:Zt,children:D.startDate}),k.jsx("td",{style:Zt,children:D.payment}),k.jsx("td",{style:Zt,children:D.washmanPackage}),k.jsx("td",{style:Zt,children:D.notes}),k.jsx("td",{style:Zt,children:(()=>{if(!D.startDate||!D.days)return k.jsx("span",{style:{padding:"4px 8px",borderRadius:"12px",fontSize:"0.7rem",fontWeight:"500",backgroundColor:"#6c757d",color:"white"},children:" Missing Data"});let M=D.washmanPackage;if(!M&&D.worker){const Se=D.worker.toLowerCase();(Se.includes("ext")||Se.includes("int"))&&(M=D.worker)}if(!M)return k.jsx("span",{style:{padding:"4px 8px",borderRadius:"12px",fontSize:"0.7rem",fontWeight:"500",backgroundColor:"#6c757d",color:"white"},children:" Missing Data"});const Fe=pN(D);return Fe?k.jsx("span",{style:{padding:"4px 8px",borderRadius:"12px",fontSize:"0.7rem",fontWeight:"600",backgroundColor:"#17a2b8",color:"white"},children:Fe}):D.washmanPackage||D.worker&&(D.worker.toLowerCase().includes("ext")||D.worker.toLowerCase().includes("int"))?k.jsx("span",{style:{padding:"4px 8px",borderRadius:"12px",fontSize:"0.7rem",fontWeight:"500",backgroundColor:"#ffc107",color:"black"},children:D.washmanPackage||D.worker}):k.jsx("span",{style:{padding:"4px 8px",borderRadius:"12px",fontSize:"0.7rem",fontWeight:"500",backgroundColor:"#6c757d",color:"white"},children:" No Package"})})()}),k.jsx("td",{style:Zt,children:k.jsx("span",{style:{padding:"4px 8px",borderRadius:"12px",fontSize:"0.8rem",fontWeight:"600",backgroundColor:D.status&&D.status.toLowerCase()==="active"?"#28a745":"#dc3545",color:"white"},children:D.status||"Not Active"})}),k.jsx("td",{style:Zt,children:k.jsx("button",{onClick:()=>L(D),style:{background:"linear-gradient(135deg, #548235 0%, #6a9c3d 100%)",color:"white",padding:"6px 12px",borderRadius:"6px",border:"none",fontSize:"0.8rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 2px 8px rgba(84, 130, 53, 0.3)"},children:" Invoice"})})]},D.id))})]})}),B.length===0&&k.jsx("p",{style:{textAlign:"center",marginTop:"2rem",color:"#666",fontSize:"1.1rem"},children:" No clients found matching your search."})]})})]})}const VL=({reportData:t,onBack:e})=>{const[r,n]=bt.useState(""),a=()=>{const l=o(t);navigator.clipboard.writeText(l).then(()=>{n("Report copied successfully!"),setTimeout(()=>n(""),3e3)})},o=l=>{let u=`Auto-Fill Schedule Report
${"=".repeat(30)}

`;return l.ignoredAppointments?.length>0&&(u+=`Ignored Appointments (${l.ignoredAppointments.length}):
`,u+="-".repeat(20)+`
`,l.ignoredAppointments.forEach(h=>{u+=` ${h.clientName} - ${h.day} at ${h.time}
`,u+=`  Reason: ${h.reason}

`})),l.conflicts?.length>0&&(u+=`Conflicts (${l.conflicts.length}):
`,u+="-".repeat(20)+`
`,l.conflicts.forEach(h=>{u+=` ${h.day} at ${h.time}
`,u+=`  Workers: ${h.workers.join(", ")}

`})),u+=`Worker Distribution:
`,u+="-".repeat(20)+`
`,Object.entries(l.workerStats||{}).forEach(([h,d])=>{u+=`${h}:
`,u+=`  Total Appointments: ${d.total}
`,u+=`  Internal Work: ${d.internal}
`,u+=`  External Work: ${d.external}

`}),u+=`Statistics:
`,u+="-".repeat(20)+`
`,u+=`Total Scheduled Appointments: ${l.totalScheduled||0}
`,u+=`Total Ignored Appointments: ${l.ignoredAppointments?.length||0}
`,u+=`Total Conflicts: ${l.conflicts?.length||0}
`,u};return t?k.jsxs("div",{className:"report-page",children:[k.jsxs("div",{className:"report-header",children:[k.jsx("button",{onClick:e,className:"back-btn",children:" Back"}),k.jsx("h2",{children:"Auto-Fill Schedule Report"}),k.jsx("button",{onClick:a,className:"copy-btn",children:" Copy Report"})]}),r&&k.jsx("div",{className:"copy-success",children:"Report copied successfully!"}),k.jsxs("div",{className:"report-content",children:[t.ignoredAppointments?.length>0&&k.jsxs("div",{className:"report-section ignored-section",children:[k.jsxs("h3",{children:[" Ignored Appointments (",t.ignoredAppointments.length,")"]}),k.jsx("div",{className:"ignored-list",children:t.ignoredAppointments.map((l,u)=>k.jsxs("div",{className:"ignored-item",children:[k.jsx("div",{className:"ignored-client",children:k.jsx("strong",{children:l.clientName})}),k.jsxs("div",{className:"ignored-details",children:[l.day,"  ",l.time]}),k.jsxs("div",{className:"ignored-reason",children:["Reason: ",l.reason]})]},u))})]}),t.conflicts?.length>0&&k.jsxs("div",{className:"report-section conflicts-section",children:[k.jsxs("h3",{children:[" Conflicts (",t.conflicts.length,")"]}),k.jsx("div",{className:"conflicts-list",children:t.conflicts.map((l,u)=>k.jsxs("div",{className:"conflict-item",children:[k.jsxs("div",{className:"conflict-time",children:[l.day,"  ",l.time]}),k.jsxs("div",{className:"conflict-workers",children:["Workers: ",l.workers.join(", ")]})]},u))})]}),k.jsxs("div",{className:"report-section stats-section",children:[k.jsx("h3",{children:" Worker Distribution"}),k.jsx("div",{className:"worker-stats",children:Object.entries(t.workerStats||{}).map(([l,u])=>k.jsxs("div",{className:"worker-stat",children:[k.jsx("h4",{children:l}),k.jsxs("div",{className:"stat-item",children:[k.jsx("span",{children:"Total Appointments:"}),k.jsx("span",{children:u.total})]}),k.jsxs("div",{className:"stat-item",children:[k.jsx("span",{children:"Internal Work:"}),k.jsx("span",{children:u.internal})]}),k.jsxs("div",{className:"stat-item",children:[k.jsx("span",{children:"External Work:"}),k.jsx("span",{children:u.external})]})]},l))})]}),k.jsxs("div",{className:"report-section summary-section",children:[k.jsx("h3",{children:" Statistics Summary"}),k.jsxs("div",{className:"summary-stats",children:[k.jsxs("div",{className:"summary-item",children:[k.jsx("span",{children:"Total Scheduled Appointments:"}),k.jsx("span",{children:t.totalScheduled||0})]}),k.jsxs("div",{className:"summary-item",children:[k.jsx("span",{children:"Total Ignored Appointments:"}),k.jsx("span",{children:t.ignoredAppointments?.length||0})]}),k.jsxs("div",{className:"summary-item",children:[k.jsx("span",{children:"Total Conflicts:"}),k.jsx("span",{children:t.conflicts?.length||0})]})]})]})]})]}):k.jsx("div",{className:"report-page",children:k.jsxs("div",{className:"report-header",children:[k.jsx("button",{onClick:e,className:"back-btn",children:" Back"}),k.jsx("h2",{children:"No Report Available"})]})})};function UL(){const[t,e]=bt.useState("schedule"),[r,n]=bt.useState(""),[a,o]=bt.useState(""),[l,u]=bt.useState(null),h=(y="")=>{n(y),e("clients")},d=(y="")=>{o(y),e("schedule")},p=y=>{u(y),e("report")},v=()=>{if(t==="schedule")return k.jsx(OL,{navigateToClientsWithSearch:h,initialSearchTerm:a});if(t==="clients")return k.jsx(BL,{initialSearchTerm:r,navigateToScheduleWithSearch:d,navigateToReport:p});if(t==="report")return k.jsx(VL,{reportData:l,onBack:()=>e("clients")})},_=y=>{t==="clients"&&y!=="clients"&&n(""),t==="schedule"&&y!=="schedule"&&o(""),e(y)};return k.jsxs("div",{className:"App",children:[k.jsx(c3,{setCurrentPage:_,currentPage:t}),k.jsx("main",{children:v()})]})}l3.createRoot(document.getElementById("root")).render(k.jsx(bt.StrictMode,{children:k.jsx(UL,{})}));
